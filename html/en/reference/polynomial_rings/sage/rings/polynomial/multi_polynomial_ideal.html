<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Ideals in multivariate polynomial rings. &mdash; Sage Reference Manual v7.5: Polynomials</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.5: Polynomials" href="../../../index.html" />
    <link rel="up" title="Multivariate Polynomials and Polynomial Rings" href="../../../polynomial_rings_multivar.html" />
    <link rel="next" title="Polynomial Sequences" href="multi_polynomial_sequence.html" />
    <link rel="prev" title="Generic Multivariate Polynomials" href="multi_polynomial_element.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="multi_polynomial_sequence.html" title="Polynomial Sequences"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="multi_polynomial_element.html" title="Generic Multivariate Polynomials"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Polynomials</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../../polynomial_rings_multivar.html" accesskey="U">Multivariate Polynomials and Polynomial Rings</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sage-rings-polynomial-multi-polynomial-ideal">
<span id="ideals-in-multivariate-polynomial-rings"></span><h1>Ideals in multivariate polynomial rings.<a class="headerlink" href="#sage-rings-polynomial-multi-polynomial-ideal" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.rings.polynomial.multi_polynomial_ideal"></span><p>Sage has a powerful system to compute with multivariate polynomial
rings. Most algorithms dealing with these ideals are centered on the
computation of <em>Groebner bases</em>. Sage mainly uses Singular to
implement this functionality. Singular is widely regarded as the best
open-source system for Groebner basis calculation in multivariate
polynomial rings over fields.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein</li>
<li>Kiran S. Kedlaya (2006-02-12): added Macaulay2 analogues of some
Singular features</li>
<li>Martin Albrecht (2008,2007): refactoring, many Singular related
functions</li>
<li>Martin Albrecht (2009): added Groebner basis over rings
functionality from Singular 3.1</li>
<li>John Perry (2012): bug fixing equality &amp; containment of ideals</li>
</ul>
<p>EXAMPLES:</p>
<p>We compute a Groebner basis for some given ideal. The type returned by
the <code class="docutils literal"><span class="pre">groebner_basis</span></code> method is <code class="docutils literal"><span class="pre">PolynomialSequence</span></code>, i.e. it is not a
<a class="reference internal" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal" title="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal"><code class="xref py py-class docutils literal"><span class="pre">MPolynomialIdeal</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.polynomial.multi_polynomial_sequence.PolynomialSequence_generic&#39;&gt;</span>
</pre></div>
</div>
<p>Groebner bases can be used to solve the ideal membership problem:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">B</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">f</span> <span class="o">+</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">f</span> <span class="o">+</span> <span class="n">g</span><span class="p">)</span> <span class="ow">in</span> <span class="n">I</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">f</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">y^3</span>

<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">f</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span> <span class="ow">in</span> <span class="n">I</span>
<span class="go">False</span>
</pre></div>
</div>
<p>We compute a Groebner basis for Cyclic 6, which is a standard
benchmark and test ideal.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x,y,z,t,u,v&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Cyclic</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">45</span>
</pre></div>
</div>
<p>We compute in a quotient of a polynomial ring over <span class="math">\(\ZZ/17\ZZ\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">quotient</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">S</span>
<span class="go">Quotient of Multivariate Polynomial Ring in x, y over Integer Ring</span>
<span class="go">by the ideal (x^2 + y^2, 17)</span>

<span class="gp">sage: </span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-a*b^2 - b^2</span>
</pre></div>
</div>
<p>Note that the result of a computation is not necessarily reduced:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">^</span><span class="mi">17</span>
<span class="go">256*a*b^16 + 256*b^17</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Or we can work with <span class="math">\(\ZZ/17\ZZ\)</span> directly:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">17</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">quotient</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,))</span>
<span class="gp">sage: </span><span class="n">S</span>
<span class="go">Quotient of Multivariate Polynomial Ring in x, y over Ring of</span>
<span class="go">integers modulo 17 by the ideal (x^2 + y^2)</span>

<span class="gp">sage: </span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">16</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">^</span><span class="mi">17</span>
<span class="go">a*b^16 + b^17</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Working with a polynomial ring over <span class="math">\(\ZZ\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[4*y^4 - 4*y^2*z^2 + z^4 - 4*y^2*w^2 + 2*z^2*w^2 + w^4,</span>
<span class="go"> 2*x*y^2 - 2*y^3 - x*z^2 + y*z^2 - x*w^2 + y*w^2,</span>
<span class="go"> x^2 - 2*x*y + y^2]</span>

<span class="gp">sage: </span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">J</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mi">0</span> <span class="ow">in</span> <span class="n">J</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We do a Groebner basis computation over a number field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">zeta</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[];</span> <span class="n">R</span>
<span class="go">Multivariate Polynomial Ring in x, y, z over Cyclotomic Field of order 3 and degree 2</span>

<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">zeta</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">zeta</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">);</span> <span class="n">i</span>
<span class="go">Ideal (x + (-zeta)*y + 1, x^3 + (-zeta)*y^3) of Multivariate</span>
<span class="go">Polynomial Ring in x, y, z over Cyclotomic Field of order 3 and degree 2</span>

<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[y^3 + (2*zeta + 1)*y^2 + (zeta - 1)*y + (-1/3*zeta - 2/3), x + (-zeta)*y + 1]</span>

<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">quotient</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="n">S</span>
<span class="go">Quotient of Multivariate Polynomial Ring in x, y, z over</span>
<span class="go">Cyclotomic Field of order 3 and degree 2 by the ideal (x +</span>
<span class="go">(-zeta)*y + 1, x^3 + (-zeta)*y^3)</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="mi">0</span>  <span class="o">-</span> <span class="n">zeta</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="mi">1</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="mi">0</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">zeta</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="mi">1</span><span class="o">^</span><span class="mi">3</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Two examples from the Mathematica documentation (done in Sage):</p>
<blockquote>
<div><p>We compute a Groebner basis:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[x - 2/3*y^3, y^4 - 9/2]</span>
</pre></div>
</div>
<p>We show that three polynomials have no common root:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[1]</span>
</pre></div>
</div>
</div></blockquote>
<p>The next example shows how we can use Groebner bases over <span class="math">\(\ZZ\)</span> to
find the primes modulo which a system of equations has a solution,
when the system has no solutions over the rationals.</p>
<blockquote>
<div><p>We first form a certain ideal <span class="math">\(I\)</span> in <span class="math">\(\ZZ[x, y, z]\)</span>, and note that
the Groebner basis of <span class="math">\(I\)</span> over <span class="math">\(\QQ\)</span> contains 1, so there are no
solutions over <span class="math">\(\QQ\)</span> or an algebraic closure of it (this is not
surprising as there are 4 equations in 3 unknowns).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> \
<span class="go">                x*z + y*z + z^2, -3*x*y + 2*y*z + 6*z^2)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQ</span><span class="p">))</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[1]</span>
</pre></div>
</div>
<p>However, when we compute the Groebner basis of I (defined over
<span class="math">\(\ZZ\)</span>), we note that there is a certain integer in the ideal
which is not 1.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[x + 130433*y + 59079*z, y^2 + 3*y + 17220, y*z + 5*y + 14504, 2*y + 158864, z^2 + 17223, 2*z + 41856, 164878]</span>
</pre></div>
</div>
<p>Now for each prime <span class="math">\(p\)</span> dividing this integer 164878, the Groebner
basis of I modulo <span class="math">\(p\)</span> will be non-trivial and will thus give a
solution of the original system modulo <span class="math">\(p\)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">164878</span><span class="p">)</span>
<span class="go">2 * 7 * 11777</span>

<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">))</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[x + y + z, y^2 + y, y*z + y, z^2 + 1]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">))</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[x - 1, y + 3, z - 2]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span> <span class="n">GF</span><span class="p">(</span><span class="mi">11777</span> <span class="p">)))</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[x + 5633, y - 3007, z - 2626]</span>
</pre></div>
</div>
<p>The Groebner basis modulo any product of the prime factors is also non-trivial:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span> <span class="n">IntegerModRing</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span> <span class="p">))</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[x + 3*y + 11*z, y^2 + 3*y, y*z + 11*y + 4, 2*y + 6, z^2 + 3, 2*z + 10]</span>
</pre></div>
</div>
<p>Modulo any other prime the Groebner basis is trivial so there are
no other solutions. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span> <span class="n">P</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[1]</span>
</pre></div>
</div>
</div></blockquote>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">I</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sage distinguishes between lists or sequences of polynomials and
ideals. Thus an ideal is not identified with a particular set of
generators. For sequences of multivariate polynomials see
<a class="reference internal" href="multi_polynomial_sequence.html#sage.rings.polynomial.multi_polynomial_sequence.PolynomialSequence_generic" title="sage.rings.polynomial.multi_polynomial_sequence.PolynomialSequence_generic"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.polynomial.multi_polynomial_sequence.PolynomialSequence_generic</span></code></a>.</p>
</div>
<dl class="class">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.multi_polynomial_ideal.</code><code class="descname">MPolynomialIdeal</code><span class="sig-paren">(</span><em>ring</em>, <em>gens</em>, <em>coerce=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr" title="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr</span></code></a>, <a class="reference internal" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_macaulay2_repr" title="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_macaulay2_repr"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_macaulay2_repr</span></code></a>, <a class="reference internal" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_magma_repr" title="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_magma_repr"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_magma_repr</span></code></a>, <a class="reference external" href="../../../../rings/sage/rings/ideal.html#sage.rings.ideal.Ideal_generic" title="(in Sage Reference Manual: General Rings, Ideals, and Morphisms v7.5)"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.ideal.Ideal_generic</span></code></a></p>
<p>Create an ideal in a multivariate polynomial ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ring</span></code> - the ring the ideal is defined in</li>
<li><code class="docutils literal"><span class="pre">gens</span></code> - a list of generators for the ideal</li>
<li><code class="docutils literal"><span class="pre">coerce</span></code> - coerce elements to the ring <code class="docutils literal"><span class="pre">ring</span></code>?</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">IntegerRing</span><span class="p">(),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="go">Ideal (x, y) of Multivariate Polynomial Ring in x, y over Integer Ring</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">x0</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Ideal (x0^2, x1^3) of Multivariate Polynomial Ring in x0, x1 over Finite Field of size 3</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.basis">
<code class="descname">basis</code><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut to <code class="docutils literal"><span class="pre">gens()</span></code>.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">basis</span>
<span class="go">[x, y + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.change_ring">
<code class="descname">change_ring</code><span class="sig-paren">(</span><em>P</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.change_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ideal <code class="docutils literal"><span class="pre">I</span></code> in <code class="docutils literal"><span class="pre">P</span></code> spanned by
the generators <span class="math">\(g_1, ..., g_n\)</span> of self as returned by
<code class="docutils literal"><span class="pre">self.gens()</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">P</span></code> - a multivariate polynomial ring</li>
</ul>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Cyclic</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span>
<span class="go">Ideal (x + y + z, x*y + x*z + y*z, x*y*z - 1) of</span>
<span class="go">Multivariate Polynomial Ring in x, y, z over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[x + y + z, y^2 + y*z + z^2, z^3 - 1]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;degrevlex&#39;</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Multivariate Polynomial Ring in x, y, z over Rational Field</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">term_order</span><span class="p">()</span>
<span class="go">Degree reverse lexicographic term order</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Q</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Ideal (x + y + z, x*y + x*z + y*z, x*y*z - 1) of</span>
<span class="go">Multivariate Polynomial Ring in x, y, z over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[z^3 - 1, y^2 + y*z + z^2, x + y + z]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.degree_of_semi_regularity">
<code class="descname">degree_of_semi_regularity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.degree_of_semi_regularity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of semi-regularity of this ideal under the
assumption that it is semi-regular.</p>
<p>Let <span class="math">\(\{f_1, ... , f_m\} \subset K[x_1 , ... , x_n]\)</span> be
homogeneous polynomials of degrees <span class="math">\(d_1,... ,d_m\)</span>
respectively. This sequence is semi-regular if:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(\{f_1, ... , f_m\} \neq K[x_1 , ... , x_n]\)</span></li>
<li>for all <span class="math">\(1 \leq i \leq m\)</span> and <span class="math">\(g \in K[x_1,\dots,x_n]\)</span>:
<span class="math">\(deg(g \cdot pi ) &lt; D\)</span> and
<span class="math">\(g \cdot f_i \in &lt;f_1 , \dots , f_{i-1}&gt;\)</span> implies that
<span class="math">\(g \in &lt;f_1, ..., f_{i-1}&gt;\)</span> where <span class="math">\(D\)</span> is the degree of regularity.</li>
</ul>
</div></blockquote>
<p>This notion can be extended to affine polynomials by
considering their homogeneous components of highest degree.</p>
<p>The degree of regularity of a semi-regular sequence
<span class="math">\(f_1, ...,f_m\)</span> of respective degrees <span class="math">\(d_1,...,d_m\)</span> is given by the
index of the first non-positive coefficient of:</p>
<blockquote>
<div><span class="math">\(\sum c_k z^k = \frac{\prod (1 - z^{d_i})}{(1-z)^n}\)</span></div></blockquote>
<p>EXAMPLE:</p>
<p>We consider a homogeneous example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">127</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">):</span>
<span class="go">....:     f = P.random_element(degree=2, terms=binomial(n,2))</span>
<span class="go">....:     f -= f(*s)</span>
<span class="go">....:     L.append(f.homogenize())</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">degree_of_semi_regularity</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>From this, we expect a Groebner basis computation to reach at
most degree 4. For homogeneous systems this is equivalent to
the largest degree in the Groebner basis:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">max</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">())</span>
<span class="go">4</span>
</pre></div>
</div>
<p>We increase the number of polynomials and observe a decrease
the degree of regularity:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">):</span>
<span class="go">....:     f = P.random_element(degree=2, terms=binomial(n,2))</span>
<span class="go">....:     f -= f(*s)</span>
<span class="go">....:     L.append(f.homogenize())</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">degree_of_semi_regularity</span><span class="p">()</span>
<span class="go">3</span>

<span class="gp">sage: </span><span class="nb">max</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">())</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The degree of regularity approaches 2 for quadratic systems as
the number of polynomials approaches <span class="math">\(n^2\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">):</span>
<span class="go">....:     f = P.random_element(degree=2, terms=binomial(n,2))</span>
<span class="go">....:     f -= f(*s)</span>
<span class="go">....:     L.append(f.homogenize())</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">degree_of_semi_regularity</span><span class="p">()</span>
<span class="go">2</span>

<span class="gp">sage: </span><span class="nb">max</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is unknown whether semi-regular sequences
exist. However, it is expected that random systems are
semi-regular sequences. For more details about
semi-regular sequences see <a class="reference internal" href="#bfs04" id="id1">[BFS04]</a>.</p>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="bfs04" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[BFS04]</a></td><td>Magali Bardet, Jean-Charles Faugère, and Bruno
Salvy, On the complexity of Groebner basis computation of
semi-regular overdetermined algebraic equations.
Proc. International Conference on Polynomial System Solving
(ICPSS), pp. 71-75, 2004.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.gens">
<code class="descname">gens</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.gens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a set of generators / a basis of this ideal. This is usually the
set of generators provided during object creation.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Ideal (x, y + 1) of Multivariate Polynomial Ring in x, y over Rational Field</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[x, y + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.groebner_basis">
<code class="descname">groebner_basis</code><span class="sig-paren">(</span><em>algorithm=''</em>, <em>deg_bound=None</em>, <em>mult_bound=None</em>, <em>prot=False</em>, <em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.groebner_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the reduced Groebner basis of this ideal.</p>
<p>A Groebner basis <span class="math">\(g_1,...,g_n\)</span> for an ideal <span class="math">\(I\)</span> is a
generating set such that <span class="math">\(&lt;LM(g_i)&gt; = LM(I)\)</span>, i.e., the
leading monomial ideal of <span class="math">\(I\)</span> is spanned by the leading terms
of <span class="math">\(g_1,...,g_n\)</span>. Groebner bases are the key concept in
computational ideal theory in multivariate polynomial rings
which allows a variety of problems to be solved.</p>
<p>Additionally, a <em>reduced</em> Groebner basis <span class="math">\(G\)</span> is a unique
representation for the ideal <span class="math">\(&lt;G&gt;\)</span> with respect to the chosen
monomial ordering.</p>
<p>INPUT:</p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">algorithm</span></code> - determines the algorithm to use, see below</dt>
<dd><p class="first last">for available algorithms.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">deg_bound</span></code> - only compute to degree <code class="docutils literal"><span class="pre">deg_bound</span></code>, that
is, ignore all S-polynomials of higher degree. (default:
<code class="docutils literal"><span class="pre">None</span></code>)</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">mult_bound</span></code> - the computation is stopped if the ideal is
zero-dimensional in a ring with local ordering and its
multiplicity is lower than <code class="docutils literal"><span class="pre">mult_bound</span></code>. Singular
only. (default: <code class="docutils literal"><span class="pre">None</span></code>)</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">prot</span></code> - if set to <code class="docutils literal"><span class="pre">True</span></code> the computation protocol of
the underlying implementation is printed. If an algorithm
from the <code class="docutils literal"><span class="pre">singular:</span></code> or <code class="docutils literal"><span class="pre">magma:</span></code> family is used,
<code class="docutils literal"><span class="pre">prot</span></code> may also be <code class="docutils literal"><span class="pre">sage</span></code> in which case the output is
parsed and printed in a common format where the amount of
information printed can be controlled via calls to
<a class="reference external" href="../../../../misc/sage/misc/misc.html#sage.misc.misc.set_verbose" title="(in Sage Reference Manual: Utilities v7.5)"><code class="xref py py-func docutils literal"><span class="pre">set_verbose()</span></code></a>.</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">*args</span></code> - additional parameters passed to the respective</dt>
<dd><p class="first last">implementations</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">**kwds</span></code> - additional keyword parameters passed to the</dt>
<dd><p class="first last">respective implementations</p>
</dd>
</dl>
</li>
</ul>
<p>ALGORITHMS:</p>
<dl class="docutils">
<dt>&#8216;&#8217;</dt>
<dd>autoselect (default)</dd>
<dt>&#8216;singular:groebner&#8217;</dt>
<dd>Singular&#8217;s <code class="docutils literal"><span class="pre">groebner</span></code> command</dd>
<dt>&#8216;singular:std&#8217;</dt>
<dd>Singular&#8217;s <code class="docutils literal"><span class="pre">std</span></code> command</dd>
<dt>&#8216;singular:stdhilb&#8217;</dt>
<dd>Singular&#8217;s <code class="docutils literal"><span class="pre">stdhib</span></code> command</dd>
<dt>&#8216;singular:stdfglm&#8217;</dt>
<dd>Singular&#8217;s <code class="docutils literal"><span class="pre">stdfglm</span></code> command</dd>
<dt>&#8216;singular:slimgb&#8217;</dt>
<dd>Singular&#8217;s <code class="docutils literal"><span class="pre">slimgb</span></code> command</dd>
<dt>&#8216;libsingular:groebner&#8217;</dt>
<dd>libSingular&#8217;s <code class="docutils literal"><span class="pre">groebner</span></code> command</dd>
<dt>&#8216;libsingular:std&#8217;</dt>
<dd>libSingular&#8217;s <code class="docutils literal"><span class="pre">std</span></code> command</dd>
<dt>&#8216;libsingular:slimgb&#8217;</dt>
<dd>libSingular&#8217;s <code class="docutils literal"><span class="pre">slimgb</span></code> command</dd>
<dt>&#8216;libsingular:stdhilb&#8217;</dt>
<dd>libSingular&#8217;s <code class="docutils literal"><span class="pre">stdhib</span></code> command</dd>
<dt>&#8216;libsingular:stdfglm&#8217;</dt>
<dd>libSingular&#8217;s <code class="docutils literal"><span class="pre">stdfglm</span></code> command</dd>
<dt>&#8216;toy:buchberger&#8217;</dt>
<dd>Sage&#8217;s toy/educational buchberger without Buchberger criteria</dd>
<dt>&#8216;toy:buchberger2&#8217;</dt>
<dd>Sage&#8217;s toy/educational buchberger with Buchberger criteria</dd>
<dt>&#8216;toy:d_basis&#8217;</dt>
<dd>Sage&#8217;s toy/educational algorithm for computation over PIDs</dd>
<dt>&#8216;macaulay2:gb&#8217;</dt>
<dd>Macaulay2&#8217;s <code class="docutils literal"><span class="pre">gb</span></code> command (if available)</dd>
<dt>&#8216;magma:GroebnerBasis&#8217;</dt>
<dd>Magma&#8217;s <code class="docutils literal"><span class="pre">Groebnerbasis</span></code> command (if available)</dd>
<dt>&#8216;ginv:TQ&#8217;, &#8216;ginv:TQBlockHigh&#8217;, &#8216;ginv:TQBlockLow&#8217; and &#8216;ginv:TQDegree&#8217;</dt>
<dd>One of GINV&#8217;s implementations (if available)</dd>
<dt>&#8216;giac:gbasis&#8217;</dt>
<dd>Giac&#8217;s <code class="docutils literal"><span class="pre">gbasis</span></code> command (if available)</dd>
</dl>
<p>If only a system is given - e.g. &#8216;magma&#8217; - the default algorithm is
chosen for that system.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Singular and libSingular versions of the respective
algorithms are identical, but the former calls an external
Singular process while the later calls a C function,
i.e. the calling overhead is smaller. However, the
libSingular interface does not support pretty printing of
computation protocols.</p>
</div>
<p>EXAMPLES:</p>
<p>Consider Katsura-3 over <span class="math">\(\QQ\)</span> with lexicographical term
ordering. We compute the reduced Groebner basis using every
available implementation and check their equality.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;libsingular:groebner&#39;</span><span class="p">)</span>
<span class="go">[a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;libsingular:std&#39;</span><span class="p">)</span>
<span class="go">[a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;libsingular:stdhilb&#39;</span><span class="p">)</span>
<span class="go">[a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;libsingular:stdfglm&#39;</span><span class="p">)</span>
<span class="go">[a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;libsingular:slimgb&#39;</span><span class="p">)</span>
<span class="go">[a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<p>Giac only supports the degree reverse lexicographical ordering:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;degrevlex&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">gb</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span> <span class="c1"># optional - giacpy_sage, random</span>
<span class="gp">sage: </span><span class="n">gb</span>  <span class="c1"># optional - giacpy_sage</span>
<span class="go">[c^3 - 79/210*c^2 + 1/30*b + 1/70*c, b^2 - 3/5*c^2 - 1/5*b + 1/5*c, b*c + 6/5*c^2 - 1/10*b - 2/5*c, a + 2*b + 2*c - 1]</span>

<span class="gp">sage: </span><span class="n">ideal</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">transformed_basis</span><span class="p">())</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">interreduced_basis</span><span class="p">()</span>  <span class="c1"># optional - giacpy_sage</span>
<span class="go">[a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<p>Giac&#8217;s gbasis over <span class="math">\(\QQ\)</span> can benefit from a probabilistic lifting and
multi threaded operations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A9</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="c1"># optional - giacpy_sage</span>
<span class="gp">sage: </span><span class="n">I9</span><span class="o">=</span><span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">A9</span><span class="p">)</span> <span class="c1"># optional - giacpy_sage</span>
<span class="gp">sage: </span><span class="n">I9</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s2">&quot;giac&quot;</span><span class="p">,</span><span class="n">proba_epsilon</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">)</span> <span class="c1"># optional - giacpy_sage, long time (3s)</span>
<span class="go">Running a probabilistic check for the reconstructed Groebner basis...</span>
<span class="go">Polynomial Sequence with 143 Polynomials in 9 Variables</span>
</pre></div>
</div>
<p>The list of available Giac options is provided at <code class="xref py py-func docutils literal"><span class="pre">sage.libs.giac.groebner_basis()</span></code>.</p>
<p>Note that <code class="docutils literal"><span class="pre">toy:buchberger</span></code> does not return the reduced Groebner
basis,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;toy:buchberger&#39;</span><span class="p">)</span>
<span class="go">[a^2 - a + 2*b^2 + 2*c^2,</span>
<span class="go"> a*b + b*c - 1/2*b, a + 2*b + 2*c - 1,</span>
<span class="go"> b^2 + 3*b*c - 1/2*b + 3*c^2 - c,</span>
<span class="go"> b*c - 1/10*b + 6/5*c^2 - 2/5*c,</span>
<span class="go"> b + 30*c^3 - 79/7*c^2 + 3/7*c,</span>
<span class="go"> c^6 - 79/210*c^5 - 229/2100*c^4 + 121/2520*c^3 + 1/3150*c^2 - 11/12600*c,</span>
<span class="go"> c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<p>but that <code class="docutils literal"><span class="pre">toy:buchberger2</span></code> does.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;toy:buchberger2&#39;</span><span class="p">)</span>
<span class="go">[a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;macaulay2:gb&#39;</span><span class="p">)</span> <span class="c1"># optional - macaulay2</span>
<span class="go">[a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># regenerate to prevent caching</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;magma:GroebnerBasis&#39;</span><span class="p">)</span> <span class="c1"># optional - magma</span>
<span class="go">[a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]</span>
</pre></div>
</div>
<p>Singular and libSingular can compute Groebner basis with degree
restrictions.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;singular&#39;</span><span class="p">)</span>
<span class="go">[x^3 + y^2, x^2*y + 1, y^3 - x]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;singular&#39;</span><span class="p">,</span><span class="n">deg_bound</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[x^3 + y^2, x^2*y + 1]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[x^3 + y^2, x^2*y + 1, y^3 - x]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="n">deg_bound</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[x^3 + y^2, x^2*y + 1]</span>
</pre></div>
</div>
<p>A protocol is printed, if the verbosity level is at least 2,
or if the argument <code class="docutils literal"><span class="pre">prot</span></code> is provided. Historically, the
protocol did not appear during doctests, so, we skip the
examples with protocol output.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>  <span class="c1"># not tested</span>
<span class="go">std in (QQ),(x,y),(dp(2),C)</span>
<span class="go">[...:2]3ss4s6</span>
<span class="go">(S:2)--</span>
<span class="go">product criterion:1 chain criterion:0</span>
<span class="go">[x^3 + y^2, x^2*y + 1, y^3 - x]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="n">prot</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">std in (QQ),(x,y),(dp(2),C)</span>
<span class="go">[...:2]3ss4s6</span>
<span class="go">(S:2)--</span>
<span class="go">product criterion:1 chain criterion:0</span>
<span class="go">[x^3 + y^2, x^2*y + 1, y^3 - x]</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="n">prot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1"># not tested</span>
<span class="go">std in (QQ),(x,y),(dp(2),C)</span>
<span class="go">[...:2]3ss4s6</span>
<span class="go">(S:2)--</span>
<span class="go">product criterion:1 chain criterion:0</span>
<span class="go">[x^3 + y^2, x^2*y + 1, y^3 - x]</span>
</pre></div>
</div>
<p>The list of available options is provided at
<a class="reference external" href="../../../../libs/sage/libs/singular/option.html#sage.libs.singular.option.LibSingularOptions" title="(in Sage Reference Manual: C/C++ Library Interfaces v7.5)"><code class="xref py py-class docutils literal"><span class="pre">LibSingularOptions</span></code></a>.</p>
<p>Note that Groebner bases over <span class="math">\(\ZZ\)</span> can also be computed.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">P</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[b^3 - 181*b*c^2 + 222*c^3 - 26*b*c - 146*c^2 + 19*b + 24*c,</span>
<span class="go"> 2*b*c^2 - 48*c^3 + 3*b*c + 22*c^2 - 2*b - 2*c,</span>
<span class="go"> 42*c^3 + 45*b^2 + 54*b*c + 22*c^2 - 13*b - 12*c,</span>
<span class="go"> 2*b^2 + 6*b*c + 6*c^2 - b - 2*c,</span>
<span class="go"> 10*b*c + 12*c^2 - b - 4*c,</span>
<span class="go"> a + 2*b + 2*c - 1]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;macaulay2&#39;</span><span class="p">)</span> <span class="c1"># optional - macaulay2</span>
<span class="go">[b^3 + b*c^2 + 12*c^3 + b^2 + b*c - 4*c^2,</span>
<span class="go"> 2*b*c^2 - 6*c^3 + b^2 + 5*b*c + 8*c^2 - b - 2*c,</span>
<span class="go"> 42*c^3 + b^2 + 2*b*c - 14*c^2 + b,</span>
<span class="go"> 2*b^2 - 4*b*c - 6*c^2 + 2*c, 10*b*c + 12*c^2 - b - 4*c,</span>
<span class="go"> a + 2*b + 2*c - 1]</span>
</pre></div>
</div>
<p>Groebner bases over <span class="math">\(\ZZ/n\ZZ\)</span> are also supported:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">P</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[b*c^2 + 992*b*c + 712*c^2 + 332*b + 96*c,</span>
<span class="go"> 2*c^3 + 214*b*c + 862*c^2 + 762*b + 268*c,</span>
<span class="go"> b^2 + 438*b*c + 281*b,</span>
<span class="go"> 5*b*c + 156*c^2 + 112*b + 948*c,</span>
<span class="go"> 50*c^2 + 600*b + 650*c, a + 2*b + 2*c + 999, 125*b]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">2233497349584</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="mi">3</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[2*z^4, y*z^2 + 81*z^3, 248166372176*z^3, 9*x^2 - y*z, y^2 + z^2, x*z +</span>
<span class="go">2233497349581*y*z, 248166372176*y*z]</span>
</pre></div>
</div>
<p>Sage also supports local orderings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;negdegrevlex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">P</span> <span class="o">*</span> <span class="p">(</span>  <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span><span class="n">y</span> <span class="o">^</span><span class="mi">5</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[x^2 + 1/2*y^3, x*y*z + z^5, y^5 + 3*z^5, y^4*z - 2*x*z^5, z^6]</span>
</pre></div>
</div>
<p>We can represent every element in the ideal as a combination
of the generators using the <a class="reference internal" href="multi_polynomial_element.html#sage.rings.polynomial.multi_polynomial_element.MPolynomial_polydict.lift" title="sage.rings.polynomial.multi_polynomial_element.MPolynomial_polydict.lift"><code class="xref py py-meth docutils literal"><span class="pre">lift()</span></code></a> method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">P</span> <span class="o">*</span> <span class="p">(</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span><span class="n">y</span> <span class="o">^</span><span class="mi">5</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">terms</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">1/2*y^2*z^7 - 1/4*y*z^8 + 2*x*z^5 + 95*z^6 + 1/2*y^5 - 1/4*y^4*z + x^2*y^2 + 3/2*x^2*y*z + 95*x*y*z^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="go">[2*x + 95*z, 1/2*y^2 - 1/4*y*z, 0]</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">gens</span><span class="p">());</span> <span class="n">l</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1/2*y^2 + 1/4*y*z, 1/2*y^2*z^2 - 1/4*y*z^3 + 2*x + 95*z]</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">J</span><span class="o">.</span><span class="n">gens</span><span class="p">())))</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Groebner bases over fraction fields of polynomial rings are also supported:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Frac</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">f</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[Z^3 + (79/105*t^2 - 79/105*t + 79/630)*Z^2 + (-11/105*t^4 + 22/105*t^3 - 17/45*t^2 + 197/630*t + 557/1890)*Y + ...,</span>
<span class="go">Y^2 + (-3/5)*Z^2 + (2/5*t^2 - 2/5*t + 1/15)*Y + (-2/5*t^2 + 2/5*t - 1/15)*Z - 1/10*t^4 + 1/5*t^3 - 7/30*t^2 + 2/5*t + 11/90,</span>
<span class="go">Y*Z + 6/5*Z^2 + (1/5*t^2 - 1/5*t + 1/30)*Y + (4/5*t^2 - 4/5*t + 2/15)*Z + 1/5*t^4 - 2/5*t^3 + 7/15*t^2 - 3/10*t - 11/45, X + 2*Y + 2*Z + t^2 - t - 1/3]</span>
</pre></div>
</div>
<p>In cases where a characteristic cannot be determined, we use a toy implementation of Buchberger&#8217;s algorithm
(see <a class="reference external" href="https://trac.sagemath.org/6581">trac ticket #6581</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[];</span> <span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuotientRing</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">I</span><span class="p">);</span> <span class="n">K</span> <span class="o">=</span> <span class="n">Frac</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[];</span> <span class="n">J</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">ideal</span><span class="p">([(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">verbose 0 (...: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to very slow toy implementation.</span>
<span class="go">[x + y]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular, Magma (if available), Macaulay2 (if available),
Giac (if available), or a toy implementation.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.groebner_fan">
<code class="descname">groebner_fan</code><span class="sig-paren">(</span><em>is_groebner_basis=False</em>, <em>symmetry=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.groebner_fan" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Groebner fan of this ideal.</p>
<p>The base ring must be <span class="math">\(\QQ\)</span> or a finite field
<span class="math">\(\GF{p}\)</span> of with <span class="math">\(p \leq 32749\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">groebner_fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">reduced_groebner_bases</span><span class="p">()</span>
<span class="go">[[x^2 - y^2 + 1], [-x^2 + y^2 - 1]]</span>
</pre></div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">is_groebner_basis</span></code> - bool (default False). if
True, then I.gens() must be a Groebner basis with respect to the
standard degree lexicographic term order.</li>
<li><code class="docutils literal"><span class="pre">symmetry</span></code> - default: None; if not None, describes
symmetries of the ideal</li>
<li><code class="docutils literal"><span class="pre">verbose</span></code> - default: False; if True, printout
useful info during computations</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.homogenize">
<code class="descname">homogenize</code><span class="sig-paren">(</span><em>var='h'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.homogenize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return homogeneous ideal spanned by the homogeneous polynomials
generated by homogenizing the generators of this ideal.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">h</span></code> - variable name or variable in cover ring
(default: &#8216;h&#8217;)</li>
</ul>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Ideal (x^2*y + z + 1, y^2 + x + 1) of Multivariate</span>
<span class="go">Polynomial Ring in x, y, z over Finite Field of size 2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">homogenize</span><span class="p">()</span>
<span class="go">Ideal (x^2*y + z*h^2 + h^3, y^2 + x*h + h^2) of</span>
<span class="go">Multivariate Polynomial Ring in x, y, z, h over Finite</span>
<span class="go">Field of size 2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">homogenize</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">Ideal (x^2*y + y^3 + y^2*z, x*y) of Multivariate</span>
<span class="go">Polynomial Ring in x, y, z over Finite Field of size 2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>       <span class="n">sage</span><span class="p">:</span> <span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">I</span><span class="o">.</span><span class="n">homogenize</span><span class="p">()</span>
<span class="n">Ideal</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">h</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="n">of</span>
<span class="n">Multivariate</span> <span class="n">Polynomial</span> <span class="n">Ring</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">h</span> <span class="n">over</span> <span class="n">Finite</span>
<span class="n">Field</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.is_homogeneous">
<code class="descname">is_homogeneous</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.is_homogeneous" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> if this ideal is spanned by homogeneous
polynomials, i.e. if it is a homogeneous ideal.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span>
<span class="go">Ideal (x + 2*y + 2*z - 1, x^2 + 2*y^2 + 2*z^2 - x, 2*x*y +</span>
<span class="go">2*y*z - y) of Multivariate Polynomial Ring in x, y, z over</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">homogenize</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">Ideal (x + 2*y + 2*z - h, x^2 + 2*y^2 + 2*z^2 - x*h, 2*x*y</span>
<span class="go">+ 2*y*z - y*h) of Multivariate Polynomial Ring in x, y, z,</span>
<span class="go">h over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the real zero locus of this principal ideal.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">self</span></code> - a principal ideal in 2 variables</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">algorithm</span></code> - set this to &#8216;surf&#8217; if you want &#8216;surf&#8217; to</dt>
<dd><p class="first last">plot the ideal (default: None)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">*args</span></code> - optional tuples <code class="docutils literal"><span class="pre">(variable,</span> <span class="pre">minimum,</span> <span class="pre">maximum)</span></code></dt>
<dd><p class="first last">for plotting dimensions</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">**kwds</span></code> - optional keyword arguments passed on to</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">implicit_plot</span></code></p>
</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<p>Implicit plotting in 2-d:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>                         <span class="c1"># cusp</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># hyperbola</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>                         <span class="c1"># ellipse</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>                         <span class="c1"># elliptic curve</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>                         <span class="c1"># the Singular logo</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<p>This used to be <a class="reference external" href="https://trac.sagemath.org/5267">trac ticket #5267</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Martin Albrecht (2008-09)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.random_element">
<code class="descname">random_element</code><span class="sig-paren">(</span><em>degree</em>, <em>compute_gb=False</em>, <em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.random_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random element in this ideal as <span class="math">\(r = \sum h_i·f_i\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">compute_gb</span></code> - if <code class="docutils literal"><span class="pre">True</span></code> then a Gröbner basis is computed first
and <span class="math">\(f_i\)</span> are the elements in the Gröbner basis. Otherwise whatever
basis is returned by <code class="docutils literal"><span class="pre">self.gens()</span></code> is used.</li>
<li><code class="docutils literal"><span class="pre">*args</span></code> and <code class="docutils literal"><span class="pre">**kwds</span></code> are passed to <code class="docutils literal"><span class="pre">R.random_element()</span></code> with
<code class="docutils literal"><span class="pre">R</span> <span class="pre">=</span> <span class="pre">self.ring()</span></code>.</li>
</ul>
<p>EXAMPLE:</p>
<p>We compute a uniformly random element up to the provided degree.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">127</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">compute_gb</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">34*x^4 - 33*x^3*y + 45*x^2*y^2 - 51*x*y^3 - 55*y^4 + 43*x^3*z ... - 28*y - 33*z + 45</span>
</pre></div>
</div>
<p>Note that sampling uniformly at random from the ideal at some large enough degree is
equivalent to computing a Gröbner basis. We give an example showing how to compute a Gröbner
basis if we can sample uniformly at random from an ideal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">127</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Cyclic</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic">
<li><p class="first">We sample <span class="math">\(n^d\)</span> uniformly random elements in the ideal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">compute_gb</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="n">infinity</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="n">d</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p class="first">We linearize and compute the echelon form:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">coefficient_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelonize</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">The result is the desired Gröbner basis:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">((</span><span class="n">A</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_groebner</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Ideal</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
</ol>
<p>We return some element in the ideal with no guarantee on the distribution:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">127</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-25*x0^2*x1 + 14*x1^3 + 57*x0*x1*x2 + ... + 19*x7*x9 + 40*x8*x9 + 49*x1</span>
</pre></div>
</div>
<p>We show that the default method does not sample uniformly at random from the ideal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">127</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">([</span><span class="n">x</span><span class="o">+</span><span class="mi">7</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">+</span><span class="mi">110</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="nb">sum</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="o">*</span> <span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If degree equals the degree of the generators a random linear
combination of the generators is returned:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.reduce">
<code class="descname">reduce</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce an element modulo the reduced Groebner basis for this ideal.
This returns 0 if and only if the element is in this ideal. In any
case, this reduction is unique up to monomial orders.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
<span class="go">x</span>

<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">y^2 - x</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="go">y^4 - 2*x*y^2 + x^2</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">y^4 - 2*x*y^2 + x^2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires computation of a Groebner basis, which can be a
very expensive operation.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.subs">
<code class="descname">subs</code><span class="sig-paren">(</span><em>in_dict=None</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Substitute variables.</p>
<p>This method substitutes some variables in the polynomials that
generate the ideal with given values. Variables that are not
specified in the input remain unchanged.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">in_dict</span></code> &#8211; (optional) dictionary of inputs</li>
<li><code class="docutils literal"><span class="pre">**kwds</span></code> &#8211; named parameters</li>
</ul>
<p>OUTPUT:</p>
<p>A new ideal with modified generators. If possible, in the same
polynomial ring. Raises a <code class="docutils literal"><span class="pre">TypeError</span></code> if no common
polynomial ring of the substituted generators can be found.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;xy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Ideal (x^5 + y^5, x^2*y^2 + x^2 + y + 5) of Multivariate Polynomial Ring in x, y over Integer Ring</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="go">Ideal (2*y^5, y^4 + y^2 + y + 5) of Multivariate Polynomial Ring in x, y over Integer Ring</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="n">y</span><span class="p">})</span>    <span class="c1"># same substitution but with dictionary</span>
<span class="go">Ideal (2*y^5, y^4 + y^2 + y + 5) of Multivariate Polynomial Ring in x, y over Integer Ring</span>
</pre></div>
</div>
<p>The new ideal can be in a different ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Ideal (a^2 + b^2 + a - b + 2) of Multivariate Polynomial Ring in a, b over Rational Field</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="go">Ideal (x^2 + y^2 + x - y + 2) of Multivariate Polynomial Ring in x, y over Rational Field</span>
</pre></div>
</div>
<p>The resulting ring need not be a mulitvariate polynomial ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="go">Principal ideal (t^2 + 1) of Univariate Polynomial Ring in t over Rational Field</span>
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
<span class="go">z</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
<span class="go">Principal ideal (2*z^2 + 2) of Symbolic Ring</span>
</pre></div>
</div>
<p>Variables that are not substituted remain unchanged:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Ideal (x^2 + y^2 + x - y + 2) of Multivariate Polynomial Ring in x, y over Rational Field</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Ideal (y^2 - y + 4) of Multivariate Polynomial Ring in x, y over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.weil_restriction">
<code class="descname">weil_restriction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal.weil_restriction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Weil restriction of this ideal over some extension
field. If the field is a finite field, then this computes
the Weil restriction to the prime subfield.</p>
<p>A Weil restriction of scalars - denoted <span class="math">\(Res_{L/k}\)</span> - is a
functor which, for any finite extension of fields <span class="math">\(L/k\)</span> and
any algebraic variety <span class="math">\(X\)</span> over <span class="math">\(L\)</span>, produces another
corresponding variety <span class="math">\(Res_{L/k}(X)\)</span>, defined over <span class="math">\(k\)</span>. It is
useful for reducing questions about varieties over large
fields to questions about more complicated varieties over
smaller fields.</p>
<p>This function does not compute this Weil restriction directly
but computes on generating sets of polynomial ideals:</p>
<p>Let <span class="math">\(d\)</span> be the degree of the field extension <span class="math">\(L/k\)</span>, let <span class="math">\(a\)</span> a
generator of <span class="math">\(L/k\)</span> and <span class="math">\(p\)</span> the minimal polynomial of
<span class="math">\(L/k\)</span>. Denote this ideal by <span class="math">\(I\)</span>.</p>
<p>Specifically, this function first maps each variable <span class="math">\(x\)</span> to
its representation over <span class="math">\(k\)</span>: <span class="math">\(\sum_{i=0}^{d-1} a^i x_i\)</span>. Then
each generator of <span class="math">\(I\)</span> is evaluated over these representations
and reduced modulo the minimal polynomial <span class="math">\(p\)</span>. The result is
interpreted as a univariate polynomial in <span class="math">\(a\)</span> and its
coefficients are the new generators of the returned ideal.</p>
<p>If the input and the output ideals are radical, this is
equivalent to the statement about algebraic varieties above.</p>
<p>OUTPUT: MPolynomial Ideal</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
<span class="go">[{y: a, x: a + 1}]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">weil_restriction</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">Ideal (x0*y0 + x1*y1 + 1, x1*y0 + x0*y1 + x1*y1, x1 + 1, x0 + x1) of</span>
<span class="go">Multivariate Polynomial Ring in x0, x1, y0, y1 over Finite Field of size</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">+=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">FieldIdeal</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">ring</span><span class="p">())</span> <span class="c1"># ensure radical ideal</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
<span class="go">[{y1: 1, x1: 1, x0: 1, y0: 0}]</span>

<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">weil_restriction</span><span class="p">()</span> <span class="c1"># returns J</span>
<span class="go">Ideal (x0*y0 + x1*y1 + 1, x1*y0 + x0*y1 + x1*y1, x1 + 1, x0 + x1, x0^2 +</span>
<span class="go">x0, x1^2 + x1, y0^2 + y0, y1^2 + y1) of Multivariate Polynomial Ring in</span>
<span class="go">x0, x1, y0, y1 over Finite Field of size 2</span>

<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Katsura</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
<span class="go">[{y: 0, z: 0, x: 1}]</span>

<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">weil_restriction</span><span class="p">();</span> <span class="n">J</span>
<span class="go">Ideal (x0 - y0 - z0 - 1, x1 - y1 - z1, x2 - y2 - z2, x3 - y3 - z3, x4 -</span>
<span class="go">y4 - z4, x0^2 + x2*x3 + x1*x4 - y0^2 - y2*y3 - y1*y4 - z0^2 - z2*z3 -</span>
<span class="go">z1*z4 - x0, -x0*x1 - x2*x3 - x3^2 - x1*x4 + x2*x4 + y0*y1 + y2*y3 + y3^2</span>
<span class="go">+ y1*y4 - y2*y4 + z0*z1 + z2*z3 + z3^2 + z1*z4 - z2*z4 - x1, x1^2 -</span>
<span class="go">x0*x2 + x3^2 - x2*x4 + x3*x4 - y1^2 + y0*y2 - y3^2 + y2*y4 - y3*y4 -</span>
<span class="go">z1^2 + z0*z2 - z3^2 + z2*z4 - z3*z4 - x2, -x1*x2 - x0*x3 - x3*x4 - x4^2</span>
<span class="go">+ y1*y2 + y0*y3 + y3*y4 + y4^2 + z1*z2 + z0*z3 + z3*z4 + z4^2 - x3, x2^2</span>
<span class="go">- x1*x3 - x0*x4 + x4^2 - y2^2 + y1*y3 + y0*y4 - y4^2 - z2^2 + z1*z3 +</span>
<span class="go">z0*z4 - z4^2 - x4, -x0*y0 + x4*y1 + x3*y2 + x2*y3 + x1*y4 - y0*z0 +</span>
<span class="go">y4*z1 + y3*z2 + y2*z3 + y1*z4 - y0, -x1*y0 - x0*y1 - x4*y1 - x3*y2 +</span>
<span class="go">x4*y2 - x2*y3 + x3*y3 - x1*y4 + x2*y4 - y1*z0 - y0*z1 - y4*z1 - y3*z2 +</span>
<span class="go">y4*z2 - y2*z3 + y3*z3 - y1*z4 + y2*z4 - y1, -x2*y0 - x1*y1 - x0*y2 -</span>
<span class="go">x4*y2 - x3*y3 + x4*y3 - x2*y4 + x3*y4 - y2*z0 - y1*z1 - y0*z2 - y4*z2 -</span>
<span class="go">y3*z3 + y4*z3 - y2*z4 + y3*z4 - y2, -x3*y0 - x2*y1 - x1*y2 - x0*y3 -</span>
<span class="go">x4*y3 - x3*y4 + x4*y4 - y3*z0 - y2*z1 - y1*z2 - y0*z3 - y4*z3 - y3*z4 +</span>
<span class="go">y4*z4 - y3, -x4*y0 - x3*y1 - x2*y2 - x1*y3 - x0*y4 - x4*y4 - y4*z0 -</span>
<span class="go">y3*z1 - y2*z2 - y1*z3 - y0*z4 - y4*z4 - y4) of Multivariate Polynomial</span>
<span class="go">Ring in x0, x1, x2, x3, x4, y0, y1, y2, y3, y4, z0, z1, z2, z3, z4 over</span>
<span class="go">Finite Field of size 3</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">+=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">FieldIdeal</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">ring</span><span class="p">())</span> <span class="c1"># ensure radical ideal</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.doctest.fixtures</span> <span class="kn">import</span> <span class="n">reproducible_repr</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">reproducible_repr</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">variety</span><span class="p">()))</span>
<span class="go">[{x0: 1, x1: 0, x2: 0, x3: 0, x4: 0, y0: 0, y1: 0, y2: 0, y3: 0, y4: 0, z0: 0, z1: 0, z2: 0, z3: 0, z4: 0}]</span>
</pre></div>
</div>
<p>Weil restrictions are often used to study elliptic curves over
extension fields so we give a simple example involving those:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>We pick a point on <code class="docutils literal"><span class="pre">E</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">p</span>
<span class="go">(1 : 2 : 1)</span>

<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">defining_ideal</span><span class="p">();</span> <span class="n">I</span>
<span class="go">Ideal (-x^3 - 2*x^2*z + x*y*z + y^2*z - 4*x*z^2 + 3*y*z^2 - 5*z^3)</span>
<span class="go">of Multivariate Polynomial Ring in x, y, z over Number Field in a with defining polynomial x^2 - 1/3</span>
</pre></div>
</div>
<p>Of course, the point <code class="docutils literal"><span class="pre">p</span></code> is a root of all generators of <code class="docutils literal"><span class="pre">I</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Ideal (0) of Multivariate Polynomial Ring in x, y, z over</span>
<span class="go">Number Field in a with defining polynomial x^2 - 1/3</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">I</span></code> is also radical:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
<p>So we compute its Weil restriction:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">weil_restriction</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">Ideal (-x0^3 - x0*x1^2 - 2*x0^2*z0 - 2/3*x1^2*z0 + x0*y0*z0 + y0^2*z0 +</span>
<span class="go">1/3*x1*y1*z0 + 1/3*y1^2*z0 - 4*x0*z0^2 + 3*y0*z0^2 - 5*z0^3 -</span>
<span class="go">4/3*x0*x1*z1 + 1/3*x1*y0*z1 + 1/3*x0*y1*z1 + 2/3*y0*y1*z1 - 8/3*x1*z0*z1</span>
<span class="go">+ 2*y1*z0*z1 - 4/3*x0*z1^2 + y0*z1^2 - 5*z0*z1^2, -3*x0^2*x1 - 1/3*x1^3</span>
<span class="go">- 4*x0*x1*z0 + x1*y0*z0 + x0*y1*z0 + 2*y0*y1*z0 - 4*x1*z0^2 + 3*y1*z0^2</span>
<span class="go">- 2*x0^2*z1 - 2/3*x1^2*z1 + x0*y0*z1 + y0^2*z1 + 1/3*x1*y1*z1 +</span>
<span class="go">1/3*y1^2*z1 - 8*x0*z0*z1 + 6*y0*z0*z1 - 15*z0^2*z1 - 4/3*x1*z1^2 +</span>
<span class="go">y1*z1^2 - 5/3*z1^3) of Multivariate Polynomial Ring in x0, x1, y0, y1,</span>
<span class="go">z0, z1 over Rational Field</span>
</pre></div>
</div>
<p>We can check that the point <code class="docutils literal"><span class="pre">p</span></code> is still a root of all generators of <code class="docutils literal"><span class="pre">J</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">z0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">x1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">z1</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Ideal (0, 0) of Multivariate Polynomial Ring in x0, x1, y0, y1, z0, z1 over Rational Field</span>
</pre></div>
</div>
<p>Example for relative number fields:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">L</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">weil_restriction</span><span class="p">()</span>
<span class="go">Ideal (-x0^3 + 3*x0*x1^2 + y0^2 - y1^2 - 1, -3*x0^2*x1 + x1^3 + 2*y0*y1)</span>
<span class="go">of Multivariate Polynomial Ring in x0, x1, y0, y1 over Number Field in w</span>
<span class="go">with defining polynomial x^5 - 2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Based on a Singular implementation by Michael Brickenstein</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_macaulay2_repr">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.multi_polynomial_ideal.</code><code class="descname">MPolynomialIdeal_macaulay2_repr</code><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_macaulay2_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>An ideal in a multivariate polynomial ring, which has an underlying
Macaulay2 ring associated to it.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span>
<span class="go">Ideal (x*y - z^2, y^2 - w^2) of Multivariate Polynomial Ring in x, y, z, w over Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_magma_repr">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.multi_polynomial_ideal.</code><code class="descname">MPolynomialIdeal_magma_repr</code><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_magma_repr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_base_repr">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.multi_polynomial_ideal.</code><code class="descname">MPolynomialIdeal_singular_base_repr</code><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_base_repr" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_base_repr.syzygy_module">
<code class="descname">syzygy_module</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_base_repr.syzygy_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the first syzygy (i.e., the module of relations of the
given generators) of the ideal.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">y</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">f</span> <span class="o">+</span> <span class="n">g</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">syzygy_module</span><span class="p">();</span> <span class="n">M</span>
<span class="go">[       -2        -1         1]</span>
<span class="go">[       -y 2*x^2 + y         0]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">*</span><span class="n">G</span>
<span class="go">(0, 0)</span>
</pre></div>
</div>
<p>ALGORITHM: Uses Singular&#8217;s syz command</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.multi_polynomial_ideal.</code><code class="descname">MPolynomialIdeal_singular_repr</code><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_base_repr" title="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_base_repr"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_base_repr</span></code></a></p>
<p>An ideal in a multivariate polynomial ring, which has an
underlying Singular ring associated to it.</p>
<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.associated_primes">
<code class="descname">associated_primes</code><span class="sig-paren">(</span><em>algorithm='sy'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.associated_primes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the associated primes of primary ideals of
which the intersection is <span class="math">\(I\)</span> = <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>An ideal <span class="math">\(Q\)</span> is called primary if it is a proper ideal of
the ring <span class="math">\(R\)</span> and if whenever <span class="math">\(ab \in Q\)</span> and
<span class="math">\(a \not\in Q\)</span> then <span class="math">\(b^n \in Q\)</span> for some
<span class="math">\(n \in \ZZ\)</span>.</p>
<p>If <span class="math">\(Q\)</span> is a primary ideal of the ring <span class="math">\(R\)</span>, then the
radical ideal <span class="math">\(P\)</span> of <span class="math">\(Q\)</span>, i.e.
<span class="math">\(P = \{a \in R, a^n \in Q\}\)</span> for some
<span class="math">\(n \in \ZZ\)</span>, is called the
<em>associated prime</em> of <span class="math">\(Q\)</span>.</p>
<p>If <span class="math">\(I\)</span> is a proper ideal of the ring <span class="math">\(R\)</span> then there
exists a decomposition in primary ideals <span class="math">\(Q_i\)</span> such that</p>
<ul class="simple">
<li>their intersection is <span class="math">\(I\)</span></li>
<li>none of the <span class="math">\(Q_i\)</span> contains the intersection of the
rest, and</li>
<li>the associated prime ideals of <span class="math">\(Q_i\)</span> are pairwise
different.</li>
</ul>
<p>This method returns the associated primes of the <span class="math">\(Q_i\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">algorithm</span></code> - string:</li>
<li><code class="docutils literal"><span class="pre">'sy'</span></code> - (default) use the Shimoyama-Yokoyama algorithm</li>
<li><code class="docutils literal"><span class="pre">'gtz'</span></code> - use the Gianni-Trager-Zacharias algorithm</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">list</span></code> - a list of associated primes</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">pd</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">associated_primes</span><span class="p">();</span> <span class="n">pd</span>
<span class="go">[Ideal (z^2 + 1, y + 1) of Multivariate Polynomial Ring in x, y, z over Rational Field,</span>
<span class="go"> Ideal (z^3 + 2, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular.</p>
<p>REFERENCES:</p>
<ul class="simple">
<li>Thomas Becker and Volker Weispfenning. Groebner Bases - A
Computational Approach To Commutative Algebra. Springer, New
York 1993.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.basis_is_groebner">
<code class="descname">basis_is_groebner</code><span class="sig-paren">(</span><em>singular=Singular</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.basis_is_groebner" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the generators of this ideal
(<code class="docutils literal"><span class="pre">self.gens()</span></code>) form a Groebner basis.</p>
<p>Let <span class="math">\(I\)</span> be the set of generators of this ideal. The check is
performed by trying to lift <span class="math">\(Syz(LM(I))\)</span> to <span class="math">\(Syz(I)\)</span> as <span class="math">\(I\)</span>
forms a Groebner basis if and only if for every element <span class="math">\(S\)</span> in
<span class="math">\(Syz(LM(I))\)</span>:</p>
<div class="math">
\[S * G = \sum_{i=0}^{m} h_ig_i ----&gt;_G 0.\]</div>
<p>ALGORITHM:</p>
<p>Uses Singular.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">127</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Cyclic</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">basis_is_groebner</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">I2</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">I2</span><span class="o">.</span><span class="n">basis_is_groebner</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A more complicated example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">U6</span><span class="p">,</span><span class="n">U5</span><span class="p">,</span><span class="n">U4</span><span class="p">,</span><span class="n">U3</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span> <span class="n">u6</span><span class="p">,</span><span class="n">u5</span><span class="p">,</span><span class="n">u4</span><span class="p">,</span><span class="n">u3</span><span class="p">,</span><span class="n">u2</span><span class="p">,</span> <span class="n">h</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7583</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">u6</span> <span class="o">+</span> <span class="n">u5</span> <span class="o">+</span> <span class="n">u4</span> <span class="o">+</span> <span class="n">u3</span> <span class="o">+</span> <span class="n">u2</span> <span class="o">-</span> <span class="mi">3791</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> \
<span class="go">           U6 + U5 + U4 + U3 + U2 - 3791*h, \</span>
<span class="go">           U2*u2 - h^2, U3*u3 - h^2, U4*u4 - h^2, \</span>
<span class="go">           U5*u4 + U5*u3 + U4*u3 + U5*u2 + U4*u2 + U3*u2 - 3791*U5*h - 3791*U4*h - 3791*U3*h - 3791*U2*h - 2842*h^2, \</span>
<span class="go">           U4*u5 + U3*u5 + U2*u5 + U3*u4 + U2*u4 + U2*u3 - 3791*u5*h - 3791*u4*h - 3791*u3*h - 3791*u2*h - 2842*h^2, \</span>
<span class="go">           U5*u5 - h^2, U4*U2*u3 + U5*U3*u2 + U4*U3*u2 + U3^2*u2 - 3791*U5*U3*h - 3791*U4*U3*h - 3791*U3^2*h - 3791*U5*U2*h \</span>
<span class="go">            - 3791*U4*U2*h + U3*U2*h - 3791*U2^2*h - 3791*U4*u3*h - 3791*U4*u2*h - 3791*U3*u2*h - 2843*U5*h^2 + 1897*U4*h^2 - 946*U3*h^2 - 947*U2*h^2 + 2370*h^3, \</span>
<span class="go">           U3*u5*u4 + U2*u5*u4 + U3*u4^2 + U2*u4^2 + U2*u4*u3 - 3791*u5*u4*h - 3791*u4^2*h - 3791*u4*u3*h - 3791*u4*u2*h + u5*h^2 - 2842*u4*h^2, \</span>
<span class="go">           U2*u5*u4*u3 + U2*u4^2*u3 + U2*u4*u3^2 - 3791*u5*u4*u3*h - 3791*u4^2*u3*h - 3791*u4*u3^2*h - 3791*u4*u3*u2*h + u5*u4*h^2 + u4^2*h^2 + u5*u3*h^2 - 2842*u4*u3*h^2, \</span>
<span class="go">           U5^2*U4*u3 + U5*U4^2*u3 + U5^2*U4*u2 + U5*U4^2*u2 + U5^2*U3*u2 + 2*U5*U4*U3*u2 + U5*U3^2*u2 - 3791*U5^2*U4*h - 3791*U5*U4^2*h - 3791*U5^2*U3*h \</span>
<span class="go">            + U5*U4*U3*h - 3791*U5*U3^2*h - 3791*U5^2*U2*h + U5*U4*U2*h + U5*U3*U2*h - 3791*U5*U2^2*h - 3791*U5*U3*u2*h - 2842*U5^2*h^2 + 1897*U5*U4*h^2 \</span>
<span class="go">            - U4^2*h^2 - 947*U5*U3*h^2 - U4*U3*h^2 - 948*U5*U2*h^2 - U4*U2*h^2 - 1422*U5*h^3 + 3791*U4*h^3, \</span>
<span class="go">           u5*u4*u3*u2*h + u4^2*u3*u2*h + u4*u3^2*u2*h + u4*u3*u2^2*h + 2*u5*u4*u3*h^2 + 2*u4^2*u3*h^2 + 2*u4*u3^2*h^2 + 2*u5*u4*u2*h^2 + 2*u4^2*u2*h^2 \</span>
<span class="go">            + 2*u5*u3*u2*h^2 + 1899*u4*u3*u2*h^2, \</span>
<span class="go">           U5^2*U4*U3*u2 + U5*U4^2*U3*u2 + U5*U4*U3^2*u2 - 3791*U5^2*U4*U3*h - 3791*U5*U4^2*U3*h - 3791*U5*U4*U3^2*h - 3791*U5*U4*U3*U2*h \</span>
<span class="go">            + 3791*U5*U4*U3*u2*h + U5^2*U4*h^2 + U5*U4^2*h^2 + U5^2*U3*h^2 - U4^2*U3*h^2 - U5*U3^2*h^2 - U4*U3^2*h^2 - U5*U4*U2*h^2 \</span>
<span class="go">            - U5*U3*U2*h^2 - U4*U3*U2*h^2 + 3791*U5*U4*h^3 + 3791*U5*U3*h^3 + 3791*U4*U3*h^3, \</span>
<span class="go">           u4^2*u3*u2*h^2 + 1515*u5*u3^2*u2*h^2 + u4*u3^2*u2*h^2 + 1515*u5*u4*u2^2*h^2 + 1515*u5*u3*u2^2*h^2 + u4*u3*u2^2*h^2 \</span>
<span class="go">            + 1521*u5*u4*u3*h^3 - 3028*u4^2*u3*h^3 - 3028*u4*u3^2*h^3 + 1521*u5*u4*u2*h^3 - 3028*u4^2*u2*h^3 + 1521*u5*u3*u2*h^3 + 3420*u4*u3*u2*h^3, \</span>
<span class="go">           U5^2*U4*U3*U2*h + U5*U4^2*U3*U2*h + U5*U4*U3^2*U2*h + U5*U4*U3*U2^2*h + 2*U5^2*U4*U3*h^2 + 2*U5*U4^2*U3*h^2 + 2*U5*U4*U3^2*h^2 \</span>
<span class="go">            + 2*U5^2*U4*U2*h^2 + 2*U5*U4^2*U2*h^2 + 2*U5^2*U3*U2*h^2 - 2*U4^2*U3*U2*h^2 - 2*U5*U3^2*U2*h^2 - 2*U4*U3^2*U2*h^2 \</span>
<span class="go">             - 2*U5*U4*U2^2*h^2 - 2*U5*U3*U2^2*h^2 - 2*U4*U3*U2^2*h^2 - U5*U4*U3*h^3 - U5*U4*U2*h^3 - U5*U3*U2*h^3 - U4*U3*U2*h^3]</span>

<span class="gp">sage: </span><span class="n">Ideal</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">basis_is_groebner</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">gb</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ideal</span><span class="p">(</span><span class="n">gb</span><span class="p">)</span><span class="o">.</span><span class="n">basis_is_groebner</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">From the Singular Manual for the reduce function we use in
this method: &#8216;The result may have no meaning if the second
argument (<code class="docutils literal"><span class="pre">self</span></code>) is not a standard basis&#8217;. I (malb)
believe this refers to the mathematical fact that the
results may have no meaning if self is no standard basis,
i.e., Singular doesn&#8217;t &#8216;add&#8217; any additional &#8216;nonsense&#8217; to
the result. So we may actually use reduce to determine if
self is a Groebner basis.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.complete_primary_decomposition">
<code class="descname">complete_primary_decomposition</code><span class="sig-paren">(</span><em>algorithm='sy'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.complete_primary_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of primary ideals such that their intersection
is <code class="docutils literal"><span class="pre">self</span></code>, together with the associated prime ideals.</p>
<p>An ideal <span class="math">\(Q\)</span> is called primary if it is a proper ideal of the
ring <span class="math">\(R\)</span>, and if whenever <span class="math">\(ab \in Q\)</span> and <span class="math">\(a \not\in Q\)</span>, then
<span class="math">\(b^n \in Q\)</span> for some <span class="math">\(n \in \ZZ\)</span>.</p>
<p>If <span class="math">\(Q\)</span> is a primary ideal of the ring <span class="math">\(R\)</span>, then the radical
ideal <span class="math">\(P\)</span> of <span class="math">\(Q\)</span> (i.e. the ideal consisting of all <span class="math">\(a \in R\)</span>
with a^n in Q` for some <span class="math">\(n \in \ZZ\)</span>), is called the
associated prime of <span class="math">\(Q\)</span>.</p>
<p>If <span class="math">\(I\)</span> is a proper ideal of a Noetherian ring <span class="math">\(R\)</span>, then there
exists a finite collection of primary ideals <span class="math">\(Q_i\)</span> such that
the following hold:</p>
<ul class="simple">
<li>the intersection of the <span class="math">\(Q_i\)</span> is <span class="math">\(I\)</span>;</li>
<li>none of the <span class="math">\(Q_i\)</span> contains the intersection of the others;</li>
<li>the associated prime ideals <span class="math">\(P_i\)</span> of the <span class="math">\(Q_i\)</span> are pairwise
distinct.</li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">algorithm</span></code> &#8211; string:<ul>
<li><code class="docutils literal"><span class="pre">'sy'</span></code> &#8211; (default) use the Shimoyama-Yokoyama
algorithm</li>
<li><code class="docutils literal"><span class="pre">'gtz'</span></code> &#8211; use the Gianni-Trager-Zacharias algorithm</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of pairs <span class="math">\((Q_i, P_i)\)</span>, where the <span class="math">\(Q_i\)</span> form a primary
decomposition of <code class="docutils literal"><span class="pre">self</span></code> and <span class="math">\(P_i\)</span> is the associated prime
of <span class="math">\(Q_i\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">pd</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">complete_primary_decomposition</span><span class="p">();</span> <span class="n">pd</span>
<span class="go">[(Ideal (z^2 + 1, y + 1) of Multivariate Polynomial Ring in x, y, z over Rational Field,</span>
<span class="go">  Ideal (z^2 + 1, y + 1) of Multivariate Polynomial Ring in x, y, z over Rational Field),</span>
<span class="go"> (Ideal (z^6 + 4*z^3 + 4, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field,</span>
<span class="go">  Ideal (z^3 + 2, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field)]</span>

<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">primary_decomposition_complete</span><span class="p">(</span><span class="n">algorithm</span> <span class="o">=</span> <span class="s1">&#39;gtz&#39;</span><span class="p">)</span>
<span class="go">[(Ideal (z^6 + 4*z^3 + 4, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field,</span>
<span class="go">  Ideal (z^3 + 2, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field),</span>
<span class="go"> (Ideal (z^2 + 1, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field,</span>
<span class="go">  Ideal (z^2 + 1, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field)]</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="gp">sage: </span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">Qi</span><span class="p">,</span><span class="n">Qj</span><span class="p">:</span> <span class="n">Qi</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">Qj</span><span class="p">),</span> <span class="p">[</span><span class="n">Qi</span> <span class="k">for</span> <span class="p">(</span><span class="n">Qi</span><span class="p">,</span><span class="n">radQi</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pd</span><span class="p">])</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="p">[</span><span class="n">Qi</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span> <span class="o">==</span> <span class="n">radQi</span> <span class="k">for</span> <span class="p">(</span><span class="n">Qi</span><span class="p">,</span><span class="n">radQi</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pd</span><span class="p">]</span>
<span class="go">[True, True]</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">complete_primary_decomposition</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Coefficient ring must be a field for function &#39;complete_primary_decomposition&#39;.</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="toy_buchberger.html#bw93" id="id2">[BW93]</a> for an introduction to primary decomposition.</p>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="https://trac.sagemath.org/15745">trac ticket #15745</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">complete_primary_decomposition</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.dimension">
<code class="descname">dimension</code><span class="sig-paren">(</span><em>singular='singular_default'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>The dimension of the ring modulo this ideal.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">32003</span><span class="p">),</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;degrevlex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>If the ideal is the total ring, the dimension is <span class="math">\(-1\)</span> by convention.</p>
<p>For polynomials over a finite field of order too large for Singular,
this falls back on a toy implementation of Buchberger to compute
the Groebner basis, then uses the algorithm described in Chapter 9,
Section 1 of Cox, Little, and O&#8217;Shea&#8217;s &#8220;Ideals, Varieties, and Algorithms&#8221;.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2147483659</span><span class="p">),</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">verbose 0 (...: multi_polynomial_ideal.py, dimension) Warning: falling back to very slow toy implementation.</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">=</span><span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">verbose 0 (...: multi_polynomial_ideal.py, dimension) Warning: falling back to very slow toy implementation.</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">verbose 0 (...: multi_polynomial_ideal.py, dimension) Warning: falling back to very slow toy implementation.</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2147483659</span><span class="p">),</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">verbose 0 (...: multi_polynomial_ideal.py, dimension) Warning: falling back to very slow toy implementation.</span>
<span class="go">2</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular, unless the characteristic is too large.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires computation of a Groebner basis, which can be a
very expensive operation.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.elimination_ideal">
<code class="descname">elimination_ideal</code><span class="sig-paren">(</span><em>variables</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.elimination_ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elimination ideal of this ideal with respect to the
variables given in <code class="docutils literal"><span class="pre">variables</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">variables</span></code> &#8211; a list or tuple of variables in <code class="docutils literal"><span class="pre">self.ring()</span></code></li>
</ul>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">z</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">elimination_ideal</span><span class="p">([</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">])</span>
<span class="go">Ideal (y^2 - x*z, x*y - z, x^2 - y) of Multivariate</span>
<span class="go">Polynomial Ring in x, y, t, s, z over Rational Field</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires computation of a Groebner basis, which can be a very
expensive operation.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.genus">
<code class="descname">genus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.genus" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the genus of the projective curve defined by this ideal,
which must be 1 dimensional.</p>
<p>EXAMPLE:</p>
<p>Consider the hyperelliptic curve <span class="math">\(y^2 = 4x^5 - 30x^3 + 45x -
22\)</span> over <span class="math">\(\QQ\)</span>, it has genus 2:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">30</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">45</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">22</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="n">C</span>
<span class="go">Hyperelliptic Curve over Rational Field defined by y^2 = 4*x^5 - 30*x^3 + 45*x - 22</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">30</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">45</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">22</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">f</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that the answer is correct for reducible curves:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">Curve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">is_singular</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">Ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.&lt;</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">TJ</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">t1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">u1</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="n">t2</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">u2</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">u1</span><span class="o">-</span><span class="n">u2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">TJ</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.hilbert_numerator">
<code class="descname">hilbert_numerator</code><span class="sig-paren">(</span><em>singular='singular_default'</em>, <em>grading=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.hilbert_numerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hilbert numerator of this ideal.</p>
<p>Let <span class="math">\(I\)</span> = <code class="docutils literal"><span class="pre">self</span></code> be a homogeneous ideal and
<span class="math">\(R\)</span> = <code class="docutils literal"><span class="pre">self.ring()</span></code> be a graded commutative
algebra (<span class="math">\(R = \oplus R_d\)</span>) over a field
<span class="math">\(K\)</span>. Then the Hilbert function is defined as
<span class="math">\(H(d) = dim_K R_d\)</span> and the Hilbert series of <span class="math">\(I\)</span>
is defined as the formal power series
<span class="math">\(H(d) = dim_K R_d\)</span> and the Hilbert series of <span class="math">\(I\)</span>
is defined as the formal power series
<span class="math">\(HS(t) = \sum_0^{\infty} H(d) t^d\)</span>.</p>
<p>This power series can be expressed as
<span class="math">\(HS(t) = Q(t)/(1-t)^n\)</span> where <span class="math">\(Q(t)\)</span> is a polynomial
over <span class="math">\(Z\)</span> and <span class="math">\(n\)</span> the number of variables in
<span class="math">\(R\)</span>. This method returns <span class="math">\(Q(t)\)</span>, the numerator;
hence the name, <span class="math">\(hilbert_numerator\)</span>.</p>
<p>An optional <code class="docutils literal"><span class="pre">grading</span></code> can be given, in which case
the graded (or weighted) Hilbert numerator is given.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">hilbert_numerator</span><span class="p">()</span>
<span class="go">-t^5 + 1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">hilbert_numerator</span><span class="p">()</span>
<span class="go">t^4 - 2*t^3 + 1</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">hilbert_numerator</span><span class="p">(</span><span class="n">grading</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">t^26 - t^23 - t^16 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.hilbert_polynomial">
<code class="descname">hilbert_polynomial</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.hilbert_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hilbert polynomial of this ideal.</p>
<p>Let <span class="math">\(I\)</span> = <code class="docutils literal"><span class="pre">self</span></code> be a homogeneous ideal and
<span class="math">\(R\)</span> = <code class="docutils literal"><span class="pre">self.ring()</span></code> be a graded commutative
algebra (<span class="math">\(R = \oplus R_d\)</span>) over a field <span class="math">\(K\)</span>. The
Hilbert polynomial is the unique polynomial <span class="math">\(HP(t)\)</span> with
rational coefficients such that <span class="math">\(HP(d) = dim_K R_d\)</span> for
all but finitely many positive integers <span class="math">\(d\)</span>.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">hilbert_polynomial</span><span class="p">()</span>
<span class="go">5*t - 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.hilbert_series">
<code class="descname">hilbert_series</code><span class="sig-paren">(</span><em>singular='singular_default'</em>, <em>grading=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.hilbert_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hilbert series of this ideal.</p>
<p>Let <span class="math">\(I\)</span> = <code class="docutils literal"><span class="pre">self</span></code> be a homogeneous ideal and
<span class="math">\(R\)</span> = <code class="docutils literal"><span class="pre">self.ring()</span></code> be a graded commutative
algebra (<span class="math">\(R = \oplus R_d\)</span>) over a field
<span class="math">\(K\)</span>. Then the Hilbert function is defined as
<span class="math">\(H(d) = dim_K R_d\)</span> and the Hilbert series of <span class="math">\(I\)</span>
is defined as the formal power series
<span class="math">\(HS(t) = \sum_0^{\infty} H(d) t^d\)</span>.</p>
<p>This power series can be expressed as
<span class="math">\(HS(t) = Q(t)/(1-t)^n\)</span> where <span class="math">\(Q(t)\)</span> is a polynomial
over <span class="math">\(Z\)</span> and <span class="math">\(n\)</span> the number of variables in
<span class="math">\(R\)</span>. This method returns <span class="math">\(Q(t)/(1-t)^n\)</span>.</p>
<p>An optional <code class="docutils literal"><span class="pre">grading</span></code> can be given, in which case
the graded (or weighted) Hilbert series is given.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">hilbert_series</span><span class="p">()</span>
<span class="go">(-t^4 - t^3 - t^2 - t - 1)/(-t^2 + 2*t - 1)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">hilbert_series</span><span class="p">()</span>
<span class="go">(t^3 - t^2 - t - 1)/(t - 1)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">hilbert_series</span><span class="p">(</span><span class="n">grading</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">(t^25 + t^24 + t^23 - t^15 - t^14 - t^13 - t^12 - t^11</span>
<span class="go"> - t^10 - t^9 - t^8 - t^7 - t^6 - t^5 - t^4 - t^3 - t^2</span>
<span class="go"> - t - 1)/(t^12 + t^11 + t^10 - t^2 - t - 1)</span>

<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">hilbert_series</span><span class="p">(</span><span class="n">grading</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(t^11 + t^8 - t^6 - t^5 - t^4 - t^3 - t^2 - t - 1)/(t^2 - 1)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">hilbert_series</span><span class="p">(</span><span class="n">grading</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(2*t^7 - t^6 - t^4 - t^2 - 1)/(t - 1)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">hilbert_series</span><span class="p">(</span><span class="n">grading</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Grading must be a list or a tuple of integers.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.integral_closure">
<code class="descname">integral_closure</code><span class="sig-paren">(</span><em>p=0</em>, <em>r=True</em>, <em>singular='singular_default'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.integral_closure" title="Permalink to this definition">¶</a></dt>
<dd><p>Let <span class="math">\(I\)</span> = <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>Returns the integral closure of <span class="math">\(I, ..., I^p\)</span>, where <span class="math">\(sI\)</span> is
an ideal in the polynomial ring <span class="math">\(R=k[x(1),...x(n)]\)</span>. If <span class="math">\(p\)</span> is
not given, or <span class="math">\(p=0\)</span>, compute the closure of all powers up to
the maximum degree in t occurring in the closure of <span class="math">\(R[It]\)</span>
(so this is the last power whose closure is not just the
sum/product of the smaller). If <span class="math">\(r\)</span> is given and <code class="docutils literal"><span class="pre">r</span> <span class="pre">is</span>
<span class="pre">True</span></code>, <code class="docutils literal"><span class="pre">I.integral_closure()</span></code> starts with a check whether I
is already a radical ideal.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - powers of I (default: 0)</li>
<li><code class="docutils literal"><span class="pre">r</span></code> - check whether self is a radical ideal first (default: <code class="docutils literal"><span class="pre">True</span></code>)</li>
</ul>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span><span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">integral_closure</span><span class="p">()</span>
<span class="go">[x^2, x*y^4, y^5, x*y^3]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses libSINGULAR.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.interreduced_basis">
<code class="descname">interreduced_basis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.interreduced_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>If this ideal is spanned by <span class="math">\((f_1, ..., f_n)\)</span> this method
returns <span class="math">\((g_1, ..., g_s)\)</span> such that:</p>
<ul>
<li><p class="first"><span class="math">\((f_1,...,f_n) = (g_1,...,g_s)\)</span></p>
</li>
<li><p class="first"><span class="math">\(LT(g_i) != LT(g_j)\)</span> for all <span class="math">\(i != j\)</span></p>
</li>
<li><dl class="first docutils">
<dt><span class="math">\(LT(g_i)\)</span> does not divide <span class="math">\(m\)</span> for all monomials <span class="math">\(m\)</span> of</dt>
<dd><p class="first last"><span class="math">\(\{g_1,...,g_{i-1},g_{i+1},...,g_s\}\)</span></p>
</dd>
</dl>
</li>
<li><p class="first"><span class="math">\(LC(g_i) == 1\)</span> for all <span class="math">\(i\)</span> if the coefficient ring is a field.</p>
</li>
</ul>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="n">z</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="n">z</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">interreduced_basis</span><span class="p">()</span>
<span class="go">[y^3 + z, x*y + z, x*z - z]</span>
</pre></div>
</div>
<p>Note that tail reduction for local orderings is not well-defined:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;negdegrevlex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="n">z</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="n">z</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">interreduced_basis</span><span class="p">()</span>
<span class="go">[z + x*y, x*y - y^3, x^2*y - y^3]</span>
</pre></div>
</div>
<p>A fixed error with nonstandard base fields:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">R</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()[</span><span class="s1">&#39;x,y&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">=</span><span class="n">t</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">K</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">interreduced_basis</span><span class="p">()</span>
<span class="go">[x]</span>
</pre></div>
</div>
<p>The interreduced basis of 0 is 0:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">Ideal</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">interreduced_basis</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular&#8217;s interred command or
<a class="reference internal" href="toy_buchberger.html#sage.rings.polynomial.toy_buchberger.inter_reduction" title="sage.rings.polynomial.toy_buchberger.inter_reduction"><code class="xref py py-func docutils literal"><span class="pre">sage.rings.polynomial.toy_buchberger.inter_reduction()</span></code></a>
if conversion to Singular fails.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.intersection">
<code class="descname">intersection</code><span class="sig-paren">(</span><em>*others</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of the arguments with this ideal.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">y</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">Ideal (x*y) of Multivariate Polynomial Ring in x, y over Rational Field</span>
</pre></div>
</div>
<p>The following simple example illustrates that the product need
not equal the intersection.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">J</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Ideal (y^2, x*y, x^2) of Multivariate Polynomial Ring in x, y over Rational Field</span>
<span class="gp">sage: </span><span class="n">IJ</span> <span class="o">=</span> <span class="n">I</span><span class="o">*</span><span class="n">J</span><span class="p">;</span> <span class="n">IJ</span>
<span class="go">Ideal (x^2*y^2, x^3, y^3, x*y) of Multivariate Polynomial Ring in x, y over Rational Field</span>
<span class="gp">sage: </span><span class="n">IJ</span> <span class="o">==</span> <span class="n">K</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Intersection of several ideals:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I1</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I2</span> <span class="o">=</span> <span class="n">y</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I3</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I4</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">I2</span><span class="p">,</span> <span class="n">I3</span><span class="p">,</span> <span class="n">I4</span><span class="p">)</span>
<span class="go">Ideal (x*y*z^20 - x*y*z^3, x*y^2 - x*y*z^3, x^2*y + x*y*z^4) of Multivariate Polynomial Ring in x, y, z over Rational Field</span>
</pre></div>
</div>
<p>The ideals must share the same ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R3</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I2</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">R2</span>
<span class="gp">sage: </span><span class="n">I3</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">R3</span>
<span class="gp">sage: </span><span class="n">I2</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">I3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Intersection is only available for ideals of the same ring.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.is_prime">
<code class="descname">is_prime</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.is_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> if this ideal is prime.</p>
<p>INPUT:</p>
<ul class="simple">
<li>keyword arguments are passed on to
<code class="docutils literal"><span class="pre">complete_primary_decomposition</span></code>; in this way you can
specify the algorithm to use.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">I</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">J</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="p">(</span><span class="n">I</span> <span class="o">*</span> <span class="n">J</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The following is <a class="reference external" href="https://trac.sagemath.org/5982">trac ticket #5982</a>.  Note that the quotient ring
is not recognized as being a field at this time, so the
fraction field is not the quotient ring itself:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">quotient</span><span class="p">(</span><span class="n">I</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Quotient of Multivariate Polynomial Ring in x, y over Rational Field by the ideal (x^2 - y^2 - 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="go">Fraction Field of Quotient of Multivariate Polynomial Ring in x, y over Rational Field by the ideal (x^2 - y^2 - 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.minimal_associated_primes">
<code class="descname">minimal_associated_primes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.minimal_associated_primes" title="Permalink to this definition">¶</a></dt>
<dd><p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">list</span></code> - a list of prime ideals</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">minimal_associated_primes</span> <span class="p">()</span>
<span class="go">[Ideal (z^2 + 1, -z^2 + y) of Multivariate Polynomial Ring</span>
<span class="go">in x, y, z over Rational Field, Ideal (z^3 + 2, -z^2 + y)</span>
<span class="go">of Multivariate Polynomial Ring in x, y, z over Rational</span>
<span class="go">Field]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.normal_basis">
<code class="descname">normal_basis</code><span class="sig-paren">(</span><em>algorithm='libsingular'</em>, <em>singular='singular_default'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.normal_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a vector space basis (consisting of monomials) of the
quotient ring by the ideal, resp. of a free module by the module,
in case it is finite dimensional and if the input is a standard
basis with respect to the ring ordering.</p>
<p>INPUT:</p>
<p><code class="docutils literal"><span class="pre">algorithm</span></code> - defaults to use libsingular, if it is anything
else we will use the <code class="docutils literal"><span class="pre">kbase()</span></code> command</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">normal_basis</span><span class="p">()</span>
<span class="go">[y*z^2, z^2, y*z, z, x*y, y, x, 1]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">normal_basis</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;singular&#39;</span><span class="p">)</span>
<span class="go">[y*z^2, z^2, y*z, z, x*y, y, x, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>singular=Singular</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>If you somehow manage to install surf, perhaps you can use
this function to implicitly plot the real zero locus of this
ideal (if principal).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> - must be a principal ideal in 2 or 3 vars
over <span class="math">\(\QQ\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Implicit plotting in 2-d:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>        <span class="c1"># cusp</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>        <span class="c1"># hyperbola</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>        <span class="c1"># ellipse</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>        <span class="c1"># elliptic curve</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<p>Implicit plotting in 3-d:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>          <span class="c1"># a cone; optional - surf</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>          <span class="c1"># same code, from a different angle; optional - surf</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>          <span class="c1"># Steiner surface; optional - surf</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner (2006-02-12)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.primary_decomposition">
<code class="descname">primary_decomposition</code><span class="sig-paren">(</span><em>algorithm='sy'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.primary_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of primary ideals such that their intersection
is <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>An ideal <span class="math">\(Q\)</span> is called primary if it is a proper ideal of the
ring <span class="math">\(R\)</span>, and if whenever <span class="math">\(ab \in Q\)</span> and <span class="math">\(a \not\in Q\)</span>, then
<span class="math">\(b^n \in Q\)</span> for some <span class="math">\(n \in \ZZ\)</span>.</p>
<p>If <span class="math">\(Q\)</span> is a primary ideal of the ring <span class="math">\(R\)</span>, then the radical
ideal <span class="math">\(P\)</span> of <span class="math">\(Q\)</span> (i.e. the ideal consisting of all <span class="math">\(a \in R\)</span>
with a^n in Q` for some <span class="math">\(n \in \ZZ\)</span>), is called the
associated prime of <span class="math">\(Q\)</span>.</p>
<p>If <span class="math">\(I\)</span> is a proper ideal of a Noetherian ring <span class="math">\(R\)</span>, then there
exists a finite collection of primary ideals <span class="math">\(Q_i\)</span> such that
the following hold:</p>
<ul class="simple">
<li>the intersection of the <span class="math">\(Q_i\)</span> is <span class="math">\(I\)</span>;</li>
<li>none of the <span class="math">\(Q_i\)</span> contains the intersection of the others;</li>
<li>the associated prime ideals of the <span class="math">\(Q_i\)</span> are pairwise
distinct.</li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">algorithm</span></code> &#8211; string:<ul>
<li><code class="docutils literal"><span class="pre">'sy'</span></code> &#8211; (default) use the Shimoyama-Yokoyama
algorithm</li>
<li><code class="docutils literal"><span class="pre">'gtz'</span></code> &#8211; use the Gianni-Trager-Zacharias algorithm</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of primary ideals <span class="math">\(Q_i\)</span> forming a primary
decomposition of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">pd</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">primary_decomposition</span><span class="p">();</span> <span class="n">pd</span>
<span class="go">[Ideal (z^2 + 1, y + 1) of Multivariate Polynomial Ring in x, y, z over Rational Field,</span>
<span class="go"> Ideal (z^6 + 4*z^3 + 4, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="gp">sage: </span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">Qi</span><span class="p">,</span><span class="n">Qj</span><span class="p">:</span> <span class="n">Qi</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">Qj</span><span class="p">),</span> <span class="n">pd</span><span class="p">)</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular.</p>
<p>REFERENCES:</p>
<ul class="simple">
<li>Thomas Becker and Volker Weispfenning. Groebner Bases - A
Computational Approach To Commutative Algebra. Springer, New
York 1993.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.primary_decomposition_complete">
<code class="descname">primary_decomposition_complete</code><span class="sig-paren">(</span><em>algorithm='sy'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.primary_decomposition_complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of primary ideals such that their intersection
is <code class="docutils literal"><span class="pre">self</span></code>, together with the associated prime ideals.</p>
<p>An ideal <span class="math">\(Q\)</span> is called primary if it is a proper ideal of the
ring <span class="math">\(R\)</span>, and if whenever <span class="math">\(ab \in Q\)</span> and <span class="math">\(a \not\in Q\)</span>, then
<span class="math">\(b^n \in Q\)</span> for some <span class="math">\(n \in \ZZ\)</span>.</p>
<p>If <span class="math">\(Q\)</span> is a primary ideal of the ring <span class="math">\(R\)</span>, then the radical
ideal <span class="math">\(P\)</span> of <span class="math">\(Q\)</span> (i.e. the ideal consisting of all <span class="math">\(a \in R\)</span>
with a^n in Q` for some <span class="math">\(n \in \ZZ\)</span>), is called the
associated prime of <span class="math">\(Q\)</span>.</p>
<p>If <span class="math">\(I\)</span> is a proper ideal of a Noetherian ring <span class="math">\(R\)</span>, then there
exists a finite collection of primary ideals <span class="math">\(Q_i\)</span> such that
the following hold:</p>
<ul class="simple">
<li>the intersection of the <span class="math">\(Q_i\)</span> is <span class="math">\(I\)</span>;</li>
<li>none of the <span class="math">\(Q_i\)</span> contains the intersection of the others;</li>
<li>the associated prime ideals <span class="math">\(P_i\)</span> of the <span class="math">\(Q_i\)</span> are pairwise
distinct.</li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">algorithm</span></code> &#8211; string:<ul>
<li><code class="docutils literal"><span class="pre">'sy'</span></code> &#8211; (default) use the Shimoyama-Yokoyama
algorithm</li>
<li><code class="docutils literal"><span class="pre">'gtz'</span></code> &#8211; use the Gianni-Trager-Zacharias algorithm</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of pairs <span class="math">\((Q_i, P_i)\)</span>, where the <span class="math">\(Q_i\)</span> form a primary
decomposition of <code class="docutils literal"><span class="pre">self</span></code> and <span class="math">\(P_i\)</span> is the associated prime
of <span class="math">\(Q_i\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">pd</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">complete_primary_decomposition</span><span class="p">();</span> <span class="n">pd</span>
<span class="go">[(Ideal (z^2 + 1, y + 1) of Multivariate Polynomial Ring in x, y, z over Rational Field,</span>
<span class="go">  Ideal (z^2 + 1, y + 1) of Multivariate Polynomial Ring in x, y, z over Rational Field),</span>
<span class="go"> (Ideal (z^6 + 4*z^3 + 4, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field,</span>
<span class="go">  Ideal (z^3 + 2, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field)]</span>

<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">primary_decomposition_complete</span><span class="p">(</span><span class="n">algorithm</span> <span class="o">=</span> <span class="s1">&#39;gtz&#39;</span><span class="p">)</span>
<span class="go">[(Ideal (z^6 + 4*z^3 + 4, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field,</span>
<span class="go">  Ideal (z^3 + 2, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field),</span>
<span class="go"> (Ideal (z^2 + 1, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field,</span>
<span class="go">  Ideal (z^2 + 1, y - z^2) of Multivariate Polynomial Ring in x, y, z over Rational Field)]</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="gp">sage: </span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">Qi</span><span class="p">,</span><span class="n">Qj</span><span class="p">:</span> <span class="n">Qi</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">Qj</span><span class="p">),</span> <span class="p">[</span><span class="n">Qi</span> <span class="k">for</span> <span class="p">(</span><span class="n">Qi</span><span class="p">,</span><span class="n">radQi</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pd</span><span class="p">])</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="p">[</span><span class="n">Qi</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span> <span class="o">==</span> <span class="n">radQi</span> <span class="k">for</span> <span class="p">(</span><span class="n">Qi</span><span class="p">,</span><span class="n">radQi</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pd</span><span class="p">]</span>
<span class="go">[True, True]</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">complete_primary_decomposition</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Coefficient ring must be a field for function &#39;complete_primary_decomposition&#39;.</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="toy_buchberger.html#bw93" id="id3">[BW93]</a> for an introduction to primary decomposition.</p>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="https://trac.sagemath.org/15745">trac ticket #15745</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">complete_primary_decomposition</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.quotient">
<code class="descname">quotient</code><span class="sig-paren">(</span><em>J</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.quotient" title="Permalink to this definition">¶</a></dt>
<dd><p>Given ideals <span class="math">\(I\)</span> = <code class="docutils literal"><span class="pre">self</span></code> and <span class="math">\(J\)</span> in the same polynomial
ring <span class="math">\(P\)</span>, return the ideal quotient of <span class="math">\(I\)</span> by <span class="math">\(J\)</span> consisting
of the polynomials <span class="math">\(a\)</span> of <span class="math">\(P\)</span> such that <span class="math">\(\{aJ \subset I\}\)</span>.</p>
<p>This is also referred to as the colon ideal
(<span class="math">\(I\)</span>:<span class="math">\(J\)</span>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">J</span></code> - multivariate polynomial ideal</li>
</ul>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">181</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">,</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">quotient</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">I</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="ow">in</span> <span class="n">J</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TEST:</p>
<p>This example checks <a class="reference external" href="https://trac.sagemath.org/16301">trac ticket #16301</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eD</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">quotient</span><span class="p">(</span><span class="n">eD</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[2, x*z + x, x*y]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.radical">
<code class="descname">radical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.radical" title="Permalink to this definition">¶</a></dt>
<dd><p>The radical of this ideal.</p>
<p>EXAMPLES:</p>
<p>This is an obviously not radical ideal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">Ideal (y, x) of Multivariate Polynomial Ring in x, y, z over Rational Field</span>
</pre></div>
</div>
<p>That the radical is correct is clear from the Groebner basis.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[y^3, x^2]</span>
</pre></div>
</div>
<p>This is the example from the Singular manual:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">Ideal (z^2 - y, y^2*z + y*z + 2*y + 2) of Multivariate Polynomial Ring in x, y, z over Rational Field</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">From the Singular manual: A combination of the algorithms
of Krick/Logar and Kemper is used. Works also in positive
characteristic (Kempers algorithm).</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">37</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">Ideal (z^2 - y, y^2*z + y*z + 2*y + 2) of Multivariate Polynomial Ring in x, y, z over Finite Field of size 37</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.saturation">
<code class="descname">saturation</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.saturation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the saturation (and saturation exponent) of the ideal <code class="docutils literal"><span class="pre">self</span></code> with respect to the ideal <code class="docutils literal"><span class="pre">other</span></code></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; another ideal in the same ring</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a pair (ideal, integer)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">(Ideal (y, x^5) of Multivariate Polynomial Ring in x, y, z over Rational Field, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.syzygy_module">
<code class="descname">syzygy_module</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.syzygy_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the first syzygy (i.e., the module of relations of the
given generators) of the ideal.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">y</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">f</span> <span class="o">+</span> <span class="n">g</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">syzygy_module</span><span class="p">();</span> <span class="n">M</span>
<span class="go">[       -2        -1         1]</span>
<span class="go">[       -y 2*x^2 + y         0]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">*</span><span class="n">G</span>
<span class="go">(0, 0)</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular&#8217;s syz command.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.transformed_basis">
<code class="descname">transformed_basis</code><span class="sig-paren">(</span><em>algorithm='gwalk'</em>, <em>other_ring=None</em>, <em>singular='singular_default'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.transformed_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a lex or <code class="docutils literal"><span class="pre">other_ring</span></code> Groebner Basis for this ideal.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">algorithm</span></code> - see below for options.</li>
<li><code class="docutils literal"><span class="pre">other_ring</span></code> - only valid for algorithm &#8216;fglm&#8217;, if
provided conversion will be performed to this
ring. Otherwise a lex Groebner basis will be returned.</li>
</ul>
<p>ALGORITHMS:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">fglm</span></code> - FGLM algorithm. The input ideal must be given with a reduced
Groebner Basis of a zero-dimensional ideal</li>
<li><code class="docutils literal"><span class="pre">gwalk</span></code> - Groebner Walk algorithm (<em>default</em>)</li>
<li><code class="docutils literal"><span class="pre">awalk1</span></code> - &#8216;first alternative&#8217; algorithm</li>
<li><code class="docutils literal"><span class="pre">awalk2</span></code> - &#8216;second alternative&#8217; algorithm</li>
<li><code class="docutils literal"><span class="pre">twalk</span></code> - Tran algorithm</li>
<li><code class="docutils literal"><span class="pre">fwalk</span></code> - Fractal Walk algorithm</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">z</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">transformed_basis</span><span class="p">(</span><span class="s1">&#39;fglm&#39;</span><span class="p">,</span><span class="n">S</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">Ideal (z^4 + y^3 - y, x^2 + y^3, x*y^3 - y^3, y^4 + y^3)</span>
<span class="go">of Multivariate Polynomial Ring in z, x, y over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">z</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">32003</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">=</span><span class="n">Ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">transformed_basis</span><span class="p">(</span><span class="s1">&#39;gwalk&#39;</span><span class="p">)</span>
<span class="go">[z*y^2 + y*x^2 + y*x + 3,</span>
<span class="go"> z*x + 8297*y^8*x^2 + 8297*y^8*x + 3556*y^7 - 8297*y^6*x^4 + 15409*y^6*x^3 - 8297*y^6*x^2</span>
<span class="go"> - 8297*y^5*x^5 + 15409*y^5*x^4 - 8297*y^5*x^3 + 3556*y^5*x^2 + 3556*y^5*x + 3556*y^4*x^3</span>
<span class="go"> + 3556*y^4*x^2 - 10668*y^4 - 10668*y^3*x - 8297*y^2*x^9 - 1185*y^2*x^8 + 14224*y^2*x^7</span>
<span class="go"> - 1185*y^2*x^6 - 8297*y^2*x^5 - 14223*y*x^7 - 10666*y*x^6 - 10666*y*x^5 - 14223*y*x^4</span>
<span class="go"> + x^5 + 2*x^4 + x^3,</span>
<span class="go"> y^9 - y^7*x^2 - y^7*x - y^6*x^3 - y^6*x^2 - 3*y^6 - 3*y^5*x - y^3*x^7 - 3*y^3*x^6</span>
<span class="go"> - 3*y^3*x^5 - y^3*x^4 - 9*y^2*x^5 - 18*y^2*x^4 - 9*y^2*x^3 - 27*y*x^3 - 27*y*x^2 - 27*x]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses Singular.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.triangular_decomposition">
<code class="descname">triangular_decomposition</code><span class="sig-paren">(</span><em>algorithm=None</em>, <em>singular='singular_default'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.triangular_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Decompose zero-dimensional ideal <code class="docutils literal"><span class="pre">self</span></code> into triangular
sets.</p>
<p>This requires that the given basis is reduced w.r.t. to the
lexicographical monomial ordering. If the basis of self does
not have this property, the required Groebner basis is
computed implicitly.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">algorithm</span></code> - string or None (default: None)</li>
</ul>
<p>ALGORITHMS:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">singular:triangL</span></code> - decomposition of self into triangular
systems (Lazard).</li>
<li><code class="docutils literal"><span class="pre">singular:triangLfak</span></code> - decomp. of self into tri.  systems
plus factorization.<ul>
<li><code class="docutils literal"><span class="pre">singular:triangM</span></code> - decomposition of self into
triangular systems (Moeller).</li>
</ul>
</li>
</ul>
<p>OUTPUT: a list <span class="math">\(T\)</span> of lists <span class="math">\(t\)</span> such that the variety of
<code class="docutils literal"><span class="pre">self</span></code> is the union of the varieties of <span class="math">\(t\)</span> in <span class="math">\(L\)</span> and each
<span class="math">\(t\)</span> is in triangular form.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">e</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">ideal</span><span class="o">.</span><span class="n">Cyclic</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">GB</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">(</span><span class="s1">&#39;libsingular:stdfglm&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">GB</span><span class="o">.</span><span class="n">triangular_decomposition</span><span class="p">(</span><span class="s1">&#39;singular:triangLfak&#39;</span><span class="p">)</span>
<span class="go">[Ideal (a - 1, b - 1, c - 1, d^2 + 3*d + 1, e + d + 3) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a - 1, b - 1, c^2 + 3*c + 1, d + c + 3, e - 1) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a - 1, b^2 + 3*b + 1, c + b + 3, d - 1, e - 1) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a - 1, b^4 + b^3 + b^2 + b + 1, -c + b^2, -d + b^3, e + b^3 + b^2 + b + 1) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a^2 + 3*a + 1, b - 1, c - 1, d - 1, e + a + 3) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a^2 + 3*a + 1, b + a + 3, c - 1, d - 1, e - 1) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a^4 - 4*a^3 + 6*a^2 + a + 1, -11*b^2 + 6*b*a^3 - 26*b*a^2 + 41*b*a - 4*b - 8*a^3 + 31*a^2 - 40*a - 24, 11*c + 3*a^3 - 13*a^2 + 26*a - 2, 11*d + 3*a^3 - 13*a^2 + 26*a - 2, -11*e - 11*b + 6*a^3 - 26*a^2 + 41*a - 4) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a^4 + a^3 + a^2 + a + 1, b - 1, c + a^3 + a^2 + a + 1, -d + a^3, -e + a^2) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a^4 + a^3 + a^2 + a + 1, b - a, c - a, d^2 + 3*d*a + a^2, e + d + 3*a) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a^4 + a^3 + a^2 + a + 1, b - a, c^2 + 3*c*a + a^2, d + c + 3*a, e - a) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a^4 + a^3 + a^2 + a + 1, b^2 + 3*b*a + a^2, c + b + 3*a, d - a, e - a) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a^4 + a^3 + a^2 + a + 1, b^3 + b^2*a + b^2 + b*a^2 + b*a + b + a^3 + a^2 + a + 1, c + b^2*a^3 + b^2*a^2 + b^2*a + b^2, -d + b^2*a^2 + b^2*a + b^2 + b*a^2 + b*a + a^2, -e + b^2*a^3 - b*a^2 - b*a - b - a^2 - a) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field,</span>
<span class="go">Ideal (a^4 + a^3 + 6*a^2 - 4*a + 1, -11*b^2 + 6*b*a^3 + 10*b*a^2 + 39*b*a + 2*b + 16*a^3 + 23*a^2 + 104*a - 24, 11*c + 3*a^3 + 5*a^2 + 25*a + 1, 11*d + 3*a^3 + 5*a^2 + 25*a + 1, -11*e - 11*b + 6*a^3 + 10*a^2 + 39*a + 2) of Multivariate Polynomial Ring in e, d, c, b, a over Rational Field]</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">triangular_decomposition</span><span class="p">()</span>
<span class="go">[Ideal (x2, x1^2) of Multivariate Polynomial Ring in x1, x2 over Rational Field,</span>
<span class="go"> Ideal (x2, x1^2) of Multivariate Polynomial Ring in x1, x2 over Rational Field,</span>
<span class="go"> Ideal (x2, x1^2) of Multivariate Polynomial Ring in x1, x2 over Rational Field,</span>
<span class="go"> Ideal (x2^4 + 4*x2^3 - 6*x2^2 - 20*x2 + 5, 8*x1 - x2^3 + x2^2 + 13*x2 - 5) of Multivariate Polynomial Ring in x1, x2 over Rational Field]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">triangular_decomposition</span><span class="p">()</span>
<span class="go">[Ideal (y^2 - 1, x^2 - 1) of Multivariate Polynomial Ring in x, y over Rational Field]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.variety">
<code class="descname">variety</code><span class="sig-paren">(</span><em>ring=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.variety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the variety of this ideal.</p>
<p>Given a zero-dimensional ideal <span class="math">\(I\)</span> (== <code class="docutils literal"><span class="pre">self</span></code>) of a
polynomial ring <span class="math">\(P\)</span> whose order is lexicographic, return the
variety of <span class="math">\(I\)</span> as a list of dictionaries with <code class="docutils literal"><span class="pre">(variable,</span> <span class="pre">value)</span></code>
pairs. By default, the variety of the ideal over its
coefficient field <span class="math">\(K\)</span> is returned; <code class="docutils literal"><span class="pre">ring</span></code> can be specified
to find the variety over a different ring.</p>
<p>These dictionaries have cardinality equal to the number of
variables in <span class="math">\(P\)</span> and represent assignments of values to these
variables such that all polynomials in <span class="math">\(I\)</span> vanish.</p>
<p>If <code class="docutils literal"><span class="pre">ring</span></code> is specified, then a triangular decomposition of
<code class="docutils literal"><span class="pre">self</span></code> is found over the original coefficient field <span class="math">\(K\)</span>;
then the triangular systems are solved using root-finding over
<code class="docutils literal"><span class="pre">ring</span></code>. This is particularly useful when <span class="math">\(K\)</span> is <code class="docutils literal"><span class="pre">QQ</span></code> (to
allow fast symbolic computation of the triangular
decomposition) and <code class="docutils literal"><span class="pre">ring</span></code> is <code class="docutils literal"><span class="pre">RR</span></code>, <code class="docutils literal"><span class="pre">AA</span></code>, <code class="docutils literal"><span class="pre">CC</span></code>, or
<code class="docutils literal"><span class="pre">QQbar</span></code> (to compute the whole real or complex variety of the
ideal).</p>
<p>Note that with <code class="docutils literal"><span class="pre">ring=RR</span></code> or <code class="docutils literal"><span class="pre">CC</span></code>, computation is done
numerically and potentially inaccurately; in particular, the
number of points in the real variety may be miscomputed. With
<code class="docutils literal"><span class="pre">ring=AA</span></code> or <code class="docutils literal"><span class="pre">QQbar</span></code>, computation is done exactly
(which may be much slower, of course).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ring</span></code> - return roots in the <code class="docutils literal"><span class="pre">ring</span></code> instead of the base
ring of this ideal (default: <code class="docutils literal"><span class="pre">None</span></code>)</li>
<li><code class="docutils literal"><span class="pre">proof</span></code> - return a provably correct result (default: <code class="docutils literal"><span class="pre">True</span></code>)</li>
</ul>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="c1"># this example is from the MAGMA handbook</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span> <span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">());</span> <span class="n">I</span>
<span class="go">Ideal (x - y^47 - y^45 + y^44 - y^43 + y^41 - y^39 - y^38</span>
<span class="go">- y^37 - y^36 + y^35 - y^34 - y^33 + y^32 - y^31 + y^30 +</span>
<span class="go">y^28 + y^27 + y^26 + y^25 - y^23 + y^22 + y^21 - y^19 -</span>
<span class="go">y^18 - y^16 + y^15 + y^13 + y^12 - y^10 + y^9 + y^8 + y^7</span>
<span class="go">- y^6 + y^4 + y^3 + y^2 + y - 1, y^48 + y^41 - y^40 + y^37</span>
<span class="go">- y^36 - y^33 + y^32 - y^29 + y^28 - y^25 + y^24 + y^2 + y</span>
<span class="go">+ 1) of Multivariate Polynomial Ring in x, y over Finite</span>
<span class="go">Field in w of size 3^3</span>

<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">();</span> <span class="n">V</span>
<span class="go">[{y: w^2 + 2, x: 2*w}, {y: w^2 + w, x: 2*w + 1}, {y: w^2 + 2*w, x: 2*w + 2}]</span>

<span class="gp">sage: </span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">V</span><span class="p">]</span> <span class="c1"># check that all polynomials vanish</span>
<span class="go">[0, 0, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">I</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">V</span><span class="p">]</span> <span class="c1"># same test, but nicer syntax</span>
<span class="go">[True, True, True]</span>
</pre></div>
</div>
<p>However, we only account for solutions in the ground field and not
in the algebraic closure:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">vector_space_dimension</span><span class="p">()</span>
<span class="go">48</span>
</pre></div>
</div>
<p>Here we compute the points of intersection of a hyperbola and a
circle, in several fields:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">());</span> <span class="n">I</span>
<span class="go">Ideal (x + y^3 - 2*y^2 + 4*y - 4, y^4 - 2*y^3 + 4*y^2 - 4*y + 1)</span>
<span class="go">of Multivariate Polynomial Ring in x, y over Rational Field</span>
</pre></div>
</div>
<p>These two curves have one rational intersection:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
<span class="go">[{y: 1, x: 1}]</span>
</pre></div>
</div>
<p>There are two real intersections:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RR</span><span class="p">)</span>
<span class="go">[{y: 0.361103080528647, x: 2.76929235423863},</span>
<span class="go"> {y: 1.00000000000000, x: 1.00000000000000}]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">AA</span><span class="p">)</span>
<span class="go">[{x: 2.769292354238632?, y: 0.3611030805286474?},</span>
<span class="go"> {x: 1, y: 1}]</span>
</pre></div>
</div>
<p>and a total of four intersections:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">CC</span><span class="p">)</span>
<span class="go">[{y: 0.31944845973567... - 1.6331702409152...*I,</span>
<span class="go">  x: 0.11535382288068... + 0.58974280502220...*I},</span>
<span class="go"> {y: 0.31944845973567... + 1.6331702409152...*I,</span>
<span class="go">  x: 0.11535382288068... - 0.58974280502220...*I},</span>
<span class="go"> {y: 0.36110308052864..., x: 2.7692923542386...},</span>
<span class="go"> {y: 1.00000000000000, x: 1.00000000000000}]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">QQbar</span><span class="p">)</span>
<span class="go">[{y: 0.3194484597356763? - 1.633170240915238?*I,</span>
<span class="go">  x: 0.11535382288068429? + 0.5897428050222055?*I},</span>
<span class="go"> {y: 0.3194484597356763? + 1.633170240915238?*I,</span>
<span class="go">  x: 0.11535382288068429? - 0.5897428050222055?*I},</span>
<span class="go"> {y: 0.3611030805286474?, x: 2.769292354238632?},</span>
<span class="go"> {y: 1, x: 1}]</span>
</pre></div>
</div>
<p>Computation over floating point numbers may compute only a partial solution,
or even none at all. Notice that x values are missing from the following variety:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CC</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
<span class="go">verbose 0 (...: multi_polynomial_ideal.py, variety) Warning: computations in the complex field are inexact; variety may be computed partially or incorrectly.</span>
<span class="go">verbose 0 (...: multi_polynomial_ideal.py, variety) Warning: falling back to very slow toy implementation.</span>
<span class="go">[{y: -0.86602540378443... - 0.500000000000000*I},</span>
<span class="go"> {y: -0.86602540378443... + 0.500000000000000*I},</span>
<span class="go"> {y: 0.86602540378443... - 0.500000000000000*I},</span>
<span class="go"> {y: 0.86602540378443... + 0.500000000000000*I}]</span>
</pre></div>
</div>
<p>This is due to precision error,
which causes the computation of an intermediate Groebner basis to fail.</p>
<p>If the ground field&#8217;s characteristic is too large for
Singular, we resort to a toy implementation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2147483659</span><span class="p">),</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">=</span><span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
<span class="go">verbose 0 (...: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to very slow toy implementation.</span>
<span class="go">verbose 0 (...: multi_polynomial_ideal.py, dimension) Warning: falling back to very slow toy implementation.</span>
<span class="go">verbose 0 (...: multi_polynomial_ideal.py, variety) Warning: falling back to very slow toy implementation.</span>
<span class="go">[{y: 0, x: 0}]</span>
</pre></div>
</div>
<p>The dictionary expressing the variety will be indexed by generators
of the polynomial ring after changing to the target field.
But the mapping will also accept generators of the original ring,
or even generator names as strings, when provided as keys:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">(</span><span class="n">AA</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v</span>
<span class="go">{x: 4.464101615137755?, y: -7.464101615137755?}</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Multivariate Polynomial Ring in x, y over Algebraic Real Field</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="go">4.464101615137755?</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
<span class="go">-7.464101615137755?</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span> <span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="p">])</span>
</pre></div>
</div>
<p>Testing the robustness of the Singular interface:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">triangular_decomposition</span><span class="p">(</span><span class="s1">&#39;singular:triangLfak&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
<span class="go">[{y: w^2 + 2, x: 2*w}, {y: w^2 + w, x: 2*w + 1}, {y: w^2 + 2*w, x: 2*w + 2}]</span>
</pre></div>
</div>
<p>Testing that a bug is indeed fixed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">30</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">)],</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining...</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x5</span><span class="o">*</span><span class="n">x10</span> <span class="o">+</span> <span class="n">x10</span> <span class="o">+</span> <span class="n">x18</span><span class="p">,</span> <span class="n">x5</span><span class="o">*</span><span class="n">x11</span> <span class="o">+</span> <span class="n">x11</span><span class="p">,</span> \
<span class="go">                 x5*x18, x6, x7 + 1, x9, x10*x11 + x10 + x18, x10*x18 + x18, \</span>
<span class="go">                 x11*x18, x12, x13, x14, x15, x16 + 1, x17 + x18 + 1, x19, x20, \</span>
<span class="go">                 x21 + 1, x22, x23, x24, x25 + 1, x28 + 1, x29 + 1, x30, x8, \</span>
<span class="go">                 x26, x1^2 + x1, x2^2 + x2, x3^2 + x3, x4^2 + x4, x5^2 + x5, \</span>
<span class="go">                 x6^2 + x6, x7^2 + x7, x8^2 + x8, x9^2 + x9, x10^2 + x10, \</span>
<span class="go">                 x11^2 + x11, x12^2 + x12, x13^2 + x13, x14^2 + x14, x15^2 + x15, \</span>
<span class="go">                 x16^2 + x16, x17^2 + x17, x18^2 + x18, x19^2 + x19, x20^2 + x20, \</span>
<span class="go">                 x21^2 + x21, x22^2 + x22, x23^2 + x23, x24^2 + x24, x25^2 + x25, \</span>
<span class="go">                 x26^2 + x26, x27^2 + x27, x28^2 + x28, x29^2 + x29, x30^2 + x30])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">basis_is_groebner</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="n">g</span><span class="p">])</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span> <span class="k">for</span> <span class="n">V</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">())</span>  <span class="c1"># long time (6s on sage.math, 2011)</span>
<span class="go">[&#39;101000100000000110001000100110&#39;,</span>
<span class="go"> &#39;101000100000000110001000101110&#39;,</span>
<span class="go"> &#39;101000100100000101001000100110&#39;,</span>
<span class="go"> &#39;101000100100000101001000101110&#39;,</span>
<span class="go"> &#39;101010100000000110001000100110&#39;,</span>
<span class="go"> &#39;101010100000000110001000101110&#39;,</span>
<span class="go"> &#39;101010100010000110001000100110&#39;,</span>
<span class="go"> &#39;101010100010000110001000101110&#39;,</span>
<span class="go"> &#39;101010100110000110001000100110&#39;,</span>
<span class="go"> &#39;101010100110000110001000101110&#39;,</span>
<span class="go"> &#39;101100100000000110001000100110&#39;,</span>
<span class="go"> &#39;101100100000000110001000101110&#39;,</span>
<span class="go"> &#39;101100100100000101001000100110&#39;,</span>
<span class="go"> &#39;101100100100000101001000101110&#39;,</span>
<span class="go"> &#39;101110100000000110001000100110&#39;,</span>
<span class="go"> &#39;101110100000000110001000101110&#39;,</span>
<span class="go"> &#39;101110100010000110001000100110&#39;,</span>
<span class="go"> &#39;101110100010000110001000101110&#39;,</span>
<span class="go"> &#39;101110100110000110001000100110&#39;,</span>
<span class="go"> &#39;101110100110000110001000101110&#39;]</span>
</pre></div>
</div>
<p>Check that the issue at <a class="reference external" href="https://trac.sagemath.org/7425">trac ticket #7425</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The dimension of the ideal is 1, but it should be 0</span>
</pre></div>
</div>
<p>Check that the issue at <a class="reference external" href="https://trac.sagemath.org/7425">trac ticket #7425</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">q</span><span class="o">&gt;=</span><span class="n">QQ</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">=</span><span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
<span class="go">[...{y: -q^3, x: 0}...]</span>
</pre></div>
</div>
<p>Check that computing the variety of the <code class="docutils literal"><span class="pre">[1]</span></code> ideal is allowed (<a class="reference external" href="https://trac.sagemath.org/13977">trac ticket #13977</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>Check that the issue at <a class="reference external" href="https://trac.sagemath.org/16485">trac ticket #16485</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)</span>
<span class="go">[...a: 0...]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses triangular decomposition.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.vector_space_dimension">
<code class="descname">vector_space_dimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr.vector_space_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vector space dimension of the ring modulo this ideal. If
the ideal is not zero-dimensional, a TypeError is raised.</p>
<p>ALGORITHM:</p>
<p>Uses Singular.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">u</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">v</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">u</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">v</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">+</span> <span class="n">ideal</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gradient</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">vector_space_dimension</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>When the ideal is not zero-dimensional, we return infinity:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">vector_space_dimension</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.multi_polynomial_ideal.</code><code class="descname">NCPolynomialIdeal</code><span class="sig-paren">(</span><em>ring</em>, <em>gens</em>, <em>coerce=True</em>, <em>side='left'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr" title="sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal_singular_repr</span></code></a>, <a class="reference external" href="../../../../rings/sage/rings/noncommutative_ideals.html#sage.rings.noncommutative_ideals.Ideal_nc" title="(in Sage Reference Manual: General Rings, Ideals, and Morphisms v7.5)"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.noncommutative_ideals.Ideal_nc</span></code></a></p>
<p>Creates a non-commutative polynomial ideal.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ring</span></code> - the g-algebra to which this ideal belongs</li>
<li><code class="docutils literal"><span class="pre">gens</span></code> - the generators of this ideal</li>
<li><code class="docutils literal"><span class="pre">coerce</span></code> (optional - default True) - generators are
coerced into the ring before creating the ideal</li>
<li><code class="docutils literal"><span class="pre">side</span></code> - optional string, either &#8220;left&#8221; (default)
or &#8220;twosided&#8221;; defines whether this ideal is left
of two-sided.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">g_algebra</span><span class="p">({</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, y, z</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">H</span><span class="o">.</span><span class="n">one</span><span class="p">()],</span><span class="nb">coerce</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="c1">#random</span>
<span class="go">Left Ideal (y^2, x^2, z^2 - 1) of Noncommutative Multivariate Polynomial Ring in x, y, z over Rational Field, nc-relations: {z*x: x*z + 2*x, z*y: y*z - 2*y, y*x: x*y - z}</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[x^2, y^2, z^2 - 1]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">H</span><span class="o">.</span><span class="n">one</span><span class="p">()],</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;twosided&quot;</span><span class="p">)</span> <span class="c1">#random</span>
<span class="go">Twosided Ideal (y^2, x^2, z^2 - 1) of Noncommutative Multivariate Polynomial Ring in x, y, z over Rational Field, nc-relations: {z*x: x*z + 2*x, z*y: y*z - 2*y, y*x: x*y - z}</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">H</span><span class="o">.</span><span class="n">one</span><span class="p">()],</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;twosided&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[x^2, y^2, z^2 - 1]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">H</span><span class="o">.</span><span class="n">one</span><span class="p">()],</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Only left and two-sided ideals are allowed.</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.reduce">
<code class="descname">reduce</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce an element modulo a Groebner basis for this ideal.</p>
<p>It returns 0 if and only if the element is in this ideal. In any
case, this reduction is unique up to monomial orders.</p>
<p>NOTE:</p>
<p>There are left and two-sided ideals. Hence,</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">g_algebra</span><span class="p">({</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">H</span><span class="o">.</span><span class="n">one</span><span class="p">()],</span><span class="nb">coerce</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;twosided&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">quotient</span><span class="p">(</span><span class="n">I</span><span class="p">);</span> <span class="n">Q</span> <span class="c1">#random</span>
<span class="go">Quotient of Noncommutative Multivariate Polynomial Ring in x, y, z</span>
<span class="go"> over Rational Field, nc-relations: {z*x: x*z + 2*x,</span>
<span class="go"> z*y: y*z - 2*y, y*x: x*y - z} by the ideal (y^2, x^2, z^2 - 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="mi">2</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>   <span class="c1"># indirect doctest</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Here, we see that the relation that we just found in the quotient
is actually a consequence of the given relations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="mi">2</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">H</span><span class="o">.</span><span class="n">one</span><span class="p">()</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Here is the corresponding direct test:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.res">
<code class="descname">res</code><span class="sig-paren">(</span><em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.res" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the resolution up to a given length of the ideal.</p>
<p>NOTE:</p>
<p>Only left syzygies can be computed. So, even if the ideal is
two-sided, then the resolution is only one-sided. In that case,
a warning is printed.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">g_algebra</span><span class="p">({</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, y, z</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">H</span><span class="o">.</span><span class="n">one</span><span class="p">()],</span><span class="nb">coerce</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">res</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&lt;Resolution&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.std">
<code class="descname">std</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.std" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a GB of the ideal. It is two-sided if and only if the ideal is two-sided.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">g_algebra</span><span class="p">({</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, y, z</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">H</span><span class="o">.</span><span class="n">one</span><span class="p">()],</span><span class="nb">coerce</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="c1">#random</span>
<span class="go">Left Ideal (z^2 - 1, y*z - y, x*z + x, y^2, 2*x*y - z - 1, x^2) of Noncommutative Multivariate Polynomial Ring in x, y, z over Rational Field, nc-relations: {z*x: x*z + 2*x, z*y: y*z - 2*y, y*x: x*y - z}</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[2*x*y - z - 1, x*z + x, x^2, y*z - y, y^2, z^2 - 1]</span>
</pre></div>
</div>
<p>If the ideal is a left ideal, then std returns a left
Groebner basis. But if it is a two-sided ideal, then
the output of std and <a class="reference internal" href="#sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.twostd" title="sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.twostd"><code class="xref py py-meth docutils literal"><span class="pre">twostd()</span></code></a> coincide:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">JL</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">JL</span> <span class="c1">#random</span>
<span class="go">Left Ideal (x^3, y^3, z^3 - 4*z) of Noncommutative Multivariate Polynomial Ring in x, y, z over Rational Field, nc-relations: {z*x: x*z + 2*x, z*y: y*z - 2*y, y*x: x*y - z}</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">JL</span><span class="o">.</span><span class="n">gens</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[x^3, y^3, z^3 - 4*z]</span>
<span class="gp">sage: </span><span class="n">JL</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="c1">#random</span>
<span class="go">Left Ideal (z^3 - 4*z, y*z^2 - 2*y*z, x*z^2 + 2*x*z, 2*x*y*z - z^2 - 2*z, y^3, x^3) of Noncommutative Multivariate Polynomial Ring in x, y, z over Rational Field, nc-relations: {z*x: x*z + 2*x, z*y: y*z - 2*y, y*x: x*y - z}</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">JL</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[2*x*y*z - z^2 - 2*z, x*z^2 + 2*x*z, x^3, y*z^2 - 2*y*z, y^3, z^3 - 4*z]</span>
<span class="gp">sage: </span><span class="n">JT</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="p">],</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;twosided&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">JT</span> <span class="c1">#random</span>
<span class="go">Twosided Ideal (x^3, y^3, z^3 - 4*z) of Noncommutative Multivariate Polynomial Ring in x, y, z over Rational Field, nc-relations: {z*x: x*z + 2*x, z*y: y*z - 2*y, y*x: x*y - z}</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">JT</span><span class="o">.</span><span class="n">gens</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[x^3, y^3, z^3 - 4*z]</span>
<span class="gp">sage: </span><span class="n">JT</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="c1">#random</span>
<span class="go">Twosided Ideal (z^3 - 4*z, y*z^2 - 2*y*z, x*z^2 + 2*x*z, y^2*z - 2*y^2, 2*x*y*z - z^2 - 2*z, x^2*z + 2*x^2, y^3, x*y^2 - y*z, x^2*y - x*z - 2*x, x^3) of Noncommutative Multivariate Polynomial Ring in x, y, z over Rational Field, nc-relations: {z*x: x*z + 2*x, z*y: y*z - 2*y, y*x: x*y - z}</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">JT</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[2*x*y*z - z^2 - 2*z, x*y^2 - y*z, x*z^2 + 2*x*z, x^2*y - x*z - 2*x, x^2*z + 2*x^2, x^3, y*z^2 - 2*y*z, y^2*z - 2*y^2, y^3, z^3 - 4*z]</span>
<span class="gp">sage: </span><span class="n">JT</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">==</span> <span class="n">JL</span><span class="o">.</span><span class="n">twostd</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>ALGORITHM: Uses Singular&#8217;s std command</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.syzygy_module">
<code class="descname">syzygy_module</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.syzygy_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the first syzygy (i.e., the module of relations of the
given generators) of the ideal.</p>
<p>NOTE:</p>
<p>Only left syzygies can be computed. So, even if the ideal is
two-sided, then the syzygies are only one-sided. In that case,
a warning is printed.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">g_algebra</span><span class="p">({</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, y, z</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">H</span><span class="o">.</span><span class="n">one</span><span class="p">()],</span><span class="nb">coerce</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">());</span> <span class="n">G</span>
<span class="go">d...: UserWarning: You are constructing a free module</span>
<span class="go">over a noncommutative ring. Sage does not have a concept</span>
<span class="go">of left/right and both sided modules, so be careful.</span>
<span class="go">It&#39;s also not guaranteed that all multiplications are</span>
<span class="go">done from the right side.</span>
<span class="go">d...: UserWarning: You are constructing a free module</span>
<span class="go">over a noncommutative ring. Sage does not have a concept</span>
<span class="go">of left/right and both sided modules, so be careful.</span>
<span class="go">It&#39;s also not guaranteed that all multiplications are</span>
<span class="go">done from the right side.</span>
<span class="go">(y^2, x^2, z^2 - 1)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">syzygy_module</span><span class="p">();</span> <span class="n">M</span>
<span class="go">[                                                                         -z^2 - 8*z - 15                                                                                        0                                                                                      y^2]</span>
<span class="go">[                                                                                       0                                                                          -z^2 + 8*z - 15                                                                                      x^2]</span>
<span class="go">[                                                              x^2*z^2 + 8*x^2*z + 15*x^2                                                              -y^2*z^2 + 8*y^2*z - 15*y^2                                                                   -4*x*y*z + 2*z^2 + 2*z]</span>
<span class="go">[                 x^2*y*z^2 + 9*x^2*y*z - 6*x*z^3 + 20*x^2*y - 72*x*z^2 - 282*x*z - 360*x                                                              -y^3*z^2 + 7*y^3*z - 12*y^3                                                                                  6*y*z^2]</span>
<span class="go">[                                                              x^3*z^2 + 7*x^3*z + 12*x^3                 -x*y^2*z^2 + 9*x*y^2*z - 4*y*z^3 - 20*x*y^2 + 52*y*z^2 - 224*y*z + 320*y                                                                                 -6*x*z^2]</span>
<span class="go">[  x^2*y^2*z + 4*x^2*y^2 - 8*x*y*z^2 - 48*x*y*z + 12*z^3 - 64*x*y + 108*z^2 + 312*z + 288                                                                           -y^4*z + 4*y^4                                                                                        0]</span>
<span class="go">[                                                  2*x^3*y*z + 8*x^3*y + 9*x^2*z + 27*x^2                                   -2*x*y^3*z + 8*x*y^3 - 12*y^2*z^2 + 99*y^2*z - 195*y^2                                                                -36*x*y*z + 24*z^2 + 18*z]</span>
<span class="go">[                                                                           x^4*z + 4*x^4    -x^2*y^2*z + 4*x^2*y^2 - 4*x*y*z^2 + 32*x*y*z - 6*z^3 - 64*x*y + 66*z^2 - 240*z + 288                                                                                        0]</span>
<span class="go">[x^3*y^2*z + 4*x^3*y^2 + 18*x^2*y*z - 36*x*z^3 + 66*x^2*y - 432*x*z^2 - 1656*x*z - 2052*x                                      -x*y^4*z + 4*x*y^4 - 8*y^3*z^2 + 62*y^3*z - 114*y^3                                                                        48*y*z^2 - 36*y*z]</span>

<span class="gp">sage: </span><span class="n">M</span><span class="o">*</span><span class="n">G</span>
<span class="go">(0, 0, 0, 0, 0, 0, 0, 0, 0)</span>
</pre></div>
</div>
<p>ALGORITHM: Uses Singular&#8217;s syz command</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.twostd">
<code class="descname">twostd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.twostd" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a two-sided GB of the ideal (even if it is a left ideal).</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">g_algebra</span><span class="p">({</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, y, z</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">H</span><span class="o">.</span><span class="n">one</span><span class="p">()],</span><span class="nb">coerce</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">twostd</span><span class="p">()</span> <span class="c1">#random</span>
<span class="go">Twosided Ideal (z^2 - 1, y*z - y, x*z + x, y^2, 2*x*y - z - 1, x^2) of Noncommutative Multivariate Polynomial Ring in x, y, z over Rational Field...</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">twostd</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[2*x*y - z - 1, x*z + x, x^2, y*z - y, y^2, z^2 - 1]</span>
</pre></div>
</div>
<p>ALGORITHM: Uses Singular&#8217;s twostd command</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.RequireField">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.multi_polynomial_ideal.</code><code class="descname">RequireField</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.RequireField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../misc/sage/misc/method_decorator.html#sage.misc.method_decorator.MethodDecorator" title="(in Sage Reference Manual: Utilities v7.5)"><code class="xref py py-class docutils literal"><span class="pre">sage.misc.method_decorator.MethodDecorator</span></code></a></p>
<p>Decorator which throws an exception if a computation over a
coefficient ring which is not a field is attempted.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This decorator is used automatically internally so the user
does not need to use it manually.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.is_MPolynomialIdeal">
<code class="descclassname">sage.rings.polynomial.multi_polynomial_ideal.</code><code class="descname">is_MPolynomialIdeal</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.is_MPolynomialIdeal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> if the provided argument <code class="docutils literal"><span class="pre">x</span></code> is an ideal in the
multivariate polynomial ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">x</span></code> - an arbitrary object</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.polynomial.multi_polynomial_ideal</span> <span class="kn">import</span> <span class="n">is_MPolynomialIdeal</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">y</span><span class="p">]</span>
</pre></div>
</div>
<p>Sage distinguishes between a list of generators for an ideal and
the ideal itself. This distinction is inconsistent with Singular
but matches Magma&#8217;s behavior.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_MPolynomialIdeal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_MPolynomialIdeal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="sage.rings.polynomial.multi_polynomial_ideal.require_field">
<code class="descclassname">sage.rings.polynomial.multi_polynomial_ideal.</code><code class="descname">require_field</code><a class="headerlink" href="#sage.rings.polynomial.multi_polynomial_ideal.require_field" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.rings.polynomial.multi_polynomial_ideal.RequireField" title="sage.rings.polynomial.multi_polynomial_ideal.RequireField"><code class="xref py py-class docutils literal"><span class="pre">RequireField</span></code></a></p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="multi_polynomial_element.html"
                                  title="previous chapter">Generic Multivariate Polynomials</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="multi_polynomial_sequence.html"
                                  title="next chapter">Polynomial Sequences</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/rings/polynomial/multi_polynomial_ideal.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="multi_polynomial_sequence.html" title="Polynomial Sequences"
             >next</a> |</li>
        <li class="right" >
          <a href="multi_polynomial_element.html" title="Generic Multivariate Polynomials"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Polynomials</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../../polynomial_rings_multivar.html" >Multivariate Polynomials and Polynomial Rings</a> &raquo;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2017, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>