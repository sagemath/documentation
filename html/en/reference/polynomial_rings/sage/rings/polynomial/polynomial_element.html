<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Univariate Polynomial Base Class &mdash; Sage Reference Manual v7.2: Polynomials</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.2: Polynomials" href="../../../index.html" />
    <link rel="up" title="Univariate Polynomials and Polynomial Rings" href="../../../polynomial_rings_univar.html" />
    <link rel="next" title="Univariate Polynomials over domains and fields" href="polynomial_element_generic.html" />
    <link rel="prev" title="Ring homomorphisms from a polynomial ring to another ring" href="polynomial_ring_homomorphism.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="polynomial_element_generic.html" title="Univariate Polynomials over domains and fields"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="polynomial_ring_homomorphism.html" title="Ring homomorphisms from a polynomial ring to another ring"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Polynomials</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../../polynomial_rings_univar.html" accesskey="U">Univariate Polynomials and Polynomial Rings</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="univariate-polynomial-base-class">
<span id="sage-rings-polynomial-polynomial-element"></span><h1>Univariate Polynomial Base Class<a class="headerlink" href="#univariate-polynomial-base-class" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.rings.polynomial.polynomial_element"></span><p>AUTHORS:</p>
<ul class="simple">
<li>William Stein: first version.</li>
<li>Martin Albrecht: Added singular coercion.</li>
<li>Robert Bradshaw: Move Polynomial_generic_dense to Cython.</li>
<li>Miguel Marco: Implemented resultant in the case where PARI fails.</li>
<li>Simon King: Use a faster way of conversion from the base ring.</li>
<li>Julian Rueth (2012-05-25,2014-05-09): Fixed is_squarefree() for imperfect
fields, fixed division without remainder over QQbar; added <code class="docutils literal"><span class="pre">_cache_key</span></code>
for polynomials with unhashable coefficients</li>
<li>Simon King (2013-10): Implement copying of <a class="reference internal" href="#sage.rings.polynomial.polynomial_element.PolynomialBaseringInjection" title="sage.rings.polynomial.polynomial_element.PolynomialBaseringInjection"><code class="xref py py-class docutils literal"><span class="pre">PolynomialBaseringInjection</span></code></a>.</li>
</ul>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">objgen</span><span class="p">()</span>
<span class="go">(Univariate Polynomial Ring in x over Integer Ring, x)</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.rings.polynomial.polynomial_element.ConstantPolynomialSection">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.polynomial_element.</code><code class="descname">ConstantPolynomialSection</code><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.ConstantPolynomialSection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../categories/sage/categories/map.html#sage.categories.map.Map" title="(in Sage Reference Manual: Category Framework v7.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.categories.map.Map</span></code></a></p>
<p>This class is used for conversion from a polynomial ring to its base ring.</p>
<p>Since <a class="reference external" href="http://trac.sagemath.org/9944">trac ticket #9944</a>, it calls the constant_coefficient method,
which can be optimized for a particular polynomial type.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P0</span><span class="o">.&lt;</span><span class="n">y_1</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.&lt;</span><span class="n">y_2</span><span class="p">,</span><span class="n">y_1</span><span class="p">,</span><span class="n">y_0</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">P0</span><span class="p">(</span><span class="o">-</span><span class="n">y_1</span><span class="p">)</span>    <span class="c1"># indirect doctest</span>
<span class="go">2*y_1</span>

<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">convert_map_from</span><span class="p">(</span><span class="n">P0</span><span class="p">);</span> <span class="n">phi</span>
<span class="go">Generic map:</span>
<span class="go">  From: Univariate Polynomial Ring in y_1 over Finite Field of size 3</span>
<span class="go">  To:   Finite Field of size 3</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.polynomial.polynomial_element.ConstantPolynomialSection&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">P0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">y_1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">not a constant polynomial</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.polynomial_element.</code><code class="descname">Polynomial</code><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/element.html#sage.structure.element.CommutativeAlgebraElement" title="(in Sage Reference Manual: Basic Structures v7.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.element.CommutativeAlgebraElement</span></code></a></p>
<p>A polynomial.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">S</span>
<span class="go">Univariate Polynomial Ring in x over Univariate Polynomial Ring in y</span>
<span class="go">over Rational Field</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">;</span> <span class="n">f</span>
<span class="go">y*x</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.polynomial.polynomial_element.Polynomial_generic_dense&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">10</span><span class="p">;</span> <span class="n">p</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1024</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial._add_">
<code class="descname">_add_</code><span class="sig-paren">(</span><em>right</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial._add_" title="Permalink to this definition">¶</a></dt>
<dd><p>Add two polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">R</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">R</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span>    <span class="c1"># indirect doctest</span>
<span class="go">3*x^3 + 5*x^2 - x + 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial._sub_">
<code class="descname">_sub_</code><span class="sig-paren">(</span><em>left</em>, <em>right</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial._sub_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial._lmul_">
<code class="descname">_lmul_</code><span class="sig-paren">(</span><em>left</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial._lmul_" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply self on the left by a scalar.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">_lmul_</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">7*x^3 + 7*x + 35</span>
<span class="gp">sage: </span><span class="mi">7</span><span class="o">*</span><span class="n">f</span>
<span class="go">7*x^3 + 7*x + 35</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial._rmul_">
<code class="descname">_rmul_</code><span class="sig-paren">(</span><em>right</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial._rmul_" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply self on the right by a scalar.</p>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">_rmul_</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">7*x^3 + 7*x + 35</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">*</span><span class="mi">7</span>
<span class="go">7*x^3 + 7*x + 35</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial._mul_">
<code class="descname">_mul_</code><span class="sig-paren">(</span><em>right</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial._mul_" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span>
<span class="go">x^3 - 12*x^2 + 48*x - 64</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">*</span><span class="n">z</span>
<span class="go">t^2*s^4 + (2*t + O(t^2))*s^2 + 1 + O(t)</span>

<span class="go">## More examples from trac 2943, added by Kiran S. Kedlaya 2 Dec 09</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">*</span><span class="n">z</span>
<span class="go">(t^4 + O(t^5))*s^4 + (2*t^3 + O(t^4))*s^3 + (3*t^2 + O(t^3))*s^2 + (2*t + O(t^2))*s + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial._mul_trunc_">
<code class="descname">_mul_trunc_</code><span class="sig-paren">(</span><em>right</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial._mul_trunc_" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the truncated multiplication of two polynomials up to <code class="docutils literal"><span class="pre">n</span></code>.</p>
<p>This is the default implementation that does the multiplication and then
truncate! There are custom implementations in several subclasses:</p>
<ul class="simple">
<li><a class="reference internal" href="polynomial_integer_dense_flint.html#sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint._mul_trunc_" title="sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint._mul_trunc_"><code class="xref py py-meth docutils literal"><span class="pre">on</span> <span class="pre">dense</span> <span class="pre">polynomial</span> <span class="pre">over</span> <span class="pre">integers</span> <span class="pre">(via</span> <span class="pre">FLINT)</span></code></a></li>
<li><a class="reference internal" href="polynomial_zmod_flint.html#sage.rings.polynomial.polynomial_zmod_flint.Polynomial_zmod_flint._mul_trunc_" title="sage.rings.polynomial.polynomial_zmod_flint.Polynomial_zmod_flint._mul_trunc_"><code class="xref py py-meth docutils literal"><span class="pre">on</span> <span class="pre">dense</span> <span class="pre">polynomial</span> <span class="pre">over</span> <span class="pre">Z/nZ</span> <span class="pre">(via</span> <span class="pre">FLINT)</span></code></a></li>
<li><a class="reference internal" href="polynomial_rational_flint.html#sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint._mul_trunc_" title="sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint._mul_trunc_"><code class="xref py py-meth docutils literal"><span class="pre">on</span> <span class="pre">dense</span> <span class="pre">rational</span> <span class="pre">polynomial</span> <span class="pre">(via</span> <span class="pre">FLINT)</span></code></a></li>
<li><a class="reference internal" href="polynomial_modn_dense_ntl.html#sage.rings.polynomial.polynomial_modn_dense_ntl.Polynomial_dense_modn_ntl_zz._mul_trunc_" title="sage.rings.polynomial.polynomial_modn_dense_ntl.Polynomial_dense_modn_ntl_zz._mul_trunc_"><code class="xref py py-meth docutils literal"><span class="pre">on</span> <span class="pre">dense</span> <span class="pre">polynomial</span> <span class="pre">on</span> <span class="pre">Z/nZ</span> <span class="pre">(via</span> <span class="pre">NTL)</span></code></a></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">p2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">p1</span><span class="o">.</span><span class="n">_mul_trunc_</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">-2/3*y^3 + 1/3*x*y - 1/3</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">implement a generic truncated Karatsuba and use it here.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.add_bigoh">
<code class="descname">add_bigoh</code><span class="sig-paren">(</span><em>prec</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.add_bigoh" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the power series of precision at most prec got by adding
<span class="math">\(O(q^\text{prec})\)</span> to self, where q is its variable.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1 + 4*x + x^3 + O(x^7)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1 + 4*x + O(x^2)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Power Series Ring in x over Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.any_root">
<code class="descname">any_root</code><span class="sig-paren">(</span><em>ring=None</em>, <em>degree=None</em>, <em>assume_squarefree=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.any_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a root of this polynomial in the given ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ring</span></code> &#8211; The ring in which a root is sought.  By default
this is the coefficient ring.</li>
<li><code class="docutils literal"><span class="pre">degree</span></code> (None or nonzero integer) &#8211; Used for polynomials
over finite fields.  Returns a root of degree
<code class="docutils literal"><span class="pre">abs(degree)</span></code> over the ground field.  If negative, also
assumes that all factors of this polynomial are of degree
<code class="docutils literal"><span class="pre">abs(degree)</span></code>.  If None, returns a root of minimal degree
contained within the given ring.</li>
<li><code class="docutils literal"><span class="pre">assume_squarefree</span></code> (bool) &#8211; Used for polynomials over
finite fields.  If True, this polynomial is assumed to be
squarefree.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">any_root</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(7) * (x + 9) * (x^6 + 10*x^4 + 6*x^3 + 5*x^2 + 2*x + 2)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">any_root</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">a^5 + a^4 + 7*a^3 + 2*a^2 + 10*a</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)))</span>
<span class="go">[(10*a^5 + 2*a^4 + 8*a^3 + 9*a^2 + a, 1), (a^5 + a^4 + 7*a^3 + 2*a^2 + 10*a, 1), (9*a^5 + 5*a^4 + 10*a^3 + 8*a^2 + 3*a + 1, 1), (2*a^5 + 8*a^4 + 3*a^3 + 6*a + 2, 1), (a^5 + 3*a^4 + 8*a^3 + 2*a^2 + 3*a + 4, 1), (10*a^5 + 3*a^4 + 8*a^3 + a^2 + 10*a + 4, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">any_root</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">a^5 + a^4 + 7*a^3 + 2*a^2 + 10*a</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">any_root</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">any_root</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">5*b^9 + 4*b^7 + 4*b^6 + 8*b^5 + 10*b^2 + 10*b + 5</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">any_root</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">5*b^9 + b^8 + 3*b^7 + 2*b^6 + b^5 + 4*b^4 + 3*b^3 + 7*b^2 + 10*b</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">):</span>
<span class="go">....:     f = R.random_element(degree=4)</span>
<span class="go">....:     assert f(f.any_root(K)) == 0</span>
</pre></div>
</div>
<p>Check that our Cantor-Zassenhaus implementation does not loop
over finite fields of even characteristic (see <a class="reference external" href="http://trac.sagemath.org/16162">trac ticket #16162</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any_root</span><span class="p">()</span> <span class="c1"># used to loop</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no roots A 1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any_root</span><span class="p">()</span>
<span class="go">a^7 + a^2</span>
</pre></div>
</div>
<p>Also check that such computations can be interrupted:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">1000000</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">a</span>
<span class="gp">sage: </span><span class="n">alarm</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span> <span class="n">pol</span><span class="o">.</span><span class="n">any_root</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AlarmInterrupt</span>
</pre></div>
</div>
<p>Check root computation over large finite fields:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">any_root</span><span class="p">()</span>
<span class="go">a^49 + a^47 + a^44 + a^42 + a^41 + a^39 + a^38 + a^37 + a^36 + a^34 + a^33 + a^29 + a^27 + a^26 + a^25 + a^23 + a^18 + a^13 + a^7 + a^5 + a^4 + a^3 + a^2 + a</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">any_root</span><span class="p">()</span>
<span class="go">a^149 + a^148 + a^146 + a^144 + a^143 + a^140 + a^138 + a^136 + a^134 + a^132 + a^131 + a^130 + a^129 + a^127 + a^123 + a^120 + a^118 + a^114 + a^113 + a^112 + a^111 + a^108 + a^104 + a^103 + a^102 + a^99 + a^98 + a^94 + a^91 + a^90 + a^88 + a^79 + a^78 + a^75 + a^73 + a^72 + a^67 + a^65 + a^64 + a^63 + a^62 + a^61 + a^59 + a^57 + a^52 + a^50 + a^48 + a^47 + a^46 + a^45 + a^43 + a^41 + a^39 + a^37 + a^34 + a^31 + a^29 + a^27 + a^25 + a^23 + a^22 + a^20 + a^18 + a^16 + a^14 + a^11 + a^10 + a^8 + a^6 + a^5 + a^4 + a + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.args">
<code class="descname">args</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the generator of this polynomial ring, which is the (only)
argument used when calling self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">args</span><span class="p">()</span>
<span class="go">(x,)</span>
</pre></div>
</div>
<p>A constant polynomial has no variables, but still takes a single
argument.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">()</span>
<span class="go">(x,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.base_extend">
<code class="descname">base_extend</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.base_extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of this polynomial but with coefficients in R, if
there is a natural map from coefficient ring of self to R.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">17</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">no such base extension</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">x^3 + 4*x + 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.base_ring">
<code class="descname">base_ring</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.base_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the base ring of the parent of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.change_ring">
<code class="descname">change_ring</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.change_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of this polynomial but with coefficients in <code class="docutils literal"><span class="pre">R</span></code>, if at
all possible.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">R</span></code> - a ring or morphism.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">defining_polynomial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">x^2 + x + 1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">x^2 - 0.500000000000000 - 0.866025403784439*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.change_variable_name">
<code class="descname">change_variable_name</code><span class="sig-paren">(</span><em>var</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.change_variable_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new polynomial over the same base ring but in a different
variable.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">19</span><span class="o">/</span><span class="mi">993</span><span class="p">;</span> <span class="n">f</span>
<span class="go">-2/7*x^3 + 2/3*x - 19/993</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">change_variable_name</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="go">-2/7*theta^3 + 2/3*theta - 19/993</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.coefficients">
<code class="descname">coefficients</code><span class="sig-paren">(</span><em>sparse=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coefficients of the monomials appearing in self.
If <code class="docutils literal"><span class="pre">sparse=True</span></code> (the default), it returns only the non-zero coefficients.
Otherwise, it returns the same value as <code class="docutils literal"><span class="pre">self.list()</span></code>.
(In this case, it may be slightly faster to invoke <code class="docutils literal"><span class="pre">self.list()</span></code> directly.)</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">_</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">coefficients</span><span class="p">()</span>
<span class="go">[1, 2, 1]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">coefficients</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[1, 0, 2, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.coeffs">
<code class="descname">coeffs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Using <code class="docutils literal"><span class="pre">coeffs()</span></code> is now deprecated (<a class="reference external" href="http://trac.sagemath.org/17518">trac ticket #17518</a>).
Returns <code class="docutils literal"><span class="pre">self.list()</span></code>.</p>
<p>(It is potentially slightly faster to use
<code class="docutils literal"><span class="pre">self.list()</span></code> directly.)</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="mi">17</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">doctest:...: DeprecationWarning: The use of coeffs() is now deprecated in favor of coefficients(sparse=False).</span>
<span class="go">See http://trac.sagemath.org/17518 for details.</span>
<span class="go">[2/17, 5, 0, 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.complex_roots">
<code class="descname">complex_roots</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.complex_roots" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the complex roots of this polynomial, without
multiplicities.</p>
<p>Calls self.roots(ring=CC), unless this is a polynomial with
floating-point coefficients, in which case it is uses the
appropriate precision from the input coefficients.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">complex_roots</span><span class="p">()</span>   <span class="c1"># note: low order bits slightly different on ppc.</span>
<span class="go">[1.00000000000000, -0.500000000000000 - 0.86602540378443...*I, -0.500000000000000 + 0.86602540378443...*I]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">complex_roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Complex Field with 53 bits of precision</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">RDF</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">complex_roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Complex Double Field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">RealField</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">complex_roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Complex Field with 200 bits of precision</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">CDF</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">complex_roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Complex Double Field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">complex_roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Complex Field with 200 bits of precision</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">);</span> <span class="n">v</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">complex_roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">CC</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.constant_coefficient">
<code class="descname">constant_coefficient</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.constant_coefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the constant coefficient of this polynomial.</p>
<p>OUTPUT: element of base ring</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">constant_coefficient</span><span class="p">()</span>
<span class="go">-1/3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.content">
<code class="descname">content</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.content" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the content of <code class="docutils literal"><span class="pre">self</span></code>, which is the ideal generated by the coefficients of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">IntegerModRing</span><span class="p">(</span><span class="mi">4</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
<span class="go">Ideal (2, 3, 1) of Ring of integers modulo 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.cyclotomic_part">
<code class="descname">cyclotomic_part</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.cyclotomic_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the product of the irreducible factors of this polynomial
which are cyclotomic polynomials.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic" title="sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic"><code class="xref py py-meth docutils literal"><span class="pre">is_cyclotomic()</span></code></a>
<a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic_product" title="sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic_product"><code class="xref py py-meth docutils literal"><span class="pre">is_cyclotomic_product()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">cyclotomic_part</span><span class="p">()</span>
<span class="go">x^4 + 1</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">cyclotomic_part</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">cyclotomic_part</span><span class="p">()</span>
<span class="go">x^8 + 2*x^4 + 1</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">cyclotomic_part</span><span class="p">()</span>
<span class="go">x^8 + 2*x^4 + 1</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">cyclotomic_part</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">not implemented for inexact base rings</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cyclotomic_part</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">not implemented in non-zero characteristic</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.degree">
<code class="descname">degree</code><span class="sig-paren">(</span><em>gen=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of this polynomial. The zero polynomial has
degree -1.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">93</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">93</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">100000</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">100000</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">2006</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2006</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">2006</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">33</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Naqi Jaffery (2006-01-24): examples</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.denominator">
<code class="descname">denominator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.denominator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a denominator of self.</p>
<p>First, the lcm of the denominators of the entries of self
is computed and returned. If this computation fails, the
unit of the parent of self is returned.</p>
<p>Note that some subclasses may implement their own
denominator function. For example, see
<a class="reference internal" href="polynomial_rational_flint.html#sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint" title="sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint</span></code></a></p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is not the denominator of the rational function
defined by self, which would always be 1 since self is a
polynomial.</p>
</div>
<p>EXAMPLES:</p>
<p>First we compute the denominator of a polynomial with
integer coefficients, which is of course 1.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Next we compute the denominator of a polynomial with rational
coefficients.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">19</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">;</span> <span class="n">f</span>
<span class="go">1/17*x^19 - 2/3*x + 1/3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">51</span>
</pre></div>
</div>
<p>Finally, we try to compute the denominator of a polynomial with
coefficients in the real numbers, which is a ring whose elements do
not have a denominator method.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">RR</span><span class="p">(</span><span class="s1">&#39;0.3&#39;</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x + 0.300000000000000</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
<p>Check that the denominator is an element over the base whenever the base
has no denominator function. This closes #9063.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">denominator</span><span class="p">())</span>
<span class="go">&lt;type &#39;sage.rings.finite_rings.integer_mod.IntegerMod_int&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">denominator</span><span class="p">(),</span> <span class="n">Polynomial</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="o">/</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Polynomial</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/18518">trac ticket #18518</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.derivative">
<code class="descname">derivative</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>The formal derivative of this polynomial, with respect to variables
supplied in args.</p>
<p>Multiple variables and iteration counts may be supplied; see
documentation for the global derivative() function for more
details.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">_derivative()</span></code></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">-4*x^3 + x - 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">-4*x^3 + x - 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">-12*x^2 + 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-12*x^2 + 1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">3*t^4*x^2 + 2*t^3*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">3*t^4*x^2 + 2*t^3*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">4*t^3*x^3 + 3*t^2*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.dict">
<code class="descname">dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sparse dictionary representation of this univariate
polynomial.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">13</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: 13, 1: -1/7, 3: 1}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.diff">
<code class="descname">diff</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.diff" title="Permalink to this definition">¶</a></dt>
<dd><p>The formal derivative of this polynomial, with respect to variables
supplied in args.</p>
<p>Multiple variables and iteration counts may be supplied; see
documentation for the global derivative() function for more
details.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">_derivative()</span></code></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">-4*x^3 + x - 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">-4*x^3 + x - 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">-12*x^2 + 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-12*x^2 + 1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">3*t^4*x^2 + 2*t^3*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">3*t^4*x^2 + 2*t^3*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">4*t^3*x^3 + 3*t^2*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.differentiate">
<code class="descname">differentiate</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.differentiate" title="Permalink to this definition">¶</a></dt>
<dd><p>The formal derivative of this polynomial, with respect to variables
supplied in args.</p>
<p>Multiple variables and iteration counts may be supplied; see
documentation for the global derivative() function for more
details.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">_derivative()</span></code></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">-4*x^3 + x - 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">-4*x^3 + x - 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">-12*x^2 + 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-12*x^2 + 1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">3*t^4*x^2 + 2*t^3*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">3*t^4*x^2 + 2*t^3*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">4*t^3*x^3 + 3*t^2*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.discriminant">
<code class="descname">discriminant</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the discriminant of self.</p>
<p>The discriminant is</p>
<div class="math">
\[R_n := a_n^{2 n-2} \prod_{1&lt;i&lt;j&lt;n} (r_i-r_j)^2,\]</div>
<p>where <span class="math">\(n\)</span> is the degree of self, <span class="math">\(a_n\)</span> is the
leading coefficient of self and the roots of self are
<span class="math">\(r_1, \ldots, r_n\)</span>.</p>
<p>OUTPUT: An element of the base ring of the polynomial ring.</p>
<p>ALGORITHM:</p>
<p>Uses the identity <span class="math">\(R_n(f) := (-1)^{n (n-1)/2} R(f, f')
a_n^{n-k-2}\)</span>, where <span class="math">\(n\)</span> is the degree of self, <span class="math">\(a_n\)</span> is the
leading coefficient of self, <span class="math">\(f'\)</span> is the derivative of <span class="math">\(f\)</span>,
and <span class="math">\(k\)</span> is the degree of <span class="math">\(f'\)</span>. Calls <a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.resultant" title="sage.rings.polynomial.polynomial_element.Polynomial.resultant"><code class="xref py py-meth docutils literal"><span class="pre">resultant()</span></code></a>.</p>
<p>EXAMPLES:</p>
<p>In the case of elliptic curves in special form, the discriminant is
easy to calculate:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">();</span> <span class="n">d</span>
<span class="go">-31</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QQ</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">/</span><span class="mi">16</span>
<span class="go">-31</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">();</span> <span class="n">d</span>
<span class="go">-116</span>
</pre></div>
</div>
<p>We can compute discriminants over univariate and multivariate
polynomial rings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">();</span> <span class="n">d</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">R</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">();</span> <span class="n">d</span>
<span class="go">-4*a - 4*b</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">R</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/13672">trac ticket #13672</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">4*t^5</span>
</pre></div>
</div>
<p>The following examples show that <a class="reference external" href="http://trac.sagemath.org/11782">trac ticket #11782</a> has been fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZ</span><span class="o">.</span><span class="n">quo</span><span class="p">(</span><span class="mi">81</span><span class="p">)[</span><span class="n">x</span><span class="p">](</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">54</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="o">.</span><span class="n">quo</span><span class="p">(</span><span class="mi">9</span><span class="p">)[</span><span class="n">x</span><span class="p">](</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>This was fixed by <a class="reference external" href="http://trac.sagemath.org/15422">trac ticket #15422</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>This was fixed by <a class="reference external" href="http://trac.sagemath.org/16014">trac ticket #16014</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PR</span><span class="o">.&lt;</span><span class="n">b</span><span class="p">,</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">PRmu</span><span class="o">.&lt;</span><span class="n">mu</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">(</span><span class="n">PR</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">PR</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span><span class="n">x1</span><span class="o">-</span><span class="n">t1</span><span class="o">*</span><span class="n">y1</span><span class="p">],[</span><span class="n">t1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="n">t1</span><span class="o">*</span><span class="n">x1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">*</span><span class="n">E1</span><span class="o">*</span><span class="n">M</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">E1</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t1</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="n">y2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">det</span><span class="p">(</span><span class="n">mu</span><span class="o">*</span><span class="n">E1</span> <span class="o">+</span> <span class="n">E2</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">degrees</span><span class="p">()</span>
<span class="go">(24, 12, 12, 8, 8, 8, 8)</span>
</pre></div>
</div>
<p>This addresses an issue raised by <a class="reference external" href="http://trac.sagemath.org/15061">trac ticket #15061</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">R</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">RP</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">F</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">4 + 4*T + O(T^2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.dispersion">
<code class="descname">dispersion</code><span class="sig-paren">(</span><em>other=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.dispersion" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the dispersion of a pair of polynomials.</p>
<p>The dispersion of <span class="math">\(f\)</span> and <span class="math">\(g\)</span> is the largest nonnegative integer <span class="math">\(n\)</span>
such that <span class="math">\(f(x + n)\)</span> and <span class="math">\(g(x)\)</span> have a nonconstant common factor.</p>
<p>When <code class="docutils literal"><span class="pre">other</span></code> is <code class="docutils literal"><span class="pre">None</span></code>, compute the auto-dispersion of <code class="docutils literal"><span class="pre">self</span></code>,
i.e., its dispersion with itself.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.dispersion_set" title="sage.rings.polynomial.polynomial_element.Polynomial.dispersion_set"><code class="xref py py-meth docutils literal"><span class="pre">dispersion_set()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Pol</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">dispersion</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dispersion</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">-Infinity</span>

<span class="gp">sage: </span><span class="n">Pol</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQbar</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">Pol</span><span class="p">([</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">dispersion</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">pol</span><span class="o">*</span><span class="n">pol</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">dispersion</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.dispersion_set">
<code class="descname">dispersion_set</code><span class="sig-paren">(</span><em>other=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.dispersion_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the dispersion set of two polynomials.</p>
<p>The dispersion set of <span class="math">\(f\)</span> and <span class="math">\(g\)</span> is the set of nonnegative integers
<span class="math">\(n\)</span> such that <span class="math">\(f(x + n)\)</span> and <span class="math">\(g(x)\)</span> have a nonconstant common factor.</p>
<p>When <code class="docutils literal"><span class="pre">other</span></code> is <code class="docutils literal"><span class="pre">None</span></code>, compute the auto-dispersion set of
<code class="docutils literal"><span class="pre">self</span></code>, i.e., its dispersion set with itself.</p>
<p>ALGORITHM:</p>
<p>See Section 4 of Man &amp; Wright <a class="reference internal" href="#manwright1994" id="id1">[ManWright1994]</a>.</p>
<table class="docutils citation" frame="void" id="manwright1994" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[ManWright1994]</a></td><td>Yiu-Kwong Man and Francis J. Wright.
<em>Fast Polynomial Dispersion Computation and its Application to
Indefinite Summation</em>. ISSAC 1994.</td></tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.dispersion" title="sage.rings.polynomial.polynomial_element.Polynomial.dispersion"><code class="xref py py-meth docutils literal"><span class="pre">dispersion()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Pol</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">dispersion_set</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dispersion_set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">pol</span><span class="o">*</span><span class="n">pol</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">dispersion_set</span><span class="p">()</span>
<span class="go">[0, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.euclidean_degree">
<code class="descname">euclidean_degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.euclidean_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of this element as an element of a euclidean domain.</p>
<p>If this polynomial is defined over a field, this is simply its <a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.degree" title="sage.rings.polynomial.polynomial_element.Polynomial.degree"><code class="xref py py-meth docutils literal"><span class="pre">degree()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">euclidean_degree</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">euclidean_degree</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.exponents">
<code class="descname">exponents</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.exponents" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the exponents of the monomials appearing in self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">_</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">exponents</span><span class="p">()</span>
<span class="go">[0, 2, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.factor">
<code class="descname">factor</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the factorization of <code class="docutils literal"><span class="pre">self</span></code> over its base ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">kwargs</span></code> &#8211; any keyword arguments are passed to the method
<code class="docutils literal"><span class="pre">_factor_univariate_polynomial()</span></code> of the base ring if it
defines such a method.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A factorization of <code class="docutils literal"><span class="pre">self</span></code> over its parent into a unit and
irreducible factors.  If the parent is a polynomial ring
over a field, these factors are monic.</li>
</ul>
<p>EXAMPLES:</p>
<p>Factorization is implemented over various rings. Over <span class="math">\(\QQ\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 1)^2 * (x^2 + x + 1)^2</span>
</pre></div>
</div>
<p>Since <span class="math">\(\QQ\)</span> is a field, the irreducible factors are monic:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(10) * (x^5 - 1/10)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(10) * (x - 1) * (x^4 + x^3 + x^2 + x + 1)</span>
</pre></div>
</div>
<p>Over <span class="math">\(\ZZ\)</span> the irreducible factors need not be monic:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">10*x^5 - 1</span>
</pre></div>
</div>
<p>We factor a non-monic polynomial over a finite field of 25
elements:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">k</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">();</span> <span class="n">F</span>
<span class="go">(2) * (x + a + 2) * (x^2 + 3*x + 4*a + 4) * (x^2 + (a + 1)*x + a + 2) * (x^5 + (3*a + 4)*x^4 + (3*a + 3)*x^3 + 2*a*x^2 + (3*a + 1)*x + 3*a + 1)</span>
</pre></div>
</div>
<p>Notice that the unit factor is included when we multiply <span class="math">\(F\)</span>
back out:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">expand</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">2*x^10 + 2*x + 2*a</span>
</pre></div>
</div>
<p>A new ring.  In the example below, we set the special method
<code class="docutils literal"><span class="pre">_factor_univariate_polynomial()</span></code> in the base ring which is
called to factor univariate polynomials.  This facility can be
used to easily extend polynomial factorization to work over
new rings you introduce:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">IntegerModRing</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;NTL&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">factorization of polynomials over rings with composite characteristic is not implemented</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span><span class="o">.</span><span class="n">_factor_univariate_polynomial</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">x^2</span>
<span class="gp">sage: </span><span class="k">del</span> <span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span><span class="o">.</span><span class="n">_factor_univariate_polynomial</span> <span class="c1"># clean up</span>
</pre></div>
</div>
<p>Arbitrary precision real and complex factorization:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">);</span> <span class="n">F</span>
<span class="go">(x - 1.7320508075688772935274463415) * (x + 1.7320508075688772935274463415)</span>
<span class="gp">sage: </span><span class="n">expand</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">x^2 - 3.0000000000000000000000000000</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">x^2 + 1.0000000000000000000000000000</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ComplexField</span><span class="p">(</span><span class="mi">100</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="p">);</span> <span class="n">F</span>
<span class="go">(x - 1.7320508075688772935274463415*I) * (x + 1.7320508075688772935274463415*I)</span>
<span class="gp">sage: </span><span class="n">expand</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">x^2 + 3.0000000000000000000000000000</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(x - I) * (x + I)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">f</span>
<span class="go">I*x^2 + I</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="n">F</span>
<span class="go">(1.0000000000000000000000000000*I) * (x - I) * (x + I)</span>
<span class="gp">sage: </span><span class="n">expand</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">I*x^2 + I</span>
</pre></div>
</div>
<p>Over a number field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - z) * (x^3 + z*x + 1)^3</span>
<span class="gp">sage: </span><span class="n">cyclotomic_polynomial</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x^2 - z^5 - 1) * (x^2 + z^5)</span>
<span class="gp">sage: </span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(-1/331*z^7 + 3/331*z^6 - 6/331*z^5 + 11/331*z^4 - 21/331*z^3 + 41/331*z^2 - 82/331*z + 165/331) * (x - 1/3*z - 2/3) * (x^3 + z*x + 1)^3</span>
</pre></div>
</div>
<p>Over a relative number field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="n">z</span><span class="p">);</span> <span class="n">f</span>
<span class="go">t^8 + t^6 + a*t^5 + t^4 + z*t^3 + t^2 + (a + z)*t + z*a</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(t^3 + t + a) * (t^5 + t + z)</span>
</pre></div>
</div>
<p>Over the real double field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(-2.0) * (x^2 + 0.5000000000000001)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">-2.0*x^2 - 1.0000000000000002</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>  <span class="c1"># abs tol 2e-5</span>
<span class="go">(x - 1.0000065719436413) * (x^2 - 1.9999934280563585*x + 0.9999934280995487)</span>
</pre></div>
</div>
<p>The above output is incorrect because it relies on the
<a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.roots" title="sage.rings.polynomial.polynomial_element.Polynomial.roots"><code class="xref py py-meth docutils literal"><span class="pre">roots()</span></code></a> method, which does not detect that all the roots
are real:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>  <span class="c1"># abs tol 2e-5</span>
<span class="go">[(1.0000065719436413, 1)]</span>
</pre></div>
</div>
<p>Over the complex double field the factors are approximate and
therefore occur with multiplicity 1:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CDF</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span>  <span class="c1"># abs tol 3e-5</span>
<span class="go">(x - 1.0000138879287663 + 1.0000013435286879*I) * (x - 0.9999942196864997 + 0.9999873009803959*I) * (x - 0.9999918923847313 + 1.0000113554909125*I) * (x + 0.9999908759550227 - 1.0000069659624138*I) * (x + 0.9999985293216753 - 0.9999886153831807*I) * (x + 1.0000105947233 - 1.0000044186544053*I)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">F</span><span class="p">]</span> <span class="c1"># abs tol 1e-13</span>
<span class="go">[1.979365054e-14, 1.97936298566e-14, 1.97936990747e-14, 3.6812407475e-14, 3.65211563729e-14, 3.65220890052e-14]</span>
</pre></div>
</div>
<p>Factoring polynomials over <span class="math">\(\ZZ/n\ZZ\)</span> for
composite <span class="math">\(n\)</span> is not implemented:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">factorization of polynomials over rings with composite characteristic is not implemented</span>
</pre></div>
</div>
<p>Factoring polynomials over the algebraic numbers (see
<a class="reference external" href="http://trac.sagemath.org/8544">trac ticket #8544</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQbar</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 1) * (x - 0.7071067811865475? - 0.7071067811865475?*I) * (x - 0.7071067811865475? + 0.7071067811865475?*I) * (x - I) * (x + I) * (x + 0.7071067811865475? - 0.7071067811865475?*I) * (x + 0.7071067811865475? + 0.7071067811865475?*I) * (x + 1)</span>
</pre></div>
</div>
<p>Factoring polynomials over the algebraic reals (see
<a class="reference external" href="http://trac.sagemath.org/8544">trac ticket #8544</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AA</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x^2 - 1.847759065022574?*x + 1.000000000000000?) * (x^2 - 0.7653668647301795?*x + 1.000000000000000?) * (x^2 + 0.7653668647301795?*x + 1.000000000000000?) * (x^2 + 1.847759065022574?*x + 1.000000000000000?)</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>This came up in <a class="reference external" href="http://trac.sagemath.org/7088">trac ticket #7088</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">432</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">9011</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">13</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">89</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g</span><span class="o">^</span><span class="mi">3</span><span class="p">;</span> <span class="n">F</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(12*x^10 + x^9 + 432*x^3 + 9011)^2 * (13*x^11 + 89*x^3 + 1)^3</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">7</span><span class="p">;</span> <span class="n">F</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">7 * (12*x^10 + x^9 + 432*x^3 + 9011)^2 * (13*x^11 + 89*x^3 + 1)^3</span>
</pre></div>
</div>
<p>This example came up in <a class="reference external" href="http://trac.sagemath.org/7097">trac ticket #7097</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">42</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">24</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">23</span> <span class="o">+</span> <span class="mi">72</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">22</span> <span class="o">-</span> <span class="mi">286</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">21</span> <span class="o">+</span> <span class="mi">849</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">20</span> <span class="o">-</span> <span class="mi">2022</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">19</span> <span class="o">+</span> <span class="mi">4034</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">6894</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">17</span> <span class="o">+</span> <span class="mi">10182</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">13048</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">15</span> <span class="o">+</span> <span class="mi">14532</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="mi">13974</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">11365</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">7578</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">4038</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">1766</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">762</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">408</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">236</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">126</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">69</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">38</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">18</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">g</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(8) * (x^3 + 1/4) * (x^6 + 5*x^3 - 1/2)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(8) * (x - 3260097/3158212*a^22 + 35861067/3158212*a^21 - 197810817/3158212*a^20 + 722970825/3158212*a^19 - 1980508347/3158212*a^18 + 4374189477/3158212*a^17 - 4059860553/1579106*a^16 + 6442403031/1579106*a^15 - 17542341771/3158212*a^14 + 20537782665/3158212*a^13 - 20658463789/3158212*a^12 + 17502836649/3158212*a^11 - 11908953451/3158212*a^10 + 6086953981/3158212*a^9 - 559822335/789553*a^8 + 194545353/789553*a^7 - 505969453/3158212*a^6 + 338959407/3158212*a^5 - 155204647/3158212*a^4 + 79628015/3158212*a^3 - 57339525/3158212*a^2 + 26692783/3158212*a - 1636338/789553) * ...</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">QQbar</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Factorization also works even if the variable of the finite
field is nefariously labeled &#8220;x&#8221;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span><span class="mi">13</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">();</span> <span class="n">G</span>
<span class="go">(x + x) * (x + 2*x + 1) * (x^4 + (x + 2)*x^3 + (2*x + 2)*x + 2) * (x^4 + 2*x*x^3 + (x + 1)*x + 2)</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x0</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)[]</span>  <span class="c1"># purposely calling it x to test robustness</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x0</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x0</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x0 + 2) * (x0 + x) * (x0 + 2*x + 1)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">x0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">factorization of 0 not defined</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x0</span><span class="o">^</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Over a complicated number field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">10</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">867</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">76</span><span class="o">/</span><span class="mi">245</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3148</span><span class="o">/</span><span class="mi">35</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">25944</span><span class="o">/</span><span class="mi">245</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">48771</span><span class="o">/</span><span class="mi">1225</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">ff</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="n">ff</span>
<span class="go">T^6 + 10/7*T^5 - 867/49*T^4 - 76/245*T^3 + 3148/35*T^2 - 25944/245*T + 48771/1225</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[(T - a, 1), (T - 40085763200/924556084127*a^5 - 145475769880/924556084127*a^4 + 527617096480/924556084127*a^3 + 1289745809920/924556084127*a^2 - 3227142391585/924556084127*a - 401502691578/924556084127, 1)]</span>
<span class="gp">sage: </span><span class="n">expand</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">T^6 + 10/7*T^5 - 867/49*T^4 - 76/245*T^3 + 3148/35*T^2 - 25944/245*T + 48771/1225</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(T - 1) * (T + 1)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(3) * (T - a) * (T + a)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(T - a) * (T + a)</span>
</pre></div>
</div>
<p>Test that <a class="reference external" href="http://trac.sagemath.org/10279">trac ticket #10279</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">11</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(t - 2*a^3 + a) * (t - 4/3*a^3 + 2/3*a) * (t - 2/3*a^3 + 1/3*a)</span>
</pre></div>
</div>
<p>Test that this factorization really uses <code class="docutils literal"><span class="pre">nffactor()</span></code> internally:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pari</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">pol</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>

<span class="go">Entering nffactor:</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="n">pari</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Test that <a class="reference external" href="http://trac.sagemath.org/10369">trac ticket #10369</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">6</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="p">(</span><span class="mi">90</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">152</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">18</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">24</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">30</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">36</span><span class="o">/</span><span class="mi">49</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">198</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">102</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">60</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">26</span><span class="o">/</span><span class="mi">49</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="p">(</span><span class="mi">40</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">45</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">60</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">277</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">204</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">78</span><span class="o">/</span><span class="mi">49</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="p">(</span><span class="mi">90</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">110</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">80</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">46</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">30</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="p">(</span><span class="mi">30</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">260</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">250</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">232</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">32</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">184</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">58</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">52</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">66</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">72</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">72</span><span class="o">/</span><span class="mi">49</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="mi">18</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">32</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">10</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">4</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(-1/7*a^5 - 1/7*a^4 - 1/7*a^3 - 1/7*a^2 - 2/7*a - 1/7) * t * (t - a^5 - a^4 - a^3 - a^2 - a - 1)^4 * (t^5 + (-12/7*a^5 - 10/7*a^4 - 8/7*a^3 - 6/7*a^2 - 4/7*a - 2/7)*t^4 + (12/7*a^5 - 8/7*a^3 + 16/7*a^2 + 2/7*a + 20/7)*t^3 + (-20/7*a^5 - 20/7*a^3 - 20/7*a^2 + 4/7*a - 2)*t^2 + (12/7*a^5 + 12/7*a^3 + 2/7*a + 16/7)*t - 4/7*a^5 - 4/7*a^3 - 4/7*a - 2/7)</span>

<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">6</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="p">(</span><span class="mi">102</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">99</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">96</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">93</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">90</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">150</span><span class="o">/</span><span class="mi">49</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">160</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">36</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">48</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">8</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">60</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">60</span><span class="o">/</span><span class="mi">49</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="p">(</span><span class="mi">30</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">55</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">20</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="p">(</span><span class="mi">6</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">12</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">6</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(1/7*a^2 - 1/7*a) * t^5 * (t^5 + (-40/7*a^5 - 38/7*a^4 - 36/7*a^3 - 34/7*a^2 - 32/7*a - 30/7)*t^4 + (60/7*a^5 - 30/7*a^4 - 18/7*a^3 - 9/7*a^2 - 3/7*a)*t^3 + (60/7*a^4 - 40/7*a^3 - 16/7*a^2 - 4/7*a)*t^2 + (30/7*a^3 - 25/7*a^2 - 5/7*a)*t + 6/7*a^2 - 6/7*a)</span>

<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">6</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="p">(</span><span class="mi">9</span><span class="o">/</span><span class="mi">49</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">15</span><span class="o">/</span><span class="mi">49</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="p">(</span><span class="mi">8</span><span class="o">/</span><span class="mi">343</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">32</span><span class="o">/</span><span class="mi">343</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">40</span><span class="o">/</span><span class="mi">343</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">20</span><span class="o">/</span><span class="mi">343</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2401</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">20</span><span class="o">/</span><span class="mi">2401</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">40</span><span class="o">/</span><span class="mi">2401</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="o">/</span><span class="mi">343</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">15</span><span class="o">/</span><span class="mi">2401</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="o">/</span><span class="mi">16807</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">12</span><span class="o">/</span><span class="mi">16807</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">18</span><span class="o">/</span><span class="mi">16807</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">12</span><span class="o">/</span><span class="mi">16807</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">6</span><span class="o">/</span><span class="mi">16807</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">x^5 * (x^5 + (4/7*a - 6/7)*x^4 + (9/49*a^2 - 3/7*a + 15/49)*x^3 + (8/343*a^3 - 32/343*a^2 + 40/343*a - 20/343)*x^2 + (5/2401*a^4 - 20/2401*a^3 + 40/2401*a^2 - 5/343*a + 15/2401)*x - 6/16807*a^4 + 12/16807*a^3 - 18/16807*a^2 + 12/16807*a - 6/16807)</span>
</pre></div>
</div>
<p>Factoring over a number field over which we cannot factor the
discriminant by trial division:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">16</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">^</span><span class="mi">50</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">50</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">pari</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[-1, 1; 3, 15; 23, 1; 887, 1; 12583, 1; 2354691439917211, 1]</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span>
<span class="go">-1 * 3^15 * 23 * 887 * 12583 * 6335047 * 371692813</span>
</pre></div>
</div>
<p>Factoring over a number field over which we cannot factor the
discriminant and over which <span class="math">\(nffactor()\)</span> fails:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">);</span> <span class="n">q</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">51</span><span class="p">);</span> <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">;</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nffactor</span><span class="p">(</span><span class="s2">&quot;x^2+1&quot;</span><span class="p">)</span>
<span class="go">Mat([x^2 + 1, 1])</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">x^2 + 1</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span> <span class="p">)</span>
<span class="go">(x - a) * (x + 2*a)</span>
</pre></div>
</div>
<p>A test where nffactor used to fail without a nf structure:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1099511627777</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">(x - a1) * (x^2 + a1*x + a1^2)</span>
</pre></div>
</div>
<p>We check that <a class="reference external" href="http://trac.sagemath.org/7554">trac ticket #7554</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">q</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">LaurentPolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(-1) * (-x + q) * (x + q)</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">q</span><span class="o">^-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1/q^2) * (q*x - 1) * (q*x + 1)</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">FractionField</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">(a/(a + 2)) * (x - a) * (b*x + c)^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.gcd">
<code class="descname">gcd</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a greatest common divisor of this polynomial and <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; a polynomial in the same ring as this polynomial</li>
</ul>
<p>OUTPUT:</p>
<p>A greatest common divisor as a polynomial in the same ring as
this polynomial. If the base ring is a field, the return value
is a monic polynomial.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The actual algorithm for computing greatest common divisors depends
on the base ring underlying the polynomial ring. If the base ring
defines a method <code class="docutils literal"><span class="pre">_gcd_univariate_polynomial</span></code>, then this method
will be called (see examples below).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">x</span>
</pre></div>
</div>
<p>One can easily add gcd functionality to new rings by providing a method
<code class="docutils literal"><span class="pre">_gcd_univariate_polynomial</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">O</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">a</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Order in Number Field in a with defining polynomial x^2 - 5 does not provide a gcd implementation for univariate polynomials</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">number_field</span><span class="p">()[]</span>
<span class="gp">sage: </span><span class="n">O</span><span class="o">.</span><span class="n">_gcd_univariate_polynomial</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span><span class="n">g</span> <span class="p">:</span> <span class="n">R</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">g</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">x + a</span>
<span class="gp">sage: </span><span class="k">del</span> <span class="n">O</span><span class="o">.</span><span class="n">_gcd_univariate_polynomial</span>
</pre></div>
</div>
<p>Use multivariate implementation for polynomials over polynomials rings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">S</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">z + 2*x*y</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">2*x*y + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.hamming_weight">
<code class="descname">hamming_weight</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.hamming_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of non-zero coefficients of self. Also called weight,
hamming weight or sparsity.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">number_of_terms</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_terms</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">100</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">number_of_terms</span><span class="p">()</span>
<span class="go">101</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_terms</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">cyclotomic_polynomial</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_terms</span><span class="p">()</span>
<span class="go">33</span>
</pre></div>
</div>
<p>The method <a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.hamming_weight" title="sage.rings.polynomial.polynomial_element.Polynomial.hamming_weight"><code class="xref py py-meth docutils literal"><span class="pre">hamming_weight()</span></code></a> is an alias:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">hamming_weight</span><span class="p">()</span>
<span class="go">101</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.homogenize">
<code class="descname">homogenize</code><span class="sig-paren">(</span><em>var='h'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.homogenize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the homogenization of this polynomial.</p>
<p>The polynomial itself is returned if it is homogeneous already. Otherwise,
its monomials are multiplied with the smallest powers of <code class="docutils literal"><span class="pre">var</span></code> such
that they all have the same total degree.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">var</span></code> &#8211; a variable in the polynomial ring (as a string, an element
of the ring, or <code class="docutils literal"><span class="pre">0</span></code>) or a name for a new variable (default:
<code class="docutils literal"><span class="pre">'h'</span></code>)</li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal"><span class="pre">var</span></code> specifies the variable in the polynomial ring, then a
homogeneous element in that ring is returned. Otherwise, a homogeneous
element is returned in a polynomial ring with an extra last variable
<code class="docutils literal"><span class="pre">var</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">homogenize</span><span class="p">()</span>
<span class="go">x^2 + h^2</span>
</pre></div>
</div>
<p>The parameter <code class="docutils literal"><span class="pre">var</span></code> can be used to specify the name of the variable:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">homogenize</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">);</span> <span class="n">g</span>
<span class="go">x^2 + z^2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Multivariate Polynomial Ring in x, z over Rational Field</span>
</pre></div>
</div>
<p>However, if the polynomial is homogeneous already, then that parameter
is ignored and no extra variable is added to the polynomial ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">homogenize</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">);</span> <span class="n">g</span>
<span class="go">x^2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<p>For compatibility with the multivariate case, if <code class="docutils literal"><span class="pre">var</span></code> specifies the
variable of the polynomial ring, then the monomials are multiplied with
the smallest powers of <code class="docutils literal"><span class="pre">var</span></code> such that the result is homogeneous; in
other words, we end up with a monomial whose leading coefficient is the
sum of the coefficients of the polynomial:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">homogenize</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">3*x^2</span>
</pre></div>
</div>
<p>In positive characterstic, the degree can drop in this case:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">homogenize</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>For compatibility with the multivariate case, the parameter <code class="docutils literal"><span class="pre">var</span></code> can
also be 0 to specify the variable in the polynomial ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">homogenize</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.integral">
<code class="descname">integral</code><span class="sig-paren">(</span><em>var=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integral of this polynomial.</p>
<p>By default, the integration variable is the variable of the
polynomial.</p>
<p>Otherwise, the integration variable is the optional parameter <code class="docutils literal"><span class="pre">var</span></code></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The integral is always chosen so that the constant term is 0.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">integral</span><span class="p">();</span> <span class="n">f</span>
<span class="go">2*x</span>
</pre></div>
</div>
<p>Note that the integral lives over the fraction field of the
scalar coefficients:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Rational Field</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Rational Field</span>

<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">();</span> <span class="n">g</span>
<span class="go">1/4*x^4 + 1/2*x^2 - 2*x</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<p>This shows that the issue at <a class="reference external" href="http://trac.sagemath.org/7711">trac ticket #7711</a> is resolved:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2147483647</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">z</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">-1073741823*y^2 + (x + z)*y</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">2147483647</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">z</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">1073741830*y^2 + (x + z)*y</span>
</pre></div>
</div>
<p>A truly convoluted example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">a2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">b</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Power Series Ring in c</span>
<span class="go">over Univariate Polynomial Ring in b over Multivariate Polynomial</span>
<span class="go">Ring in a1, a2 over Integer Ring</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">1/3*a2*x^3 + 1/2*c*x^2 - a1*b*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Power Series Ring in c</span>
<span class="go">over Univariate Polynomial Ring in b over Multivariate Polynomial</span>
<span class="go">Ring in a1, a2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">a2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">b</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">a2*x^3 + c*x^2 - a1*b*x</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Power Series Ring in c</span>
<span class="go">over Univariate Polynomial Ring in b over Multivariate Polynomial</span>
<span class="go">Ring in a1, a2 over Rational Field</span>
</pre></div>
</div>
<p>Integration with respect to a variable in the base ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">5*x*t^2 + 1/2*x^2*t</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/18600">trac ticket #18600</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sx</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">Sxy</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Sx</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">Sxyz</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Sxy</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span>
<span class="go">1/3*y*z^3 + 1/2*x*z^2 + (x*y + 1)*z</span>
<span class="gp">sage: </span><span class="n">q</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in z over Univariate Polynomial Ring in y</span>
<span class="go">over Univariate Polynomial Ring in x over Rational Field</span>
<span class="gp">sage: </span><span class="n">q</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span> <span class="o">==</span> <span class="n">p</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">1/2*y^2*z^2 + x*y*z + 1/2*x*y^2 + y</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Check that it works with non-integral domains (<a class="reference external" href="http://trac.sagemath.org/18600">trac ticket #18600</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">x^5 + x</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span> <span class="o">==</span> <span class="n">p</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.inverse_mod">
<code class="descname">inverse_mod</code><span class="sig-paren">(</span><em>a</em>, <em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.inverse_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverts the polynomial a with respect to m, or raises a ValueError
if no such inverse exists. The parameter m may be either a single
polynomial or an ideal (for consistency with inverse_mod in other
rings).</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">If you are only interested in the inverse modulo a monomial <span class="math">\(x^k\)</span>
then you might use the specialized method
<a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.inverse_series_trunc" title="sage.rings.polynomial.polynomial_element.Polynomial.inverse_series_trunc"><code class="xref py py-meth docutils literal"><span class="pre">inverse_series_trunc()</span></code></a> which is much faster.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">inverse_mod</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">f</span>
<span class="go">-1/2*t^2 - 1/2*t + 1/2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">((</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">7</span><span class="p">);</span> <span class="n">f</span>
<span class="go">-t^6 - 7*t^5 - 21*t^4 - 35*t^3 - 35*t^2 - 21*t - 7</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">7</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">7</span><span class="p">))</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This also works over inexact rings, but note that due to rounding
error the product may not always exactly equal the constant
polynomial 1 and have extra terms with coefficients close to zero.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ulp</span><span class="p">()</span><span class="o">*</span><span class="mi">50</span>   <span class="c1"># Allow an error of up to 50 ulp</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">inverse_mod</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">f</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">0.4*x^4 - 0.2*x^3 - 0.4*x^2 + 0.2*x + 0.8</span>
<span class="gp">sage: </span><span class="n">poly</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="c1"># Remove noisy zero terms:</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">poly</span><span class="p">)([</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">epsilon</span> <span class="k">else</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="p">])</span>
<span class="go">1.0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">inverse_mod</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span> <span class="n">f</span>
<span class="go">0.14285714285714285</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">1.0</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">13</span><span class="p">;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">inverse_mod</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">m</span><span class="p">);</span> <span class="n">f</span>
<span class="go">-0.0319636125...*x^3 - 0.0383269759...*x^2 - 0.0463050900...*x + 0.346479687...</span>
<span class="gp">sage: </span><span class="n">poly</span> <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="n">g</span> <span class="o">%</span> <span class="n">m</span>
<span class="gp">sage: </span><span class="c1"># Remove noisy zero terms:</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">poly</span><span class="p">)([</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">epsilon</span> <span class="k">else</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">coefficients</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="p">])</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">1.0000000000000004</span>
</pre></div>
</div>
<p>ALGORITHM: Solve the system as + mt = 1, returning s as the inverse
of a mod m.</p>
<p>Uses the Euclidean algorithm for exact rings, and solves a linear
system for the coefficients of s and t for inexact rings (as the
Euclidean algorithm may not converge in that case).</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Robert Bradshaw (2007-05-31)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.inverse_of_unit">
<code class="descname">inverse_of_unit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.inverse_of_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">90283</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">self is not a unit.</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="o">-</span><span class="mi">90283</span><span class="p">);</span> <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">inverse_of_unit</span><span class="p">();</span> <span class="n">g</span>
<span class="go">-1/90283</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.inverse_series_trunc">
<code class="descname">inverse_series_trunc</code><span class="sig-paren">(</span><em>prec</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.inverse_series_trunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a polynomial approximation of precision <code class="docutils literal"><span class="pre">prec</span></code> of the inverse
series of this polynomial.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The method <a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.inverse_mod" title="sage.rings.polynomial.polynomial_element.Polynomial.inverse_mod"><code class="xref py py-meth docutils literal"><span class="pre">inverse_mod()</span></code></a> allows more generally to invert this
polynomial with respect to any ideal.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">inverse_series_trunc</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="p">)</span>
<span class="go">x^5 + 1</span>
</pre></div>
</div>
<p>Note that the constant coefficient needs to be a unit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZx</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">ZZxy</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZx</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">inverse_series_trunc</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">constant term x + 1 is not a unit</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZx</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">())</span><span class="o">.</span><span class="n">inverse_series_trunc</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(-1/(x^2 + 2*x + 1))*y^2 + 1/(x + 1)</span>
</pre></div>
</div>
<p>The method works over any polynomial ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rx</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">Rxy</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Rx</span><span class="p">[]</span>

<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">4</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">inverse_series_trunc</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">(2*x^4 + 3*x^2 + 3)*y^10 + 1</span>
</pre></div>
</div>
<p>Even noncommutative ones:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">M</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">M</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">M</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">inverse_series_trunc</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="n">M</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">inverse_series_trunc</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">==</span> <span class="n">M</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">inverse_series_trunc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">the precision must be positive, got 0</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-09-09): Newton&#8217;s method implementation for power
series</li>
<li>Vincent Delecroix (2014-2015): move the implementation directly in
polynomial</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_constant">
<code class="descname">is_constant</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this is a constant polynomial.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bool</span></code> - True if and only if this polynomial is
constant</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic">
<code class="descname">is_cyclotomic</code><span class="sig-paren">(</span><em>certificate=False</em>, <em>algorithm='pari'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if this polynomial is a cyclotomic polynomial.</p>
<p>A <em>cyclotomic polynomial</em> is a monic, irreducible polynomial such that
all roots are roots of unity.</p>
<p>By default the answer is a boolean. But if <code class="docutils literal"><span class="pre">certificate</span></code> is <code class="docutils literal"><span class="pre">True</span></code>,
the result is a non-negative integer: it is <code class="docutils literal"><span class="pre">0</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is not
cyclotomic, and a positive integer <code class="docutils literal"><span class="pre">n</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is the <span class="math">\(n\)</span>-th
cyclotomic polynomial.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic_product" title="sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic_product"><code class="xref py py-meth docutils literal"><span class="pre">is_cyclotomic_product()</span></code></a>
<a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.cyclotomic_part" title="sage.rings.polynomial.polynomial_element.Polynomial.cyclotomic_part"><code class="xref py py-meth docutils literal"><span class="pre">cyclotomic_part()</span></code></a></p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">certificate</span></code> &#8211; boolean, default to <code class="docutils literal"><span class="pre">False</span></code>. Only works with
<code class="docutils literal"><span class="pre">algorithm</span></code> set to &#8220;pari&#8221;.</li>
<li><code class="docutils literal"><span class="pre">algorithm</span></code> &#8211; either &#8220;pari&#8221; or &#8220;sage&#8221; (default is &#8220;pari&#8221;)</li>
</ul>
<p>ALGORITHM:</p>
<p>The native algorithm implemented in Sage uses the first algorithm of
<a class="reference internal" href="#bd89" id="id2">[BD89]</a>. The algorithm in pari is more subtle since it does compute the
inverse of the Euler <span class="math">\(\phi\)</span> function to determine the <span class="math">\(n\)</span> such that the
polynomial is the <span class="math">\(n\)</span>-th cyclotomic polynomial.</p>
<p>EXAMPLES:</p>
<p>Quick tests:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Test first 100 cyclotomic polynomials:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">cyclotomic_polynomial</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Some more tests:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">16</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;pari&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">16</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;sage&quot;</span><span class="p">)</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">16</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;pari&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">16</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;sage&quot;</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Invalid arguments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;sage&quot;</span><span class="p">,</span> <span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no implementation of the certificate within Sage</span>
</pre></div>
</div>
<p>Test using other rings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">not implemented in non-zero characteristic</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
<span class="go">....:     p = R.random_element(degree=randint(10,20))</span>
<span class="go">....:     ans_pari = p.is_cyclotomic(algorithm=&quot;pari&quot;)</span>
<span class="go">....:     ans_sage = p.is_cyclotomic(algorithm=&quot;sage&quot;)</span>
<span class="go">....:     assert ans_pari == ans_sage, &quot;problem with p={}&quot;.format(p)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">):</span>
<span class="go">....:     p = cyclotomic_polynomial(d)</span>
<span class="go">....:     assert p.is_cyclotomic(algorithm=&quot;pari&quot;), &quot;pari problem with p={}&quot;.format(p)</span>
<span class="go">....:     assert p.is_cyclotomic(algorithm=&quot;sage&quot;), &quot;sage problem with p={}&quot;.format(p)</span>
</pre></div>
</div>
<p>Test the output type when <code class="docutils literal"><span class="pre">certificate=True</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
<p>Check that the arguments are forwarded when the input is not a
polynomial with coefficients in <span class="math">\(\ZZ\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="bd89" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[BD89]</a></td><td>R. J. Bradford and J. H. Davenport, Effective tests
for cyclotomic polynomials, Symbolic and Algebraic Computation (1989)
pp. 244 &#8211; 251, <a class="reference external" href="https://dx.doi.org/10.1007/3-540-51084-2_22">doi:10.1007/3-540-51084-2_22</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic_product">
<code class="descname">is_cyclotomic_product</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether this polynomial is a product of cyclotomic polynomials.</p>
<p>This method simply calls the function <code class="docutils literal"><span class="pre">poliscycloprod</span></code> from the Pari
library.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic" title="sage.rings.polynomial.polynomial_element.Polynomial.is_cyclotomic"><code class="xref py py-meth docutils literal"><span class="pre">is_cyclotomic()</span></code></a>
<a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.cyclotomic_part" title="sage.rings.polynomial.polynomial_element.Polynomial.cyclotomic_part"><code class="xref py py-meth docutils literal"><span class="pre">cyclotomic_part()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic_product</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic_product</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">cyclotomic_polynomial</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">is_cyclotomic_product</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic_product</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_cyclotomic_product</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">not implemented in non-zero characteristic</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_gen">
<code class="descname">is_gen</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this polynomial is the distinguished generator of
the parent polynomial ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_gen</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_gen</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Important - this function doesn&#8217;t return True if self equals the
generator; it returns True if self <em>is</em> the generator.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">f</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_gen</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="ow">is</span> <span class="n">x</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_homogeneous">
<code class="descname">is_homogeneous</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_homogeneous" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> if this polynomial is homogeneous.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_irreducible">
<code class="descname">is_irreducible</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_irreducible" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True precisely if this polynomial is irreducible over its
base ring.</p>
<p>Testing irreducibility over <span class="math">\(\ZZ/n\ZZ\)</span> for composite <span class="math">\(n\)</span> is not
implemented.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>See <a class="reference external" href="http://trac.sagemath.org/5140">trac ticket #5140</a>,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The base ring does matter:  for example, 2x is irreducible as a
polynomial in QQ[x], but not in ZZ[x],</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Fx</span><span class="o">.&lt;</span><span class="n">xF</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fx</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">t</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fx</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">t</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_monic">
<code class="descname">is_monic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_monic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if this polynomial is monic. The zero polynomial is by
definition not monic.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">33</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_monic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_monic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_monic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">56</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_monic</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Naqi Jaffery (2006-01-24): examples</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_monomial">
<code class="descname">is_monomial</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_monomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a monomial, i.e., a power of the generator.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The coefficient must be 1:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>To allow a non-1 leading coefficient, use is_term():</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_term</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The definition of is_monomial in Sage up to 4.7.1 was the
same as is_term, i.e., it allowed a coefficient not equal
to 1.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_nilpotent">
<code class="descname">is_nilpotent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_nilpotent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this polynomial is nilpotent.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_nilpotent</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_nilpotent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">^</span><span class="mi">2</span>
<span class="go">0</span>
</pre></div>
</div>
<p>EXERCISE (Atiyah-McDonald, Ch 1): Let <span class="math">\(A[x]\)</span> be a
polynomial ring in one variable. Then
<span class="math">\(f=\sum a_i x^i \in A[x]\)</span> is nilpotent if and only if
every <span class="math">\(a_i\)</span> is nilpotent.</p>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/18600">trac ticket #18600</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_nilpotent</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_one">
<code class="descname">is_one</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_one" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether this polynomial is 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">R2</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_primitive">
<code class="descname">is_primitive</code><span class="sig-paren">(</span><em>n=None</em>, <em>n_prime_divs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the polynomial is primitive.  The semantics of
&#8220;primitive&#8221; depend on the polynomial coefficients.</p>
<ul class="simple">
<li>(field theory) A polynomial of degree <span class="math">\(m\)</span> over a finite field
<span class="math">\(\GF{q}\)</span> is primitive if it is irreducible and its root in
<span class="math">\(\GF{q^m}\)</span> generates the multiplicative group <span class="math">\(\GF{q^m}^*\)</span>.</li>
<li>(ring theory) A polynomial over a ring is primitive if its
coefficients generate the unit ideal.</li>
</ul>
<p>Calling <span class="math">\(is_primitive\)</span> on a polynomial over an infinite field will
raise an error.</p>
<p>The additional inputs to this function are to speed up computation for
field semantics (see note).</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">n</span></code> (default: <code class="docutils literal"><span class="pre">None</span></code>) - if provided, should equal
<span class="math">\(q-1\)</span> where <code class="docutils literal"><span class="pre">self.parent()</span></code> is the field with <span class="math">\(q\)</span>
elements;  otherwise it will be computed.</li>
<li><code class="docutils literal"><span class="pre">n_prime_divs</span></code> (default: <code class="docutils literal"><span class="pre">None</span></code>) - if provided, should
be a list of the prime divisors of <code class="docutils literal"><span class="pre">n</span></code>; otherwise it
will be computed.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Computation of the prime divisors of <code class="docutils literal"><span class="pre">n</span></code> can dominate the running
time of this method, so performing this computation externally
(e.g. <code class="docutils literal"><span class="pre">pdivs=n.prime_divisors()</span></code>) is a good idea for repeated calls
to is_primitive for polynomials of the same degree.</p>
<p class="last">Results may be incorrect if the wrong <code class="docutils literal"><span class="pre">n</span></code> and/or factorization are
provided.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Field</span> <span class="n">semantics</span> <span class="n">examples</span><span class="o">.</span>

<span class="p">::</span>

  <span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">(),</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">(),</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)[]</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">(),</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">(),</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)[]</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="kc">False</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="kc">True</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">x</span><span class="o">=</span><span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">);</span> <span class="n">f</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="o">...</span>
  <span class="ne">NotImplementedError</span><span class="p">:</span> <span class="n">is_primitive</span><span class="p">()</span> <span class="ow">not</span> <span class="n">defined</span> <span class="k">for</span> <span class="n">polynomials</span> <span class="n">over</span> <span class="n">infinite</span> <span class="n">fields</span><span class="o">.</span>

<span class="n">Ring</span> <span class="n">semantics</span> <span class="n">examples</span><span class="o">.</span>

<span class="p">::</span>

  <span class="n">sage</span><span class="p">:</span> <span class="n">x</span><span class="o">=</span><span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="kc">True</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">5</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="kc">False</span>

  <span class="n">sage</span><span class="p">:</span> <span class="n">K</span><span class="o">=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">R</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">ring_of_integers</span><span class="p">()</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="o">=</span><span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span>
  <span class="o">-</span><span class="mi">5</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="kc">True</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
  <span class="kc">False</span>

  <span class="n">sage</span><span class="p">:</span> <span class="n">x</span><span class="o">=</span><span class="n">polygen</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span>
  <span class="n">sage</span><span class="p">:</span> <span class="c1">#f.is_primitive()  #BUG:: elsewhere in Sage, should return True</span>
  <span class="n">sage</span><span class="p">:</span> <span class="n">f</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span>
  <span class="n">sage</span><span class="p">:</span> <span class="c1">#f.is_primitive()  #BUG:: elsewhere in Sage, should return False</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">(</span><span class="n">n_prime_divs</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">polygen</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">103</span><span class="p">));</span> <span class="n">f</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_square">
<code class="descname">is_square</code><span class="sig-paren">(</span><em>root=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether or not polynomial is square. If the optional
argument <code class="docutils literal"><span class="pre">root</span></code> is set to <code class="docutils literal"><span class="pre">True</span></code>, then also returns the square root
(or <code class="docutils literal"><span class="pre">None</span></code>, if the polynomial is not square).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">root</span></code> - whether or not to also return a square
root (default: <code class="docutils literal"><span class="pre">False</span></code>)</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bool</span></code> - whether or not a square</li>
<li><code class="docutils literal"><span class="pre">root</span></code> - (optional) an actual square root if
found, and <code class="docutils literal"><span class="pre">None</span></code> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, x^2 + x - 1)</span>

<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">12</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_square</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(False, None)</span>

<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">f</span><span class="o">/</span><span class="mi">3</span><span class="p">;</span> <span class="n">h</span>
<span class="go">4*x^4 + 32*x^3 + 88*x^2 + 96*x + 36</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">is_square</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, 2*x^2 + 8*x + 6)</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">12</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>

<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Make sure <a class="reference external" href="http://trac.sagemath.org/9093">trac ticket #9093</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, 2/3)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_squarefree">
<code class="descname">is_squarefree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_squarefree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return False if this polynomial is not square-free, i.e., if there is a
non-unit <span class="math">\(g\)</span> in the polynomial ring such that <span class="math">\(g^2\)</span> divides <code class="docutils literal"><span class="pre">self</span></code>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This method is not consistent with
<a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.squarefree_decomposition" title="sage.rings.polynomial.polynomial_element.Polynomial.squarefree_decomposition"><code class="xref py py-meth docutils literal"><span class="pre">squarefree_decomposition()</span></code></a> since the latter does not factor
the content of a polynomial. See the examples below.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">17</span><span class="o">-</span><span class="mi">3</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^21 - 3*x^20 - 3*x^19 + 15*x^18 - 10*x^17 - 3*x^4 + 9*x^3 + 9*x^2 - 45*x + 30</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">f</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A generic implementation is available, which relies on gcd
computations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">S</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>In positive characteristic, we compute the square-free
decomposition or a full factorization, depending on which is
available:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FunctionField</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>In the following example, <span class="math">\(t^2\)</span> is a unit in the base field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This method is not consistent with <a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.squarefree_decomposition" title="sage.rings.polynomial.polynomial_element.Polynomial.squarefree_decomposition"><code class="xref py py-meth docutils literal"><span class="pre">squarefree_decomposition()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">squarefree_decomposition</span><span class="p">()</span>
<span class="go">(4) * x</span>
</pre></div>
</div>
<p>If you want this method equally not to consider the content, you can
remove it as in the following example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If the base ring is not an integral domain, the question is not
mathematically well-defined:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">IntegerModRing</span><span class="p">(</span><span class="mi">9</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">);</span> <span class="n">pol</span>
<span class="go">x^2</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">is_squarefree() is not defined for polynomials over Ring of integers modulo 9</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_term">
<code class="descname">is_term</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is an element of the base ring times a
power of the generator.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_term</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_term</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_term</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_term</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>To require that the coefficient is 1, use is_monomial() instead:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_unit">
<code class="descname">is_unit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this polynomial is a unit.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">90384098234</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">191</span><span class="o">*</span><span class="mi">236607587</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">is_nilpotent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">a</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_unit</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_unit</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>EXERCISE (Atiyah-McDonald, Ch 1): Let <span class="math">\(A[x]\)</span> be a
polynomial ring in one variable. Then
<span class="math">\(f=\sum a_i x^i \in A[x]\)</span> is a unit if and only if
<span class="math">\(a_0\)</span> is a unit and <span class="math">\(a_1,\ldots, a_n\)</span> are
nilpotent.</p>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/18600">trac ticket #18600</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">is_unit</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.is_zero">
<code class="descname">is_zero</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.is_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether this polynomial is zero.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.lcm">
<code class="descname">lcm</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.lcm" title="Permalink to this definition">¶</a></dt>
<dd><p>Let f and g be two polynomials. Then this function returns the
monic least common multiple of f and g.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.leading_coefficient">
<code class="descname">leading_coefficient</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.leading_coefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the leading coefficient of this polynomial.</p>
<p>OUTPUT: element of the base ring</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">leading_coefficient</span><span class="p">()</span>
<span class="go">-2/5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.list">
<code class="descname">list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new copy of the list of the underlying elements of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">list</span><span class="p">();</span> <span class="n">v</span>
<span class="go">[-1/3, 2, 0, -2/5]</span>
</pre></div>
</div>
<p>Note that v is a list, it is mutable, and each call to the list
method returns a new list:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">&lt;type &#39;list&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[-1/3, 2, 0, -2/5]</span>
</pre></div>
</div>
<p>Here is an example with a generic polynomial ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">;</span> <span class="n">f</span>
<span class="go">y^3 + x*y - 3*x</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.polynomial.polynomial_element.Polynomial_generic_dense&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">list</span><span class="p">();</span> <span class="n">v</span>
<span class="go">[-3*x, x, 0, 1]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[-3*x, x, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.map_coefficients">
<code class="descname">map_coefficients</code><span class="sig-paren">(</span><em>f</em>, <em>new_base_ring=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.map_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the polynomial obtained by applying <code class="docutils literal"><span class="pre">f</span></code> to the non-zero
coefficients of self.</p>
<p>If <code class="docutils literal"><span class="pre">f</span></code> is a <a class="reference external" href="../../../../categories/sage/categories/map.html#sage.categories.map.Map" title="(in Sage Reference Manual: Category Framework v7.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.categories.map.Map</span></code></a>, then the resulting
polynomial will be defined over the codomain of <code class="docutils literal"><span class="pre">f</span></code>. Otherwise, the
resulting polynomial will be over the same ring as self. Set
<code class="docutils literal"><span class="pre">new_base_ring</span></code> to override this behaviour.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">f</span></code> &#8211; a callable that will be applied to the coefficients of self.</li>
<li><code class="docutils literal"><span class="pre">new_base_ring</span></code> (optional) &#8211; if given, the resulting polynomial
will be defined over this ring.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">SR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">I</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>
<span class="go">(-I + 1)*x^2 + 3*x + I</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">42</span><span class="p">)</span>
<span class="go">43*x^2 + 44</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">32</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>
<span class="go">(-I + 1)*x^4294967296 + I</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">32</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">42</span><span class="p">)</span>
<span class="go">43*x^4294967296 + 44</span>
</pre></div>
</div>
<p>Examples with different base ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">residue</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">k</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="n">residue</span><span class="p">);</span> <span class="n">g</span>
<span class="go">x + 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">new_base_ring</span> <span class="o">=</span> <span class="n">k</span><span class="p">);</span> <span class="n">g</span>
<span class="go">x + 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Finite Field of size 2 (using NTL)</span>
<span class="gp">sage: </span><span class="n">residue</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">coerce_map_from</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="n">residue</span><span class="p">);</span> <span class="n">g</span>
<span class="go">x + 1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Finite Field of size 2 (using NTL)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.mod">
<code class="descname">mod</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Remainder of division of self by other.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">2*x - 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.monic">
<code class="descname">monic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.monic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return this polynomial divided by its leading coefficient. Does not
change this polynomial.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">56</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span>
<span class="go">x^5 + 1/56*x^3 + 1/28*x^2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span>
<span class="go">x^2 + 12*x + 4</span>
</pre></div>
</div>
<p>The following happens because <span class="math">\(f = 0\)</span> cannot be made into a
monic polynomial</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">rational division by zero</span>
</pre></div>
</div>
<p>Notice that the monic version of a polynomial over the integers is
defined over the rationals.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">19</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">37</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">monic</span><span class="p">();</span> <span class="n">g</span>
<span class="go">x^19 + 1/3*x^2 - 37/3</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Naqi Jaffery (2006-01-24): examples</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.newton_raphson">
<code class="descname">newton_raphson</code><span class="sig-paren">(</span><em>n</em>, <em>x0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.newton_raphson" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of n iterative approximations to a root of this
polynomial, computed using the Newton-Raphson method.</p>
<p>The Newton-Raphson method is an iterative root-finding algorithm.
For f(x) a polynomial, as is the case here, this is essentially the
same as Horner&#8217;s method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">n</span></code> - an integer (=the number of iterations),</li>
<li><code class="docutils literal"><span class="pre">x0</span></code> - an initial guess x0.</li>
</ul>
<p>OUTPUT: A list of numbers hopefully approximating a root of
f(x)=0.</p>
<p>If one of the iterates is a critical point of f then a
ZeroDivisionError exception is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RealField</span><span class="p">(),</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">newton_raphson</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[1.50000000000000, 1.41666666666667, 1.41421568627451, 1.41421356237469]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner and William Stein (2005-11-28)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.newton_slopes">
<code class="descname">newton_slopes</code><span class="sig-paren">(</span><em>p</em>, <em>lengths=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.newton_slopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(p\)</span>-adic slopes of the Newton polygon of self,
when this makes sense.</p>
<p>OUTPUT:</p>
<p>If <span class="math">\(lengths\)</span> is <span class="math">\(False\)</span>, a list of rational numbers. If <span class="math">\(lengths\)</span> is
<span class="math">\(True\)</span>, a list of couples <span class="math">\((s,l)\)</span> where <span class="math">\(s\)</span> is the slope and <span class="math">\(l\)</span> the
length of the corresponding segment in the Newton polygon.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">newton_slopes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[1/3, 1/3, 1/3]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">newton_slopes</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[1/2, 1/2, 1/3, 1/3, 1/3]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">newton_slopes</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">lengths</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(1/2, 2), (1/3, 3)]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">27</span><span class="p">)</span><span class="o">.</span><span class="n">newton_slopes</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lengths</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(3/1267650600228229401496703205376, 1267650600228229401496703205376)]</span>
</pre></div>
</div>
<p>ALGORITHM: Uses PARI if <span class="math">\(lengths\)</span> is <span class="math">\(False\)</span>.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.norm">
<code class="descname">norm</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(p\)</span>-norm of this polynomial.</p>
<p>DEFINITION: For integer <span class="math">\(p\)</span>, the <span class="math">\(p\)</span>-norm of a
polynomial is the <span class="math">\(p\)</span>th root of the sum of the
<span class="math">\(p\)</span>th powers of the absolute values of the coefficients of
the polynomial.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - (positive integer or +infinity) the degree
of the norm</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2.64575131106459</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="go">2.64575131106459</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">5.00000000000000</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">2.00000000000000</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The degree of the norm must be positive</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">2.00000000000000</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/18600">trac ticket #18600</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2.00000000000000</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Didier Deshommes</li>
<li>William Stein: fix bugs, add definition, etc.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.number_of_terms">
<code class="descname">number_of_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.number_of_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of non-zero coefficients of self. Also called weight,
hamming weight or sparsity.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">number_of_terms</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_terms</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">100</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">number_of_terms</span><span class="p">()</span>
<span class="go">101</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_terms</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">cyclotomic_polynomial</span><span class="p">(</span><span class="mi">105</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_terms</span><span class="p">()</span>
<span class="go">33</span>
</pre></div>
</div>
<p>The method <a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.hamming_weight" title="sage.rings.polynomial.polynomial_element.Polynomial.hamming_weight"><code class="xref py py-meth docutils literal"><span class="pre">hamming_weight()</span></code></a> is an alias:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">hamming_weight</span><span class="p">()</span>
<span class="go">101</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.numerator">
<code class="descname">numerator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.numerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numerator of self computed as self * self.denominator()</p>
<p>Note that some subclases may implement its own numerator
function. For example, see
<a class="reference internal" href="polynomial_rational_flint.html#sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint" title="sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint</span></code></a></p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is not the numerator of the rational function
defined by self, which would always be self since self is a
polynomial.</p>
</div>
<p>EXAMPLES:</p>
<p>First we compute the numerator of a polynomial with
integer coefficients, which is of course self.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">x^3 + 17*x + 1</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Next we compute the numerator of a polynomial with rational
coefficients.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">19</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">;</span> <span class="n">f</span>
<span class="go">1/17*x^19 - 2/3*x + 1/3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">3*x^19 - 34*x + 17</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>We try to compute the denominator of a polynomial with
coefficients in the real numbers, which is a ring whose elements do
not have a denominator method.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">RR</span><span class="p">(</span><span class="s1">&#39;0.3&#39;</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x + 0.300000000000000</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">x + 0.300000000000000</span>
</pre></div>
</div>
<p>We check that the computation the numerator and denominator
are valid</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">symbolic_expression</span><span class="p">(</span><span class="s1">&#39;x^3+2&#39;</span><span class="p">),</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="s1">&#39;s,t&#39;</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="o">/</span> <span class="n">f</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">=</span><span class="n">RR</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">R</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="o">/</span> <span class="n">f</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.ord">
<code class="descname">ord</code><span class="sig-paren">(</span><em>p=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.ord" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the same as the valuation of self at p. See the
documentation for <code class="docutils literal"><span class="pre">self.valuation</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">ord</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.padded_list">
<code class="descname">padded_list</code><span class="sig-paren">(</span><em>n=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.padded_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of coefficients of self up to (but not including)
<span class="math">\(q^n\)</span>.</p>
<p>Includes 0&#8217;s in the list on the right so that the list has length
<span class="math">\(n\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">n</span></code> - (default: None); if given, an integer that
is at least 0</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">23</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">padded_list</span><span class="p">()</span>
<span class="go">[1, 0, 0, 1, 0, 23]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">padded_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[1, 0, 0, 1, 0, 23, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">padded_list</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">padded_list</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[1, 0, 0]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">padded_list</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">padded_list</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">n must be at least 0</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/18600">trac ticket #18600</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">padded_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[-1, 0, 0, 0, 0, 0, 0, 0, 1, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>xmin=None</em>, <em>xmax=None</em>, <em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a plot of this polynomial.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">xmin</span></code> - float</li>
<li><code class="docutils literal"><span class="pre">xmax</span></code> - float</li>
<li><code class="docutils literal"><span class="pre">*args,</span> <span class="pre">**kwds</span></code> - passed to either plot or
point</li>
</ul>
<p>OUTPUT: returns a graphic object.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">389</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.polynomial">
<code class="descname">polynomial</code><span class="sig-paren">(</span><em>var</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Let var be one of the variables of the parent of self. This returns
self viewed as a univariate polynomial in var over the polynomial
ring generated by all the other variables of the parent.</p>
<p>For univariate polynomials, if var is the generator of the parent
ring, we return this polynomial, otherwise raise an error.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">polynomial</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">x + 1</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">polynomial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">given variable is not the generator of parent.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.prec">
<code class="descname">prec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.prec" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the precision of this polynomial. This is always infinity,
since polynomials are of infinite precision by definition (there is
no big-oh).</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">prec</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">prec</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.pseudo_quo_rem">
<code class="descname">pseudo_quo_rem</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.pseudo_quo_rem" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the pseudo-division of two polynomials.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; a nonzero polynomial</li>
</ul>
<p>OUTPUT:</p>
<p><span class="math">\(Q\)</span> and <span class="math">\(R\)</span> such that <span class="math">\(l^{m-n+1} \mathrm{self} = Q \cdot\mathrm{other} + R\)</span>
where <span class="math">\(m\)</span> is the degree of this polynomial, <span class="math">\(n\)</span> is the degree of
<code class="docutils literal"><span class="pre">other</span></code>, <span class="math">\(l\)</span> is the leading coefficient of <code class="docutils literal"><span class="pre">other</span></code>. The result is
such that <span class="math">\(\deg(R) &lt; \deg(\mathrm{other})\)</span>.</p>
<p>ALGORITHM:</p>
<p>Algorithm 3.1.2 in <a class="reference internal" href="#gtm138" id="id3">[GTM138]</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">quo</span><span class="p">,</span><span class="n">rem</span><span class="p">)</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">pseudo_quo_rem</span><span class="p">(</span><span class="n">q</span><span class="p">);</span> <span class="n">quo</span><span class="p">,</span><span class="n">rem</span>
<span class="go">(4*x^2 + 30*x + 51, 175*x + 67)</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">p</span> <span class="o">==</span> <span class="n">quo</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="n">rem</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">T</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">T</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">T</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">quo</span><span class="p">,</span><span class="n">rem</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">pseudo_quo_rem</span><span class="p">(</span><span class="n">q</span><span class="p">);</span> <span class="n">quo</span><span class="p">,</span><span class="n">rem</span>
<span class="go">((3*x^4 + 13*x^3 + 19*x^2 + 5*x)*T + 18*x^4 + 12*x^3 + 16*x^2 + 16*x,</span>
<span class="go"> (-113*x^6 - 106*x^5 - 133*x^4 - 101*x^3 - 42*x^2 - 41*x)*T - 34*x^6 + 13*x^5 + 54*x^4 + 126*x^3 + 134*x^2 - 5*x - 50)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span> <span class="o">==</span> <span class="n">quo</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="n">rem</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="gtm138" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[GTM138]</a></td><td>Henri Cohen. A Course in Computational Number Theory.
Graduate Texts in Mathematics, vol. 138. Springer, 1993.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.radical">
<code class="descname">radical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.radical" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the radical of self; over a field, this is the product of
the distinct irreducible factors of self. (This is also sometimes
called the &#8220;square-free part&#8221; of self, but that term is ambiguous;
it is sometimes used to mean the quotient of self by its maximal
square factor.)</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">3*x^3 - 4*x^2 + 4*x - 1</span>
<span class="gp">sage: </span><span class="n">radical</span><span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="go">6*x</span>
</pre></div>
</div>
<p>If self has a factor of multiplicity divisible by the characteristic (see <a class="reference external" href="http://trac.sagemath.org/8736">trac ticket #8736</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">x^2 + x</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.real_roots">
<code class="descname">real_roots</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.real_roots" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the real roots of this polynomial, without multiplicities.</p>
<p>Calls self.roots(ring=RR), unless this is a polynomial with
floating-point real coefficients, in which case it calls
self.roots().</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">real_roots</span><span class="p">()</span>
<span class="go">[-0.618033988749895, 1.61803398874989]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">real_roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">    Real Field with 100 bits of precision</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">RDF</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">real_roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Real Double Field</span>

<span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">);</span> <span class="n">v</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">real_roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">RR</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.resultant">
<code class="descname">resultant</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.resultant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the resultant of <code class="docutils literal"><span class="pre">self</span></code> and <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; a polynomial</li>
</ul>
<p>OUTPUT: an element of the base ring of the polynomial ring</p>
<p>ALGORITHM:</p>
<p>Uses PARI&#8217;s <code class="docutils literal"><span class="pre">polresultant</span></code> function.  For base rings that
are not supported by PARI, the resultant is computed as the
determinant of the Sylvester matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>  <span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">g</span><span class="p">);</span> <span class="n">r</span>
<span class="go">-8</span>
<span class="gp">sage: </span><span class="n">r</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QQ</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can compute resultants over univariate and multivariate
polynomial rings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">a</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">g</span><span class="p">);</span> <span class="n">r</span>
<span class="go">a^3 + a^2</span>
<span class="gp">sage: </span><span class="n">r</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">R</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">g</span><span class="p">);</span> <span class="n">r</span>
<span class="go">a^3 + b^2</span>
<span class="gp">sage: </span><span class="n">r</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">R</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">a</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">g</span><span class="p">);</span> <span class="n">h</span>
<span class="go">y^3 - x^2</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">R</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/13672">trac ticket #13672</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">t^4 + t</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/15061">trac ticket #15061</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">R</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">RP</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">F</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">derivative</span><span class="p">())</span>
<span class="go">-4 - 4*T + O(T^2)</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/16360">trac ticket #16360</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FunctionField</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">x</span><span class="p">)</span>
<span class="go">x</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FunctionField</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">L</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">a</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">b</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/17817">trac ticket #17817</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Frac</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;a,b,c&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;d,e,f&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">d</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">16*c^4*x^6 + 48*c^4*e*x^4 + (1/b^6*d^6 + 3/(a*b^4)*d^4 + ((-12*a^3*b*c + 3)/(a^2*b^2))*d^2 + (-12*a^3*b*c + 1)/a^3)*x^3 + 48*c^4*e^2*x^2 + (((-12*a*c)/b)*d^2*e + (-12*b*c)*e)*x + 16*c^4*e^3 + 4*a^3*b^3/c</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.reverse">
<code class="descname">reverse</code><span class="sig-paren">(</span><em>degree=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.reverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return polynomial but with the coefficients reversed.</p>
<p>If an optional degree argument is given the coefficient list will be
truncated or zero padded as necessary and the reverse polynomial will
have the specified degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[];</span> <span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">;</span> <span class="n">f</span>
<span class="go">y^3 + x*y - 3*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="go">-3*x*y^3 + x*y^2 + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">reverse</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-3*x*y^2 + x*y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">reverse</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-3*x*y^5 + x*y^4 + y^2</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">reverse</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mf">1.5</span><span class="n">r</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">degree argument must be a non-negative integer, got 1.5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.root_field">
<code class="descname">root_field</code><span class="sig-paren">(</span><em>names</em>, <em>check_irreducible=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.root_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the field generated by the roots of the irreducible
polynomial self. The output is either a number field, relative
number field, a quotient of a polynomial ring over a field, or the
fraction field of the base ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">17</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">root_field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Number Field in a with defining polynomial x^3 + x + 17</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">root_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">17</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">root_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Number Field in b with defining polynomial x^3 + x + 17</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">17</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">root_field</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="go">Number Field in c with defining polynomial x^3 + x + 17 over its base field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">8</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">root_field</span><span class="p">();</span> <span class="n">K</span>
<span class="go">Univariate Quotient Polynomial Ring in alpha over Finite Field in a of size 3^2 with modulus x^3 + x^2 + 2</span>
<span class="gp">sage: </span><span class="n">alpha</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">alpha^2 + 1</span>
<span class="gp">sage: </span><span class="n">alpha</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">^</span><span class="mi">2</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">root_field</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">polynomial must be irreducible</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="mi">0</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">root_field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Ring of integers modulo 31</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.roots">
<code class="descname">roots</code><span class="sig-paren">(</span><em>ring=None</em>, <em>multiplicities=True</em>, <em>algorithm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.roots" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the roots of this polynomial (by default, in the base ring
of this polynomial).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ring</span></code> - the ring to find roots in</li>
<li><code class="docutils literal"><span class="pre">multiplicities</span></code> - bool (default: True) if True
return list of pairs (r, n), where r is the root and n is the
multiplicity. If False, just return the unique roots, with no
information about multiplicities.</li>
<li><code class="docutils literal"><span class="pre">algorithm</span></code> - the root-finding algorithm to use.
We attempt to select a reasonable algorithm by default, but this
lets the caller override our choice.</li>
</ul>
<p>By default, this finds all the roots that lie in the base ring of
the polynomial. However, the ring parameter can be used to specify
a ring to look for roots in.</p>
<p>If the polynomial and the output ring are both exact (integers,
rationals, finite fields, etc.), then the output should always be
correct (or raise an exception, if that case is not yet handled).</p>
<p>If the output ring is approximate (floating-point real or complex
numbers), then the answer will be estimated numerically, using
floating-point arithmetic of at least the precision of the output
ring. If the polynomial is ill-conditioned, meaning that a small
change in the coefficients of the polynomial will lead to a
relatively large change in the location of the roots, this may give
poor results. Distinct roots may be returned as multiple roots,
multiple roots may be returned as distinct roots, real roots may be
lost entirely (because the numerical estimate thinks they are
complex roots). Note that polynomials with multiple roots are
always ill-conditioned; there&#8217;s a footnote at the end of the
docstring about this.</p>
<p>If the output ring is a RealIntervalField or ComplexIntervalField
of a given precision, then the answer will always be correct (or an
exception will be raised, if a case is not implemented). Each root
will be contained in one of the returned intervals, and the
intervals will be disjoint. (The returned intervals may be of
higher precision than the specified output ring.)</p>
<p>At the end of this docstring (after the examples) is a description
of all the cases implemented in this function, and the algorithms
used. That section also describes the possibilities for
&#8220;algorithm=&#8221;, for the cases where multiple algorithms exist.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(1, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">CC</span><span class="p">)</span>   <span class="c1"># note -- low order bits slightly different on ppc.</span>
<span class="go">[(1.00000000000000, 1), (-0.500000000000000 - 0.86602540378443...*I, 1), (-0.500000000000000 + 0.86602540378443...*I, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(1, 2)]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mi">19</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">884736</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(884736/19, 1)]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">f</span><span class="o">^</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(884736/19, 20)]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">defining_polynomial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">[(4, 1), (2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(4, 1), (2, 1)]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[4, 2]</span>
</pre></div>
</div>
<p>A new ring.  In the example below, we add the special method
_roots_univariate_polynomial to the base ring, and observe
that this method is called instead to find roots of
polynomials over this ring.  This facility can be used to
easily extend root finding to work over new rings you
introduce:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">CDF</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">QQ</span><span class="o">.</span><span class="n">_roots_univariate_polynomial</span> <span class="o">=</span> <span class="n">g</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">[(2.7755575615628914e-17 - 1.0*I, 1), (0.9999999999999997*I, 1)]</span>
<span class="gp">sage: </span><span class="k">del</span> <span class="n">QQ</span><span class="o">.</span><span class="n">_roots_univariate_polynomial</span>
</pre></div>
</div>
<p>An example over RR, which illustrates that only the roots in RR are
returned:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(1.25992104989487, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 1.25992104989487) * (x^2 + 1.25992104989487*x + 1.58740105196820)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(1.2599210498948731647672106073, 1)]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">CC</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(1.25992104989487, 1), (-0.62996052494743... - 1.09112363597172*I, 1), (-0.62996052494743... + 1.09112363597172*I, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">[(1.25992104989487, 1), (-0.629960524947437 - 1.09112363597172*I, 1), (-0.629960524947437 + 1.09112363597172*I, 1)]</span>
</pre></div>
</div>
<p>Another example showing that only roots in the base ring are
returned:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(1, 1), (-1, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">[(3/2, 1), (1, 1), (-1, 1)]</span>
</pre></div>
</div>
<p>An example involving large numbers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">1e100</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(-1.00000000000000e50, 1), (1.00000000000000e50, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[-1.6772670339941..., 0.19995479628..., 0.20004530611..., 1.5763035161844...]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">CC</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="n">CC</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[1.00000000000000, 1.00000000000000*I]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">1.33</span><span class="o">+</span><span class="mf">1.33</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">2.66</span><span class="o">-</span><span class="mf">2.66</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[1.33000000000000 - 1.33000000000000*I, 2.66000000000000 + 2.66000000000000*I]</span>
</pre></div>
</div>
<p>Describing roots using radical expressions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">SR</span><span class="p">)</span>
<span class="go">[(-I*sqrt(2), 1), (I*sqrt(2), 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span> <span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[-I*sqrt(2), I*sqrt(2)]</span>
</pre></div>
</div>
<p>The roots of some polynomials can&#8217;t be described using radical
expressions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">SR</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>For some other polynomials, no roots can be found at the moment
due to the way roots are computed. <a class="reference external" href="http://trac.sagemath.org/17516">trac ticket #17516</a> addresses
these defecits. Until that gets implemented, one such example
is the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">300</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">30361</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1061610</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1141893</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">915320</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">101724</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>A purely symbolic roots example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">expand</span><span class="p">((</span><span class="n">X</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)));</span> <span class="n">f</span>
<span class="go">X^6 - (3*I + 1)*X^5 - sqrt(2)*X^4 + (3*I - 3)*X^4 + (3*I + 1)*sqrt(2)*X^3 + (I + 3)*X^3 - (3*I - 3)*sqrt(2)*X^2 - I*X^2 - (I + 3)*sqrt(2)*X + I*sqrt(2)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(I, 3), (-2^(1/4), 1), (2^(1/4), 1), (1, 1)]</span>
</pre></div>
</div>
<p>The same operation, performed over a polynomial ring
with symbolic coefficients:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">SR</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span> <span class="n">f</span>
<span class="go">X^6 + (-3*I - 1)*X^5 + (-sqrt(2) + 3*I - 3)*X^4 + ((3*I + 1)*sqrt(2) + I + 3)*X^3 + (-(3*I - 3)*sqrt(2) - I)*X^2 + (-(I + 3)*sqrt(2))*X + I*sqrt(2)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(I, 3), (-2^(1/4), 1), (2^(1/4), 1), (1, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[I, -2^(1/4), 2^(1/4), 1]</span>
</pre></div>
</div>
<p>A couple of examples where the base ring doesn&#8217;t have a
factorization algorithm (yet). Note that this is currently done via
naive enumeration, so could be very slow:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">root finding with multiplicities for this polynomial not implemented (try the multiplicities=False option)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[1, 5]</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">9</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[0, 1, 3, 6]</span>
</pre></div>
</div>
<p>An example over the complex double field (where root finding is
fast, thanks to NumPy):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CDF</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">cyclotomic_polynomial</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^4 + x^3 + x^2 + x + 1.0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># abs tol 1e-9</span>
<span class="go">[-0.8090169943749469 - 0.5877852522924724*I, -0.8090169943749473 + 0.5877852522924724*I, 0.30901699437494773 - 0.951056516295154*I, 0.30901699437494756 + 0.9510565162951525*I]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">z</span><span class="o">^</span><span class="mi">5</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">[0.9999999999999957 - 1.2864981197413038e-15*I, 0.9999999999999976 + 3.062854959141552e-15*I, 1.0000000000000024 + 1.1331077795295987e-15*I, 0.9999999999999953 - 2.0212861992297117e-15*I]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">f</span>
<span class="go">4.0*x^3 + 3.0*x^2 + 2.0*x + 1.0</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">r</span><span class="p">]</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">[2.574630599127759e-15, 1.457101633618084e-15, 1.1443916996305594e-15]</span>
</pre></div>
</div>
<p>Another example over RDF:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>  <span class="c1"># abs tol 4e-16</span>
<span class="go">[(1.0000000000000002, 1)]</span>
<span class="gp">sage: </span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># abs tol 4e-16</span>
<span class="go">[1.0000000000000002]</span>
</pre></div>
</div>
<p>More examples involving the complex double field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="n">CDF</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">;</span> <span class="n">f</span>
<span class="go">x^3 + 2.0*I</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">[(-1.0911236359717227 - 0.6299605249474374*I, 1), (3.885780586188048e-16 + 1.2599210498948734*I, 1), (1.0911236359717211 - 0.6299605249474363*I, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">[-1.0911236359717227 - 0.6299605249474374*I, 3.885780586188048e-16 + 1.2599210498948734*I, 1.0911236359717211 - 0.6299605249474363*I]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">[8.95090418262362e-16, 8.728374398092689e-16, 1.0235750533041806e-15]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span> <span class="n">f</span>
<span class="go">I*x^3 + 2.0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">[(-1.0911236359717227 + 0.6299605249474374*I, 1), (3.885780586188048e-16 - 1.2599210498948734*I, 1), (1.0911236359717211 + 0.6299605249474363*I, 1)]</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># abs tol 1e-13</span>
<span class="go">1.1102230246251565e-16</span>
</pre></div>
</div>
<p>Examples using real root isolation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RIF</span><span class="p">)</span>
<span class="go">[(-0.6180339887498948482045868343657?, 1), (1.6180339887498948482045868343657?, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RIF</span><span class="p">,</span> <span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[-0.6180339887498948482045868343657?, 1.6180339887498948482045868343657?]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RealIntervalField</span><span class="p">(</span><span class="mi">150</span><span class="p">))</span>
<span class="go">[(-0.6180339887498948482045868343656381177203091798057628621354486227?, 1), (1.618033988749894848204586834365638117720309179805762862135448623?, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">AA</span><span class="p">)</span>
<span class="go">[(-0.618033988749895?, 1), (1.618033988749895?, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RIF</span><span class="p">)</span>
<span class="go">[(-0.6180339887498948482045868343657?, 2), (1.0000000000000000000000000000000?, 1), (1.6180339887498948482045868343657?, 2)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RIF</span><span class="p">,</span> <span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[-0.6180339887498948482045868343657?, 1.0000000000000000000000000000000?, 1.6180339887498948482045868343657?]</span>
</pre></div>
</div>
<p>Examples using complex root isolation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">CIF</span><span class="p">)</span>
<span class="go">[(1.167303978261419?, 1), (-0.764884433600585? - 0.352471546031727?*I, 1), (-0.764884433600585? + 0.352471546031727?*I, 1), (0.181232444469876? - 1.083954101317711?*I, 1), (0.181232444469876? + 1.083954101317711?*I, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">ComplexIntervalField</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
<span class="go">[(1.167303978261418684256045899854842180720560371525489039140082?, 1), (-0.76488443360058472602982318770854173032899665194736756700778? - 0.35247154603172624931794709140258105439420648082424733283770?*I, 1), (-0.76488443360058472602982318770854173032899665194736756700778? + 0.35247154603172624931794709140258105439420648082424733283770?*I, 1), (0.18123244446987538390180023778112063996871646618462304743774? - 1.08395410131771066843034449298076657427364024315511565430114?*I, 1), (0.18123244446987538390180023778112063996871646618462304743774? + 1.08395410131771066843034449298076657427364024315511565430114?*I, 1)]</span>
<span class="gp">sage: </span><span class="n">rts</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">QQbar</span><span class="p">);</span> <span class="n">rts</span>
<span class="go">[(1.167303978261419?, 1), (-0.7648844336005847? - 0.3524715460317263?*I, 1), (-0.7648844336005847? + 0.3524715460317263?*I, 1), (0.1812324444698754? - 1.083954101317711?*I, 1), (0.1812324444698754? + 1.083954101317711?*I, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">AA</span><span class="p">)</span>
<span class="go">[(1.167303978261419?, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">rts</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">QQbar</span><span class="p">)</span>
<span class="go">[(-0.1666666666666667? - 0.552770798392567?*I, 1), (-0.1666666666666667? + 0.552770798392567?*I, 1), (0.1812324444698754? + 1.083954101317711?*I, 2)]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">CIF</span><span class="p">)</span>
<span class="go">[(-0.1666666666666667? - 0.552770798392567?*I, 1), (-0.1666666666666667? + 0.552770798392567?*I, 1), (0.1812324444698754? + 1.083954101317711?*I, 2)]</span>
</pre></div>
</div>
<p>Note that coefficients in a number field with defining polynomial
<span class="math">\(x^2 + 1\)</span> are considered to be Gaussian rationals (with the
generator mapping to +I), if you ask for complex roots.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">im</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">im</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">CC</span><span class="p">)</span>
<span class="go">[(-1.2146389322441... - 0.14142505258239...*I, 1), (-0.14142505258239... + 1.2146389322441...*I, 1), (0.14142505258239... - 1.2146389322441...*I, 1), (1.2146389322441... + 0.14142505258239...*I, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">CIF</span><span class="p">)</span>
<span class="go">[(-1.414213562373095?, 1), (1.414213562373095?, 1), (-1.214638932244183? - 0.141425052582394?*I, 2), (-0.141425052582394? + 1.214638932244183?*I, 2), (0.141425052582394? - 1.214638932244183?*I, 2), (1.214638932244183? + 0.141425052582394?*I, 2)]</span>
</pre></div>
</div>
<p>Note that one should not use NumPy when wanting high precision
output as it does not support any of the high precision types:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="mi">200</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">R</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(-1.7724538509055160272981674833411451827975494561223871282138, 1), (1.7724538509055160272981674833411451827975494561223871282138, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
<span class="go">doctest... UserWarning: NumPy does not support arbitrary precision arithmetic.  The roots found will likely have less precision than you expect.</span>
<span class="go">[(-1.77245385090551..., 1), (1.77245385090551..., 1)]</span>
</pre></div>
</div>
<p>We can also find roots over number fields:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(z^5, 1), (-z^5 - 1, 1)]</span>
</pre></div>
</div>
<p>There are many combinations of floating-point input and output
types that work. (Note that some of them are quite pointless like using
<code class="docutils literal"><span class="pre">algorithm='numpy'</span></code> with high-precision types.)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rflds</span> <span class="o">=</span> <span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="n">RDF</span><span class="p">,</span> <span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">cflds</span> <span class="o">=</span> <span class="p">(</span><span class="n">CC</span><span class="p">,</span> <span class="n">CDF</span><span class="p">,</span> <span class="n">ComplexField</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">cross</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="go">....:     return list(cartesian_product_iterator([a, b]))</span>
<span class="gp">sage: </span><span class="n">flds</span> <span class="o">=</span> <span class="n">cross</span><span class="p">(</span><span class="n">rflds</span><span class="p">,</span> <span class="n">rflds</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross</span><span class="p">(</span><span class="n">rflds</span><span class="p">,</span> <span class="n">cflds</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross</span><span class="p">(</span><span class="n">cflds</span><span class="p">,</span> <span class="n">cflds</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="p">(</span><span class="n">fld_in</span><span class="p">,</span> <span class="n">fld_out</span><span class="p">)</span> <span class="ow">in</span> <span class="n">flds</span><span class="p">:</span>
<span class="go">....:     x = polygen(fld_in)</span>
<span class="go">....:     f = x^3 - fld_in(2)</span>
<span class="go">....:     x2 = polygen(fld_out)</span>
<span class="go">....:     f2 = x2^3 - fld_out(2)</span>
<span class="go">....:     for algo in (None, &#39;pari&#39;, &#39;numpy&#39;):</span>
<span class="go">....:         rts = f.roots(ring=fld_out, multiplicities=False)</span>
<span class="go">....:         if fld_in == fld_out and algo is None:</span>
<span class="go">....:             print fld_in, rts</span>
<span class="go">....:         for rt in rts:</span>
<span class="go">....:             assert(abs(f2(rt)) &lt;= 1e-10)</span>
<span class="go">....:             assert(rt.parent() == fld_out)</span>
<span class="go">Real Field with 53 bits of precision [1.25992104989487]</span>
<span class="go">Real Double Field [1.25992104989...]</span>
<span class="go">Real Field with 100 bits of precision [1.2599210498948731647672106073]</span>
<span class="go">Complex Field with 53 bits of precision [1.25992104989487, -0.62996052494743... - 1.09112363597172*I, -0.62996052494743... + 1.09112363597172*I]</span>
<span class="go">Complex Double Field [1.25992104989..., -0.629960524947... - 1.0911236359717...*I, -0.629960524947... + 1.0911236359717...*I]</span>
<span class="go">Complex Field with 100 bits of precision [1.2599210498948731647672106073, -0.62996052494743658238360530364 - 1.0911236359717214035600726142*I, -0.62996052494743658238360530364 + 1.0911236359717214035600726142*I]</span>
</pre></div>
</div>
<p>Note that we can find the roots of a polynomial with algebraic
coefficients:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rt2</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">AA</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">rt3</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">AA</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">AA</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">rt2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">rt3</span><span class="p">);</span> <span class="n">f</span>
<span class="go">    x^2 - 3.146264369941973?*x + 2.449489742783178?</span>
<span class="gp">sage: </span><span class="n">rts</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">();</span> <span class="n">rts</span>
<span class="go">[(1.414213562373095?, 1), (1.732050807568878?, 1)]</span>
<span class="gp">sage: </span><span class="n">rts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">rt2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RealIntervalField</span><span class="p">(</span><span class="mi">150</span><span class="p">))</span>
<span class="go">[(1.414213562373095048801688724209698078569671875376948073176679738?, 1), (1.732050807568877293527446341505872366942805253810380628055806980?, 1)]</span>
</pre></div>
</div>
<p>We can handle polynomials with huge coefficients.</p>
<p>This number doesn&#8217;t even fit in an IEEE double-precision float, but
RR and CC allow a much larger range of floating-point numbers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">bigc</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">1500</span>
<span class="gp">sage: </span><span class="n">CDF</span><span class="p">(</span><span class="n">bigc</span><span class="p">)</span>
<span class="go">+infinity</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">bigc</span><span class="p">)</span>
<span class="go">3.50746621104340e451</span>
</pre></div>
</div>
<p>Polynomials using such large coefficients can&#8217;t be handled by
numpy, but pari can deal with them:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">bigc</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RR</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">LinAlgError</span>: <span class="n">Array must not contain infs or NaNs</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RR</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">[(-3.50746621104340e451, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">AA</span><span class="p">)</span>
<span class="go">[(-3.5074662110434039?e451, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">QQbar</span><span class="p">)</span>
<span class="go">[(-3.5074662110434039?e451, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">bigc</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RR</span><span class="p">)</span>
<span class="go">[(0.000000000000000, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">AA</span><span class="p">)</span>
<span class="go">[(-2.8510609648967059?e-452, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">QQbar</span><span class="p">)</span>
<span class="go">[(-2.8510609648967059?e-452, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">bigc</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">RR</span><span class="p">)</span>
<span class="go">[(-5.92238652153286e225, 1), (5.92238652153286e225, 1)]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">QQbar</span><span class="p">)</span>
<span class="go">[(-5.9223865215328558?e225, 1), (5.9223865215328558?e225, 1)]</span>
</pre></div>
</div>
<p>Algorithms used:</p>
<p>For brevity, we will use RR to mean any RealField of any precision;
similarly for RIF, CC, and CIF. Since Sage has no specific
implementation of Gaussian rationals (or of number fields with
embedding, at all), when we refer to Gaussian rationals below we
will accept any number field with defining polynomial
<span class="math">\(x^2+1\)</span>, mapping the field generator to +I.</p>
<p>We call the base ring of the polynomial K, and the ring given by
the ring= argument L. (If ring= is not specified, then L is the
same as K.)</p>
<p>If K and L are floating-point (RDF, CDF, RR, or CC), then a
floating-point root-finder is used. If L is RDF or CDF then we
default to using NumPy&#8217;s roots(); otherwise, we use PARI&#8217;s
polroots(). This choice can be overridden with
algorithm=&#8217;pari&#8217; or algorithm=&#8217;numpy&#8217;. If the algorithm is
unspecified and NumPy&#8217;s roots() algorithm fails, then we fall
back to pari (numpy will fail if some coefficient is infinite,
for instance).</p>
<p>If L is SR, then the roots will be radical expressions,
computed as the solutions of a symbolic polynomial expression.
At the moment this delegates to
<a class="reference external" href="../../../../calculus/sage/symbolic/expression.html#sage.symbolic.expression.Expression.solve" title="(in Sage Reference Manual: Symbolic Calculus v7.2)"><code class="xref py py-meth docutils literal"><span class="pre">sage.symbolic.expression.Expression.solve()</span></code></a>
which in turn uses Maxima to find radical solutions.
Some solutions may be lost in this approach.
Once <a class="reference external" href="http://trac.sagemath.org/17516">trac ticket #17516</a> gets implemented, all possible radical
solutions should become available.</p>
<p>If L is AA or RIF, and K is ZZ, QQ, or AA, then the root isolation
algorithm sage.rings.polynomial.real_roots.real_roots() is used.
(You can call real_roots() directly to get more control than this
method gives.)</p>
<p>If L is QQbar or CIF, and K is ZZ, QQ, AA, QQbar, or the Gaussian
rationals, then the root isolation algorithm
sage.rings.polynomial.complex_roots.complex_roots() is used. (You
can call complex_roots() directly to get more control than this
method gives.)</p>
<p>If L is AA and K is QQbar or the Gaussian rationals, then
complex_roots() is used (as above) to find roots in QQbar, then
these roots are filtered to select only the real roots.</p>
<p>If L is floating-point and K is not, then we attempt to change the
polynomial ring to L (using .change_ring()) (or, if L is complex
and K is not, to the corresponding real field). Then we use either
PARI or numpy as specified above.</p>
<p>For all other cases where K is different than L, we just use
.change_ring(L) and proceed as below.</p>
<p>The next method, which is used if K is an integral domain, is to
attempt to factor the polynomial. If this succeeds, then for every
degree-one factor a*x+b, we add -b/a as a root (as long as this
quotient is actually in the desired ring).</p>
<p>If factoring over K is not implemented (or K is not an integral
domain), and K is finite, then we find the roots by enumerating all
elements of K and checking whether the polynomial evaluates to zero
at that value.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>We mentioned above that polynomials with multiple roots are
always ill-conditioned; if your input is given to n bits of
precision, you should not expect more than n/k good bits
for a k-fold root. (You can get solutions that make the
polynomial evaluate to a number very close to zero;
basically the problem is that with a multiple root, there
are many such numbers, and it&#8217;s difficult to choose between
them.)</p>
<p class="last">To see why this is true, consider the naive floating-point
error analysis model where you just pretend that all
floating-point numbers are somewhat imprecise - a little
&#8216;fuzzy&#8217;, if you will.  Then the graph of a floating-point
polynomial will be a fuzzy line.  Consider the graph of
<span class="math">\((x-1)^3\)</span>; this will be a fuzzy line with a
horizontal tangent at <span class="math">\(x=1\)</span>, <span class="math">\(y=0\)</span>. If the
fuzziness extends up and down by about j, then it will
extend left and right by about cube_root(j).</p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">zeta</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(x - 1) * (x^2 + x + 1)</span>
</pre></div>
</div>
<p>This shows that the issue from <a class="reference external" href="http://trac.sagemath.org/6237">trac ticket #6237</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="mi">27</span><span class="o">*</span><span class="n">u</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="mi">32</span><span class="o">*</span><span class="n">u</span><span class="o">^</span><span class="mi">9</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">CDF</span><span class="p">,</span> <span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># abs tol 2e-15</span>
<span class="go">[-1.0345637159435719, 0.0, -0.3196977699902601 - 0.9839285635706636*I, -0.3196977699902601 + 0.9839285635706636*I, 0.8369796279620465 - 0.6081012947885318*I, 0.8369796279620465 + 0.6081012947885318*I]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">CDF</span><span class="p">)</span>  <span class="c1"># abs tol 2e-15</span>
<span class="go">[(-1.0345637159435719, 1), (0.0, 9), (-0.3196977699902601 - 0.9839285635706636*I, 1), (-0.3196977699902601 + 0.9839285635706636*I, 1), (0.8369796279620465 - 0.6081012947885318*I, 1), (0.8369796279620465 + 0.6081012947885318*I, 1)]</span>
</pre></div>
</div>
<p>This shows that the issue at <a class="reference external" href="http://trac.sagemath.org/2418">trac ticket #2418</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">50</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">106</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">rts</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eps</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>   <span class="c1"># we test the roots numerically</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">rt</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">eps</span> <span class="k">for</span> <span class="n">rt</span> <span class="ow">in</span> <span class="n">rts</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span><span class="o">*</span><span class="mi">50</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This shows that the issue at <a class="reference external" href="http://trac.sagemath.org/10901">trac ticket #10901</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">SR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">a</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot evaluate symbolic expression to a numeric value.</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot evaluate symbolic expression to a numeric value.</span>
</pre></div>
</div>
<p>We can find roots of polynomials defined over <span class="math">\(\ZZ\)</span> or <span class="math">\(\QQ\)</span>
over the <span class="math">\(p\)</span>-adics, see <a class="reference external" href="http://trac.sagemath.org/15422">trac ticket #15422</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="go">[(1 + O(3^5), 2)]</span>
</pre></div>
</div>
<p>This doesn&#8217;t work if we first change coefficients to <span class="math">\(\QQ_p\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pol</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PrecisionError</span>: <span class="n">p-adic factorization not well-defined since the discriminant is zero up to the requestion p-adic precision</span>

<span class="gp">sage: </span><span class="p">(</span><span class="n">pol</span> <span class="o">-</span> <span class="mi">3</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="go">[(1 + 2*3^3 + 2*3^4 + O(3^5), 1), (1 + 3^3 + O(3^5), 1)]</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">pol</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span> <span class="n">r</span>
<span class="go">[1 + O(3^5)]</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">3-adic Ring with capped relative precision 5</span>
</pre></div>
</div>
<p>Spurious crash with pari-2.5.5, see <a class="reference external" href="http://trac.sagemath.org/16165">trac ticket #16165</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">CC</span><span class="p">)</span>
<span class="go">[(-0.500000000000000 - 0.866025403784439*I, 3),</span>
<span class="go"> (-0.500000000000000 + 0.866025403784439*I, 3)]</span>
</pre></div>
</div>
<p>Test a crash reported at <a class="reference external" href="http://trac.sagemath.org/19649">trac ticket #19649</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polRing</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">7</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">j</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="go">[(-1.00000000000000, 2),</span>
<span class="go"> (1.00000000000000, 7),</span>
<span class="go"> (0.500000000000000 - 0.866025403784439*I, 5),</span>
<span class="go"> (0.500000000000000 + 0.866025403784439*I, 5)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.shift">
<code class="descname">shift</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns this polynomial multiplied by the power <span class="math">\(x^n\)</span>. If
<span class="math">\(n\)</span> is negative, terms below <span class="math">\(x^n\)</span> will be
discarded. Does not change this polynomial (since polynomials are
immutable).</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go"> x^2 + 2*x + 4</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go"> x + 2</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go"> 0</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go"> x^4 + 2*x^3 + 4*x^2</span>
</pre></div>
</div>
<p>One can also use the infix shift operator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span>
<span class="go">x^5 + x^3</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-08-06)</li>
<li>Robert Bradshaw (2007-04-18): Added support for infix
operator.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.splitting_field">
<code class="descname">splitting_field</code><span class="sig-paren">(</span><em>names</em>, <em>map=False</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.splitting_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the absolute splitting field of a given polynomial.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">names</span></code> &#8211; a variable name for the splitting field.</li>
<li><code class="docutils literal"><span class="pre">map</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">False</span></code>) also return an embedding of
<code class="docutils literal"><span class="pre">self</span></code> into the resulting field.</li>
<li><code class="docutils literal"><span class="pre">kwds</span></code> &#8211; additional keywords depending on the type.
Currently, only number fields are implemented. See
<a class="reference external" href="../../../../number_fields/sage/rings/number_field/splitting_field.html#sage.rings.number_field.splitting_field.splitting_field" title="(in Sage Reference Manual: Algebraic Numbers and Number Fields v7.2)"><code class="xref py py-func docutils literal"><span class="pre">sage.rings.number_field.splitting_field.splitting_field()</span></code></a>
for the documentation of these keywords.</li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal"><span class="pre">map</span></code> is <code class="docutils literal"><span class="pre">False</span></code>, the splitting field as an absolute field.
If <code class="docutils literal"><span class="pre">map</span></code> is <code class="docutils literal"><span class="pre">True</span></code>, a tuple <code class="docutils literal"><span class="pre">(K,</span> <span class="pre">phi)</span></code> where <code class="docutils literal"><span class="pre">phi</span></code> is an
embedding of the base field of <code class="docutils literal"><span class="pre">self</span></code> in <code class="docutils literal"><span class="pre">K</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">();</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^6 + 3*x^5 + 6*x^4 + 11*x^3 + 12*x^2 - 3*x + 1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">();</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^3 - 3*x + 1</span>
</pre></div>
</div>
<p>Relative situation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Number Field in b with defining polynomial t^6 + 2</span>
</pre></div>
</div>
<p>With <code class="docutils literal"><span class="pre">map=True</span></code>, we also get the embedding of the base field
into the splitting field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 + 2</span>
<span class="go">  To:   Number Field in b with defining polynomial t^6 + 2</span>
<span class="go">  Defn: a |--&gt; b^2</span>
</pre></div>
</div>
<p>An example over a finite field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 7^2</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="nb">map</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(Finite Field in b of size 7^6,</span>
<span class="go"> Ring morphism:</span>
<span class="go">   From: Finite Field in a of size 7^3</span>
<span class="go">   To:   Finite Field in b of size 7^6</span>
<span class="go">   Defn: a |--&gt; 2*b^4 + 6*b^3 + 2*b^2 + 3*b + 2)</span>
</pre></div>
</div>
<p>If the extension is trivial and the generators have the same
name, the map will be the identity:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">24</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">14</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="nb">map</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(Finite Field in a of size 7^3,</span>
<span class="go"> Identity endomorphism of Finite Field in a of size 7^3)</span>

<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">56</span> <span class="o">-</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="nb">map</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(Finite Field in b of size 7^3,</span>
<span class="go"> Ring morphism:</span>
<span class="go"> From: Finite Field in a of size 7^3</span>
<span class="go">   To:   Finite Field in b of size 7^3</span>
<span class="go">   Defn: a |--&gt; b)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="../../../../number_fields/sage/rings/number_field/splitting_field.html#sage.rings.number_field.splitting_field.splitting_field" title="(in Sage Reference Manual: Algebraic Numbers and Number Fields v7.2)"><code class="xref py py-func docutils literal"><span class="pre">sage.rings.number_field.splitting_field.splitting_field()</span></code></a> for more examples over number fields</p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">IndexError</span>: <span class="n">the number of names must equal the number of generators</span>
<span class="gp">sage: </span><span class="n">polygen</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">splitting_field() is only implemented over number fields and finite fields</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 11^10</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">24</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">14</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 11^30</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">56</span> <span class="o">-</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 11^130</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 19^6</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">24</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">14</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 19^18</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">56</span> <span class="o">-</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 19^156</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">83</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 83^84</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">24</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">14</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 83^78</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">56</span> <span class="o">-</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 83^12</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">401</span><span class="o">^</span><span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 401^104</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">24</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">14</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 401^156</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">56</span> <span class="o">-</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Finite Field in b of size 401^52</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.square">
<code class="descname">square</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.square" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the square of this polynomial.</p>
<p>TODO:</p>
<ul class="simple">
<li>This is just a placeholder; for now it just uses ordinary
multiplication. But generally speaking, squaring is faster than
ordinary multiplication, and it&#8217;s frequently used, so subclasses
may choose to provide a specialised squaring routine.</li>
<li>Perhaps this even belongs at a lower level? RingElement or
something?</li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-09-09)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">square</span><span class="p">()</span>
<span class="go">x^6 + 2*x^3 + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">*</span><span class="n">f</span>
<span class="go">x^6 + 2*x^3 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.squarefree_decomposition">
<code class="descname">squarefree_decomposition</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.squarefree_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the square-free decomposition of this polynomial.  This is a
partial factorization into square-free, coprime polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">7</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">squarefree_decomposition</span><span class="p">()</span>
<span class="go">(37*x - 111/7) * (x^2 - 3*x + 2)^3 * (x - 1/3)^7</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">squarefree_decomposition</span><span class="p">()</span>
<span class="go">(37) * (x - 2/3)^2</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">squarefree_decomposition</span><span class="p">()</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">QQbar</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">](</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">squarefree_decomposition</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.subs">
<code class="descname">subs</code><span class="sig-paren">(</span><em>*x</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Identical to self(*x).</p>
<p>See the docstring for <code class="docutils literal"><span class="pre">self.__call__</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">127</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">127</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({})</span>
<span class="go">x^3 + x - 3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">keys do not match self&#39;s parent</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.substitute">
<code class="descname">substitute</code><span class="sig-paren">(</span><em>*x</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.substitute" title="Permalink to this definition">¶</a></dt>
<dd><p>Identical to self(*x).</p>
<p>See the docstring for <code class="docutils literal"><span class="pre">self.__call__</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">127</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">127</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({})</span>
<span class="go">x^3 + x - 3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">keys do not match self&#39;s parent</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.sylvester_matrix">
<code class="descname">sylvester_matrix</code><span class="sig-paren">(</span><em>right</em>, <em>variable=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.sylvester_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Sylvester matrix of self and right.</p>
<p>Note that the Sylvester matrix is not defined if one of the polynomials
is zero.</p>
<p>INPUT:</p>
<ul class="simple">
<li>right: a polynomial in the same ring as self.</li>
<li>variable: optional, included for compatibility with the multivariate
case only. The variable of the polynomials.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">47</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">38</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">47</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[  42  317  134 1786    0    0    0]</span>
<span class="go">[   0   42  317  134 1786    0    0]</span>
<span class="go">[   0    0   42  317  134 1786    0]</span>
<span class="go">[   0    0    0   42  317  134 1786]</span>
<span class="go">[  18  141   12  100   47    0    0]</span>
<span class="go">[   0   18  141   12  100   47    0]</span>
<span class="go">[   0    0   18  141   12  100   47]</span>
</pre></div>
</div>
<p>If the polynomials share a non-constant common factor then the
determinant of the Sylvester matrix will be zero:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>If self and right are polynomials of positive degree, the determinant
of the Sylvester matrix is the resultant of the polynomials.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">h1</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h2</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M1</span> <span class="o">=</span> <span class="n">h1</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M1</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span> <span class="o">==</span> <span class="n">h1</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The rank of the Sylvester matrix is related to the degree of the
gcd of self and right:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">+</span> <span class="n">g</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">-</span> <span class="n">M</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">h1</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">==</span> <span class="n">h1</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">+</span> <span class="n">h2</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">-</span> <span class="n">M1</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The variable is optional, but must be the same in both rings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">[1 1]</span>
<span class="go">[1 1]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">no common canonical parent for objects with parents: &#39;Univariate Polynomial Ring in x over Rational Field&#39; and &#39;Univariate Polynomial Ring in y over Rational Field&#39;</span>
</pre></div>
</div>
<p>Polynomials must be defined over compatible base rings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">[1 0 1 0]</span>
<span class="go">[0 1 0 1]</span>
<span class="go">[1 0 1 0]</span>
<span class="go">[0 1 0 1]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">[1 0 1 0]</span>
<span class="go">[0 1 0 1]</span>
<span class="go">[1 0 1 0]</span>
<span class="go">[0 1 0 1]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">no common canonical parent for objects with parents: &#39;Univariate Polynomial Ring in x over Rational Field&#39; and &#39;Univariate Polynomial Ring in x over Finite Field in a of size 5^2&#39;</span>
</pre></div>
</div>
<p>We can compute the sylvester matrix of a univariate and multivariate
polynomial:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x,y&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">==</span> <span class="n">K</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Corner cases:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The Sylvester matrix is not defined for zero polynomials</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The Sylvester matrix is not defined for zero polynomials</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The Sylvester matrix is not defined for zero polynomials</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[3 0]</span>
<span class="go">[0 3]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.truncate">
<code class="descname">truncate</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.truncate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the polynomial of degree ` &lt; n` which is equivalent
to self modulo <span class="math">\(x^n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[];</span> <span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">;</span> <span class="n">f</span>
<span class="go">y^3 + x*y - 3*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x*y - 3*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-3*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.valuation">
<code class="descname">valuation</code><span class="sig-paren">(</span><em>p=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>If <span class="math">\(f = a_r x^r + a_{r+1}x^{r+1} + \cdots\)</span>, with
<span class="math">\(a_r\)</span> nonzero, then the valuation of <span class="math">\(f\)</span> is
<span class="math">\(r\)</span>. The valuation of the zero polynomial is
<span class="math">\(\infty\)</span>.</p>
<p>If a prime (or non-prime) <span class="math">\(p\)</span> is given, then the valuation
is the largest power of <span class="math">\(p\)</span> which divides self.</p>
<p>The valuation at <span class="math">\(\infty\)</span> is -self.degree().</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.variable_name">
<code class="descname">variable_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.variable_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return name of variable used in this polynomial as a string.</p>
<p>OUTPUT: string</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">variable_name</span><span class="p">()</span>
<span class="go">&#39;t&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.variables">
<code class="descname">variables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the tuple of variables occurring in this polynomial.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">variables</span><span class="p">()</span>
<span class="go">(x,)</span>
</pre></div>
</div>
<p>A constant polynomial has no variables.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">variables</span><span class="p">()</span>
<span class="go">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial.xgcd">
<code class="descname">xgcd</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial.xgcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an extended gcd of this polynomial and <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; a polynomial in the same ring as this polynomial</li>
</ul>
<p>OUTPUT:</p>
<p>A tuple <code class="docutils literal"><span class="pre">(r,</span> <span class="pre">s,</span> <span class="pre">t)</span></code> where <code class="docutils literal"><span class="pre">r</span></code> is a greatest common divisor
of this polynomial and <code class="docutils literal"><span class="pre">other</span></code>, and <code class="docutils literal"><span class="pre">s</span></code> and <code class="docutils literal"><span class="pre">t</span></code> are such
that <code class="docutils literal"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">s*self</span> <span class="pre">+</span> <span class="pre">t*other</span></code> holds.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The actual algorithm for computing the extended gcd depends on the
base ring underlying the polynomial ring. If the base ring defines
a method <code class="docutils literal"><span class="pre">_xgcd_univariate_polynomial</span></code>, then this method will be
called (see examples below).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQbar</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">x</span>
</pre></div>
</div>
<p>One can easily add xgcd functionality to new rings by providing a
method <code class="docutils literal"><span class="pre">_xgcd_univariate_polynomial</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">h1</span> <span class="o">=</span> <span class="n">y</span><span class="o">*</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">h2</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">h1</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Univariate Polynomial Ring in x over Rational Field does not provide an xgcd implementation for univariate polynomials</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">poor_xgcd</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">):</span>
<span class="go">....:     ret = S(T(f).gcd(g))</span>
<span class="go">....:     if ret == f: return ret,S.one(),S.zero()</span>
<span class="go">....:     if ret == g: return ret,S.zero(),S.one()</span>
<span class="go">....:     raise NotImplementedError</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">_xgcd_univariate_polynomial</span> <span class="o">=</span> <span class="n">poor_xgcd</span>
<span class="gp">sage: </span><span class="n">h1</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span>
<span class="go">(x*y, 1, 0)</span>
<span class="gp">sage: </span><span class="k">del</span> <span class="n">R</span><span class="o">.</span><span class="n">_xgcd_univariate_polynomial</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.polynomial.polynomial_element.PolynomialBaseringInjection">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.polynomial_element.</code><code class="descname">PolynomialBaseringInjection</code><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.PolynomialBaseringInjection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Sage Reference Manual: Category Framework v7.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.categories.morphism.Morphism</span></code></a></p>
<p>This class is used for conversion from a ring to a polynomial
over that ring.</p>
<p>It calls the _new_constant_poly method on the generator,
which should be optimized for a particular polynomial type.</p>
<p>Technically, it should be a method of the polynomial ring, but
few polynomial rings are cython classes, and so, as a method
of a cython polynomial class, it is faster.</p>
<p>EXAMPLES:</p>
<p>We demonstrate that most polynomial ring classes use
polynomial base injection maps for coercion. They are
supposed to be the fastest maps for that purpose. See
<a class="reference external" href="http://trac.sagemath.org/9944">trac ticket #9944</a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">coerce_map_from</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">())</span>
<span class="go">Polynomial base injection morphism:</span>
<span class="go">  From: 3-adic Field with capped relative precision 20</span>
<span class="go">  To:   Univariate Polynomial Ring in x over 3-adic Field with capped relative precision 20</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">coerce_map_from</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">())</span>
<span class="go">Polynomial base injection morphism:</span>
<span class="go">  From: 3-adic Field with capped relative precision 20</span>
<span class="go">  To:   Multivariate Polynomial Ring in x, y over 3-adic Field with capped relative precision 20</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">coerce_map_from</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">())</span>
<span class="go">Polynomial base injection morphism:</span>
<span class="go">  From: Rational Field</span>
<span class="go">  To:   Multivariate Polynomial Ring in x, y over Rational Field</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">coerce_map_from</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">())</span>
<span class="go">Polynomial base injection morphism:</span>
<span class="go">  From: Rational Field</span>
<span class="go">  To:   Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<p>By <a class="reference external" href="http://trac.sagemath.org/9944">trac ticket #9944</a>, there are now only very few exceptions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[])</span><span class="o">.</span><span class="n">coerce_map_from</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Rational Field</span>
<span class="go">  To:   Multivariate Polynomial Ring in no variables over Rational Field</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.PolynomialBaseringInjection.section">
<code class="descname">section</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.PolynomialBaseringInjection.section" title="Permalink to this definition">¶</a></dt>
<dd><p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.polynomial.polynomial_element</span> <span class="kn">import</span> <span class="n">PolynomialBaseringInjection</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">PolynomialBaseringInjection</span><span class="p">(</span><span class="n">RDF</span><span class="p">,</span> <span class="n">RDF</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">section</span><span class="p">()</span>
<span class="go">Generic map:</span>
<span class="go">  From: Univariate Polynomial Ring in x over Real Double Field</span>
<span class="go">  To:   Real Double Field</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">section</span><span class="p">())</span>
<span class="go">&lt;type &#39;sage.rings.polynomial.polynomial_element.ConstantPolynomialSection&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.polynomial_element.</code><code class="descname">Polynomial_generic_dense</code><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial" title="sage.rings.polynomial.polynomial_element.Polynomial"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.polynomial.polynomial_element.Polynomial</span></code></a></p>
<p>A generic dense polynomial.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dumps</span><span class="p">())</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.polynomial.polynomial_element_generic</span> <span class="kn">import</span> <span class="n">Polynomial_generic_dense</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Polynomial_generic_dense</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">CC</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Polynomial_generic_dense</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.constant_coefficient">
<code class="descname">constant_coefficient</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.constant_coefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the constant coefficient of this polynomial.</p>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>element of base ring</dd>
<dt>EXAMPLES:</dt>
<dd>sage: R.&lt;t&gt; = QQ[]
sage: S.&lt;x&gt; = R[]
sage: f = x*t + x + t
sage: f.constant_coefficient()
t</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.degree">
<code class="descname">degree</code><span class="sig-paren">(</span><em>gen=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span><span class="p">)</span><span class="o">^</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">35</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/12552">trac ticket #12552</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.list">
<code class="descname">list</code><span class="sig-paren">(</span><em>copy=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new copy of the list of the underlying elements of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">;</span> <span class="n">f</span>
<span class="go">8*x^3 + 12*x^2 + 9*x + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[1, 9, 12, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.quo_rem">
<code class="descname">quo_rem</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.quo_rem" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the quotient and remainder of the Euclidean division of
<code class="docutils literal"><span class="pre">self</span></code> and <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>Raises ZerodivisionError if <code class="docutils literal"><span class="pre">other</span></code> is zero. Raises ArithmeticError if the division is not exact.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Kwankyu Lee (2013-06-02)</li>
<li>Bruno Grenet (2014-07-13)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">P</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">R</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">quo_rem</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">q</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="n">r</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">quo_rem</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Division non exact (consider coercing to polynomials over the fraction field)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">quo_rem</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">Division by zero polynomial</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The following shows that <a class="reference external" href="http://trac.sagemath.org/16649">trac ticket #16649</a> is indeed fixed.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">P</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">13</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">155</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">g</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">quo_rem</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">((-1/13*x^2 - x)*y^2 + (-x^2 + 3*x - 155/4)*y - x - 1, 0)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">17</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">6</span><span class="o">/</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">quo_rem</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">==</span> <span class="n">q</span><span class="o">*</span><span class="n">f</span> <span class="o">+</span> <span class="n">r</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.shift">
<code class="descname">shift</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns this polynomial multiplied by the power <span class="math">\(x^n\)</span>. If
<span class="math">\(n\)</span> is negative, terms below <span class="math">\(x^n\)</span> will be
discarded. Does not change this polynomial.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.polynomial.polynomial_element.Polynomial_generic_dense&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go"> x^2 + 2*x + 4</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go"> x + 2</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go"> x^4 + 2*x^3 + 4*x^2</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-08-06)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.truncate">
<code class="descname">truncate</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense.truncate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the polynomial of degree ` &lt; n` which is equivalent
to self modulo <span class="math">\(x^n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">q</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][</span><span class="s1">&#39;q&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">11</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span> <span class="n">f</span>
<span class="go">q^10 + 1</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span> <span class="n">f</span>
<span class="go">q^10 + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span> <span class="n">f</span>
<span class="go">q^100 + q^10 + 1</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Make sure we&#8217;re not actually testing a specialized
implementation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.polynomial.polynomial_element.Polynomial_generic_dense&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense_inexact">
<em class="property">class </em><code class="descclassname">sage.rings.polynomial.polynomial_element.</code><code class="descname">Polynomial_generic_dense_inexact</code><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense_inexact" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense" title="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.polynomial.polynomial_element.Polynomial_generic_dense</span></code></a></p>
<p>A dense polynomial over an inexact ring.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li>Xavier Caruso (2013-03)</li>
</ul>
<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense_inexact.degree">
<code class="descname">degree</code><span class="sig-paren">(</span><em>secure=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense_inexact.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>INPUT:</p>
<ul class="simple">
<li>secure  &#8211; a boolean (default: False)</li>
</ul>
<p>OUTPUT:</p>
<p>The degree of self.</p>
<p>If <code class="docutils literal"><span class="pre">secure</span></code> is True and the degree of this polynomial
is not determined (because the leading coefficient is
indistinguishable from 0), an error is raised</p>
<p>If <code class="docutils literal"><span class="pre">secure</span></code> is False, the returned value is the largest
<span class="math">\(n\)</span> so that the coefficient of <span class="math">\(x^n\)</span> does not compare equal
to <span class="math">\(0\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">T</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span> <span class="n">f</span>
<span class="go">(1 + O(3^10))*T + (2 + O(3^10))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">secure</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PrecisionError</span>: <span class="n">the leading coefficient is indistinguishable from 0</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">O</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">li</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="o">^</span><span class="n">i</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)];</span> <span class="n">li</span>
<span class="go">[O(3^5), O(3^6), O(3^7), O(3^8), O(3^9)]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="n">li</span><span class="p">);</span> <span class="n">f</span>
<span class="go">(O(3^9))*T^4 + (O(3^8))*T^3 + (O(3^7))*T^2 + (O(3^6))*T + (O(3^5))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">secure</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PrecisionError</span>: <span class="n">the leading coefficient is indistinguishable from 0</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Xavier Caruso (2013-03)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.polynomial.polynomial_element.Polynomial_generic_dense_inexact.prec_degree">
<code class="descname">prec_degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.Polynomial_generic_dense_inexact.prec_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the largest <span class="math">\(n\)</span> so that precision information is
stored about the coefficient of <span class="math">\(x^n\)</span>.</p>
<p>Always greater than or equal to degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">T</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span> <span class="n">f</span>
<span class="go">(1 + O(3^10))*T + (2 + O(3^10))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">prec_degree</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span> <span class="o">-</span> <span class="n">T</span><span class="p">;</span> <span class="n">g</span>
<span class="go">(O(3^10))*T + (2 + O(3^10))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">prec_degree</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Xavier Caruso (2013-03)</li>
</ul>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.rings.polynomial.polynomial_element.is_Polynomial">
<code class="descclassname">sage.rings.polynomial.polynomial_element.</code><code class="descname">is_Polynomial</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.is_Polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if f is of type univariate polynomial.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">f</span></code> - an object</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.polynomial.polynomial_element</span> <span class="kn">import</span> <span class="n">is_Polynomial</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">is_Polynomial</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">;</span> <span class="n">f</span>
<span class="go">y^3 + x*y - 3*x</span>
<span class="gp">sage: </span><span class="n">is_Polynomial</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>However this function does not return True for genuine multivariate
polynomial type objects or symbolic polynomials, since those are
not of the same data type as univariate polynomials:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">;</span> <span class="n">f</span>
<span class="go">y^3 + x*y - 3*x</span>
<span class="gp">sage: </span><span class="n">is_Polynomial</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="go">(x, y)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">;</span> <span class="n">f</span>
<span class="go">y^3 + x*y - 3*x</span>
<span class="gp">sage: </span><span class="n">is_Polynomial</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.polynomial.polynomial_element.make_generic_polynomial">
<code class="descclassname">sage.rings.polynomial.polynomial_element.</code><code class="descname">make_generic_polynomial</code><span class="sig-paren">(</span><em>parent</em>, <em>coeffs</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.make_generic_polynomial" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="sage.rings.polynomial.polynomial_element.universal_discriminant">
<code class="descclassname">sage.rings.polynomial.polynomial_element.</code><code class="descname">universal_discriminant</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.polynomial.polynomial_element.universal_discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the &#8216;universal&#8217; univariate polynomial
<span class="math">\(a_n x^n + \cdots + a_1 x + a_0\)</span> in <span class="math">\(\ZZ[a_0, \ldots, a_n][x]\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">n</span></code> - degree of the polynomial</li>
</ul>
<p>OUTPUT:</p>
<p>The discriminant as a polynomial in <span class="math">\(n + 1\)</span> variables over <span class="math">\(\ZZ\)</span>.
The result will be cached, so subsequent computations of
discriminants of the same degree will be faster.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.polynomial.polynomial_element</span> <span class="kn">import</span> <span class="n">universal_discriminant</span>
<span class="gp">sage: </span><span class="n">universal_discriminant</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">universal_discriminant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">a1^2 - 4*a0*a2</span>
<span class="gp">sage: </span><span class="n">universal_discriminant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">a1^2*a2^2 - 4*a0*a2^3 - 4*a1^3*a3 + 18*a0*a1*a2*a3 - 27*a0^2*a3^2</span>
<span class="gp">sage: </span><span class="n">universal_discriminant</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">degrees</span><span class="p">()</span>
<span class="go">(3, 4, 4, 4, 3)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.polynomial.polynomial_element.Polynomial.discriminant" title="sage.rings.polynomial.polynomial_element.Polynomial.discriminant"><code class="xref py py-meth docutils literal"><span class="pre">Polynomial.discriminant()</span></code></a></p>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="polynomial_ring_homomorphism.html"
                                  title="previous chapter">Ring homomorphisms from a polynomial ring to another ring</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="polynomial_element_generic.html"
                                  title="next chapter">Univariate Polynomials over domains and fields</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/rings/polynomial/polynomial_element.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="polynomial_element_generic.html" title="Univariate Polynomials over domains and fields"
             >next</a> |</li>
        <li class="right" >
          <a href="polynomial_ring_homomorphism.html" title="Ring homomorphisms from a polynomial ring to another ring"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Polynomials</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../../polynomial_rings_univar.html" >Univariate Polynomials and Polynomial Rings</a> &raquo;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>