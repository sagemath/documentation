<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="The Fusion Ring of the Drinfeld Double of a Finite Group" href="fusion_double.html" /><link rel="prev" title="Fusion Rings" href="fusion_ring.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>The F-Matrix of a Fusion Ring - Algebras</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Algebras</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.1 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Algebras</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../catalog.html">Catalog of Algebras</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../quantum_groups.html">Quantum Groups</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../quantum_groups/ace_quantum_onsager.html">Alternating Central Extension Quantum Onsager Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_groups/fock_space.html">Fock Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_groups/q_numbers.html"><span class="math notranslate nohighlight">\(q\)</span>-Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_groups/representations.html">Quantum Group Representations</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../free_algebra.html">Free algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../free_algebra_element.html">Free algebra elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../letterplace/free_algebra_letterplace.html">Free associative unital algebras, implemented via Singular’s letterplace rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../letterplace/free_algebra_element_letterplace.html">Weighted homogeneous elements of free algebras, in letterplace implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../letterplace/letterplace_ideal.html">Homogeneous ideals of free algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../free_algebra_quotient.html">Finite dimensional free algebra quotients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../free_algebra_quotient_element.html">Free algebra quotient elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tensor_algebra.html">Tensor Algebras</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../finite_dimensional_algebras/finite_dimensional_algebra.html">Finite-Dimensional Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../finite_dimensional_algebras/finite_dimensional_algebra_element.html">Elements of Finite Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../finite_dimensional_algebras/finite_dimensional_algebra_ideal.html">Ideals of Finite Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../finite_dimensional_algebras/finite_dimensional_algebra_morphism.html">Morphisms Between Finite Algebras</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../affine_nil_temperley_lieb.html">Affine nilTemperley Lieb Algebra of type A</a></li>
<li class="toctree-l1"><a class="reference internal" href="../askey_wilson.html">Askey-Wilson Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../combinat/diagram_algebras.html">Diagram and Partition Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../clifford_algebra.html">Clifford Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cluster_algebra.html">Cluster algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../combinat/descent_algebra.html">Descent Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../down_up_algebra.html">Down-Up Algebras</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../fusion_rings.html">Fusion Rings</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fusion_ring.html">Fusion Rings</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">The F-Matrix of a Fusion Ring</a></li>
<li class="toctree-l2"><a class="reference internal" href="fusion_double.html">The Fusion Ring of the Drinfeld Double of a Finite Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="fast_parallel_fmats_methods.html">Fast F-Matrix Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="fast_parallel_fusion_ring_braid_repn.html">Fast Fusion Ring Methods for Computing Braid Group Representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="poly_tup_engine.html">Arithmetic Engine for Polynomials as Tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="shm_managers.html">Shared Memory Managers for F-Symbol Attributes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hall_algebra.html">Hall Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../combinat/posets/incidence_algebras.html">Incidence Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../group_algebra.html">Group algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../combinat/grossman_larson_algebras.html">Grossman-Larson Hopf Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../combinat/posets/moebius_algebra.html">Möbius Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orlik_terao.html">Orlik-Terao Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orlik_solomon.html">Orlik-Solomon Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../combinat/partition_algebra.html">Partition/Diagram Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quantum_clifford.html">Quantum Clifford Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quantum_groups/quantum_group_gap.html">Quantum Groups Using GAP’s QuaGroup Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quantum_matrix_coordinate_algebra.html">Quantum Matrix Coordinate Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quatalg/quaternion_algebra.html">Quaternion Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rational_cherednik_algebra.html">Rational Cherednik Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schur_algebra.html">Schur algebras for <span class="math notranslate nohighlight">\(GL_n\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../steenrod/steenrod_algebra.html">The Steenrod algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../steenrod/steenrod_algebra_bases.html">Steenrod algebra bases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../steenrod/steenrod_algebra_misc.html">Miscellaneous functions for the Steenrod algebra and its elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../steenrod/steenrod_algebra_mult.html">Multiplication for elements of the Steenrod algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../weyl_algebra.html">Weyl Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../yangian.html">Yangians</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hecke_algebras/ariki_koike_algebra.html">Ariki-Koike Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iwahori_hecke_algebra.html">Iwahori-Hecke Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nil_coxeter_algebra.html">Nil-Coxeter Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../yokonuma_hecke_algebra.html">Yokonuma-Hecke Algebras</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../cubic_hecke_algebra.html">Cubic Hecke Algebras</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hecke_algebras/cubic_hecke_algebra.html">Cubic Hecke Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hecke_algebras/cubic_hecke_base_ring.html">Cubic Hecke Base Rings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hecke_algebras/cubic_hecke_matrix_rep.html">Cubic Hecke matrix representations</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../finite_gca.html">Finite dimensional graded commutative algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commutative_dga.html">Commutative Differential Graded Algebras</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../associated_graded.html">Associated Graded Algebras To Filtered Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cellular_basis.html">Cellular Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../q_system.html">Q-Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../q_commuting_polynomials.html"><span class="math notranslate nohighlight">\(q\)</span>-Commuting Polynomials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../splitting_algebra.html">Splitting Algebras</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../octonion_algebra.html">Octonion Algebras</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../lie_algebras.html">Lie Algebras</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/abelian.html">Abelian Lie Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/affine_lie_algebra.html">Affine Lie Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/bch.html">The Baker-Campbell-Hausdorff formula</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/classical_lie_algebra.html">Classical Lie Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/examples.html">Examples of Lie Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/free_lie_algebra.html">Free Lie Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/heisenberg.html">Heisenberg Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/lie_algebra.html">Lie Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/lie_algebra_element.html">Lie Algebra Elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/morphism.html">Homomorphisms of Lie Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/nilpotent_lie_algebra.html">Nilpotent Lie algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/onsager.html">Onsager Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/poincare_birkhoff_witt.html">The Poincare-Birkhoff-Witt Basis For A Universal Enveloping Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/quotient.html">Quotients of Lie algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/rank_two_heisenberg_virasoro.html">Rank Two Heisenberg-Virasoro Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/structure_coefficients.html">Lie Algebras Given By Structure Coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/subalgebra.html">Subalgebras and ideals of Lie algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/symplectic_derivation.html">Symplectic Derivation Lie Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/verma_module.html">Verma Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_algebras/virasoro.html">Virasoro Algebra and Related Lie Algebras</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../lie_conformal_algebras.html">Lie Conformal Algebras</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/lie_conformal_algebra.html">Lie Conformal Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/examples.html">Examples of Lie Conformal Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/lie_conformal_algebra_element.html">Lie Conformal Algebra Element</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/abelian_lie_conformal_algebra.html">Abelian Lie Conformal Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/affine_lie_conformal_algebra.html">Affine Lie Conformal Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/bosonic_ghosts_lie_conformal_algebra.html">Bosonic Ghosts Lie Conformal Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/fermionic_ghosts_lie_conformal_algebra.html">Fermionic Ghosts Super Lie Conformal Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/free_bosons_lie_conformal_algebra.html">Free Bosons Lie Conformal Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/free_fermions_lie_conformal_algebra.html">Free Fermions Super Lie Conformal Algebra.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/n2_lie_conformal_algebra.html">N=2 Super Lie Conformal Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/neveu_schwarz_lie_conformal_algebra.html">Neveu-Schwarz Super Lie Conformal Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/virasoro_lie_conformal_algebra.html">Virasoro Lie Conformal Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/weyl_lie_conformal_algebra.html">Weyl Lie Conformal Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/finitely_freely_generated_lca.html">Finitely and Freely Generated Lie Conformal Algebras.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/freely_generated_lie_conformal_algebra.html">Freely Generated Lie Conformal Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/graded_lie_conformal_algebra.html">Graded Lie Conformal Algebras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/lie_conformal_algebra_with_basis.html">Lie Conformal Algebras With Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lie_conformal_algebras/lie_conformal_algebra_with_structure_coefs.html">Lie Conformal Algebras With Structure Coefficients</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jordan_algebra.html">Jordan Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../combinat/free_dendriform_algebra.html">Free Dendriform Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../combinat/free_prelie_algebra.html">Free Pre-Lie Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shuffle_algebra.html">Shuffle algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../free_zinbiel_algebra.html">Free Zinbiel Algebras</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="the-f-matrix-of-a-fusion-ring">
<span id="sage-algebras-fusion-rings-f-matrix"></span><h1>The F-Matrix of a Fusion Ring<a class="headerlink" href="#the-f-matrix-of-a-fusion-ring" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.algebras.fusion_rings.f_matrix"></span><dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.fusion_rings.f_matrix.</span></span><span class="sig-name descname"><span class="pre">FMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fusion_ring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fusion_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>An F-matrix for a <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FR</span></code> – a <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fusion_label</span></code> – (optional) a string used to label basis elements
of the <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> associated to <code class="docutils literal notranslate"><span class="pre">self</span></code>
(see <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing.fusion_labels" title="sage.algebras.fusion_rings.fusion_ring.FusionRing.fusion_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FusionRing.fusion_labels()</span></code></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var_prefix</span></code> – (optional) a string indicating the desired prefix
for variables denoting F-symbols to be solved</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inject_variables</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) a boolean indicating
whether to inject variables (<a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> basis element
labels and F-symbols) into the global namespace</p></li>
</ul>
<p>The <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> or Verlinde algebra is the
Grothendieck ring of a modular tensor category <a class="reference internal" href="../../../../references/index.html#baki2001" id="id1"><span>[BaKi2001]</span></a>.
Such categories arise in conformal field theory or in the
representation theories of affine Lie algebras, or
quantum groups at roots of unity. They have applications
to low dimensional topology and knot theory, to conformal
field theory and to topological quantum computing. The
<a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> captures much information about a fusion
category, but to complete the picture, the F-matrices or
6j-symbols are needed. For example these are required in
order to construct braid group representations. This
can be done using the <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> method
<a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing.get_braid_generators" title="sage.algebras.fusion_rings.fusion_ring.FusionRing.get_braid_generators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FusionRing.get_braid_generators()</span></code></a>, which uses
the F-matrix.</p>
<p>We only undertake to compute the F-matrix if the
<a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> is <em>multiplicity free</em> meaning that
the Fusion coefficients <span class="math notranslate nohighlight">\(N^{ij}_k\)</span> are bounded
by 1. For Cartan Types <span class="math notranslate nohighlight">\(X_r\)</span> and level <span class="math notranslate nohighlight">\(k\)</span>,
the multiplicity-free cases are given by the
following table.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Cartan Type</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(k\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(A_1\)</span></p></td>
<td><p>any</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(A_r, r\geq 2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\leq 2\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(B_r, r\geq 2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\leq 2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(C_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\leq 2\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(C_r, r\geq 3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\leq 1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(D_r, r\geq 4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\leq 2\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(G_2, F_4, E_6, E_7\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\leq 2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(E_8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\leq 3\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Beyond this limitation, computation of the F-matrix
can involve very large systems of equations. A
rule of thumb is that this code can compute the
F-matrix for systems with <span class="math notranslate nohighlight">\(\leq 14\)</span> simple objects
(primary fields) on a machine with 16 GB of memory.
(Larger examples can be quite time consuming.)</p>
<p>The <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> and its methods capture much
of the structure of the underlying tensor category.
But an important aspect that is not encoded in the
fusion ring is the associator, which is a homomorphism
<span class="math notranslate nohighlight">\((A\otimes B)\otimes C\to A\otimes(B\otimes C)\)</span> that
requires an additional tool, the F-matrix or 6j-symbol.
To specify this, we fix a simple object <span class="math notranslate nohighlight">\(D\)</span>
and represent the transformation</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{Hom}(D, (A\otimes B)\otimes C)
\to \text{Hom}(D, A\otimes(B\otimes C))\]</div>
</div>
<p>by a matrix <span class="math notranslate nohighlight">\(F^{ABC}_D\)</span>. This depends on a pair of
additional simple objects <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>. Indeed, we can
get a basis for <span class="math notranslate nohighlight">\(\text{Hom}(D, (A\otimes B)\otimes C)\)</span>
indexed by simple objects <span class="math notranslate nohighlight">\(X\)</span> in which the corresponding
homomorphism factors through <span class="math notranslate nohighlight">\(X\otimes C\)</span>, and similarly
<span class="math notranslate nohighlight">\(\text{Hom}(D, A\otimes(B\otimes C))\)</span> has a basis indexed
by <span class="math notranslate nohighlight">\(Y\)</span>, in which the basis vector factors through <span class="math notranslate nohighlight">\(A\otimes Y\)</span>.</p>
<p>See <a class="reference internal" href="../../../../references/index.html#ttwl2009" id="id2"><span>[TTWL2009]</span></a> for an introduction to this topic,
<a class="reference internal" href="../../../../references/index.html#egno2015" id="id3"><span>[EGNO2015]</span></a> Section 4.9 for a precise mathematical
definition, and <a class="reference internal" href="../../../../references/index.html#bond2007" id="id4"><span>[Bond2007]</span></a> Section 2.5 and <a class="reference internal" href="../../../../references/index.html#ab2022" id="id5"><span>[Ab2022]</span></a> for discussions
of how to compute the F-matrix. In addition to
<a class="reference internal" href="../../../../references/index.html#bond2007" id="id6"><span>[Bond2007]</span></a>, worked out F-matrices may be found in
<a class="reference internal" href="../../../../references/index.html#rostwa2009" id="id7"><span>[RoStWa2009]</span></a> and <a class="reference internal" href="../../../../references/index.html#chw2015" id="id8"><span>[CHW2015]</span></a>.</p>
<p>The F-matrix is only determined up to a <em>gauge</em>. This
is a family of embeddings <span class="math notranslate nohighlight">\(C \to A\otimes B\)</span> for
simple objects <span class="math notranslate nohighlight">\(A, B, C\)</span> such that <span class="math notranslate nohighlight">\(\text{Hom}(C, A\otimes B)\)</span>
is nonzero. Changing the gauge changes the F-matrix though
not in a very essential way. By varying the gauge it is
possible to make the F-matrices unitary, or it is possible
to make them cyclotomic.</p>
<p>Due to the large number of equations we may fail to find a
Groebner basis if there are too many variables.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;E8&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">conjugate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">([</span><span class="s2">&quot;i0&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">],</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">f</span>
<span class="go">creating variables fx1..fx14</span>
<span class="go">Defining fx0, fx1, fx2, fx3, fx4, fx5, fx6, fx7, fx8, fx9, fx10, fx11, fx12, fx13</span>
<span class="go">F-Matrix factory for The Fusion Ring of Type E8 and level 2 with Integer Ring coefficients</span>
</pre></div>
</div>
<p>We have injected two sets of variables to the global namespace.
We created three variables <code class="docutils literal notranslate"><span class="pre">i0,</span> <span class="pre">p,</span> <span class="pre">s</span></code> to represent the
primary fields (simple elements) of the <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>. Creating
the <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix" title="sage.algebras.fusion_rings.f_matrix.FMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">FMatrix</span></code></a> factory also created variables
<code class="docutils literal notranslate"><span class="pre">fx1,</span> <span class="pre">fx2,</span> <span class="pre">...,</span> <span class="pre">fx14</span></code> in order to solve the hexagon and pentagon
equations describing the F-matrix. Since we called <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix" title="sage.algebras.fusion_rings.f_matrix.FMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">FMatrix</span></code></a>
with the parameter <code class="docutils literal notranslate"><span class="pre">inject_variables=True</span></code>, these have been injected
into the global namespace. This is not necessary for the code to work
but if you want to run the code experimentally you may want access
to these variables.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fmatrix</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">[fx10 fx11]</span>
<span class="go">[fx12 fx13]</span>
</pre></div>
</div>
<p>The F-matrix has not been computed at this stage, so
the F-matrix <span class="math notranslate nohighlight">\(F^{sss}_s\)</span> is filled with variables
<code class="docutils literal notranslate"><span class="pre">fx10</span></code>, <code class="docutils literal notranslate"><span class="pre">fx11</span></code>, <code class="docutils literal notranslate"><span class="pre">fx12</span></code>, <code class="docutils literal notranslate"><span class="pre">fx13</span></code>. The task is
to solve for these.</p>
<p>As explained above The F-matrix <span class="math notranslate nohighlight">\((F^{ABC}_D)_{X, Y}\)</span>
two other variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>. We have methods to
tell us (depending on <span class="math notranslate nohighlight">\(A, B, C, D\)</span>) what the possibilities
for these are. In this example with <span class="math notranslate nohighlight">\(A=B=C=D=s\)</span>
both <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are allowed to be <span class="math notranslate nohighlight">\(i_0\)</span> or <span class="math notranslate nohighlight">\(s\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">f_from</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">f</span><span class="o">.</span><span class="n">f_to</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">([i0, p], [i0, p])</span>
</pre></div>
</div>
<p>The last two statments show that the possible values of
<span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> when <span class="math notranslate nohighlight">\(A = B = C = D = s\)</span> are <span class="math notranslate nohighlight">\(i_0\)</span> and <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>The F-matrix is computed by solving the so-called
pentagon and hexagon equations. The <em>pentagon equations</em>
reflect the Mac Lane pentagon axiom in the definition
of a monoidal category. The hexagon relations
reflect the axioms of a <em>braided monoidal category</em>,
which are constraints on both the F-matrix and on
the R-matrix. Optionally, orthogonality constraints
may be imposed to obtain an orthogonal F-matrix.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s2">&quot;pentagons&quot;</span><span class="p">))[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[fx9*fx12 - fx2*fx13, fx4*fx11 - fx2*fx13]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s2">&quot;hexagons&quot;</span><span class="p">))[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[fx6 - 1, fx2 + 1]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get_orthogonality_constraints</span><span class="p">())[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[fx10*fx11 + fx12*fx13, fx10*fx11 + fx12*fx13]</span>
</pre></div>
</div>
<p>There are two methods available to compute an F-matrix.
The first, <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_cyclotomic_solution()</span></code></a> uses only
the pentagon and hexagon relations. The second,
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a> uses additionally
the orthogonality relations. There are some differences
that should be kept in mind.</p>
<p><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_cyclotomic_solution()</span></code></a> currently works only with
smaller examples. For example the <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> for <span class="math notranslate nohighlight">\(G_2\)</span>
at level 2 is too large. When it is available, this method
produces an F-matrix whose entries are in the same
cyclotomic field as the underlying <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_cyclotomic_solution</span><span class="p">()</span>
<span class="go">Setting up hexagons and pentagons...</span>
<span class="go">Finding a Groebner basis...</span>
<span class="go">Solving...</span>
<span class="go">Fixing the gauge...</span>
<span class="go">adding equation... fx1 - 1</span>
<span class="go">adding equation... fx11 - 1</span>
<span class="go">Done!</span>
</pre></div>
</div>
<p>We now have access to the values of the F-matrix using
the methods <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmatrix" title="sage.algebras.fusion_rings.f_matrix.FMatrix.fmatrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fmatrix()</span></code></a> and <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmat" title="sage.algebras.fusion_rings.f_matrix.FMatrix.fmat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fmat()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fmatrix</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">[(-1/2*zeta128^48 + 1/2*zeta128^16)                                  1]</span>
<span class="go">[                               1/2  (1/2*zeta128^48 - 1/2*zeta128^16)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fmat</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">(1/2*zeta128^48 - 1/2*zeta128^16)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a> is much more powerful
and is capable of handling large cases, sometimes
quickly but sometimes (in larger cases) after hours of
computation. Its F-matrices are not always in the
cyclotomic field that is the base ring of the underlying
<a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>, but sometimes in an extension field adjoining
some square roots. When this happens, the <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> is
modified, adding an attribute <code class="docutils literal notranslate"><span class="pre">_basecoer</span></code> that is
a coercion from the cyclotomic field to the field
containing the F-matrix. The field containing the F-matrix
is available through <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.field" title="sage.algebras.fusion_rings.f_matrix.FMatrix.field"><code class="xref py py-meth docutils literal notranslate"><span class="pre">field()</span></code></a>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">checkpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>     <span class="c1"># not tested (~100 s)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">in</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">56</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">get_fvars</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>  <span class="c1"># not tested</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># long time (~11 s)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>                                 <span class="c1"># long time</span>
<span class="go">Algebraic Field</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.FR">
<span class="sig-name descname"><span class="pre">FR</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.FR" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> associated to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;D3&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">FR</span><span class="p">()</span>
<span class="go">The Fusion Ring of Type D3 and level 1 with Integer Ring coefficients</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.attempt_number_field_computation">
<span class="sig-name descname"><span class="pre">attempt_number_field_computation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.attempt_number_field_computation" title="Permalink to this definition">#</a></dt>
<dd><p>Based on the <code class="docutils literal notranslate"><span class="pre">CartanType</span></code> of <code class="docutils literal notranslate"><span class="pre">self</span></code> and data
known on March 17, 2021, determine whether to attempt
to find a <a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.NumberField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">NumberField()</span></code></a> containing all the F-symbols.</p>
<p>This method is used by <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a>
to determine a field containing all F-symbols.
See <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.field" title="sage.algebras.fusion_rings.f_matrix.FMatrix.field"><code class="xref py py-meth docutils literal notranslate"><span class="pre">field()</span></code></a> and <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_non_cyclotomic_roots" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_non_cyclotomic_roots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_non_cyclotomic_roots()</span></code></a>.</p>
<p>For certain <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">fusion</span> <span class="pre">rings</span></code></a>, the number field
computation does not terminate in reasonable time.
In these cases, we report F-symbols as elements
of the <a class="reference external" href="../../../../number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QQbar</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;F4&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">attempt_number_field_computation</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">attempt_number_field_computation</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In certain cases, F-symbols are found in the associated
<a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>’s cyclotomic field and a
<a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.NumberField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">NumberField()</span></code></a> computation is not needed. In these
cases this method returns <code class="docutils literal notranslate"><span class="pre">True</span></code> but the
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a> solver does <em>not</em>
undertake a <a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.NumberField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">NumberField()</span></code></a> computation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.certify_pentagons">
<span class="sig-name descname"><span class="pre">certify_pentagons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_mp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.certify_pentagons" title="Permalink to this definition">#</a></dt>
<dd><p>Obtain a certificate of satisfaction for the pentagon equations,
up to floating-point error.</p>
<p>This method converts the computed F-symbols (available through
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_fvars()</span></code></a>) to native Python floats and then checks whether
the pentagon equations are satisfied using floating point arithmetic.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">self.FR().basis()</span></code> has many elements, verifying satisfaction
of the pentagon relations exactly using <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_defining_equations()</span></code></a>
with <code class="docutils literal notranslate"><span class="pre">option=&quot;pentagons&quot;</span></code> may take a long time. This method is
faster, but it cannot provide mathematical guarantees.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;C3&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">()</span>        <span class="c1"># long time</span>
<span class="go">Computing F-symbols for The Fusion Ring of Type C3 and level 1 with Integer Ring coefficients with 71 variables...</span>
<span class="go">Set up 134 hex and orthogonality constraints...</span>
<span class="go">Partitioned 134 equations into 17 components of size:</span>
<span class="go">[12, 12, 6, 6, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1]</span>
<span class="go">Elimination epoch completed... 10 eqns remain in ideal basis</span>
<span class="go">Elimination epoch completed... 0 eqns remain in ideal basis</span>
<span class="go">Hex elim step solved for 51 / 71 variables</span>
<span class="go">Set up 121 reduced pentagons...</span>
<span class="go">Elimination epoch completed... 18 eqns remain in ideal basis</span>
<span class="go">Elimination epoch completed... 5 eqns remain in ideal basis</span>
<span class="go">Pent elim step solved for 64 / 71 variables</span>
<span class="go">Partitioned 5 equations into 1 components of size:</span>
<span class="go">[4]</span>
<span class="go">Elimination epoch completed... 0 eqns remain in ideal basis</span>
<span class="go">Partitioned 6 equations into 6 components of size:</span>
<span class="go">[1, 1, 1, 1, 1, 1]</span>
<span class="go">Computing appropriate NumberField...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">certify_pentagons</span><span class="p">()</span>  <span class="ow">is</span> <span class="kc">None</span>      <span class="c1"># not tested (long time ~1.5s, cypari issue in doctesting framework)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.clear_equations">
<span class="sig-name descname"><span class="pre">clear_equations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.clear_equations" title="Permalink to this definition">#</a></dt>
<dd><p>Clear the list of equations to be solved.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;E6&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s1">&#39;hexagons&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">clear_equations</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.clear_vars">
<span class="sig-name descname"><span class="pre">clear_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.clear_vars" title="Permalink to this definition">#</a></dt>
<dd><p>Reset the F-symbols.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;C4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fvars</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_fvars</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">some_key</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fvars</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">fvars</span><span class="p">[</span><span class="n">some_key</span><span class="p">]</span>
<span class="go">fx0</span>
<span class="gp">sage: </span><span class="n">fvars</span><span class="p">[</span><span class="n">some_key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_fvars</span><span class="p">()[</span><span class="n">some_key</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">clear_vars</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_fvars</span><span class="p">()[</span><span class="n">some_key</span><span class="p">]</span>
<span class="go">fx0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.equations_graph">
<span class="sig-name descname"><span class="pre">equations_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eqns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.equations_graph" title="Permalink to this definition">#</a></dt>
<dd><p>Construct a graph corresponding to the given equations.</p>
<p>Every node corresponds to a variable and nodes are connected when
the corresponding variables appear together in an equation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eqns</span></code> – a list of polynomials</p></li>
</ul>
<p>Each polynomial is either an object in the ring returned by
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_poly_ring" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_poly_ring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_poly_ring()</span></code></a> or it is a tuple of pairs representing
a polynomial using the internal representation.</p>
<p>If no list of equations is passed, the graph is built from the
polynomials in <code class="docutils literal notranslate"><span class="pre">self.ideal_basis</span></code>. In this case the method assumes
the internal representation of a polynomial as a tuple of pairs is
used.</p>
<p>This method is crucial to <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a>. The
hexagon equations, obtained using <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_defining_equations()</span></code></a>,
define a disconnected graph that breaks up into many small components.
The <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a> solver exploits this when
undertaking a Groebner basis computation.</p>
<p>OUTPUT:</p>
<p>A <code class="docutils literal notranslate"><span class="pre">Graph</span></code> object. If a list of polynomial objects was given,
the set of nodes in the output graph is the subset polynomial
ring generators appearing in the equations.</p>
<p>If the internal representation was used, the set of nodes is
the subset of indices corresponding to polynomial ring generators.
This option is meant for internal use by the F-matrix solver.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_poly_ring</span><span class="p">()</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">27</span>
<span class="gp">sage: </span><span class="n">he</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s1">&#39;hexagons&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">graph</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">equations_graph</span><span class="p">(</span><span class="n">he</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">graph</span><span class="o">.</span><span class="n">connected_components_sizes</span><span class="p">()</span>
<span class="go">[6, 3, 3, 3, 3, 3, 3, 1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.f_from">
<span class="sig-name descname"><span class="pre">f_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.f_from" title="Permalink to this definition">#</a></dt>
<dd><p>Return the possible <span class="math notranslate nohighlight">\(x\)</span> such that there are morphisms
<span class="math notranslate nohighlight">\(d \to x \otimes c \to (a \otimes b) \otimes c\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">d</span></code> – basis elements of the associated <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fr</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">fusion_labels</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fr</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fmatrix</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
<span class="go">[fx6 fx7]</span>
<span class="go">[fx8 fx9]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">f_from</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
<span class="go">[a0, a2]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">f_to</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
<span class="go">[a1, a3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.f_to">
<span class="sig-name descname"><span class="pre">f_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.f_to" title="Permalink to this definition">#</a></dt>
<dd><p>Return the possible <span class="math notranslate nohighlight">\(y\)</span> such that there are morphisms
<span class="math notranslate nohighlight">\(d \to a \otimes y \to a \otimes (b \otimes c)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">d</span></code> – basis elements of the associated <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b22</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b22</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">b22</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">fmatrix</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span> <span class="n">b4</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b4</span><span class="p">)</span>
<span class="go">[fx266 fx267 fx268]</span>
<span class="go">[fx269 fx270 fx271]</span>
<span class="go">[fx272 fx273 fx274]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">f_from</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span> <span class="n">b4</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b4</span><span class="p">)</span>
<span class="go">[b1, b3, b5]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">f_to</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span> <span class="n">b4</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b4</span><span class="p">)</span>
<span class="go">[b1, b3, b5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.field">
<span class="sig-name descname"><span class="pre">field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the base field containing the F-symbols.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">self</span></code> is initialized, the field is set to be the
cyclotomic field of the <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> associated
to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The field may change after running <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a>.
At that point, this method could return the
associated <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>’s cyclotomic field, an
appropriate <a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.NumberField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">NumberField()</span></code></a> that was computed on the fly
by the F-matrix solver, or the <a class="reference external" href="../../../../number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QQbar</span></code></a>.</p>
<p>Depending on the <code class="docutils literal notranslate"><span class="pre">CartanType</span></code> of <code class="docutils literal notranslate"><span class="pre">self</span></code>, the solver may need
to compute an extension field containing certain square roots that
do not belong to the associated <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>’s cyclotomic field.</p>
<p>In certain cases we revert to <a class="reference external" href="../../../../number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QQbar</span></code></a> because
the extension field computation does not seem to terminate. See
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.attempt_number_field_computation" title="sage.algebras.fusion_rings.f_matrix.FMatrix.attempt_number_field_computation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">attempt_number_field_computation()</span></code></a> for more details.</p>
<p>The method <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_non_cyclotomic_roots" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_non_cyclotomic_roots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_non_cyclotomic_roots()</span></code></a> returns a list of
roots defining the extension of the <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>’s
cyclotomic field needed to contain all F-symbols.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Cyclotomic Field of order 60 and degree 16</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Number Field in a with defining polynomial y^32 - ... - 22*y^2 + 1</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_qqbar_embedding</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">get_non_cyclotomic_roots</span><span class="p">()]</span>
<span class="go">[-0.786151377757423 - 8.92806368517581e-31*I]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consider using <code class="docutils literal notranslate"><span class="pre">self.field().optimized_representation()</span></code> to
obtain an equivalent <a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.NumberField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">NumberField()</span></code></a> with a defining
polynomial with smaller coefficients, for a more efficient
element representation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution">
<span class="sig-name descname"><span class="pre">find_cyclotomic_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution" title="Permalink to this definition">#</a></dt>
<dd><p>Solve the hexagon and pentagon relations to evaluate the F-matrix.</p>
<p>This method (omitting the orthogonality constraints) produces
output in the cyclotomic field, but it is very limited in the size
of examples it can handle: for example, <span class="math notranslate nohighlight">\(G_2\)</span> at level 2 is
too large for this method. You may use <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a>
to solve much larger examples.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">equations</span></code> – (optional) a set of equations to be
solved; defaults to the hexagon and pentagon equations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (optional) algorithm to compute Groebner Basis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) output a dictionary of
F-matrix values; this may be useful to see but may be omitted
since this information will be available afterwards via the
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmatrix" title="sage.algebras.fusion_rings.f_matrix.FMatrix.fmatrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fmatrix()</span></code></a> and <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmat" title="sage.algebras.fusion_rings.f_matrix.FMatrix.fmat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fmat()</span></code></a> methods.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fr</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fusion_labels</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fr</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">creating variables fx1..fx8</span>
<span class="go">Defining fx0, fx1, fx2, fx3, fx4, fx5, fx6, fx7</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_cyclotomic_solution</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Setting up hexagons and pentagons...</span>
<span class="go">Finding a Groebner basis...</span>
<span class="go">Solving...</span>
<span class="go">Fixing the gauge...</span>
<span class="go">adding equation... fx4 - 1</span>
<span class="go">Done!</span>
<span class="go">{(a2, a2, a2, a0, a1, a1): 1,</span>
<span class="go"> (a2, a2, a1, a2, a1, a0): 1,</span>
<span class="go"> (a2, a1, a2, a2, a0, a0): 1,</span>
<span class="go"> (a2, a1, a1, a1, a0, a2): 1,</span>
<span class="go"> (a1, a2, a2, a2, a0, a1): 1,</span>
<span class="go"> (a1, a2, a1, a1, a0, a0): 1,</span>
<span class="go"> (a1, a1, a2, a1, a2, a0): 1,</span>
<span class="go"> (a1, a1, a1, a0, a2, a2): 1}</span>
</pre></div>
</div>
<p>After you successfully run <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_cyclotomic_solution()</span></code></a> you may
check the correctness of the F-matrix by running
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_defining_equations()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">option='hexagons'</span></code> and
<code class="docutils literal notranslate"><span class="pre">option='pentagons'</span></code>. These should return empty lists
of equations.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s2">&quot;hexagons&quot;</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s2">&quot;pentagons&quot;</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution">
<span class="sig-name descname"><span class="pre">find_orthogonal_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="Permalink to this definition">#</a></dt>
<dd><p>Solve the the hexagon and pentagon relations, along with
orthogonality constraints, to evaluate an orthogonal F-matrix.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">checkpoint</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) a boolean indicating whether
the computation should be checkpointed. Depending on the associated
<code class="docutils literal notranslate"><span class="pre">CartanType</span></code>, the computation may take hours to complete. For
large examples, checkpoints are recommended. This method supports
“warm” starting, so the calculation may be resumed from a checkpoint,
using the <code class="docutils literal notranslate"><span class="pre">warm_start</span></code> option.</p>
<p>Checkpoints store necessary state in the pickle file
<code class="docutils literal notranslate"><span class="pre">&quot;fmatrix_solver_checkpoint_&quot;</span> <span class="pre">+</span> <span class="pre">key</span> <span class="pre">+</span> <span class="pre">&quot;.pickle&quot;</span></code>, where <code class="docutils literal notranslate"><span class="pre">key</span></code>
is the result of <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fr_str" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_fr_str"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_fr_str()</span></code></a>.</p>
<p>Checkpoint pickles are automatically deleted when the solver exits
a successful run.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">save_results</span></code> – (optional) a string indicating the name of a
pickle file in which to store calculated F-symbols for later use.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">save_results</span></code> is not provided (default), F-matrix results
are not stored to file.</p>
<p>The F-symbols may be saved to file after running the solver using
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars" title="sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_fvars()</span></code></a>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">warm_start</span></code> – (optional) a string indicating the name of a pickle
file containing checkpointed solver state. This file must have been
produced by a previous call to the solver using the <code class="docutils literal notranslate"><span class="pre">checkpoint</span></code>
option.</p>
<p>If no file name is provided, the calculation begins from scratch.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_mp</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) a boolean indicating whether to use
multiprocessing to speed up calculation. The default value
<code class="docutils literal notranslate"><span class="pre">True</span></code> is highly recommended, since parallel processing yields
results much more quickly.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) a boolean indicating whether the
solver should print out intermediate progress reports.</p></li>
</ul>
<p>OUTPUT:</p>
<p>This method returns <code class="docutils literal notranslate"><span class="pre">None</span></code>. If the solver runs successfully, the
results may be accessed through various methods, such as
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_fvars()</span></code></a>, <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmatrix" title="sage.algebras.fusion_rings.f_matrix.FMatrix.fmatrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fmatrix()</span></code></a>, <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmat" title="sage.algebras.fusion_rings.f_matrix.FMatrix.fmat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fmat()</span></code></a>, etc.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B5&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">fusion_label</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">creating variables fx1..fx14</span>
<span class="go">Defining fx0, fx1, fx2, fx3, fx4, fx5, fx6, fx7, fx8, fx9, fx10, fx11, fx12, fx13</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">()</span>
<span class="go">Computing F-symbols for The Fusion Ring of Type B5 and level 1 with Integer Ring coefficients with 14 variables...</span>
<span class="go">Set up 25 hex and orthogonality constraints...</span>
<span class="go">Partitioned 25 equations into 5 components of size:</span>
<span class="go">[4, 3, 3, 3, 1]</span>
<span class="go">Elimination epoch completed... 0 eqns remain in ideal basis</span>
<span class="go">Hex elim step solved for 10 / 14 variables</span>
<span class="go">Set up 7 reduced pentagons...</span>
<span class="go">Elimination epoch completed... 0 eqns remain in ideal basis</span>
<span class="go">Pent elim step solved for 12 / 14 variables</span>
<span class="go">Partitioned 0 equations into 0 components of size:</span>
<span class="go">[]</span>
<span class="go">Partitioned 2 equations into 2 components of size:</span>
<span class="go">[1, 1]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fmatrix</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
<span class="go">[ 1/2*zeta80^30 - 1/2*zeta80^10 -1/2*zeta80^30 + 1/2*zeta80^10]</span>
<span class="go">[ 1/2*zeta80^30 - 1/2*zeta80^10  1/2*zeta80^30 - 1/2*zeta80^10]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fmat</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">b1</span><span class="p">)</span>
<span class="go">-1/2*zeta80^30 + 1/2*zeta80^10</span>
</pre></div>
</div>
<p>Every F-matrix <span class="math notranslate nohighlight">\(F^{a, b, c}_d\)</span> is orthogonal and in many cases real.
We may use <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmats_are_orthogonal" title="sage.algebras.fusion_rings.f_matrix.FMatrix.fmats_are_orthogonal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fmats_are_orthogonal()</span></code></a> and <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fvars_are_real" title="sage.algebras.fusion_rings.f_matrix.FMatrix.fvars_are_real"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fvars_are_real()</span></code></a>
to obtain correctness certificates.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fmats_are_orthogonal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In any case, the F-symbols are obtained as elements of the associated
<a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>’s
<a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.CyclotomicFieldFactory" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cyclotomic</span> <span class="pre">field</span></code></a>,
a computed <a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.NumberField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">NumberField()</span></code></a>, or <a class="reference external" href="../../../../number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QQbar</span></code></a>.
Currently, the field containing the F-symbols is determined based
on the <code class="docutils literal notranslate"><span class="pre">CartanType</span></code> associated to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.attempt_number_field_computation" title="sage.algebras.fusion_rings.f_matrix.FMatrix.attempt_number_field_computation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">attempt_number_field_computation()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.findcases">
<span class="sig-name descname"><span class="pre">findcases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.findcases" title="Permalink to this definition">#</a></dt>
<dd><p>Return unknown F-matrix entries.</p>
<p>If run with <code class="docutils literal notranslate"><span class="pre">output=True</span></code>,
this returns two dictionaries; otherwise it just returns the
number of unknown values.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fusion_labels</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;i0&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">findcases</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">findcases</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go"> ({0: (t, t, t, i0, t, t),</span>
<span class="go">  1: (t, t, t, t, i0, i0),</span>
<span class="go">  2: (t, t, t, t, i0, t),</span>
<span class="go">  3: (t, t, t, t, t, i0),</span>
<span class="go">  4: (t, t, t, t, t, t)},</span>
<span class="go"> {(t, t, t, i0, t, t): fx0,</span>
<span class="go">  (t, t, t, t, i0, i0): fx1,</span>
<span class="go">  (t, t, t, t, i0, t): fx2,</span>
<span class="go">  (t, t, t, t, t, i0): fx3,</span>
<span class="go">  (t, t, t, t, t, t): fx4})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.fmat">
<span class="sig-name descname"><span class="pre">fmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmat" title="Permalink to this definition">#</a></dt>
<dd><p>Return the F-Matrix coefficient <span class="math notranslate nohighlight">\((F^{a, b, c}_d)_{x, y}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fr</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fusion_labels</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;i0&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">),</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fr</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">fmat</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fr</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">fr</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[fx1, fx2, fx3, fx4]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_cyclotomic_solution</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Setting up hexagons and pentagons...</span>
<span class="go">Finding a Groebner basis...</span>
<span class="go">Solving...</span>
<span class="go">Fixing the gauge...</span>
<span class="go">adding equation... fx2 - 1</span>
<span class="go">Done!</span>
<span class="go">{(t, t, t, i0, t, t): 1,</span>
<span class="go"> (t, t, t, t, i0, i0): (-zeta60^14 + zeta60^6 + zeta60^4 - 1),</span>
<span class="go"> (t, t, t, t, i0, t): 1,</span>
<span class="go"> (t, t, t, t, t, i0): (-zeta60^14 + zeta60^6 + zeta60^4 - 1),</span>
<span class="go"> (t, t, t, t, t, t): (zeta60^14 - zeta60^6 - zeta60^4 + 1)}</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">fmat</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">_FR</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">_FR</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[(-zeta60^14 + zeta60^6 + zeta60^4 - 1),</span>
<span class="go"> 1,</span>
<span class="go"> (-zeta60^14 + zeta60^6 + zeta60^4 - 1),</span>
<span class="go"> (zeta60^14 - zeta60^6 - zeta60^4 + 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.fmatrix">
<span class="sig-name descname"><span class="pre">fmatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmatrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the F-Matrix <span class="math notranslate nohighlight">\(F^{a, b, c}_d\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">d</span></code> – basis elements of the associated <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fr</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fusion_labels</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fr</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fmatrix</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
<span class="go">[fx0 fx1]</span>
<span class="go">[fx2 fx3]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_cyclotomic_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
<span class="go">adding equation... fx4 - 1</span>
<span class="go">adding equation... fx10 - 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">f_from</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
<span class="go">[c0, c2]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">f_to</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
<span class="go">[c0, c2]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fmatrix</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
<span class="go">[ (1/2*zeta32^12 - 1/2*zeta32^4) (-1/2*zeta32^12 + 1/2*zeta32^4)]</span>
<span class="go">[ (1/2*zeta32^12 - 1/2*zeta32^4)  (1/2*zeta32^12 - 1/2*zeta32^4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.fmats_are_orthogonal">
<span class="sig-name descname"><span class="pre">fmats_are_orthogonal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmats_are_orthogonal" title="Permalink to this definition">#</a></dt>
<dd><p>Verify that all F-matrices are orthogonal.</p>
<p>This method should always return <code class="docutils literal notranslate"><span class="pre">True</span></code> when called after running
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;D4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fmats_are_orthogonal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.fvars_are_real">
<span class="sig-name descname"><span class="pre">fvars_are_real</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fvars_are_real" title="Permalink to this definition">#</a></dt>
<dd><p>Test whether all F-symbols are real.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fvars_are_real</span><span class="p">()</span>                        <span class="c1"># not tested (cypari issue in doctesting framework)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_coerce_map_from_fr_cyclotomic_field">
<span class="sig-name descname"><span class="pre">get_coerce_map_from_fr_cyclotomic_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_coerce_map_from_fr_cyclotomic_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return a coercion map from the associated <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>’s
cyclotomic field into the base field containing all F-symbols
(this could be the <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>’s
<a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.CyclotomicFieldFactory" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cyclotomic</span> <span class="pre">field</span></code></a>,
a <a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.NumberField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">NumberField()</span></code></a>, or <a class="reference external" href="../../../../number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QQbar</span></code></a>).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">FR</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Cyclotomic Field of order 60 and degree 16</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Number Field in a with defining polynomial y^32 - ... - 22*y^2 + 1</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_coerce_map_from_fr_cyclotomic_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">FR</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>When F-symbols are computed as elements of the associated
<a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>’s base
<a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.CyclotomicFieldFactory" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cyclotomic</span> <span class="pre">field</span></code></a>,
we have <code class="docutils literal notranslate"><span class="pre">self.field()</span> <span class="pre">==</span> <span class="pre">self.FR().field()</span></code> and this
returns the identity map on <code class="docutils literal notranslate"><span class="pre">self.field()</span></code>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_coerce_map_from_fr_cyclotomic_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Cyclotomic Field of order 48 and degree 16</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">FR</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations">
<span class="sig-name descname"><span class="pre">get_defining_equations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations" title="Permalink to this definition">#</a></dt>
<dd><p>Get the equations defining the ideal generated by the hexagon or
pentagon relations.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">option</span></code> – a string determining equations to be set up:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'hexagons'</span></code> - get equations imposed on the F-matrix by
the hexagon relations in the definition of a braided category</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pentagons'</span></code> - get equations imposed on the F-matrix by
the pentagon relations in the definition of a monoidal category</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">output</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) a boolean indicating whether
results should be returned, where the equations will be polynomials.
Otherwise, the constraints are appended to <code class="docutils literal notranslate"><span class="pre">self.ideal_basis</span></code>.
Constraints are stored in the internal tuple representation. The
<code class="docutils literal notranslate"><span class="pre">output=False</span></code> option is meant only for internal use by the
F-matrix solver. When computing the hexagon equations with the
<code class="docutils literal notranslate"><span class="pre">output=False</span></code> option, the initial state of the F-symbols is used.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To set up the defining equations using parallel processing,
use <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.start_worker_pool" title="sage.algebras.fusion_rings.f_matrix.FMatrix.start_worker_pool"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start_worker_pool()</span></code></a> to initialize multiple processes
<em>before</em> calling this method.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s1">&#39;hexagons&#39;</span><span class="p">))</span>
<span class="go">[fx7 + 1,</span>
<span class="go"> fx6 - 1,</span>
<span class="go"> fx2 + 1,</span>
<span class="go"> fx0 - 1,</span>
<span class="go"> fx11*fx12 + (-zeta32^8)*fx13^2 + (zeta32^12)*fx13,</span>
<span class="go"> fx10*fx12 + (-zeta32^8)*fx12*fx13 + (zeta32^4)*fx12,</span>
<span class="go"> fx10*fx11 + (-zeta32^8)*fx11*fx13 + (zeta32^4)*fx11,</span>
<span class="go"> fx10^2 + (-zeta32^8)*fx11*fx12 + (-zeta32^12)*fx10,</span>
<span class="go"> fx4*fx9 + fx7,</span>
<span class="go"> fx3*fx8 - fx6,</span>
<span class="go"> fx1*fx5 + fx2]</span>
<span class="gp">sage: </span><span class="n">pe</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s1">&#39;pentagons&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">pe</span><span class="p">)</span>
<span class="go">33</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_fr_str">
<span class="sig-name descname"><span class="pre">get_fr_str</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fr_str" title="Permalink to this definition">#</a></dt>
<dd><p>Auto-generate an identifying key for saving results.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_fr_str</span><span class="p">()</span>
<span class="go">&#39;B31&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars">
<span class="sig-name descname"><span class="pre">get_fvars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars" title="Permalink to this definition">#</a></dt>
<dd><p>Return a dictionary of F-symbols.</p>
<p>The keys are sextuples <span class="math notranslate nohighlight">\((a, b, c, d, x, y)\)</span> of basis elements of
<code class="docutils literal notranslate"><span class="pre">self.FR()</span></code> and the values are the corresponding F-symbols
<span class="math notranslate nohighlight">\((F^{a, b, c}_d)_{xy}\)</span>.</p>
<p>These values reflect the current state of a solver’s computation.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">creating variables fx1..fx8</span>
<span class="go">Defining fx0, fx1, fx2, fx3, fx4, fx5, fx6, fx7</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_fvars</span><span class="p">()[(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f2</span><span class="p">)]</span>
<span class="go">fx0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_fvars</span><span class="p">()[(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f2</span><span class="p">)]</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars_by_size">
<span class="sig-name descname"><span class="pre">get_fvars_by_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars_by_size" title="Permalink to this definition">#</a></dt>
<dd><p>Return the set of F-symbols that are entries of an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix
<span class="math notranslate nohighlight">\(F^{a, b, c}_d\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> – a positive integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">indices</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">indices</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> (default),
this method returns a set of sextuples <span class="math notranslate nohighlight">\((a, b, c, d, x, y)\)</span> identifying
the corresponding F-symbol. Each sextuple is a key in the
dictionary returned by <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_fvars()</span></code></a>.</p>
<p>Otherwise the method returns a list of integer indices that
internally identify the F-symbols. The <code class="docutils literal notranslate"><span class="pre">indices=True</span></code> option is
meant for internal use.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">creating variables fx1..fx287</span>
<span class="go">Defining fx0, ..., fx286</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">largest_fmat_size</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_fvars_by_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">{(f2, f2, f2, f4, f1, f1),</span>
<span class="go"> (f2, f2, f2, f4, f1, f5),</span>
<span class="go"> ...</span>
<span class="go"> (f4, f4, f4, f4, f4, f0),</span>
<span class="go"> (f4, f4, f4, f4, f4, f4)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars_in_alg_field">
<span class="sig-name descname"><span class="pre">get_fvars_in_alg_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars_in_alg_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return F-symbols as elements of the <a class="reference external" href="../../../../number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QQbar</span></code></a>.</p>
<p>This method uses the embedding defined by
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_qqbar_embedding" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_qqbar_embedding"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_qqbar_embedding()</span></code></a> to coerce
F-symbols into <a class="reference external" href="../../../../number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QQbar</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fr</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fr</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">fusion_label</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">creating variables fx1..fx5</span>
<span class="go">Defining fx0, fx1, fx2, fx3, fx4</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Number Field in a with defining polynomial y^32 - ... - 22*y^2 + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_fvars_in_alg_field</span><span class="p">()</span>
<span class="go">{(g1, g1, g1, g0, g1, g1): 1,</span>
<span class="go"> (g1, g1, g1, g1, g0, g0): 0.61803399? + 0.?e-8*I,</span>
<span class="go"> (g1, g1, g1, g1, g0, g1): -0.7861514? + 0.?e-8*I,</span>
<span class="go"> (g1, g1, g1, g1, g1, g0): -0.7861514? + 0.?e-8*I,</span>
<span class="go"> (g1, g1, g1, g1, g1, g1): -0.61803399? + 0.?e-8*I}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_non_cyclotomic_roots">
<span class="sig-name descname"><span class="pre">get_non_cyclotomic_roots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_non_cyclotomic_roots" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of roots that define the extension of the associated
<a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>’s base
<a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.CyclotomicFieldFactory" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cyclotomic</span> <span class="pre">field</span></code></a>,
containing all the F-symbols.</p>
<p>OUTPUT:</p>
<p>The list of non-cyclotomic roots is given as a list of elements of the
field returned by <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.field" title="sage.algebras.fusion_rings.f_matrix.FMatrix.field"><code class="xref py py-meth docutils literal notranslate"><span class="pre">field()</span></code></a>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">self.field()</span> <span class="pre">==</span> <span class="pre">self.FR().field()</span></code> then this method
returns an empty list.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;E6&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">FR</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_non_cyclotomic_roots</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">FR</span><span class="p">()</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_qqbar_embedding</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">get_non_cyclotomic_roots</span><span class="p">()]</span>
<span class="go">[-0.786151377757423 - 8.92806368517581e-31*I]</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">self.field()</span></code> is a <code class="docutils literal notranslate"><span class="pre">NumberField</span></code>, one may use
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_qqbar_embedding" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_qqbar_embedding"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_qqbar_embedding()</span></code></a> to embed the resulting values into
<a class="reference external" href="../../../../number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QQbar</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_orthogonality_constraints">
<span class="sig-name descname"><span class="pre">get_orthogonality_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_orthogonality_constraints" title="Permalink to this definition">#</a></dt>
<dd><p>Get equations imposed on the F-matrix by orthogonality.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">output</span></code> – a boolean</p></li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">output=True</span></code>, orthogonality constraints are returned as
polynomial objects.</p>
<p>Otherwise, the constraints are appended to <code class="docutils literal notranslate"><span class="pre">self.ideal_basis</span></code>.
They are stored in the internal tuple representation. The
<code class="docutils literal notranslate"><span class="pre">output=False</span></code> option is meant mostly for internal use by the
F-matrix solver.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_orthogonality_constraints</span><span class="p">()</span>
<span class="go">[fx0^2 - 1,</span>
<span class="go"> fx1^2 - 1,</span>
<span class="go"> fx2^2 - 1,</span>
<span class="go"> fx3^2 - 1,</span>
<span class="go"> fx4^2 - 1,</span>
<span class="go"> fx5^2 - 1,</span>
<span class="go"> fx6^2 - 1,</span>
<span class="go"> fx7^2 - 1,</span>
<span class="go"> fx8^2 - 1,</span>
<span class="go"> fx9^2 - 1,</span>
<span class="go"> fx10^2 + fx12^2 - 1,</span>
<span class="go"> fx10*fx11 + fx12*fx13,</span>
<span class="go"> fx10*fx11 + fx12*fx13,</span>
<span class="go"> fx11^2 + fx13^2 - 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_poly_ring">
<span class="sig-name descname"><span class="pre">get_poly_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_poly_ring" title="Permalink to this definition">#</a></dt>
<dd><p>Return the polynomial ring whose generators denote the desired F-symbols.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B6&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">get_poly_ring</span><span class="p">()</span>
<span class="go">Multivariate Polynomial Ring in fx0, ..., fx13 over</span>
<span class="go"> Cyclotomic Field of order 96 and degree 32</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_qqbar_embedding">
<span class="sig-name descname"><span class="pre">get_qqbar_embedding</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_qqbar_embedding" title="Permalink to this definition">#</a></dt>
<dd><p>Return an embedding from the base field containing F-symbols (the
associated <a class="reference internal" href="fusion_ring.html#sage.algebras.fusion_rings.fusion_ring.FusionRing" title="sage.algebras.fusion_rings.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>’s
<a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.CyclotomicFieldFactory" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cyclotomic</span> <span class="pre">field</span></code></a>,
a <a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.NumberField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">NumberField()</span></code></a>, or <a class="reference external" href="../../../../number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QQbar</span></code></a>) into
<a class="reference external" href="../../../../number_fields/sage/rings/qqbar.html#sage.rings.qqbar.AlgebraicField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QQbar</span></code></a>.</p>
<p>This embedding is useful for getting a better sense for the
F-symbols, particularly when they are computed as elements of a
<a class="reference external" href="../../../../number_fields/sage/rings/number_field/number_field.html#sage.rings.number_field.number_field.NumberField" title="(in Algebraic Numbers and Number Fields v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">NumberField()</span></code></a>. See also <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_non_cyclotomic_roots" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_non_cyclotomic_roots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_non_cyclotomic_roots()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fr</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fr</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">fusion_label</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">creating variables fx1..fx5</span>
<span class="go">Defining fx0, fx1, fx2, fx3, fx4</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">()</span>
<span class="go">Computing F-symbols for The Fusion Ring of Type G2 and level 1 with Integer Ring coefficients with 5 variables...</span>
<span class="go">Set up 10 hex and orthogonality constraints...</span>
<span class="go">Partitioned 10 equations into 2 components of size:</span>
<span class="go">[4, 1]</span>
<span class="go">Elimination epoch completed... 0 eqns remain in ideal basis</span>
<span class="go">Hex elim step solved for 4 / 5 variables</span>
<span class="go">Set up 0 reduced pentagons...</span>
<span class="go">Pent elim step solved for 4 / 5 variables</span>
<span class="go">Partitioned 0 equations into 0 components of size:</span>
<span class="go">[]</span>
<span class="go">Partitioned 1 equations into 1 components of size:</span>
<span class="go">[1]</span>
<span class="go">Computing appropriate NumberField...</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_qqbar_embedding</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fmat</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g1</span><span class="p">))</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="go">-0.618033988749895 + 1.46674215951686e-29*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.get_radical_expression">
<span class="sig-name descname"><span class="pre">get_radical_expression</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_radical_expression" title="Permalink to this definition">#</a></dt>
<dd><p>Return a radical expression of F-symbols.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">FR</span><span class="p">()</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">radical_fvars</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_radical_expression</span><span class="p">()</span>       <span class="c1"># long time (~1.5s)</span>
<span class="gp">sage: </span><span class="n">radical_fvars</span><span class="p">[</span><span class="n">g1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g0</span><span class="p">]</span>            <span class="c1"># long time</span>
<span class="go">-sqrt(1/2*sqrt(5) - 1/2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.largest_fmat_size">
<span class="sig-name descname"><span class="pre">largest_fmat_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.largest_fmat_size" title="Permalink to this definition">#</a></dt>
<dd><p>Get the size of the largest F-matrix <span class="math notranslate nohighlight">\(F^{abc}_d\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">largest_fmat_size</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.load_fvars">
<span class="sig-name descname"><span class="pre">load_fvars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.load_fvars" title="Permalink to this definition">#</a></dt>
<dd><p>Load previously computed F-symbols from a pickle file.</p>
<p>See <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars" title="sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_fvars()</span></code></a> for more information.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fvars</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_fvars</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">filename</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_fr_str</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;_solver_results.pickle&quot;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">save_fvars</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">del</span> <span class="n">f</span>
<span class="gp">sage: </span><span class="n">f2</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="o">.</span><span class="n">load_fvars</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fvars</span> <span class="o">==</span> <span class="n">f2</span><span class="o">.</span><span class="n">get_fvars</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">==</span> <span class="n">f2</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars" title="sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_fvars()</span></code></a>. This method does not work with intermediate
checkpoint pickles; it only works with pickles containing <em>all</em>
F-symbols, i.e. those created by <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars" title="sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_fvars()</span></code></a> and by
specifying an optional <code class="docutils literal notranslate"><span class="pre">save_results</span></code> parameter for
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars">
<span class="sig-name descname"><span class="pre">save_fvars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars" title="Permalink to this definition">#</a></dt>
<dd><p>Save computed F-symbols for later use.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filename</span></code> – a string specifying the name of the pickle file
to be used</p></li>
</ul>
<p>The current directory is used unless an absolute path to a file in
a different directory is provided.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method should only be used <em>after</em> successfully running one
of the solvers, e.g. <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_cyclotomic_solution()</span></code></a> or
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution" title="sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a>.</p>
</div>
<p>When used in conjunction with <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.load_fvars" title="sage.algebras.fusion_rings.f_matrix.FMatrix.load_fvars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_fvars()</span></code></a>, this method may
be used to restore state of an <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix" title="sage.algebras.fusion_rings.f_matrix.FMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">FMatrix</span></code></a> object at the end
of a successful F-matrix solver run.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">find_orthogonal_solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fvars</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_fvars</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">filename</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_fr_str</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;_solver_results.pickle&quot;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">save_fvars</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">del</span> <span class="n">f</span>
<span class="gp">sage: </span><span class="n">f2</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="o">.</span><span class="n">load_fvars</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fvars</span> <span class="o">==</span> <span class="n">f2</span><span class="o">.</span><span class="n">get_fvars</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">==</span> <span class="n">f2</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.shutdown_worker_pool">
<span class="sig-name descname"><span class="pre">shutdown_worker_pool</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.shutdown_worker_pool" title="Permalink to this definition">#</a></dt>
<dd><p>Shutdown the given worker pool and dispose of shared memory resources
created when the pool was set up using <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.start_worker_pool" title="sage.algebras.fusion_rings.f_matrix.FMatrix.start_worker_pool"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start_worker_pool()</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Failure to call this method after using <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.start_worker_pool" title="sage.algebras.fusion_rings.f_matrix.FMatrix.start_worker_pool"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start_worker_pool()</span></code></a>
to create a process pool may result in a memory
leak, since shared memory resources outlive the process that
created them.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">start_worker_pool</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">he</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s1">&#39;hexagons&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">shutdown_worker_pool</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.fusion_rings.f_matrix.FMatrix.start_worker_pool">
<span class="sig-name descname"><span class="pre">start_worker_pool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.start_worker_pool" title="Permalink to this definition">#</a></dt>
<dd><p>Initialize a <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> worker pool for parallel processing,
which may be used e.g. to set up defining equations using
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations" title="sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_defining_equations()</span></code></a>.</p>
<p>This method sets <code class="docutils literal notranslate"><span class="pre">self</span></code>’s <code class="docutils literal notranslate"><span class="pre">pool</span></code> attribute. The worker
pool may be used time and again. Upon initialization, each process
in the pool attaches to the necessary shared memory resources.</p>
<p>When you are done using the worker pool, use
<a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.shutdown_worker_pool" title="sage.algebras.fusion_rings.f_matrix.FMatrix.shutdown_worker_pool"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shutdown_worker_pool()</span></code></a> to close the pool and properly dispose
of shared memory resources.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Python 3.8+ is required, since the <code class="docutils literal notranslate"><span class="pre">multiprocessing.shared_memory</span></code>
module must be imported.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">processes</span></code> – an integer indicating the number of workers
in the pool; if left unspecified, the number of workers is
equals the number of processors available</p></li>
</ul>
<p>OUTPUT:</p>
<p>This method returns a boolean indicating whether a worker pool
was successfully initialized.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">get_fmatrix</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">start_worker_pool</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">he</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s1">&#39;hexagons&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">he</span><span class="p">)</span>
<span class="go">[fx0 - 1,</span>
<span class="go"> fx2*fx3 + (zeta60^14 + zeta60^12 - zeta60^6 - zeta60^4 + 1)*fx4^2 + (zeta60^6)*fx4,</span>
<span class="go"> fx1*fx3 + (zeta60^14 + zeta60^12 - zeta60^6 - zeta60^4 + 1)*fx3*fx4 + (zeta60^14 - zeta60^4)*fx3,</span>
<span class="go"> fx1*fx2 + (zeta60^14 + zeta60^12 - zeta60^6 - zeta60^4 + 1)*fx2*fx4 + (zeta60^14 - zeta60^4)*fx2,</span>
<span class="go"> fx1^2 + (zeta60^14 + zeta60^12 - zeta60^6 - zeta60^4 + 1)*fx2*fx3 + (-zeta60^12)*fx1]</span>
<span class="gp">sage: </span><span class="n">pe</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_defining_equations</span><span class="p">(</span><span class="s1">&#39;pentagons&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">shutdown_worker_pool</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is needed to initialize the worker pool using the
necessary shared memory resources. Simply using the
<code class="docutils literal notranslate"><span class="pre">multiprocessing.Pool</span></code> constructor will not work with our
class methods.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Failure to call <a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.shutdown_worker_pool" title="sage.algebras.fusion_rings.f_matrix.FMatrix.shutdown_worker_pool"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shutdown_worker_pool()</span></code></a> may result in a memory
leak, since shared memory resources outlive the process that created
them.</p>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="fusion_double.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">The Fusion Ring of the Drinfeld Double of a Finite Group</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="fusion_ring.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Fusion Rings</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">The F-Matrix of a Fusion Ring</a><ul>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix"><code class="docutils literal notranslate"><span class="pre">FMatrix</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.FR"><code class="docutils literal notranslate"><span class="pre">FR()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.attempt_number_field_computation"><code class="docutils literal notranslate"><span class="pre">attempt_number_field_computation()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.certify_pentagons"><code class="docutils literal notranslate"><span class="pre">certify_pentagons()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.clear_equations"><code class="docutils literal notranslate"><span class="pre">clear_equations()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.clear_vars"><code class="docutils literal notranslate"><span class="pre">clear_vars()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.equations_graph"><code class="docutils literal notranslate"><span class="pre">equations_graph()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.f_from"><code class="docutils literal notranslate"><span class="pre">f_from()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.f_to"><code class="docutils literal notranslate"><span class="pre">f_to()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.field"><code class="docutils literal notranslate"><span class="pre">field()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_cyclotomic_solution"><code class="docutils literal notranslate"><span class="pre">find_cyclotomic_solution()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.find_orthogonal_solution"><code class="docutils literal notranslate"><span class="pre">find_orthogonal_solution()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.findcases"><code class="docutils literal notranslate"><span class="pre">findcases()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmat"><code class="docutils literal notranslate"><span class="pre">fmat()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmatrix"><code class="docutils literal notranslate"><span class="pre">fmatrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fmats_are_orthogonal"><code class="docutils literal notranslate"><span class="pre">fmats_are_orthogonal()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.fvars_are_real"><code class="docutils literal notranslate"><span class="pre">fvars_are_real()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_coerce_map_from_fr_cyclotomic_field"><code class="docutils literal notranslate"><span class="pre">get_coerce_map_from_fr_cyclotomic_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_defining_equations"><code class="docutils literal notranslate"><span class="pre">get_defining_equations()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fr_str"><code class="docutils literal notranslate"><span class="pre">get_fr_str()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars"><code class="docutils literal notranslate"><span class="pre">get_fvars()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars_by_size"><code class="docutils literal notranslate"><span class="pre">get_fvars_by_size()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_fvars_in_alg_field"><code class="docutils literal notranslate"><span class="pre">get_fvars_in_alg_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_non_cyclotomic_roots"><code class="docutils literal notranslate"><span class="pre">get_non_cyclotomic_roots()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_orthogonality_constraints"><code class="docutils literal notranslate"><span class="pre">get_orthogonality_constraints()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_poly_ring"><code class="docutils literal notranslate"><span class="pre">get_poly_ring()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_qqbar_embedding"><code class="docutils literal notranslate"><span class="pre">get_qqbar_embedding()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.get_radical_expression"><code class="docutils literal notranslate"><span class="pre">get_radical_expression()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.largest_fmat_size"><code class="docutils literal notranslate"><span class="pre">largest_fmat_size()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.load_fvars"><code class="docutils literal notranslate"><span class="pre">load_fvars()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.save_fvars"><code class="docutils literal notranslate"><span class="pre">save_fvars()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.shutdown_worker_pool"><code class="docutils literal notranslate"><span class="pre">shutdown_worker_pool()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.fusion_rings.f_matrix.FMatrix.start_worker_pool"><code class="docutils literal notranslate"><span class="pre">start_worker_pool()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>