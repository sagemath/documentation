<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Base class for modular abelian varieties &mdash; Sage Reference Manual v7.4: Modular Abelian Varieties</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.4: Modular Abelian Varieties" href="../../../index.html" />
    <link rel="next" title="Ambient Jacobian Abelian Variety" href="abvar_ambient_jacobian.html" />
    <link rel="prev" title="Constructors for certain modular abelian varieties" href="constructor.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="abvar_ambient_jacobian.html" title="Ambient Jacobian Abelian Variety"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="constructor.html" title="Constructors for certain modular abelian varieties"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Modular Abelian Varieties</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="base-class-for-modular-abelian-varieties">
<span id="sage-modular-abvar-abvar"></span><h1>Base class for modular abelian varieties<a class="headerlink" href="#base-class-for-modular-abelian-varieties" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.modular.abvar.abvar"></span><p>AUTHORS:</p>
<ul class="simple">
<li>William Stein (2007-03)</li>
</ul>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">decomposition</span><span class="p">();</span> <span class="n">D</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33),</span>
<span class="go">Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33),</span>
<span class="go">Simple abelian subvariety 33a(1,33) of dimension 1 of J0(33)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">D</span><span class="p">))</span> <span class="o">==</span> <span class="n">D</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety">
<em class="property">class </em><code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">ModularAbelianVariety</code><span class="sig-paren">(</span><em>groups</em>, <em>lattice=None</em>, <em>base_field=Rational Field</em>, <em>is_simple=None</em>, <em>newform_level=None</em>, <em>isogeny_number=None</em>, <em>number=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract" title="sage.modular.abvar.abvar.ModularAbelianVariety_abstract"><code class="xref py py-class docutils literal"><span class="pre">sage.modular.abvar.abvar.ModularAbelianVariety_abstract</span></code></a></p>
<p>Create a modular abelian variety with given level and base field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">groups</span></code> - a tuple of congruence subgroups</li>
<li><code class="docutils literal"><span class="pre">lattice</span></code> - (default: <span class="math">\(\ZZ^n\)</span>) a
full lattice in <span class="math">\(\ZZ^n\)</span>, where <span class="math">\(n\)</span> is the
sum of the dimensions of the spaces of cuspidal modular symbols
corresponding to each <span class="math">\(\Gamma \in\)</span> groups</li>
<li><code class="docutils literal"><span class="pre">base_field</span></code> - a field (default:
<span class="math">\(\QQ\)</span>)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="go">Abelian variety J0(23) of dimension 2</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety.lattice">
<code class="descname">lattice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety.lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lattice that defines this abelian variety.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">lattice</span></code> - a lattice embedded in the rational
homology of the ambient product Jacobian</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">*</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">))[</span><span class="mi">1</span><span class="p">];</span> <span class="n">A</span>
<span class="go">Simple abelian subvariety 37a(1,37) of dimension 1 of J0(11) x J0(37)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.modular.abvar.abvar.ModularAbelianVariety_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">Free module of degree 6 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 0  0  1 -1  1  0]</span>
<span class="go">[ 0  0  0  0  2 -1]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract">
<em class="property">class </em><code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">ModularAbelianVariety_abstract</code><span class="sig-paren">(</span><em>groups</em>, <em>base_field</em>, <em>is_simple=None</em>, <em>newform_level=None</em>, <em>isogeny_number=None</em>, <em>number=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/parent_base.html#sage.structure.parent_base.ParentWithBase" title="(in Sage Reference Manual: Basic Structures v7.4)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.parent_base.ParentWithBase</span></code></a></p>
<p>Abstract base class for modular abelian varieties.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">groups</span></code> - a tuple of congruence subgroups</li>
<li><code class="docutils literal"><span class="pre">base_field</span></code> - a field</li>
<li><code class="docutils literal"><span class="pre">is_simple</span></code> - bool; whether or not self is
simple</li>
<li><code class="docutils literal"><span class="pre">newform_level</span></code> - if self is isogenous to a
newform abelian variety, returns the level of that abelian variety</li>
<li><code class="docutils literal"><span class="pre">isogeny_number</span></code> - which isogeny class the
corresponding newform is in; this corresponds to the Cremona letter
code</li>
<li><code class="docutils literal"><span class="pre">number</span></code> - the t number of the degeneracy map that
this abelian variety is the image under</li>
<li><code class="docutils literal"><span class="pre">check</span></code> - whether to do some type checking on the
defining data</li>
</ul>
<p>EXAMPLES: One should not create an instance of this class, but we
do so anyways here as an example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">ModularAbelianVariety_abstract</span><span class="p">((</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">37</span><span class="p">),),</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.modular.abvar.abvar.ModularAbelianVariety_abstract_with_category&#39;&gt;</span>
</pre></div>
</div>
<p>All hell breaks loose if you try to do anything with <span class="math">\(A\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span>
<span class="go">&lt;repr(&lt;sage.modular.abvar.abvar.ModularAbelianVariety_abstract_with_category at 0x...&gt;) failed: NotImplementedError: BUG -- lattice method must be defined in derived class&gt;</span>
</pre></div>
</div>
<p>All instances of this class are in the category of modular
abelian varieties:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of modular abelian varieties over Rational Field</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of modular abelian varieties over Rational Field</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.ambient_morphism">
<code class="descname">ambient_morphism</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.ambient_morphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the morphism from self to the ambient variety. This is
injective if self is natural a subvariety of the ambient product
Jacobian.</p>
<p>OUTPUT: morphism</p>
<p>The output is cached.</p>
<p>EXAMPLES: We compute the ambient structure morphism for an abelian
subvariety of <span class="math">\(J_0(33)\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ambient_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">Abelian variety J0(33) of dimension 3</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 1  1 -2  0  2 -1]</span>
<span class="go">[ 0  3 -2 -1  2  0]</span>
</pre></div>
</div>
<p>phi is of course injective</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">(Finite subgroup with invariants [] over QQ of Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33),</span>
<span class="go"> Abelian subvariety of dimension 0 of J0(33))</span>
</pre></div>
</div>
<p>This is the same as the basis matrix for the lattice corresponding
to self:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">Free module of degree 6 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 1  1 -2  0  2 -1]</span>
<span class="go">[ 0  3 -2 -1  2  0]</span>
</pre></div>
</div>
<p>We compute a non-injective map to an ambient space:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span><span class="n">pi</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">/</span><span class="n">A</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">ambient_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[  1   4   1   9  -1  -1]</span>
<span class="go">[  0  15   0   0  30 -75]</span>
<span class="go">[  0   0   5  10  -5  15]</span>
<span class="go">[  0   0   0  15 -15  30]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Finite subgroup with invariants [5, 15, 15] over QQ of Abelian variety factor of dimension 2 of J0(33)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.ambient_variety">
<code class="descname">ambient_variety</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.ambient_variety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ambient modular abelian variety that contains this
abelian variety. The ambient variety is always a product of
Jacobians of modular curves.</p>
<p>OUTPUT: abelian variety</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">A</span>
<span class="go">Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">ambient_variety</span><span class="p">()</span>
<span class="go">Abelian variety J0(33) of dimension 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.base_extend">
<code class="descname">base_extend</code><span class="sig-paren">(</span><em>K</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.base_extend" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">);</span> <span class="n">A</span>
<span class="go">Abelian variety J0(37) of dimension 2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)</span>
<span class="go">Abelian variety J0(37) over Algebraic Field of dimension 2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">Abelian variety J0(37) over Finite Field of size 7 of dimension 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.base_field">
<code class="descname">base_field</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.base_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Synonym for <code class="docutils literal"><span class="pre">self.base_ring()</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.change_ring">
<code class="descname">change_ring</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.change_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the base ring of this modular abelian variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Abelian variety J0(23) of dimension 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.complement">
<code class="descname">complement</code><span class="sig-paren">(</span><em>A=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a complement of this abelian variety.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">A</span></code> - (default: None); if given, A must be an
abelian variety that contains self, in which case the complement of
self is taken inside A. Otherwise the complement is taken in the
ambient product Jacobian.</li>
</ul>
<p>OUTPUT: abelian variety</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span>
<span class="go">Simple abelian subvariety 33a(1,33) of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span> <span class="o">==</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="go">Abelian subvariety of dimension 1 of J0(33)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.cuspidal_subgroup">
<code class="descname">cuspidal_subgroup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.cuspidal_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cuspidal subgroup of this modular abelian variety. This
is the subgroup generated by rational cusps.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">54</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">cuspidal_subgroup</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[[(1/3, 0, 0, 0, 0, 1/3, 0, 2/3)], [(0, 1/3, 0, 0, 0, 2/3, 0, 1/3)], [(0, 0, 1/9, 1/9, 1/9, 1/9, 1/9, 2/9)], [(0, 0, 0, 1/3, 0, 1/3, 0, 0)], [(0, 0, 0, 0, 1/3, 1/3, 0, 1/3)], [(0, 0, 0, 0, 0, 0, 1/3, 2/3)]]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>
<span class="go">[3, 3, 3, 3, 3, 9]</span>
<span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [19, 19] over QQ of Abelian variety J1(13) of dimension 2</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">cuspidal_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [5] over QQ of Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.decomposition">
<code class="descname">decomposition</code><span class="sig-paren">(</span><em>simple=True</em>, <em>bound=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sequence of abelian subvarieties of self that are all
simple, have finite intersection and sum to self.</p>
<p>INPUT: simple- bool (default: True) if True, all factors are
simple. If False, each factor returned is isogenous to a power of a
simple and the simples in each factor are distinct.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bound</span></code> - int (default: None) if given, only use
Hecke operators up to this bound when decomposing. This can give
wrong answers, so use with caution!</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_submodule</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">degeneracy_map</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">();</span> <span class="n">d3</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">degeneracy_map</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">submodule</span><span class="p">((</span><span class="n">d1</span> <span class="o">+</span> <span class="n">d3</span><span class="p">)</span><span class="o">.</span><span class="n">image</span><span class="p">(),</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">abelian_variety</span><span class="p">();</span> <span class="n">A</span>
<span class="go">Abelian subvariety of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">decomposition</span><span class="p">();</span> <span class="n">D</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">B</span>
<span class="go">Abelian subvariety of dimension 2 of J0(33)</span>
<span class="gp">sage: </span><span class="n">dd</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span> <span class="n">dd</span>
<span class="go">[</span>
<span class="go">Abelian subvariety of dimension 2 of J0(33)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">dd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">B</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">dd</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">decomposition</span><span class="p">();</span> <span class="n">dd</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33),</span>
<span class="go">Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span> <span class="o">==</span> <span class="n">B</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We decompose a product of two Jacobians:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span> <span class="o">*</span> <span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 11a(1,11) of dimension 1 of J0(33) x J0(11),</span>
<span class="go">Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33) x J0(11),</span>
<span class="go">Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33) x J0(11),</span>
<span class="go">Simple abelian subvariety 33a(1,33) of dimension 1 of J0(33) x J0(11)</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.degen_t">
<code class="descname">degen_t</code><span class="sig-paren">(</span><em>none_if_not_known=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.degen_t" title="Permalink to this definition">¶</a></dt>
<dd><p>If this abelian variety is obtained via decomposition then it gets
labeled with the newform label along with some information about
degeneracy maps. In particular, the label ends in a pair
<span class="math">\((t,N)\)</span>, where <span class="math">\(N\)</span> is the ambient level and
<span class="math">\(t\)</span> is an integer that divides the quotient of <span class="math">\(N\)</span>
by the newform level. This function returns the tuple
<span class="math">\((t,N)\)</span>, or raises a ValueError if self isn&#8217;t simple.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It need not be the case that self is literally equal to the
image of the newform abelian variety under the <span class="math">\(t^{th}\)</span>
degeneracy map. See the documentation for the label method
for more details.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">none_if_not_known</span></code> - (default: False) - if
True, return None instead of attempting to compute the degen map&#8217;s
<span class="math">\(t\)</span>, if it isn&#8217;t known. This None result is not cached.</li>
</ul>
<p>OUTPUT: a pair (integer, integer)</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">decomposition</span><span class="p">();</span> <span class="n">D</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33),</span>
<span class="go">Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33),</span>
<span class="go">Simple abelian subvariety 33a(1,33) of dimension 1 of J0(33)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">degen_t</span><span class="p">()</span>
<span class="go">(1, 33)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">degen_t</span><span class="p">()</span>
<span class="go">(3, 33)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">degen_t</span><span class="p">()</span>
<span class="go">(1, 33)</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">degen_t</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">self must be simple</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.degeneracy_map">
<code class="descname">degeneracy_map</code><span class="sig-paren">(</span><em>M_ls</em>, <em>t_ls</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.degeneracy_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degeneracy map with domain self and given
level/parameter. If self.ambient_variety() is a product of
Jacobians (as opposed to a single Jacobian), then one can provide a
list of new levels and parameters, corresponding to the ambient
Jacobians in order. (See the examples below.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M,</span> <span class="pre">t</span></code> - integers level and <span class="math">\(t\)</span>, or</li>
<li><code class="docutils literal"><span class="pre">Mlist,</span> <span class="pre">tlist</span></code> - if self is in a nontrivial
product ambient Jacobian, input consists of a list of levels and
corresponding list of <span class="math">\(t\)</span>&#8216;s.</li>
</ul>
<p>OUTPUT: a degeneracy map</p>
<p>EXAMPLES: We make several degeneracy maps related to
<span class="math">\(J_0(11)\)</span> and <span class="math">\(J_0(33)\)</span> and compute their
matrices.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d1</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">degeneracy_map</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">d1</span>
<span class="go">Degeneracy map from Abelian variety J0(11) of dimension 1 to Abelian variety J0(33) of dimension 3 defined by [1]</span>
<span class="gp">sage: </span><span class="n">d1</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 0 -3  2  1 -2  0]</span>
<span class="go">[ 1 -2  0  1  0 -1]</span>
<span class="gp">sage: </span><span class="n">d2</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">degeneracy_map</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="n">d2</span>
<span class="go">Degeneracy map from Abelian variety J0(11) of dimension 1 to Abelian variety J0(33) of dimension 3 defined by [3]</span>
<span class="gp">sage: </span><span class="n">d2</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[-1  0  0  0  1 -2]</span>
<span class="go">[-1 -1  1 -1  1  0]</span>
<span class="gp">sage: </span><span class="n">d3</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">degeneracy_map</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">d3</span>
<span class="go">Degeneracy map from Abelian variety J0(33) of dimension 3 to Abelian variety J0(11) of dimension 1 defined by [1]</span>
</pre></div>
</div>
<p>He we verify that first mapping from level <span class="math">\(11\)</span> to level
<span class="math">\(33\)</span>, then back is multiplication by <span class="math">\(4\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d1</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">d3</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[4 0]</span>
<span class="go">[0 4]</span>
</pre></div>
</div>
<p>We compute a more complicated degeneracy map involving nontrivial
product ambient Jacobians; note that this is just the block direct
sum of the two matrices at the beginning of this example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">*</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">degeneracy_map</span><span class="p">([</span><span class="mi">33</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">d</span>
<span class="go">Degeneracy map from Abelian variety J0(11) x J0(11) of dimension 2 to Abelian variety J0(33) x J0(33) of dimension 6 defined by [1, 3]</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 0 -3  2  1 -2  0  0  0  0  0  0  0]</span>
<span class="go">[ 1 -2  0  1  0 -1  0  0  0  0  0  0]</span>
<span class="go">[ 0  0  0  0  0  0 -1  0  0  0  1 -2]</span>
<span class="go">[ 0  0  0  0  0  0 -1 -1  1 -1  1  0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.degree">
<code class="descname">degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of this abelian variety, which is the dimension
of the ambient Jacobian product.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.dimension">
<code class="descname">dimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of this abelian variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.direct_product">
<code class="descname">direct_product</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.direct_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the direct product of self and other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self,</span> <span class="pre">other</span></code> - modular abelian varieties</li>
</ul>
<p>OUTPUT: abelian variety</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">direct_product</span><span class="p">(</span><span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="go">Abelian variety J0(11) x J1(13) of dimension 3</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">direct_product</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">1</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">Abelian subvariety of dimension 2 of J0(33) x J0(33)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">Free module of degree 12 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 1  1 -2  0  2 -1  0  0  0  0  0  0]</span>
<span class="go">[ 0  3 -2 -1  2  0  0  0  0  0  0  0]</span>
<span class="go">[ 0  0  0  0  0  0  1  0  0  0 -1  2]</span>
<span class="go">[ 0  0  0  0  0  0  0  1 -1  1  0 -2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.dual">
<code class="descname">dual</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.dual" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dual of this abelian variety.</p>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>dual abelian variety</li>
<li>morphism from self to dual</li>
<li>covering morphism from J to dual</li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is currently only implemented when self is an abelian
subvariety of the ambient Jacobian product, and the
complement of self in the ambient product Jacobian share no
common factors. A more general implementation will require
implementing computation of the intersection pairing on
integral homology and the resulting Weil pairing on
torsion.</p>
</div>
<p>EXAMPLES: We compute the dual of the elliptic curve newform abelian
variety of level <span class="math">\(33\)</span>, and find the kernel of the modular
map, which has structure <span class="math">\((\ZZ/3)^2\)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span>
<span class="go">Simple abelian subvariety 33a(1,33) of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">Cd</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[3 0]</span>
<span class="go">[0 3]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Finite subgroup with invariants [3, 3] over QQ of Simple abelian subvariety 33a(1,33) of dimension 1 of J0(33)</span>
</pre></div>
</div>
<p>By a theorem the modular degree must thus be <span class="math">\(3\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;33a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">modular_degree</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Next we compute the dual of a <span class="math">\(2\)</span>-dimensional new simple
abelian subvariety of <span class="math">\(J_0(43)\)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AbelianVariety</span><span class="p">(</span><span class="s1">&#39;43b&#39;</span><span class="p">);</span> <span class="n">A</span>
<span class="go">Newform abelian subvariety 43b of dimension 2 of J0(43)</span>
<span class="gp">sage: </span><span class="n">Ad</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
</pre></div>
</div>
<p>The kernel shows that the modular degree is <span class="math">\(2\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Finite subgroup with invariants [2, 2] over QQ of Newform abelian subvariety 43b of dimension 2 of J0(43)</span>
</pre></div>
</div>
<p>Unfortunately, the dual is not implemented in general:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">22</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">A</span>
<span class="go">Simple abelian subvariety 11a(1,22) of dimension 1 of J0(22)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">dual not implemented unless complement shares no simple factors with self.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.endomorphism_ring">
<code class="descname">endomorphism_ring</code><span class="sig-paren">(</span><em>category=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.endomorphism_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the endomorphism ring of self.</p>
<p>OUTPUT: b = self.sturm_bound()</p>
<p>EXAMPLES: We compute a few endomorphism rings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span>
<span class="go">Endomorphism ring of Abelian variety J0(11) of dimension 1</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span>
<span class="go">Endomorphism ring of Abelian variety J0(37) of dimension 2</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span>
<span class="go">Endomorphism ring of Simple abelian subvariety 33a(1,33) of dimension 1 of J0(33)</span>
</pre></div>
</div>
<p>No real computation is done:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">123456</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span>
<span class="go">Endomorphism ring of Abelian variety J1(123456) of dimension 423185857</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.finite_subgroup">
<code class="descname">finite_subgroup</code><span class="sig-paren">(</span><em>X</em>, <em>field_of_definition=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.finite_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a finite subgroup of this modular abelian variety.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">X</span></code> - list of elements of other finite subgroups
of this modular abelian variety or elements that coerce into the
rational homology (viewed as a rational vector space); also X could
be a finite subgroup itself that is contained in this abelian
variety.</li>
<li><code class="docutils literal"><span class="pre">field_of_definition</span></code> - (default: None) field
over which this group is defined. If None try to figure out the
best base field.</li>
</ul>
<p>OUTPUT: a finite subgroup of a modular abelian variety</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">finite_subgroup</span><span class="p">([[</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">Finite subgroup with invariants [15] over QQbar of Abelian variety J0(11) of dimension 1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">);</span> <span class="n">C</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cuspidal_subgroup</span><span class="p">();</span> <span class="n">C</span>
<span class="go">Finite subgroup with invariants [5] over QQ of Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">finite_subgroup</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">]])</span>
<span class="go">Finite subgroup with invariants [6] over QQbar of Abelian variety J0(33) of dimension 3</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">finite_subgroup</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">Finite subgroup with invariants [5] over QQ of Abelian variety J0(33) of dimension 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.free_module">
<code class="descname">free_module</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.free_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Synonym for <code class="docutils literal"><span class="pre">self.lattice()</span></code>.</p>
<p>OUTPUT: a free module over <span class="math">\(\ZZ\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Ambient free module of rank 4 over the principal ideal domain Integer Ring</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 1 -1  1  0]</span>
<span class="go">[ 0  0  2 -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.groups">
<code class="descname">groups</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ordered tuple of the congruence subgroups that the
ambient product Jacobian is attached to.</p>
<p>Every modular abelian variety is a finite quotient of an abelian
subvariety of a product of modular Jacobians <span class="math">\(J_\Gamma\)</span>.
This function returns a tuple containing the groups
<span class="math">\(\Gamma\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span> <span class="o">*</span> <span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">))[</span><span class="mi">0</span><span class="p">];</span> <span class="n">A</span>
<span class="go">Simple abelian subvariety 13aG1(1,13) of dimension 2 of J0(37) x J1(13)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="go">(Congruence Subgroup Gamma0(37), Congruence Subgroup Gamma1(13))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.hecke_operator">
<code class="descname">hecke_operator</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.hecke_operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(n^{th}\)</span> Hecke operator on the modular abelian
variety, if this makes sense [[elaborate]]. Otherwise raise a
ValueError.</p>
<p>EXAMPLES: We compute <span class="math">\(T_2\)</span> on <span class="math">\(J_0(37)\)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t2</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">hecke_operator</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">t2</span>
<span class="go">Hecke operator T_2 on Abelian variety J0(37) of dimension 2</span>
<span class="gp">sage: </span><span class="n">t2</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">x * (x + 2)</span>
<span class="gp">sage: </span><span class="n">t2</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Note that there is no matrix associated to Hecke operators on
modular abelian varieties. For a matrix, instead consider, e.g.,
the Hecke operator on integral or rational homology.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t2</span><span class="o">.</span><span class="n">action_on_homology</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[-1  1  1 -1]</span>
<span class="go">[ 1 -1  1  0]</span>
<span class="go">[ 0  0 -2  1]</span>
<span class="go">[ 0  0  0  0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.hecke_polynomial">
<code class="descname">hecke_polynomial</code><span class="sig-paren">(</span><em>n</em>, <em>var='x'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.hecke_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the characteristic polynomial of the <span class="math">\(n^{th}\)</span> Hecke
operator <span class="math">\(T_n\)</span> acting on self. Raises an ArithmeticError
if self is not Hecke equivariant.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">n</span></code> - integer <span class="math">\(\geq 1\)</span></li>
<li><code class="docutils literal"><span class="pre">var</span></code> - string (default: &#8216;x&#8217;); valid variable
name</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">hecke_polynomial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^3 + 3*x^2 - 4</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">hecke_polynomial</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">);</span> <span class="n">f</span>
<span class="go">y^3 + 3*y^2 - 4</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in y over Rational Field</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hecke_polynomial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">x + 1</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hecke_polynomial</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">x - 1</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hecke_polynomial</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">x - 1</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hecke_polynomial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">subspace is not invariant under matrix</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.homology">
<code class="descname">homology</code><span class="sig-paren">(</span><em>base_ring=Integer Ring</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.homology" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the homology of this modular abelian variety.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">For efficiency reasons the basis of the integral homology
need not be the same as the basis for the rational
homology.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">homology</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">Homology with coefficients in Finite Field of size 7 of Abelian variety J0(389) of dimension 32</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">homology</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Rational Homology of Abelian variety J0(389) of dimension 32</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">homology</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">Integral Homology of Abelian variety J0(389) of dimension 32</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.in_same_ambient_variety">
<code class="descname">in_same_ambient_variety</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.in_same_ambient_variety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self and other are abelian subvarieties of the same
ambient product Jacobian.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">in_same_ambient_variety</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">in_same_ambient_variety</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.integral_homology">
<code class="descname">integral_homology</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.integral_homology" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integral homology of this modular abelian variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">integral_homology</span><span class="p">();</span> <span class="n">H</span>
<span class="go">Integral Homology of Abelian variety J0(43) of dimension 3</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">J1</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">integral_homology</span><span class="p">();</span> <span class="n">H</span>
<span class="go">Integral Homology of Abelian variety J1(17) of dimension 5</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<p>If you just ask for the rank of the homology, no serious
calculations are done, so the following is fast:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span><span class="o">.</span><span class="n">integral_homology</span><span class="p">();</span> <span class="n">H</span>
<span class="go">Integral Homology of Abelian variety J0(50000) of dimension 7351</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">14702</span>
</pre></div>
</div>
<p>A product:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">*</span> <span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">.</span><span class="n">integral_homology</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">hecke_operator</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Hecke operator T_2 on Integral Homology of Abelian variety J0(11) x J1(13) of dimension 3</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">hecke_operator</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[-2  0  0  0  0  0]</span>
<span class="go">[ 0 -2  0  0  0  0]</span>
<span class="go">[ 0  0 -2  0 -1  1]</span>
<span class="go">[ 0  0  1 -1  0 -1]</span>
<span class="go">[ 0  0  1  1 -2  0]</span>
<span class="go">[ 0  0  0  1 -1 -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.intersection">
<code class="descname">intersection</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the intersection of self and other inside a common ambient
Jacobian product.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> - a modular abelian variety or a finite
group</li>
</ul>
<p>OUTPUT: If other is a modular abelian variety:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">G</span></code> - finite subgroup of self</li>
<li><code class="docutils literal"><span class="pre">A</span></code> - abelian variety (identity component of
intersection) If other is a finite group:</li>
<li><code class="docutils literal"><span class="pre">G</span></code> - a finite group</li>
</ul>
<p>EXAMPLES: We intersect some abelian varieties with finite
intersection.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(Finite subgroup with invariants [2, 2] over QQ of Simple abelian subvariety 37a(1,37) of dimension 1 of J0(37), Simple abelian subvariety of dimension 0 of J0(37))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">65</span><span class="p">));</span> <span class="n">D</span>
<span class="go">[Simple abelian subvariety 65a(1,65) of dimension 1 of J0(65), Simple abelian subvariety 65b(1,65) of dimension 2 of J0(65), Simple abelian subvariety 65c(1,65) of dimension 2 of J0(65)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(Finite subgroup with invariants [2] over QQ of Simple abelian subvariety 65a(1,65) of dimension 1 of J0(65), Simple abelian subvariety of dimension 0 of J0(65))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">D</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(Finite subgroup with invariants [2] over QQbar of Abelian subvariety of dimension 3 of J0(65), Abelian subvariety of dimension 2 of J0(65))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(Finite subgroup with invariants [5] over QQ of Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33), Simple abelian subvariety of dimension 0 of J0(33))</span>
</pre></div>
</div>
<p>Next we intersect two abelian varieties with non-finite
intersection:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">67</span><span class="p">);</span> <span class="n">D</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">decomposition</span><span class="p">();</span> <span class="n">D</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 67a(1,67) of dimension 1 of J0(67),</span>
<span class="go">Simple abelian subvariety 67b(1,67) of dimension 2 of J0(67),</span>
<span class="go">Simple abelian subvariety 67c(1,67) of dimension 2 of J0(67)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">D</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(Finite subgroup with invariants [5, 10] over QQbar of Abelian subvariety of dimension 3 of J0(67), Abelian subvariety of dimension 2 of J0(67))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.is_ambient">
<code class="descname">is_ambient</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.is_ambient" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self equals the ambient product Jacobian.</p>
<p>OUTPUT: bool</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_ambient</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">is_ambient</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">is_ambient</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="p">)</span><span class="o">.</span><span class="n">is_ambient</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.is_hecke_stable">
<code class="descname">is_hecke_stable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.is_hecke_stable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is stable under the Hecke operators of its
ambient Jacobian.</p>
<p>OUTPUT: bool</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">is_hecke_stable</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">is_hecke_stable</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_hecke_stable</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_hecke_stable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.is_simple">
<code class="descname">is_simple</code><span class="sig-paren">(</span><em>none_if_not_known=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.is_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether or not this modular abelian variety is simple, i.e.,
has no proper nonzero abelian subvarieties.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">none_if_not_known</span></code> - bool (default: False); if
True then this function may return None instead of True of False if
we don&#8217;t already know whether or not self is simple.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_simple</span><span class="p">(</span><span class="n">none_if_not_known</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>  <span class="c1"># this may fail if J0(5) comes up elsewhere...</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">is_simple</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">is_simple</span><span class="p">(</span><span class="n">none_if_not_known</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_simple</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">is_simple</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.is_subvariety">
<code class="descname">is_subvariety</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.is_subvariety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is a subvariety of other as they sit in a
common ambient modular Jacobian. In particular, this function will
only return True if self and other have exactly the same ambient
Jacobians.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Abelian variety J0(37) of dimension 2</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">A</span>
<span class="go">Simple abelian subvariety 37a(1,37) of dimension 1 of J0(37)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_subvariety</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_subvariety</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.is_subvariety_of_ambient_jacobian">
<code class="descname">is_subvariety_of_ambient_jacobian</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.is_subvariety_of_ambient_jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is (presented as) a subvariety of the ambient
product Jacobian.</p>
<p>Every abelian variety in Sage is a quotient of a subvariety of an
ambient Jacobian product by a finite subgroup.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">is_subvariety_of_ambient_jacobian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">A</span>
<span class="go">Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_subvariety_of_ambient_jacobian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">A</span> <span class="o">/</span> <span class="n">A</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span>
<span class="go">Abelian variety factor of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[2 0]</span>
<span class="go">[0 2]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_subvariety_of_ambient_jacobian</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.isogeny_number">
<code class="descname">isogeny_number</code><span class="sig-paren">(</span><em>none_if_not_known=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.isogeny_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number (starting at 0) of the isogeny class of new
simple abelian varieties that self is in. If self is not simple,
raises a ValueError exception.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">none_if_not_known</span></code> - bool (default: False); if
True then this function may return None instead of True of False if
we don&#8217;t already know the isogeny number of self.</li>
</ul>
<p>EXAMPLES: We test the none_if_not_known flag first:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">isogeny_number</span><span class="p">(</span><span class="n">none_if_not_known</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Of course, <span class="math">\(J_0(33)\)</span> is not simple, so this function
raises a ValueError:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">isogeny_number</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">self must be simple</span>
</pre></div>
</div>
<p>Each simple factor has isogeny number 1, since that&#8217;s the number at
which the factor is new.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isogeny_number</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">isogeny_number</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Next consider <span class="math">\(J_0(37)\)</span> where there are two distinct
newform factors:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isogeny_number</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.label">
<code class="descname">label</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the label associated to this modular abelian variety.</p>
<p>The format of the label is [level][isogeny class][group](t, ambient
level)</p>
<p>If this abelian variety <span class="math">\(B\)</span> has the above label, this
implies only that <span class="math">\(B\)</span> is isogenous to the newform abelian
variety <span class="math">\(A_f\)</span> associated to the newform with label
[level][isogeny class][group]. The [group] is empty for
<span class="math">\(\Gamma_0(N)\)</span>, is G1 for <span class="math">\(\Gamma_1(N)\)</span> and is
GH[...] for <span class="math">\(\Gamma_H(N)\)</span>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The sum of <span class="math">\(\delta_s(A_f)\)</span> for all <span class="math">\(s\mid t\)</span>
contains <span class="math">\(A\)</span>, but no sum for a proper divisor of
<span class="math">\(t\)</span> contains <span class="math">\(A\)</span>. It need <em>not</em> be the case
that <span class="math">\(B\)</span> is equal to <span class="math">\(\delta_t(A_f)\)</span>!!!</p>
</div>
<p>OUTPUT: string</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">label</span><span class="p">()</span>
<span class="go">&#39;11a(1,11)&#39;</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">()</span>
<span class="go">&#39;11a(1,11)&#39;</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">()</span>
<span class="go">&#39;33a(1,33)&#39;</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span><span class="o">.</span><span class="n">label</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">self must be simple</span>
</pre></div>
</div>
<p>We illustrate that self need not equal <span class="math">\(\delta_t(A_f)\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">degeneracy_map</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">J</span><span class="o">.</span><span class="n">degeneracy_map</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">image</span><span class="p">();</span> <span class="n">B</span>
<span class="go">Abelian subvariety of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">degeneracy_map</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">image</span><span class="p">();</span> <span class="n">C</span>
<span class="go">Abelian subvariety of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">==</span> <span class="n">B</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.lattice">
<code class="descname">lattice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return lattice in ambient cuspidal modular symbols product that
defines this modular abelian variety.</p>
<p>This must be defined in each derived class.</p>
<p>OUTPUT: a free module over <span class="math">\(\ZZ\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">ModularAbelianVariety_abstract</span><span class="p">((</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">37</span><span class="p">),),</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">&lt;repr(&lt;sage.modular.abvar.abvar.ModularAbelianVariety_abstract_with_category at 0x...&gt;) failed: NotImplementedError: BUG -- lattice method must be defined in derived class&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.level">
<code class="descname">level</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.level" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level of this modular abelian variety, which is an
integer N (usually minimal) such that this modular abelian variety
is a quotient of <span class="math">\(J_1(N)\)</span>. In the case that the ambient
variety of self is a product of Jacobians, return the LCM of their
levels.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">5077</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">5077</span>
<span class="gp">sage: </span><span class="n">JH</span><span class="p">(</span><span class="mi">389</span><span class="p">,[</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">389</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">*</span><span class="n">J0</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">187</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.lseries">
<code class="descname">lseries</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.lseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the complex <span class="math">\(L\)</span>-series of this modular abelian
variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">lseries</span><span class="p">()</span>
<span class="go">Complex L-series attached to Abelian variety J0(37) of dimension 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.modular_degree">
<code class="descname">modular_degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.modular_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the modular degree of this abelian variety, which is the
square root of the degree of the modular kernel.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AbelianVariety</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">modular_degree</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.modular_kernel">
<code class="descname">modular_kernel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.modular_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the modular kernel of this abelian variety, which is the
kernel of the canonical polarization of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AbelianVariety</span><span class="p">(</span><span class="s1">&#39;33a&#39;</span><span class="p">);</span> <span class="n">A</span>
<span class="go">Newform abelian subvariety 33a of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">modular_kernel</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [3, 3] over QQ of Newform abelian subvariety 33a of dimension 1 of J0(33)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.newform_label">
<code class="descname">newform_label</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.newform_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the label [level][isogeny class][group] of the newform
<span class="math">\(f\)</span> such that this abelian variety is isogenous to the
newform abelian variety <span class="math">\(A_f\)</span>. If this abelian variety is
not simple, raise a ValueError.</p>
<p>OUTPUT: string</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">newform_label</span><span class="p">()</span>
<span class="go">&#39;11a&#39;</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">newform_label</span><span class="p">()</span>
<span class="go">&#39;33a&#39;</span>
</pre></div>
</div>
<p>The following fails since <span class="math">\(J_0(33)\)</span> is not simple:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">newform_label</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">self must be simple</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.newform_level">
<code class="descname">newform_level</code><span class="sig-paren">(</span><em>none_if_not_known=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.newform_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Write self as a product (up to isogeny) of newform abelian
varieties <span class="math">\(A_f\)</span>. Then this function return the least
common multiple of the levels of the newforms <span class="math">\(f\)</span>, along
with the corresponding group or list of groups (the groups do not
appear with multiplicity).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">none_if_not_known</span></code> - (default: False) if True,
return None instead of attempting to compute the newform level, if
it isn&#8217;t already known. This None result is not cached.</li>
</ul>
<p>OUTPUT: integer group or list of distinct groups</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">newform_level</span><span class="p">()</span>
<span class="go">(11, Congruence Subgroup Gamma0(33))</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">newform_level</span><span class="p">(</span><span class="n">none_if_not_known</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(11, Congruence Subgroup Gamma0(33))</span>
</pre></div>
</div>
<p>Here there are multiple groups since there are in fact multiple
newforms:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">*</span> <span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">.</span><span class="n">newform_level</span><span class="p">()</span>
<span class="go">(143, [Congruence Subgroup Gamma0(11), Congruence Subgroup Gamma1(13)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.padic_lseries">
<code class="descname">padic_lseries</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.padic_lseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(p\)</span>-adic <span class="math">\(L\)</span>-series of this modular
abelian variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">padic_lseries</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">7-adic L-series attached to Abelian variety J0(37) of dimension 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.project_to_factor">
<code class="descname">project_to_factor</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.project_to_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>If self is an ambient product of Jacobians, return a projection
from self to the nth such Jacobian.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">project_to_factor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Abelian variety endomorphism of Abelian variety J0(33) of dimension 3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span> <span class="o">*</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span> <span class="o">*</span> <span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">project_to_factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Abelian variety morphism:</span>
<span class="go">  From: Abelian variety J0(33) x J0(37) x J0(11) of dimension 6</span>
<span class="go">  To:   Abelian variety J0(11) of dimension 1</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">project_to_factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.projection">
<code class="descname">projection</code><span class="sig-paren">(</span><em>A</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an abelian subvariety A of self, return a projection morphism
from self to A. Note that this morphism need not be unique.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">A</span></code> - an abelian variety</li>
</ul>
<p>OUTPUT: a morphism</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="n">pi</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 3 -2]</span>
<span class="go">[-5  5]</span>
<span class="go">[-4  1]</span>
<span class="go">[ 3 -2]</span>
<span class="go">[ 5  0]</span>
<span class="go">[ 1  1]</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="n">pi</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 0  0]</span>
<span class="go">[-3  2]</span>
<span class="go">[-4  1]</span>
<span class="go">[-1 -1]</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="n">pi</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
</pre></div>
</div>
<p>We project onto a factor in a product of two Jacobians:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">*</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span> <span class="n">A</span>
<span class="go">Abelian variety J0(11) x J0(11) of dimension 2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Simple abelian subvariety 11a(1,11) of dimension 1 of J0(11) x J0(11)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Abelian variety morphism:</span>
<span class="go">  From: Abelian variety J0(11) x J0(11) of dimension 2</span>
<span class="go">  To:   Simple abelian subvariety 11a(1,11) of dimension 1 of J0(11) x J0(11)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.qbar_torsion_subgroup">
<code class="descname">qbar_torsion_subgroup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.qbar_torsion_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the group of all points of finite order in the algebraic
closure of this abelian variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">qbar_torsion_subgroup</span><span class="p">();</span> <span class="n">T</span>
<span class="go">Group of all torsion points in QQbar on Abelian variety J0(33) of dimension 3</span>
</pre></div>
</div>
<p>The field of definition is the same as the base field of the
abelian variety.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">field_of_definition</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
<p>On the other hand, T is a module over <span class="math">\(\ZZ\)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.quotient">
<code class="descname">quotient</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.quotient" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the quotient of self and other, where other is either an
abelian subvariety of self or a finite subgroup of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> - a finite subgroup or subvariety</li>
</ul>
<p>OUTPUT: a pair (A, phi) with phi the quotient map from self to A</p>
<p>EXAMPLES: We quotient <span class="math">\(J_0(33)\)</span> out by an abelian
subvariety:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">quotient</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Abelian variety factor of dimension 2 of J0(33)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">Abelian variety morphism:</span>
<span class="go">  From: Abelian variety J0(33) of dimension 3</span>
<span class="go">  To:   Abelian variety factor of dimension 2 of J0(33)</span>
</pre></div>
</div>
<p>We quotient <span class="math">\(J_0(33)\)</span> by the cuspidal subgroup:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_subgroup</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">quotient</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Abelian variety factor of dimension 3 of J0(33)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Finite subgroup with invariants [10, 10] over QQ of Abelian variety J0(33) of dimension 3</span>
<span class="gp">sage: </span><span class="n">C</span>
<span class="go">Finite subgroup with invariants [10, 10] over QQ of Abelian variety J0(33) of dimension 3</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">direct_product</span><span class="p">(</span><span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="go">Abelian variety J0(11) x J1(13) of dimension 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.rank">
<code class="descname">rank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rank of the underlying lattice of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.rational_cusp_subgroup">
<code class="descname">rational_cusp_subgroup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.rational_cusp_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the subgroup of this modular abelian variety generated by
rational cusps.</p>
<p>This is a subgroup of the group of rational points in the cuspidal
subgroup.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is only currently implemented for
<span class="math">\(\Gamma_0(N)\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">54</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CQ</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">rational_cusp_subgroup</span><span class="p">();</span> <span class="n">CQ</span>
<span class="go">Finite subgroup with invariants [3, 3, 9] over QQ of Abelian variety J0(54) of dimension 4</span>
<span class="gp">sage: </span><span class="n">CQ</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[[(1/3, 0, 0, 1/3, 2/3, 1/3, 0, 1/3)], [(0, 0, 1/9, 1/9, 7/9, 7/9, 1/9, 8/9)], [(0, 0, 0, 0, 0, 0, 1/3, 2/3)]]</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">CQ</span><span class="o">.</span><span class="n">order</span><span class="p">())</span>
<span class="go">3^4</span>
<span class="gp">sage: </span><span class="n">CQ</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>
<span class="go">[3, 3, 9]</span>
</pre></div>
</div>
<p>In this example the rational cuspidal subgroup and the cuspidal
subgroup differ by a lot.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">49</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">cuspidal_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [2, 14] over QQ of Abelian variety J0(49) of dimension 1</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">rational_cusp_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [2] over QQ of Abelian variety J0(49) of dimension 1</span>
</pre></div>
</div>
<p>Note that computation of the rational cusp subgroup isn&#8217;t
implemented for <span class="math">\(\Gamma_1\)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">cuspidal_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [19, 19] over QQ of Abelian variety J1(13) of dimension 2</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">rational_cusp_subgroup</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">computation of rational cusps only implemented in Gamma0 case.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.rational_cuspidal_subgroup">
<code class="descname">rational_cuspidal_subgroup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.rational_cuspidal_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rational subgroup of the cuspidal subgroup of this
modular abelian variety.</p>
<p>This is a subgroup of the group of rational points in the
cuspidal subgroup.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is only currently implemented for
<span class="math">\(\Gamma_0(N)\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">54</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CQ</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">rational_cuspidal_subgroup</span><span class="p">();</span> <span class="n">CQ</span>
<span class="go">Finite subgroup with invariants [3, 3, 9] over QQ of Abelian variety J0(54) of dimension 4</span>
<span class="gp">sage: </span><span class="n">CQ</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[[(1/3, 0, 0, 1/3, 2/3, 1/3, 0, 1/3)], [(0, 0, 1/9, 1/9, 7/9, 7/9, 1/9, 8/9)], [(0, 0, 0, 0, 0, 0, 1/3, 2/3)]]</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">CQ</span><span class="o">.</span><span class="n">order</span><span class="p">())</span>
<span class="go">3^4</span>
<span class="gp">sage: </span><span class="n">CQ</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>
<span class="go">[3, 3, 9]</span>
</pre></div>
</div>
<p>In this example the rational cuspidal subgroup and the cuspidal
subgroup differ by a lot.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">49</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">cuspidal_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [2, 14] over QQ of Abelian variety J0(49) of dimension 1</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">rational_cuspidal_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [2] over QQ of Abelian variety J0(49) of dimension 1</span>
</pre></div>
</div>
<p>Note that computation of the rational cusp subgroup isn&#8217;t
implemented for <span class="math">\(\Gamma_1\)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">cuspidal_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [19, 19] over QQ of Abelian variety J1(13) of dimension 2</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">rational_cuspidal_subgroup</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">only implemented when group is Gamma0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.rational_homology">
<code class="descname">rational_homology</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.rational_homology" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rational homology of this modular abelian variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">rational_homology</span><span class="p">();</span> <span class="n">H</span>
<span class="go">Rational Homology of Abelian variety J0(37) of dimension 2</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">J1</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">rational_homology</span><span class="p">();</span> <span class="n">H</span>
<span class="go">Rational Homology of Abelian variety J1(17) of dimension 5</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.rational_torsion_subgroup">
<code class="descname">rational_torsion_subgroup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.rational_torsion_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximal torsion subgroup of self defined over QQ.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">new_subvariety</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">Abelian subvariety of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">rational_torsion_subgroup</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">multiple_of_order</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">divisor_of_order</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[[(1/2, 0, 0, -1/2, 0, 0)], [(0, 0, 1/2, 0, 1/2, -1/2)]]</span>
<span class="gp">sage: </span><span class="n">t</span>
<span class="go">Torsion subgroup of Abelian subvariety of dimension 1 of J0(33)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.shimura_subgroup">
<code class="descname">shimura_subgroup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.shimura_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Shimura subgroup of this modular abelian variety. This is
the kernel of <span class="math">\(J_0(N) \rightarrow J_1(N)\)</span> under the natural map.
Here we compute the Shimura subgroup as the kernel of
<span class="math">\(J_0(N) \rightarrow J_0(Np)\)</span> where the map is the difference between the
two degeneracy maps.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span><span class="o">=</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">shimura_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [5] over QQ of Abelian variety J0(11) of dimension 1</span>

<span class="gp">sage: </span><span class="n">J</span><span class="o">=</span><span class="n">J0</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">J</span><span class="o">.</span><span class="n">cuspidal_subgroup</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Finite subgroup with invariants [4] over QQ of Abelian variety J0(17) of dimension 1</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">=</span><span class="n">J</span><span class="o">.</span><span class="n">shimura_subgroup</span><span class="p">();</span> <span class="n">S</span>
<span class="go">Finite subgroup with invariants [4] over QQ of Abelian variety J0(17) of dimension 1</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Finite subgroup with invariants [2] over QQ of Abelian variety J0(17) of dimension 1</span>

<span class="gp">sage: </span><span class="n">J</span><span class="o">=</span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">=</span><span class="n">J</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">shimura_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [5] over QQ of Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">shimura_subgroup</span><span class="p">()</span>
<span class="go">Finite subgroup with invariants [10] over QQ of Abelian variety J0(33) of dimension 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.sturm_bound">
<code class="descname">sturm_bound</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.sturm_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a bound <span class="math">\(B\)</span> such that all Hecke operators
<span class="math">\(T_n\)</span> for <span class="math">\(n\leq B\)</span> generate the Hecke algebra.</p>
<p>OUTPUT: integer</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">sturm_bound</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">sturm_bound</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">sturm_bound</span><span class="p">()</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">123456</span><span class="p">)</span><span class="o">.</span><span class="n">sturm_bound</span><span class="p">()</span>
<span class="go">1693483008</span>
<span class="gp">sage: </span><span class="n">JH</span><span class="p">(</span><span class="mi">37</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">sturm_bound</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">sturm_bound</span><span class="p">()</span>
<span class="go">228</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.torsion_subgroup">
<code class="descname">torsion_subgroup</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.torsion_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>If n is an integer, return the subgroup of points of order n.
Return the <span class="math">\(n\)</span>-torsion subgroup of elements of order
dividing <span class="math">\(n\)</span> of this modular abelian variety <span class="math">\(A\)</span>,
i.e., the group <span class="math">\(A[n]\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="go">Finite subgroup with invariants [19, 19, 19, 19] over QQ of Abelian variety J1(13) of dimension 2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Finite subgroup with invariants [5, 5, 5, 5] over QQ of Abelian variety J0(23) of dimension 2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">625</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[[(1/5, 0, 0, 0)], [(0, 1/5, 0, 0)], [(0, 0, 1/5, 0)], [(0, 0, 0, 1/5)]]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">16</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.vector_space">
<code class="descname">vector_space</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.vector_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return vector space corresponding to the modular abelian variety.</p>
<p>This is the lattice tensored with <span class="math">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">vector_space</span><span class="p">()</span>
<span class="go">Vector space of dimension 4 over Rational Field</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vector_space</span><span class="p">()</span>
<span class="go">Vector space of degree 4 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[   1   -1    0  1/2]</span>
<span class="go">[   0    0    1 -1/2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.zero_subgroup">
<code class="descname">zero_subgroup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.zero_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the zero subgroup of this modular abelian variety, as a
finite group.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span><span class="n">J0</span><span class="p">(</span><span class="mi">54</span><span class="p">);</span> <span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">zero_subgroup</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Finite subgroup with invariants [] over QQ of Abelian variety J0(54) of dimension 4</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_subgroup</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_abstract.zero_subvariety">
<code class="descname">zero_subvariety</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract.zero_subvariety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the zero subvariety of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">zero_subvariety</span><span class="p">()</span>
<span class="go">Simple abelian subvariety of dimension 0 of J0(37)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">zero_subvariety</span><span class="p">()</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">37</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">zero_subvariety</span><span class="p">()</span><span class="o">.</span><span class="n">newform_level</span><span class="p">()</span>
<span class="go">(1, [])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym">
<em class="property">class </em><code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">ModularAbelianVariety_modsym</code><span class="sig-paren">(</span><em>modsym</em>, <em>lattice=None</em>, <em>newform_level=None</em>, <em>is_simple=None</em>, <em>isogeny_number=None</em>, <em>number=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract" title="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract"><code class="xref py py-class docutils literal"><span class="pre">sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract</span></code></a></p>
<p>Modular abelian variety that corresponds to a Hecke stable space of
cuspidal modular symbols.</p>
<p>EXAMPLES: We create a modular abelian variety attached to a space
of modular symbols.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_submodule</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">abelian_variety</span><span class="p">();</span> <span class="n">A</span>
<span class="go">Abelian variety J0(23) of dimension 2</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym.brandt_module">
<code class="descname">brandt_module</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym.brandt_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Brandt module at p that corresponds to self.  This
is the factor of the vector space on the ideal class set in an
order of level N in the quaternion algebra ramified at p and
infinity.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>p &#8211; prime that exactly divides the level</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>Brandt module space that corresponds to self.</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">43</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="go">Subspace of dimension 2 of Brandt module of dimension 4 of level 43 of weight 2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">43</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((1, 0, -1/2, -1/2), (0, 1, -1/2, -1/2))</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">43</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((0, 0, 1, -1),)</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">35</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((1, 0, -1, 0),)</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">35</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((1, -1, 1, -1),)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym.component_group_order">
<code class="descname">component_group_order</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym.component_group_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of the component group of the special fiber
at p of the Neron model of self.</p>
<p>NOTE: For bad primes, this is only implemented when the group
if Gamma0 and p exactly divides the level.</p>
<p>NOTE: the input abelian variety must be simple</p>
<p>ALGORITHM: See &#8220;Component Groups of Quotients of J0(N)&#8221; by Kohel and Stein.  That
paper is about optimal quotients; however, section 4.1 of Conrad-Stein &#8220;Component
Groups of Purely Toric Quotients&#8221;, one sees that the component group of an optimal
quotient is the same as the component group of its dual (which is the subvariety).</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>p &#8211; a prime number</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>Integer</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">component_group_order</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">43</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">component_group_order</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">component_group_order</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">component_group_order</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym.tamagawa_number">
<code class="descname">tamagawa_number</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym.tamagawa_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Tamagawa number of this abelian variety at p.</p>
<p>NOTE: For bad primes, this is only implemented when the group
if Gamma0 and p exactly divides the level and Atkin-Lehner
acts diagonally on this abelian variety (e.g., if this variety
is new and simple).  See the self.component_group command for
more information.</p>
<p>NOTE: the input abelian variety must be simple</p>
<p>In cases where this function doesn&#8217;t work, consider using the
self.tamagawa_number_bounds functions.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>p &#8211; a prime number</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>Integer</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">tamagawa_number</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">43</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">tamagawa_number</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">tamagawa_number</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">tamagawa_number</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym.tamagawa_number_bounds">
<code class="descname">tamagawa_number_bounds</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym.tamagawa_number_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a divisor and multiple of the Tamagawa number of self at p.</p>
<p>NOTE: the input abelian variety must be simple</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>p &#8211; a prime number</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>div &#8211; integer; divisor of Tamagawa number at p</li>
<li>mul &#8211; integer; multiple of Tamagawa number at p</li>
<li>mul_primes &#8211; tuple; in case mul==0, a list of all
primes that can possibly divide the Tamagawa number at p.</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">63</span><span class="p">)</span><span class="o">.</span><span class="n">new_subvariety</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">A</span>
<span class="go">Simple abelian subvariety 63b(1,63) of dimension 2 of J0(63)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">tamagawa_number_bounds</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(3, 3, ())</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">tamagawa_number_bounds</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1, 0, (2, 3, 5))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract">
<em class="property">class </em><code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">ModularAbelianVariety_modsym_abstract</code><span class="sig-paren">(</span><em>groups</em>, <em>base_field</em>, <em>is_simple=None</em>, <em>newform_level=None</em>, <em>isogeny_number=None</em>, <em>number=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modular.abvar.abvar.ModularAbelianVariety_abstract" title="sage.modular.abvar.abvar.ModularAbelianVariety_abstract"><code class="xref py py-class docutils literal"><span class="pre">sage.modular.abvar.abvar.ModularAbelianVariety_abstract</span></code></a></p>
<p>Abstract base class for modular abelian varieties.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">groups</span></code> - a tuple of congruence subgroups</li>
<li><code class="docutils literal"><span class="pre">base_field</span></code> - a field</li>
<li><code class="docutils literal"><span class="pre">is_simple</span></code> - bool; whether or not self is
simple</li>
<li><code class="docutils literal"><span class="pre">newform_level</span></code> - if self is isogenous to a
newform abelian variety, returns the level of that abelian variety</li>
<li><code class="docutils literal"><span class="pre">isogeny_number</span></code> - which isogeny class the
corresponding newform is in; this corresponds to the Cremona letter
code</li>
<li><code class="docutils literal"><span class="pre">number</span></code> - the t number of the degeneracy map that
this abelian variety is the image under</li>
<li><code class="docutils literal"><span class="pre">check</span></code> - whether to do some type checking on the
defining data</li>
</ul>
<p>EXAMPLES: One should not create an instance of this class, but we
do so anyways here as an example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">ModularAbelianVariety_abstract</span><span class="p">((</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">37</span><span class="p">),),</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.modular.abvar.abvar.ModularAbelianVariety_abstract_with_category&#39;&gt;</span>
</pre></div>
</div>
<p>All hell breaks loose if you try to do anything with <span class="math">\(A\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span>
<span class="go">&lt;repr(&lt;sage.modular.abvar.abvar.ModularAbelianVariety_abstract_with_category at 0x...&gt;) failed: NotImplementedError: BUG -- lattice method must be defined in derived class&gt;</span>
</pre></div>
</div>
<p>All instances of this class are in the category of modular
abelian varieties:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of modular abelian varieties over Rational Field</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of modular abelian varieties over Rational Field</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.decomposition">
<code class="descname">decomposition</code><span class="sig-paren">(</span><em>simple=True</em>, <em>bound=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Decompose this modular abelian variety as a product of abelian
subvarieties, up to isogeny.</p>
<p>INPUT: simple- bool (default: True) if True, all factors are
simple. If False, each factor returned is isogenous to a power of a
simple and the simples in each factor are distinct.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bound</span></code> - int (default: None) if given, only use
Hecke operators up to this bound when decomposing. This can give
wrong answers, so use with caution!</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33),</span>
<span class="go">Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33),</span>
<span class="go">Simple abelian subvariety 33a(1,33) of dimension 1 of J0(33)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 17aG1(1,17) of dimension 1 of J1(17),</span>
<span class="go">Simple abelian subvariety 17bG1(1,17) of dimension 4 of J1(17)</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.dimension">
<code class="descname">dimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of this modular abelian variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">43</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">17</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.group">
<code class="descname">group</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the congruence subgroup associated that this modular abelian
variety is associated to.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<span class="go">Congruence Subgroup Gamma0(13)</span>
<span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">997</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<span class="go">Congruence Subgroup Gamma1(997)</span>
<span class="gp">sage: </span><span class="n">JH</span><span class="p">(</span><span class="mi">37</span><span class="p">,[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<span class="go">Congruence Subgroup Gamma_H(37) with H generated by [3]</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="go">(Congruence Subgroup Gamma0(37),)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.groups">
<code class="descname">groups</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the tuple of groups associated to the modular symbols
abelian variety. This is always a 1-tuple.</p>
<p>OUTPUT: tuple</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_submodule</span><span class="p">()</span><span class="o">.</span><span class="n">abelian_variety</span><span class="p">();</span> <span class="n">A</span>
<span class="go">Abelian variety J0(33) of dimension 3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="go">(Congruence Subgroup Gamma0(33),)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.modular.abvar.abvar.ModularAbelianVariety_modsym_with_category&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.is_ambient">
<code class="descname">is_ambient</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.is_ambient" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this abelian variety attached to a modular symbols
space space is attached to the cuspidal subspace of the ambient
modular symbols space.</p>
<p>OUTPUT: bool</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_subspace</span><span class="p">()</span><span class="o">.</span><span class="n">abelian_variety</span><span class="p">();</span> <span class="n">A</span>
<span class="go">Abelian variety J0(43) of dimension 3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_ambient</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.modular.abvar.abvar.ModularAbelianVariety_modsym_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_subspace</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">abelian_variety</span><span class="p">();</span> <span class="n">A</span>
<span class="go">Abelian subvariety of dimension 2 of J0(43)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_ambient</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.is_subvariety">
<code class="descname">is_subvariety</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.is_subvariety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is a subvariety of other.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Abelian variety J0(37) of dimension 2</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">A</span>
<span class="go">Simple abelian subvariety 37a(1,37) of dimension 1 of J0(37)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_subvariety</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_subvariety</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<p>There may be a way to map <span class="math">\(A\)</span> into <span class="math">\(J_0(74)\)</span>, but
<span class="math">\(A\)</span> is not equipped with any special structure of an
embedding.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_subvariety</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">74</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Some ambient examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_subvariety</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_subvariety</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>More examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span> <span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">decomposition</span><span class="p">();</span> <span class="n">D</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 14a(1,42) of dimension 1 of J0(42),</span>
<span class="go">Simple abelian subvariety 14a(3,42) of dimension 1 of J0(42),</span>
<span class="go">Simple abelian subvariety 21a(1,42) of dimension 1 of J0(42),</span>
<span class="go">Simple abelian subvariety 21a(2,42) of dimension 1 of J0(42),</span>
<span class="go">Simple abelian subvariety 42a(1,42) of dimension 1 of J0(42)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_subvariety</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_subvariety</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">is_subvariety</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.lattice">
<code class="descname">lattice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lattice defining this modular abelian variety.</p>
<p>OUTPUT:</p>
<p>A free <span class="math">\(\ZZ\)</span>-module embedded in an ambient <span class="math">\(\QQ\)</span>-vector space.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_submodule</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abelian_variety</span><span class="p">();</span> <span class="n">A</span>
<span class="go">Abelian subvariety of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">Free module of degree 6 and rank 2 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1  0  0 -1  0  0]</span>
<span class="go">[ 0  0  1  0  1 -1]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.modular.abvar.abvar.ModularAbelianVariety_modsym_with_category&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.modular_symbols">
<code class="descname">modular_symbols</code><span class="sig-paren">(</span><em>sign=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.modular_symbols" title="Permalink to this definition">¶</a></dt>
<dd><p>Return space of modular symbols (with given sign) associated to
this modular abelian variety, if it can be found by cutting down
using Hecke operators. Otherwise raise a RuntimeError exception.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">()</span>
<span class="go">Modular Symbols subspace of dimension 4 of Modular Symbols space of dimension 5 for Gamma_0(37) of weight 2 with sign 0 over Rational Field</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 3 for Gamma_0(37) of weight 2 with sign 1 over Rational Field</span>
</pre></div>
</div>
<p>More examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">()</span>
<span class="go">Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 3 for Gamma_0(11) of weight 2 with sign 0 over Rational Field</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Modular Symbols subspace of dimension 1 of Modular Symbols space of dimension 2 for Gamma_0(11) of weight 2 with sign 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 3 for Gamma_0(11) of weight 2 with sign 0 over Rational Field</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">(</span><span class="n">sign</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Modular Symbols space of dimension 1 for Gamma_0(11) of weight 2 with sign -1 over Rational Field</span>
</pre></div>
</div>
<p>Even more examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span> <span class="n">A</span>
<span class="go">Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">()</span>
<span class="go">Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 9 for Gamma_0(33) of weight 2 with sign 0 over Rational Field</span>
</pre></div>
</div>
<p>It is not always possible to determine the sign subspaces:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">unable to determine sign (=1) space of modular symbols</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">unable to determine sign (=-1) space of modular symbols</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.new_subvariety">
<code class="descname">new_subvariety</code><span class="sig-paren">(</span><em>p=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.new_subvariety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new or <span class="math">\(p\)</span>-new subvariety of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> - a modular abelian variety</li>
<li><code class="docutils literal"><span class="pre">p</span></code> - prime number or None (default); if p is a
prime, return the p-new subvariety. Otherwise return the full new
subvariety.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">new_subvariety</span><span class="p">()</span>
<span class="go">Abelian subvariety of dimension 1 of J0(33)</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">new_subvariety</span><span class="p">()</span>
<span class="go">Abelian subvariety of dimension 1 of J0(100)</span>
<span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">new_subvariety</span><span class="p">()</span>
<span class="go">Abelian variety J1(13) of dimension 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.old_subvariety">
<code class="descname">old_subvariety</code><span class="sig-paren">(</span><em>p=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.old_subvariety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the old or <span class="math">\(p\)</span>-old abelian variety of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> - a modular abelian variety</li>
<li><code class="docutils literal"><span class="pre">p</span></code> - prime number or None (default); if p is a
prime, return the p-old subvariety. Otherwise return the full old
subvariety.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">old_subvariety</span><span class="p">()</span>
<span class="go">Abelian subvariety of dimension 2 of J0(33)</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">old_subvariety</span><span class="p">()</span>
<span class="go">Abelian subvariety of dimension 6 of J0(100)</span>
<span class="gp">sage: </span><span class="n">J1</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">old_subvariety</span><span class="p">()</span>
<span class="go">Abelian subvariety of dimension 0 of J1(13)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.modular.abvar.abvar.factor_modsym_space_new_factors">
<code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">factor_modsym_space_new_factors</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.factor_modsym_space_new_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an ambient modular symbols space, return complete
factorization of it.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - modular symbols space</li>
</ul>
<p>OUTPUT: list of decompositions corresponding to each new space.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">factor_modsym_space_new_factors</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">[[</span>
<span class="go">Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 3 for Gamma_0(11) of weight 2 with sign 0 over Rational Field</span>
<span class="go">],</span>
<span class="go"> [</span>
<span class="go">Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 9 for Gamma_0(33) of weight 2 with sign 0 over Rational Field</span>
<span class="go">]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.abvar.abvar.factor_new_space">
<code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">factor_new_space</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.factor_new_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a new space <span class="math">\(M\)</span> of modular symbols, return the
decomposition into simple of <span class="math">\(M\)</span> under the Hecke
operators.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - modular symbols space</li>
</ul>
<p>OUTPUT: list of factors</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_subspace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">factor_new_space</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 5 for Gamma_0(37) of weight 2 with sign 0 over Rational Field,</span>
<span class="go">Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 5 for Gamma_0(37) of weight 2 with sign 0 over Rational Field</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.abvar.abvar.is_ModularAbelianVariety">
<code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">is_ModularAbelianVariety</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.is_ModularAbelianVariety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is a modular abelian variety.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">x</span></code> - object</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.abvar.abvar</span> <span class="kn">import</span> <span class="n">is_ModularAbelianVariety</span>
<span class="gp">sage: </span><span class="n">is_ModularAbelianVariety</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_ModularAbelianVariety</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Returning True is a statement about the data type not whether or
not some abelian variety is modular:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_ModularAbelianVariety</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.abvar.abvar.modsym_lattices">
<code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">modsym_lattices</code><span class="sig-paren">(</span><em>M</em>, <em>factors</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.modsym_lattices" title="Permalink to this definition">¶</a></dt>
<dd><p>Append lattice information to the output of
simple_factorization_of_modsym_space.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - modular symbols spaces</li>
<li><code class="docutils literal"><span class="pre">factors</span></code> - Sequence
(simple_factorization_of_modsym_space)</li>
</ul>
<p>OUTPUT: sequence with more information for each factor (the
lattice)</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">factors</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">simple_factorization_of_modsym_space</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">simple</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">modsym_lattices</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">factors</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(11, 0, None, Modular Symbols subspace of dimension 4 of Modular Symbols space of dimension 9 for Gamma_0(33) of weight 2 with sign 0 over Rational Field, Free module of degree 6 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 1  0  0  0 -1  2]</span>
<span class="go">[ 0  1  0  0 -1  1]</span>
<span class="go">[ 0  0  1  0 -2  2]</span>
<span class="go">[ 0  0  0  1 -1 -1]),</span>
<span class="go">(33, 0, None, Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 9 for Gamma_0(33) of weight 2 with sign 0 over Rational Field, Free module of degree 6 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 1  0  0 -1  0  0]</span>
<span class="go">[ 0  0  1  0  1 -1])</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.abvar.abvar.random_hecke_operator">
<code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">random_hecke_operator</code><span class="sig-paren">(</span><em>M</em>, <em>t=None</em>, <em>p=2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.random_hecke_operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random Hecke operator acting on <span class="math">\(M\)</span>, got by adding
to <span class="math">\(t\)</span> a random multiple of <span class="math">\(T_p\)</span></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - modular symbols space</li>
<li><code class="docutils literal"><span class="pre">t</span></code> - None or a Hecke operator</li>
<li><code class="docutils literal"><span class="pre">p</span></code> - a prime</li>
</ul>
<p>OUTPUT: Hecke operator prime</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_subspace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">random_hecke_operator</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">random_hecke_operator</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.abvar.abvar.simple_factorization_of_modsym_space">
<code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">simple_factorization_of_modsym_space</code><span class="sig-paren">(</span><em>M</em>, <em>simple=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.simple_factorization_of_modsym_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return factorization of <span class="math">\(M\)</span>. If simple is False, return
powers of simples.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - modular symbols space</li>
<li><code class="docutils literal"><span class="pre">simple</span></code> - bool (default: True)</li>
</ul>
<p>OUTPUT: sequence</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">simple_factorization_of_modsym_space</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(11, 0, 1, Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 9 for Gamma_0(33) of weight 2 with sign 0 over Rational Field),</span>
<span class="go">(11, 0, 3, Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 9 for Gamma_0(33) of weight 2 with sign 0 over Rational Field),</span>
<span class="go">(33, 0, 1, Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 9 for Gamma_0(33) of weight 2 with sign 0 over Rational Field)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">simple_factorization_of_modsym_space</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">simple</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(11, 0, None, Modular Symbols subspace of dimension 4 of Modular Symbols space of dimension 9 for Gamma_0(33) of weight 2 with sign 0 over Rational Field),</span>
<span class="go">(33, 0, None, Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 9 for Gamma_0(33) of weight 2 with sign 0 over Rational Field)</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.abvar.abvar.sqrt_poly">
<code class="descclassname">sage.modular.abvar.abvar.</code><code class="descname">sqrt_poly</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.abvar.abvar.sqrt_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the square root of the polynomial <span class="math">\(f\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">At some point something like this should be a member of the
polynomial class. For now this is just used internally by some
charpoly functions above.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">x^4 + 4/3*x^3 + 10/3*x^2 + 13/3*x - 10</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">sqrt_poly</span><span class="p">(</span><span class="n">f</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^4 + 4/3*x^3 + 10/3*x^2 + 13/3*x - 10</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">sqrt_poly</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">f must be a perfect square</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">sqrt_poly</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">f must be monic</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="constructor.html"
                                  title="previous chapter">Constructors for certain modular abelian varieties</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="abvar_ambient_jacobian.html"
                                  title="next chapter">Ambient Jacobian Abelian Variety</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/modular/abvar/abvar.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="abvar_ambient_jacobian.html" title="Ambient Jacobian Abelian Variety"
             >next</a> |</li>
        <li class="right" >
          <a href="constructor.html" title="Constructors for certain modular abelian varieties"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Modular Abelian Varieties</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>