<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Spaces of homomorphisms between modular abelian varieties &mdash; Sage Reference Manual v6.6: Modular Abelian Varieties</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '6.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.6: Modular Abelian Varieties" href="../../../index.html" />
    <link rel="next" title="Morphisms between modular abelian varieties, including Hecke operators acting on modular abelian varieties" href="morphism.html" />
    <link rel="prev" title="Homology of modular abelian varieties" href="homology.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="morphism.html" title="Morphisms between modular abelian varieties, including Hecke operators acting on modular abelian varieties"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="homology.html" title="Homology of modular abelian varieties"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Modular Abelian Varieties</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="spaces-of-homomorphisms-between-modular-abelian-varieties">
<span id="sage-modular-abvar-homspace"></span><h1>Spaces of homomorphisms between modular abelian varieties<a class="headerlink" href="#spaces-of-homomorphisms-between-modular-abelian-varieties" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.modular.abvar.homspace"></span><p>EXAMPLES:</p>
<p>First, we consider J0(37). This Jacobian has two simple factors,
corresponding to distinct newforms. These two intersect
nontrivially in J0(37).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span> <span class="p">;</span> <span class="n">D</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 37a(1,37) of dimension 1 of J0(37),</span>
<span class="go">Simple abelian subvariety 37b(1,37) of dimension 1 of J0(37)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(Finite subgroup with invariants [2, 2] over QQ of Simple abelian subvariety 37a(1,37) of dimension 1 of J0(37),</span>
<span class="go"> Simple abelian subvariety of dimension 0 of J0(37))</span>
</pre></div>
</div>
<p>As an abstract product, since these newforms are distinct, the
corresponding simple abelian varieties are not isogenous, and so
there are no maps between them. The endomorphism ring of the
corresponding product is thus isomorphic to the direct sum of the
endomorphism rings for each factor. Since the factors correspond to
abelian varieties of dimension 1, these endomorphism rings are each
isomorphic to ZZ.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Hom</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">;</span> <span class="n">A</span>
<span class="go">Abelian subvariety of dimension 2 of J0(37) x J0(37)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Abelian variety endomorphism of Abelian subvariety of dimension 2 of J0(37) x J0(37),</span>
<span class="go"> Abelian variety endomorphism of Abelian subvariety of dimension 2 of J0(37) x J0(37))</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">x</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">A</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[</span>
<span class="go">[1 0 0 0]  [0 0 0 0]</span>
<span class="go">[0 1 0 0]  [0 0 0 0]</span>
<span class="go">[0 0 0 0]  [0 0 1 0]</span>
<span class="go">[0 0 0 0], [0 0 0 1]</span>
<span class="go">]</span>
</pre></div>
</div>
<p>However, these two newforms have a congruence between them modulo
2, which gives rise to interesting endomorphisms of J0(37).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Abelian variety endomorphism of Abelian variety J0(37) of dimension 2,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(37) of dimension 2)</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">x</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[</span>
<span class="go">[1 0 0 0]  [ 0  1  1 -1]</span>
<span class="go">[0 1 0 0]  [ 1  0  1  0]</span>
<span class="go">[0 0 1 0]  [ 0  0 -1  1]</span>
<span class="go">[0 0 0 1], [ 0  0  0  1]</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[-1  1  1 -1]</span>
<span class="go">[ 1 -1  1  0]</span>
<span class="go">[ 0  0 -2  1]</span>
<span class="go">[ 0  0  0  0]</span>
</pre></div>
</div>
<p>Of course, these endomorphisms will be reflected in the Hecke
algebra, which is in fact the full endomorphism ring of J0(37) in
this case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">hecke_operator</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[-1  1  1 -1]</span>
<span class="go">[ 1 -1  1  0]</span>
<span class="go">[ 0  0 -2  1]</span>
<span class="go">[ 0  0  0  0]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">image_of_hecke_algebra</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Abelian variety endomorphism of Abelian variety J0(37) of dimension 2,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(37) of dimension 2)</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">x</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">T</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[</span>
<span class="go">[1 0 0 0]  [ 0  1  1 -1]</span>
<span class="go">[0 1 0 0]  [ 1  0  1  0]</span>
<span class="go">[0 0 1 0]  [ 0  0 -1  1]</span>
<span class="go">[0 0 0 1], [ 0  0  0  1]</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Next, we consider J0(33). In this case, we have both oldforms and
newforms. There are two copies of J0(11), one for each degeneracy
map from J0(11) to J0(33). There is also one newform at level 33.
The images of the two degeneracy maps are, of course, isogenous.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[</span>
<span class="go">Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33),</span>
<span class="go">Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33),</span>
<span class="go">Simple abelian subvariety 33a(1,33) of dimension 1 of J0(33)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">Hom</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Abelian variety morphism:</span>
<span class="go">  From: Simple abelian subvariety 11a(1,33) of dimension 1 of J0(33)</span>
<span class="go">  To:   Simple abelian subvariety 11a(3,33) of dimension 1 of J0(33),)</span>
<span class="gp">sage: </span><span class="n">Hom</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 0  1]</span>
<span class="go">[-1  0]</span>
</pre></div>
</div>
<p>Then this gives that the component corresponding to the sum of the
oldforms will have a rank 4 endomorphism ring. We also have a rank
one endomorphism ring for the newform 33a (since it is again
1-dimensional), which gives a rank 5 endomorphism ring for J0(33).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">DD</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">decomposition</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="p">;</span> <span class="n">DD</span>
<span class="go">[</span>
<span class="go">Abelian subvariety of dimension 2 of J0(33),</span>
<span class="go">Abelian subvariety of dimension 1 of J0(33)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">DD</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Abelian variety endomorphism of Abelian subvariety of dimension 2 of J0(33),</span>
<span class="go"> Abelian variety endomorphism of Abelian subvariety of dimension 2 of J0(33),</span>
<span class="go"> Abelian variety endomorphism of Abelian subvariety of dimension 2 of J0(33),</span>
<span class="go"> Abelian variety endomorphism of Abelian subvariety of dimension 2 of J0(33))</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Abelian variety endomorphism of Abelian subvariety of dimension 1 of J0(33),)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span> <span class="p">;</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>  <span class="c"># long time (3s on sage.math, 2011)</span>
<span class="go">(Abelian variety endomorphism of Abelian variety J0(33) of dimension 3,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(33) of dimension 3,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(33) of dimension 3,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(33) of dimension 3,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(33) of dimension 3)</span>
</pre></div>
</div>
<p>In this case, the image of the Hecke algebra will only have rank 3,
so that it is of infinite index in the full endomorphism ring.
However, if we call this image T, we can still ask about the index
of T in its saturation, which is 1 in this case.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">image_of_hecke_algebra</span><span class="p">()</span>  <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>  <span class="c"># long time</span>
<span class="go">(Abelian variety endomorphism of Abelian variety J0(33) of dimension 3,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(33) of dimension 3,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(33) of dimension 3)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>  <span class="c"># long time</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>  <span class="c"># long time</span>
<span class="go">1</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein (2007-03)</li>
<li>Craig Citro, Robert Bradshaw (2008-03): Rewrote with modabvar overhaul</li>
</ul>
<dl class="class">
<dt id="sage.modular.abvar.homspace.EndomorphismSubring">
<em class="property">class </em><tt class="descclassname">sage.modular.abvar.homspace.</tt><tt class="descname">EndomorphismSubring</tt><big>(</big><em>A</em>, <em>gens=None</em>, <em>category=None</em><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.EndomorphismSubring" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modular.abvar.homspace.Homspace" title="sage.modular.abvar.homspace.Homspace"><tt class="xref py py-class docutils literal"><span class="pre">sage.modular.abvar.homspace.Homspace</span></tt></a>, <a class="reference external" href="../../../../rings/sage/rings/ring.html#sage.rings.ring.Ring" title="(in Sage Reference Manual: General Rings, Ideals, and Morphisms v6.6)"><tt class="xref py py-class docutils literal"><span class="pre">sage.rings.ring.Ring</span></tt></a></p>
<p>A subring of the endomorphism ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">A</span></tt> - an abelian variety</li>
<li><tt class="docutils literal"><span class="pre">gens</span></tt> - (default: None); optional; if given
should be a tuple of the generators as matrices</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span>
<span class="go">Endomorphism ring of Abelian variety J0(23) of dimension 2</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">homspace</span><span class="o">.</span><span class="n">EndomorphismSubring</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="go">Endomorphism ring of Abelian variety J0(25) of dimension 0</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.modular.abvar.homspace.EndomorphismSubring_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">homset_category</span><span class="p">()</span>
<span class="go">Category of modular abelian varieties over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of endsets of modular abelian varieties over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="ow">in</span> <span class="n">Rings</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">skip</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;_test_prod&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The following tests against a problem on 32 bit machines that
occured while working on trac ticket #9944:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">abvar</span><span class="o">.</span><span class="n">homspace</span><span class="o">.</span><span class="n">EndomorphismSubring</span><span class="p">(</span><span class="n">J1</span><span class="p">(</span><span class="mi">12345</span><span class="p">))</span>
<span class="go">Endomorphism ring of Abelian variety J1(12345) of dimension 5405473</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/16275">trac ticket #16275</a> removed the custom <tt class="docutils literal"><span class="pre">__reduce__</span></tt> method, since
<tt class="xref py py-meth docutils literal"><span class="pre">Homset.__reduce__()</span></tt> already implements appropriate
unpickling by construction:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">__reduce__</span><span class="o">.</span><span class="n">__module__</span>
<span class="go">&#39;sage.categories.homset&#39;</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">()</span>
<span class="go">(&lt;function Hom at ...&gt;,</span>
<span class="go"> (Abelian variety J0(11) of dimension 1,</span>
<span class="go">  Abelian variety J0(11) of dimension 1,</span>
<span class="go">  Category of modular abelian varieties over Rational Field,</span>
<span class="go"> False))</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.modular.abvar.homspace.EndomorphismSubring.abelian_variety">
<tt class="descname">abelian_variety</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.EndomorphismSubring.abelian_variety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the abelian variety that this endomorphism ring is attached
to.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span><span class="o">.</span><span class="n">abelian_variety</span><span class="p">()</span>
<span class="go">Abelian variety J0(11) of dimension 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.homspace.EndomorphismSubring.discriminant">
<tt class="descname">discriminant</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.EndomorphismSubring.discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of this ring, which is the discriminant of
the trace pairing.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">One knows that for modular abelian varieties, the
endomorphism ring should be isomorphic to an order in a
number field. However, the discriminant returned by this
function will be <span class="math">\(2^n\)</span> ( <span class="math">\(n =\)</span>
self.dimension()) times the discriminant of that order,
since the elements are represented as 2d x 2d
matrices. Notice, for example, that the case of a one
dimensional abelian variety, whose endomorphism ring must
be ZZ, has discriminant 2, as in the example below.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-64800</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">46</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>  <span class="c"># long time (6s on sage.math, 2011)</span>
<span class="go">24200000000</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.homspace.EndomorphismSubring.image_of_hecke_algebra">
<tt class="descname">image_of_hecke_algebra</tt><big>(</big><em>check_every=1</em><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.EndomorphismSubring.image_of_hecke_algebra" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the image of the Hecke algebra inside this endomorphism
subring.</p>
<p>We simply calculate Hecke operators up to the Sturm bound, and look
at the submodule spanned by them. While computing, we can check to
see if the submodule spanned so far is saturated and of maximal
dimension, in which case we may be done. The optional argument
check_every determines how many Hecke operators we add in before
checking to see if this condition is met.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">image_of_hecke_algebra</span><span class="p">()</span>
<span class="go">Subring of endomorphism ring of Abelian variety J0(33) of dimension 3</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">image_of_hecke_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Abelian variety endomorphism of Abelian variety J0(33) of dimension 3,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(33) of dimension 3,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(33) of dimension 3)</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">x</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">image_of_hecke_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[</span>
<span class="go">[1 0 0 0 0 0]  [ 0  2  0 -1  1 -1]  [ 0  0  1 -1  1 -1]</span>
<span class="go">[0 1 0 0 0 0]  [-1 -2  2 -1  2 -1]  [ 0 -1  1  0  1 -1]</span>
<span class="go">[0 0 1 0 0 0]  [ 0  0  1 -1  3 -1]  [ 0  0  1  0  2 -2]</span>
<span class="go">[0 0 0 1 0 0]  [-2  2  0  1  1 -1]  [-2  0  1  1  1 -1]</span>
<span class="go">[0 0 0 0 1 0]  [-1  1  0  2  0 -3]  [-1  0  1  1  0 -1]</span>
<span class="go">[0 0 0 0 0 1], [-1  1 -1  1  1 -2], [-1  0  0  1  0 -1]</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">hecke_operator</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[-1  0  1 -1  1 -1]</span>
<span class="go">[ 0 -2  1  0  1 -1]</span>
<span class="go">[ 0  0  0  0  2 -2]</span>
<span class="go">[-2  0  1  0  1 -1]</span>
<span class="go">[-1  0  1  1 -1 -1]</span>
<span class="go">[-1  0  0  1  0 -2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.homspace.EndomorphismSubring.index_in">
<tt class="descname">index_in</tt><big>(</big><em>other</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.EndomorphismSubring.index_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of self in other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - another endomorphism subring of the
same abelian variety</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> - bool (default: True); whether to do some
type and other consistency checks</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span> <span class="p">;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span> <span class="p">;</span> <span class="n">T</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">image_of_hecke_algebra</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">J0</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="p">;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span> <span class="p">;</span> <span class="n">T</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">image_of_hecke_algebra</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.homspace.EndomorphismSubring.index_in_saturation">
<tt class="descname">index_in_saturation</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.EndomorphismSubring.index_in_saturation" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a Hecke algebra T, compute its index in its saturation.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">End</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">.</span><span class="n">image_of_hecke_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">End</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">44</span><span class="p">))</span><span class="o">.</span><span class="n">image_of_hecke_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.abvar.homspace.Homspace">
<em class="property">class </em><tt class="descclassname">sage.modular.abvar.homspace.</tt><tt class="descname">Homspace</tt><big>(</big><em>domain</em>, <em>codomain</em>, <em>cat</em><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.Homspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../categories/sage/categories/homset.html#sage.categories.homset.HomsetWithBase" title="(in Sage Reference Manual: Category Theory v6.6)"><tt class="xref py py-class docutils literal"><span class="pre">sage.categories.homset.HomsetWithBase</span></tt></a></p>
<p>A space of homomorphisms between two modular abelian varieties.</p>
<dl class="attribute">
<dt id="sage.modular.abvar.homspace.Homspace.Element">
<tt class="descname">Element</tt><a class="headerlink" href="#sage.modular.abvar.homspace.Homspace.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Sage Reference Manual: Category Theory v6.6)"><tt class="xref py py-class docutils literal"><span class="pre">Morphism</span></tt></a></p>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.homspace.Homspace.calculate_generators">
<tt class="descname">calculate_generators</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.Homspace.calculate_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>If generators haven&#8217;t already been computed, calculate generators
for this homspace. If they have been computed, do nothing.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">calculate_generators</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.homspace.Homspace.free_module">
<tt class="descname">free_module</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.Homspace.free_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return this endomorphism ring as a free submodule of a big
<span class="math">\(\ZZ^{4nm}\)</span>, where <span class="math">\(n\)</span> is the dimension of
the domain abelian variety and <span class="math">\(m\)</span> the dimension of the
codomain.</p>
<p>OUTPUT: free module</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">Hom</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">J0</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 8 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 1  0 -3  1  1  1 -1 -1]</span>
<span class="go">[ 0  1 -3  1  1  1 -1  0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.homspace.Homspace.gen">
<tt class="descname">gen</tt><big>(</big><em>i=0</em><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.Homspace.gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return i-th generator of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">i</span></tt> - an integer</li>
</ul>
<p>OUTPUT: a morphism</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.homspace.Homspace.gens">
<tt class="descname">gens</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.Homspace.gens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return tuple of generators for this endomorphism ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Abelian variety endomorphism of Abelian variety J0(22) of dimension 2,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(22) of dimension 2,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(22) of dimension 2,</span>
<span class="go"> Abelian variety endomorphism of Abelian variety J0(22) of dimension 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.homspace.Homspace.matrix_space">
<tt class="descname">matrix_space</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.Homspace.matrix_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the underlying matrix space that we view this endomorphism
ring as being embedded into.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">matrix_space</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 4 by 4 dense matrices over Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.abvar.homspace.Homspace.ngens">
<tt class="descname">ngens</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.abvar.homspace.Homspace.ngens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of generators of self.</p>
<p>OUTPUT: integer</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">J0</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="homology.html"
                                  title="previous chapter">Homology of modular abelian varieties</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="morphism.html"
                                  title="next chapter">Morphisms between modular abelian varieties, including Hecke operators acting on modular abelian varieties</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/modular/abvar/homspace.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="morphism.html" title="Morphisms between modular abelian varieties, including Hecke operators acting on modular abelian varieties"
             >next</a> |</li>
        <li class="right" >
          <a href="homology.html" title="Homology of modular abelian varieties"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Modular Abelian Varieties</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>