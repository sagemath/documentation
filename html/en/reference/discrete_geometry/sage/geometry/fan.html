<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Morphisms between toric lattices compatible with fans" href="fan_morphism.html" /><link rel="prev" title="Catalog of common polyhedral convex cones" href="cone_catalog.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Rational polyhedral fans - Combinatorial and Discrete Geometry</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Combinatorial and Discrete Geometry</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.1 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Combinatorial and Discrete Geometry</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/arrangement.html">Hyperplane Arrangements</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/library.html">Library of Hyperplane Arrangements</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/hyperplane.html">Hyperplanes</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/affine_subspace.html">Affine Subspaces of a Vector Space</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/plot.html">Plotting of Hyperplane Arrangements</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/library.html">Library of commonly used, famous, or interesting polytopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/constructor.html">Polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/parent.html">Parents for Polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/representation.html">H(yperplane) and V(ertex) representation objects for polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/plot.html">Functions for plotting polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/face.html">A class to keep information about faces of a polyhedron</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/cdd_file_format.html">Generate cdd <code class="docutils literal notranslate"><span class="pre">.ext</span></code> / <code class="docutils literal notranslate"><span class="pre">.ine</span></code> file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/modules/formal_polyhedra_module.html">Formal modules generated by polyhedra</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="lattice_polytope.html">Lattice and reflexive polytopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/lattice_euclidean_group_element.html">Lattice Euclidean Group Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/palp_database.html">Access the PALP database(s) of reflexive lattice polytopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/ppl_lattice_polygon.html">Fast Lattice Polygons using PPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/ppl_lattice_polytope.html">Fast Lattice Polytopes using PPL.</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/generating_function.html">Generating Function of Polyhedron’s Integral Points</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/base.html">Combinatorial polyhedron</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/combinatorial_face.html">Combinatorial face of a polyhedron</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/polyhedron_face_lattice.html">PolyhedronFaceLattice</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/face_iterator.html">Face iterator for polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/list_of_faces.html">List of faces</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/conversions.html">Conversions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="polyhedral_complex.html">Finite polyhedral complexes</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="toric_lattice.html">Toric lattices</a></li>
<li class="toctree-l1"><a class="reference internal" href="cone.html">Convex rational polyhedral cones</a></li>
<li class="toctree-l1"><a class="reference internal" href="cone_catalog.html">Catalog of common polyhedral convex cones</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Rational polyhedral fans</a></li>
<li class="toctree-l1"><a class="reference internal" href="fan_morphism.html">Morphisms between toric lattices compatible with fans</a></li>
<li class="toctree-l1"><a class="reference internal" href="point_collection.html">Point collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="toric_plotter.html">Toric plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rings/polynomial/groebner_fan.html">Groebner Fans</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base0.html">Base class for polyhedra: Initialization and access to Vrepresentation and Hrepresentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base1.html">Base class for polyhedra: Implementation of the <code class="xref py py-class docutils literal notranslate"><span class="pre">ConvexSet_base</span></code> API</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base2.html">Base class for polyhedra: Methods related to lattice points</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base3.html">Base class for polyhedra: Methods regarding the combinatorics of a polyhedron</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base4.html">Base class for polyhedra: Graph-theoretic methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base5.html">Base class for polyhedra: Methods for constructing new polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base6.html">Base class for polyhedra: Methods for plotting and affine hull projection</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base7.html">Base class for polyhedra: Methods for triangulation and volume computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base.html">Base class for polyhedra: Miscellaneous methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base_QQ.html">Base class for polyhedra over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base_ZZ.html">Base class for polyhedra over <span class="math notranslate nohighlight">\(\ZZ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base_RDF.html">Base class for polyhedra over <code class="docutils literal notranslate"><span class="pre">RDF</span></code></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_cdd.html">The cdd backend for polyhedral computations</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_cdd_rdf.html">The cdd backend for polyhedral computations, floating point version</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_field.html">The Python backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_number_field.html">The Python backend, using number fields internally</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_normaliz.html">The Normaliz backend for polyhedral computations</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_polymake.html">The polymake backend for polyhedral computations</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_ppl.html">The PPL (Parma Polyhedra Library) backend for polyhedral computations</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/double_description.html">Double Description Algorithm for Cones</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/double_description_inhomogeneous.html">Double Description for Arbitrary Polyhedra</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="triangulation/point_configuration.html">Triangulations of a point configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="triangulation/base.html">Base classes for triangulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="triangulation/element.html">A triangulation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="abc.html">Abstract base classes for classes in <code class="xref py py-mod docutils literal notranslate"><span class="pre">geometry</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="convex_set.html">Convex Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_expression.html">Linear Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="newton_polygon.html">Newton Polygons</a></li>
<li class="toctree-l1"><a class="reference internal" href="relative_interior.html">Relative Interiors of Polyhedra and Cones</a></li>
<li class="toctree-l1"><a class="reference internal" href="ribbon_graph.html">Ribbon Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="pseudolines.html">Pseudolines</a></li>
<li class="toctree-l1"><a class="reference internal" href="voronoi_diagram.html">Voronoi diagram</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="fan_isomorphism.html">Find isomorphisms between fans</a></li>
<li class="toctree-l1"><a class="reference internal" href="hasse_diagram.html">Construction of finite atomic and coatomic lattices from incidences</a></li>
<li class="toctree-l1"><a class="reference internal" href="integral_points.html">MISSING TITLE</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/check_freeness.html">Helper Functions For Freeness Of Hyperplane Arrangements</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="rational-polyhedral-fans">
<span id="sage-geometry-fan"></span><h1>Rational polyhedral fans<a class="headerlink" href="#rational-polyhedral-fans" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.geometry.fan"></span><p>This module was designed as a part of the framework for toric varieties
(<a class="reference external" href="../../../schemes/sage/schemes/toric/variety.html#module-sage.schemes.toric.variety" title="(in Schemes v10.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">variety</span></code></a>,
<a class="reference external" href="../../../schemes/sage/schemes/toric/fano_variety.html#module-sage.schemes.toric.fano_variety" title="(in Schemes v10.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fano_variety</span></code></a>). While the emphasis is on
complete full-dimensional fans, arbitrary fans are supported. Work
with distinct lattices. The default lattice is <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricLattice</span></code></a> <span class="math notranslate nohighlight">\(N\)</span> of the appropriate
dimension. The only case when you must specify lattice explicitly is creation
of a 0-dimensional fan, where dimension of the ambient space cannot be
guessed.</p>
<p>A <strong>rational polyhedral fan</strong> is a <em>finite</em> collection of <em>strictly</em> convex
rational polyhedral cones, such that the intersection of any two cones of the
fan is a face of each of them and each face of each cone is also a cone of the
fan.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Andrey Novoseltsev (2010-05-15): initial version.</p></li>
<li><p>Andrey Novoseltsev (2010-06-17): substantial improvement during review by
Volker Braun.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Use <a class="reference internal" href="#sage.geometry.fan.Fan" title="sage.geometry.fan.Fan"><code class="xref py py-func docutils literal notranslate"><span class="pre">Fan()</span></code></a> to construct fans “explicitly”:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">....: </span>          <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
<p>In addition to giving such lists of cones and rays you can also create cones
first using <a class="reference internal" href="cone.html#sage.geometry.cone.Cone" title="sage.geometry.cone.Cone"><code class="xref py py-func docutils literal notranslate"><span class="pre">Cone()</span></code></a> and then combine them into a fan.
See the documentation of <a class="reference internal" href="#sage.geometry.fan.Fan" title="sage.geometry.fan.Fan"><code class="xref py py-func docutils literal notranslate"><span class="pre">Fan()</span></code></a> for details.</p>
<p>In 2 dimensions there is a unique maximal fan determined by rays, and
you can use <a class="reference internal" href="#sage.geometry.fan.Fan2d" title="sage.geometry.fan.Fan2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">Fan2d()</span></code></a> to construct it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan2d</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">(</span><span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan2d</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But keep in mind that in higher dimensions the cone data is essential
and cannot be omitted. Instead of building a fan from scratch, for
this tutorial we will use an easy way to get two fans associated to
<a class="reference internal" href="lattice_polytope.html#sage.geometry.lattice_polytope.LatticePolytopeClass" title="sage.geometry.lattice_polytope.LatticePolytopeClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">lattice</span> <span class="pre">polytopes</span></code></a>:
<a class="reference internal" href="#sage.geometry.fan.FaceFan" title="sage.geometry.fan.FaceFan"><code class="xref py py-func docutils literal notranslate"><span class="pre">FaceFan()</span></code></a> and <a class="reference internal" href="#sage.geometry.fan.NormalFan" title="sage.geometry.fan.NormalFan"><code class="xref py py-func docutils literal notranslate"><span class="pre">NormalFan()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>Given such “automatic” fans, you may wonder what are their rays and cones:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">M( 1,  0,  0),</span>
<span class="go">M( 0,  1,  0),</span>
<span class="go">M( 0,  0,  1),</span>
<span class="go">M(-1,  0,  0),</span>
<span class="go">M( 0, -1,  0),</span>
<span class="go">M( 0,  0, -1)</span>
<span class="go">in 3-d lattice M</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>
<span class="go">(3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M)</span>
</pre></div>
</div>
<p>The last output is not very illuminating. Let’s try to improve it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">())</span>
<span class="go">M( 0, 1, 0),</span>
<span class="go">M( 0, 0, 1),</span>
<span class="go">M(-1, 0, 0)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M( 0,  0, 1),</span>
<span class="go">M(-1,  0, 0),</span>
<span class="go">M( 0, -1, 0)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M(-1,  0,  0),</span>
<span class="go">M( 0, -1,  0),</span>
<span class="go">M( 0,  0, -1)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M( 0, 1,  0),</span>
<span class="go">M(-1, 0,  0),</span>
<span class="go">M( 0, 0, -1)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M(1, 0,  0),</span>
<span class="go">M(0, 1,  0),</span>
<span class="go">M(0, 0, -1)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M(1, 0, 0),</span>
<span class="go">M(0, 1, 0),</span>
<span class="go">M(0, 0, 1)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M(1,  0, 0),</span>
<span class="go">M(0,  0, 1),</span>
<span class="go">M(0, -1, 0)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M(1,  0,  0),</span>
<span class="go">M(0, -1,  0),</span>
<span class="go">M(0,  0, -1)</span>
<span class="go">in 3-d lattice M</span>
</pre></div>
</div>
<p>You can also do</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">())</span>
<span class="go">(1, 2, 3)</span>
<span class="go">(2, 3, 4)</span>
<span class="go">(3, 4, 5)</span>
<span class="go">(1, 3, 5)</span>
<span class="go">(0, 1, 5)</span>
<span class="go">(0, 1, 2)</span>
<span class="go">(0, 2, 4)</span>
<span class="go">(0, 4, 5)</span>
</pre></div>
</div>
<p>to see indices of rays of the fan corresponding to each cone.</p>
<p>While the above cycles were over “cones in fan”, it is obvious that we did not
get ALL the cones: every face of every cone in a fan must also be in the fan,
but all of the above cones were of dimension three. The reason for this
behaviour is that in many cases it is enough to work with generating cones of
the fan, i.e. cones which are not faces of bigger cones. When you do need to
work with lower dimensional cones, you can easily get access to them using
<a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.cones" title="sage.geometry.fan.RationalPolyhedralFan.cones"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cones()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan1</span><span class="o">.</span><span class="n">cones</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[(0, 1), (0, 2), (1, 2), (1, 3), (2, 3), (0, 4),</span>
<span class="go"> (2, 4), (3, 4), (1, 5), (3, 5), (4, 5), (0, 5)]</span>
</pre></div>
</div>
<p>In fact, you do not have to type <code class="docutils literal notranslate"><span class="pre">.cones</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan1</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[(0, 1), (0, 2), (1, 2), (1, 3), (2, 3), (0, 4),</span>
<span class="go"> (2, 4), (3, 4), (1, 5), (3, 5), (4, 5), (0, 5)]</span>
</pre></div>
</div>
<p>You may also need to know the inclusion relations between all of the cones of
the fan. In this case check out
<a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.cone_lattice" title="sage.geometry.fan.RationalPolyhedralFan.cone_lattice"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cone_lattice()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">fan1</span><span class="o">.</span><span class="n">cone_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Finite lattice containing 28 elements with distinguished linear extension</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span>
<span class="go">0-d cone of Rational polyhedral fan in 3-d lattice M</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">top</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 3-d lattice M</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">cone</span>
<span class="go">2-d cone of Rational polyhedral fan in 3-d lattice M</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">hasse_diagram</span><span class="p">()</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">cone</span><span class="p">))</span>
<span class="go">[1-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 1-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M]</span>
</pre></div>
</div>
<p>You can check how “good” a fan is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The face fan of the octahedron is really good! Time to remember that we have
also constructed its normal fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This one does have some “problems,” but we can fix them:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan3</span> <span class="o">=</span> <span class="n">fan2</span><span class="o">.</span><span class="n">make_simplicial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan3</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan3</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note that we had to save the result of
<a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.make_simplicial" title="sage.geometry.fan.RationalPolyhedralFan.make_simplicial"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_simplicial()</span></code></a> in a new fan.
Fans in Sage are immutable, so any operation that does change them constructs
a new fan.</p>
<p>We can also make <code class="docutils literal notranslate"><span class="pre">fan3</span></code> smooth, but it will take a bit more work:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">cube</span> <span class="o">=</span> <span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">polar</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sk</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">skeleton_points</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">[</span><span class="n">cube</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">sk</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">fan4</span> <span class="o">=</span> <span class="n">fan3</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="n">rays</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan4</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Let’s see how “different” are <code class="docutils literal notranslate"><span class="pre">fan2</span></code> and <code class="docutils literal notranslate"><span class="pre">fan4</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">fan4</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>                                                      <span class="c1"># needs palp</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="n">fan4</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>                                                                  <span class="c1"># needs palp</span>
<span class="go">26</span>
</pre></div>
</div>
<p>Smoothness does not come for free!</p>
<p>Please take a look at the rest of the available functions below and their
complete descriptions. If you need any features that are missing, feel free to
suggest them. (Or implement them on your own and submit a patch to Sage for
inclusion!)</p>
<dl class="py class">
<dt class="sig sig-object py" id="sage.geometry.fan.Cone_of_fan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.geometry.fan.</span></span><span class="sig-name descname"><span class="pre">Cone_of_fan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ambient</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambient_ray_indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.Cone_of_fan" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConvexRationalPolyhedralCone</span></code></a></p>
<p>Construct a cone belonging to a fan.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This class does not check that the input defines a valid cone of a
fan. You must not construct objects of this class directly.</p>
</div>
<p>In addition to all of the properties of “regular” <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cones</span></code></a>, such cones know their
relation to the fan.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ambient</span></code> – fan whose cone is constructed;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ambient_ray_indices</span></code> – increasing list or tuple of integers, indices
of rays of <code class="docutils literal notranslate"><span class="pre">ambient</span></code> generating this cone.</p></li>
</ul>
<p>OUTPUT:</p>
<p>cone of <code class="docutils literal notranslate"><span class="pre">ambient</span></code></p>
<p>EXAMPLES:</p>
<p>The intended way to get objects of this class is the following:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cone</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0, 2)</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">star_generator_indices</span><span class="p">()</span>
<span class="go">(0,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.Cone_of_fan.star_generator_indices">
<span class="sig-name descname"><span class="pre">star_generator_indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.Cone_of_fan.star_generator_indices" title="Permalink to this definition">#</a></dt>
<dd><p>Return indices of generating cones of the “ambient fan” containing
<code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>increasing <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>                                       <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                                 <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">star_generator_indices</span><span class="p">()</span>                                         <span class="c1"># needs palp</span>
<span class="go">(0,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.Cone_of_fan.star_generators">
<span class="sig-name descname"><span class="pre">star_generators</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.Cone_of_fan.star_generators" title="Permalink to this definition">#</a></dt>
<dd><p>Return indices of generating cones of the “ambient fan” containing
<code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>increasing <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>                                       <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                                 <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">star_generators</span><span class="p">()</span>                                                <span class="c1"># needs palp</span>
<span class="go">(2-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.geometry.fan.FaceFan">
<span class="sig-prename descclassname"><span class="pre">sage.geometry.fan.</span></span><span class="sig-name descname"><span class="pre">FaceFan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polytope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.FaceFan" title="Permalink to this definition">#</a></dt>
<dd><p>Construct the face fan of the given rational <code class="docutils literal notranslate"><span class="pre">polytope</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">polytope</span></code> – a <a class="reference internal" href="polyhedron/constructor.html#sage.geometry.polyhedron.constructor.Polyhedron" title="sage.geometry.polyhedron.constructor.Polyhedron"><code class="xref py py-func docutils literal notranslate"><span class="pre">polytope</span></code></a> over <span class="math notranslate nohighlight">\(\QQ\)</span> or
a <a class="reference internal" href="lattice_polytope.html#sage.geometry.lattice_polytope.LatticePolytopeClass" title="sage.geometry.lattice_polytope.LatticePolytopeClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">lattice</span> <span class="pre">polytope</span></code></a>. A (not
necessarily full-dimensional) polytope containing the origin in
its <code class="xref py py-meth docutils literal notranslate"><span class="pre">relative</span> <span class="pre">interior</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lattice</span></code> – <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricLattice</span></code></a>, <span class="math notranslate nohighlight">\(\ZZ^n\)</span>, or any
other object that behaves like these. If not specified, an attempt will
be made to determine an appropriate toric lattice automatically.</p></li>
</ul>
<p>OUTPUT:</p>
<p><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a></p>
<p>See also <a class="reference internal" href="#sage.geometry.fan.NormalFan" title="sage.geometry.fan.NormalFan"><code class="xref py py-func docutils literal notranslate"><span class="pre">NormalFan()</span></code></a>.</p>
<p>EXAMPLES:</p>
<p>Let’s construct the fan corresponding to the product of two projective
lines:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">diamond</span> <span class="o">=</span> <span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">diamond</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">M( 1,  0),</span>
<span class="go">M( 0,  1),</span>
<span class="go">M(-1,  0),</span>
<span class="go">M( 0, -1)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">P1xP1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">())</span>
<span class="go">M(-1,  0),</span>
<span class="go">M( 0, -1)</span>
<span class="go">in 2-d lattice M</span>
<span class="go">M( 0, 1),</span>
<span class="go">M(-1, 0)</span>
<span class="go">in 2-d lattice M</span>
<span class="go">M(1, 0),</span>
<span class="go">M(0, 1)</span>
<span class="go">in 2-d lattice M</span>
<span class="go">M(1,  0),</span>
<span class="go">M(0, -1)</span>
<span class="go">in 2-d lattice M</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.geometry.fan.Fan">
<span class="sig-prename descclassname"><span class="pre">sage.geometry.fan.</span></span><span class="sig-name descname"><span class="pre">Fan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_complete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard_faces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_arrangement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.Fan" title="Permalink to this definition">#</a></dt>
<dd><p>Construct a rational polyhedral fan.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Approximate time to construct a fan consisting of <span class="math notranslate nohighlight">\(n\)</span> cones is <span class="math notranslate nohighlight">\(n^2/5\)</span>
seconds. That is half an hour for 100 cones. This time can be
significantly reduced in the future, but it is still likely to be
<span class="math notranslate nohighlight">\(\sim n^2\)</span> (with, say, <span class="math notranslate nohighlight">\(/500\)</span> instead of <span class="math notranslate nohighlight">\(/5\)</span>). If you know that your
input does form a valid fan, use <code class="docutils literal notranslate"><span class="pre">check=False</span></code> option to skip
consistency checks.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cones</span></code> – list of either
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cone</span></code></a> objects
or lists of integers interpreted as indices of generating rays in
<code class="docutils literal notranslate"><span class="pre">rays</span></code>. These must be only <strong>maximal</strong> cones of the fan, unless
<code class="docutils literal notranslate"><span class="pre">discard_faces=True</span></code> or <code class="docutils literal notranslate"><span class="pre">allow_arrangement=True</span></code> option is specified;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rays</span></code> – list of rays given as list or vectors convertible to the
rational extension of <code class="docutils literal notranslate"><span class="pre">lattice</span></code>. If <code class="docutils literal notranslate"><span class="pre">cones</span></code> are given by
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cone</span></code></a> objects
<code class="docutils literal notranslate"><span class="pre">rays</span></code> may be determined automatically. You still may give them
explicitly to ensure a particular order of rays in the fan. In this case
you must list all rays that appear in <code class="docutils literal notranslate"><span class="pre">cones</span></code>. You can give “extra”
ones if it is convenient (e.g. if you have a big list of rays for
several fans), but all “extra” rays will be discarded;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lattice</span></code> – <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricLattice</span></code></a>, <span class="math notranslate nohighlight">\(\ZZ^n\)</span>, or any
other object that behaves like these. If not specified, an attempt will
be made to determine an appropriate toric lattice automatically;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – by default the input data will be checked for correctness
(e.g. that intersection of any two given cones is a face of each),
unless <code class="docutils literal notranslate"><span class="pre">allow_arrangement=True</span></code> option is specified. If you
know for sure that the input is correct, you may significantly decrease
construction time using <code class="docutils literal notranslate"><span class="pre">check=False</span></code> option;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalize</span></code> – you can further speed up construction using
<code class="docutils literal notranslate"><span class="pre">normalize=False</span></code> option. In this case <code class="docutils literal notranslate"><span class="pre">cones</span></code> must be a list of
<strong>sorted</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">tuples</span></code> and <code class="docutils literal notranslate"><span class="pre">rays</span></code> must be immutable primitive
vectors in <code class="docutils literal notranslate"><span class="pre">lattice</span></code>. In general, you should not use this option, it
is designed for code optimization and does not give as drastic
improvement in speed as the previous one;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_complete</span></code> – every fan can determine on its own if it is complete
or not, however it can take quite a bit of time for “big” fans with many
generating cones. On the other hand, in some situations it is known in
advance that a certain fan is complete. In this case you can pass
<code class="docutils literal notranslate"><span class="pre">is_complete=True</span></code> option to speed up some computations. You may also
pass <code class="docutils literal notranslate"><span class="pre">is_complete=False</span></code> option, although it is less likely to be
beneficial. Of course, passing a wrong value can compromise the
integrity of data structures of the fan and lead to wrong results, so
you should be very careful if you decide to use this option;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">virtual_rays</span></code> – (optional, computed automatically if needed) a list of
ray generators to be used for <code class="xref py py-meth docutils literal notranslate"><span class="pre">virtual_rays()</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">discard_faces</span></code> – by default, the fan constructor expects the list of
<strong>maximal</strong> cones, unless <code class="docutils literal notranslate"><span class="pre">allow_arrangement=True</span></code> option is specified.
If you provide “extra” ones and leave <code class="docutils literal notranslate"><span class="pre">allow_arrangement=False</span></code> (default)
and <code class="docutils literal notranslate"><span class="pre">check=True</span></code> (default), an exception will be raised.
If you provide “extra” cones and set <code class="docutils literal notranslate"><span class="pre">allow_arrangement=False</span></code> (default)
and <code class="docutils literal notranslate"><span class="pre">check=False</span></code>, you may get wrong results as assumptions on internal
data structures will be invalid. If you want the fan constructor to
select the maximal cones from the given input, you may provide
<code class="docutils literal notranslate"><span class="pre">discard_faces=True</span></code> option (it works both for <code class="docutils literal notranslate"><span class="pre">check=True</span></code> and
<code class="docutils literal notranslate"><span class="pre">check=False</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_arrangement</span></code> – by default (<code class="docutils literal notranslate"><span class="pre">allow_arrangement=False</span></code>),
the fan constructor expects that the intersection of any two given cones is
a face of each. If <code class="docutils literal notranslate"><span class="pre">allow_arrangement=True</span></code> option is specified, then
construct a rational polyhedralfan from the cone arrangement, so that the
union of the cones in the polyhedral fan equals to the union of the given
cones, and each given cone is the union of some cones in the polyhedral fan.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">fan</span></code></a></p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>In 2 dimensions you can cyclically order the rays. Hence the
rays determine a unique maximal fan without having to specify
the cones, and you can use <a class="reference internal" href="#sage.geometry.fan.Fan2d" title="sage.geometry.fan.Fan2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">Fan2d()</span></code></a> to construct this
fan from just the rays.</p>
</div>
<p>EXAMPLES:</p>
<p>Let’s construct a fan corresponding to the projective plane in several
ways:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone3</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: you have provided 3 cones, but only 2 of them are maximal!</span>
<span class="go">Use discard_faces=True if you indeed need to construct a fan from</span>
<span class="go">these cones.</span>
</pre></div>
</div>
<p>Oops! There was a typo and <code class="docutils literal notranslate"><span class="pre">cone2</span></code> was listed twice as a generating cone
of the fan. If it was intentional (e.g. the list of cones was generated
automatically and it is possible that it contains repetitions or faces of
other cones), use <code class="docutils literal notranslate"><span class="pre">discard_faces=True</span></code> option:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">,</span> <span class="n">cone2</span><span class="p">],</span> <span class="n">discard_faces</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>However, in this case it was definitely a typo, since the fan of
<span class="math notranslate nohighlight">\(\mathbb{P}^2\)</span> has 3 maximal cones:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">,</span> <span class="n">cone3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Looks better. An alternative way is</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">cones</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">P2a</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="n">rays</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2a</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">==</span> <span class="n">P2a</span>
<span class="go">False</span>
</pre></div>
</div>
<p>That may seem wrong, but it is not:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">P2a</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.is_equivalent" title="sage.geometry.fan.RationalPolyhedralFan.is_equivalent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_equivalent()</span></code></a> for details.</p>
<p>Yet another way to construct this fan is</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2b</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="n">rays</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2b</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">P2a</span> <span class="o">==</span> <span class="n">P2b</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If you try the above examples, you are likely to notice the difference in
speed, so when you are sure that everything is correct, it is a good idea
to use <code class="docutils literal notranslate"><span class="pre">check=False</span></code> option. On the other hand, it is usually <strong>NOT</strong> a
good idea to use <code class="docutils literal notranslate"><span class="pre">normalize=False</span></code> option:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2c</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="n">rays</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;tuple&#39; object has no attribute &#39;parent&#39;</span>
</pre></div>
</div>
<p>Yet another way is to use functions <a class="reference internal" href="#sage.geometry.fan.FaceFan" title="sage.geometry.fan.FaceFan"><code class="xref py py-func docutils literal notranslate"><span class="pre">FaceFan()</span></code></a> and <a class="reference internal" href="#sage.geometry.fan.NormalFan" title="sage.geometry.fan.NormalFan"><code class="xref py py-func docutils literal notranslate"><span class="pre">NormalFan()</span></code></a>
to construct fans from <a class="reference internal" href="lattice_polytope.html#sage.geometry.lattice_polytope.LatticePolytopeClass" title="sage.geometry.lattice_polytope.LatticePolytopeClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">lattice</span> <span class="pre">polytopes</span></code></a>.</p>
<p>We have not yet used <code class="docutils literal notranslate"><span class="pre">lattice</span></code> argument, since if was determined
automatically:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">2-d lattice N</span>
<span class="gp">sage: </span><span class="n">P2b</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">2-d lattice N</span>
</pre></div>
</div>
<p>However, it is necessary to specify it explicitly if you want to construct
a fan without rays or cones:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Fan</span><span class="p">([],</span> <span class="p">[])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: you must specify the lattice</span>
<span class="go">when you construct a fan without rays and cones!</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">Rational polyhedral fan in 2-d lattice L</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">lattice_dim</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>In the following examples, we test the <code class="docutils literal notranslate"><span class="pre">allow_arrangement=True</span></code> option.
See <a class="reference external" href="https://github.com/sagemath/sage/issues/25122">github issue #25122</a>.</p>
<p>The intersection of the two cones is not a face of each. Therefore,
they do not belong to the same rational polyhedral fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">is_face_of</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">is_face_of</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Fan</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: these cones cannot belong to the same fan!</span>
<span class="go">...</span>
</pre></div>
</div>
<p>Let’s construct the fan using <code class="docutils literal notranslate"><span class="pre">allow_arrangement=True</span></code> option:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">],</span> <span class="n">allow_arrangement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
<p>Another example where cone c2 is inside cone c1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">],</span> <span class="n">allow_arrangement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>                                                                <span class="c1"># needs sage.plot</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
<p>Cones of different dimension:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c3</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">],</span> <span class="n">allow_arrangement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">()))</span>
<span class="go">[N(-1, -2)]</span>
<span class="go">[N(0, 1), N(1, 2)]</span>
<span class="go">[N(1, 0), N(2, 1)]</span>
<span class="go">[N(1, 2), N(2, 1)]</span>
</pre></div>
</div>
<p>A 3-d cone and a 1-d cone:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c3</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c3</span><span class="p">],</span> <span class="n">allow_arrangement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>                                                               <span class="c1"># needs sage.plot</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
<p>A 3-d cone and two 2-d cones:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c2v</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">c2h</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">c2v</span><span class="p">,</span> <span class="n">c2h</span><span class="p">,</span> <span class="n">c3</span><span class="p">],</span> <span class="n">allow_arrangement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.geometry.fan.Fan2d">
<span class="sig-prename descclassname"><span class="pre">sage.geometry.fan.</span></span><span class="sig-name descname"><span class="pre">Fan2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.Fan2d" title="Permalink to this definition">#</a></dt>
<dd><p>Construct the maximal 2-d fan with given <code class="docutils literal notranslate"><span class="pre">rays</span></code>.</p>
<p>In two dimensions we can uniquely construct a fan from just rays,
just by cyclically ordering the rays and constructing as many
cones as possible. This is why we implement a special constructor
for this case.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rays</span></code> – list of rays given as list or vectors convertible to
the rational extension of <code class="docutils literal notranslate"><span class="pre">lattice</span></code>. Duplicate rays are
removed without changing the ordering of the remaining rays.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lattice</span></code> – <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricLattice</span></code></a>, <span class="math notranslate nohighlight">\(\ZZ^n\)</span>, or any
other object that behaves like these. If not specified, an attempt will
be made to determine an appropriate toric lattice automatically.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;myN&#39;</span><span class="p">))</span>
<span class="go">Rational polyhedral fan in 2-d lattice myN</span>
</pre></div>
</div>
<p>The ray order is as specified, even if it is not the cyclic order:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(0, 1),</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">==</span> <span class="n">fan2</span><span class="p">,</span> <span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">(False, True)</span>

<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan</span><span class="p">]</span>
<span class="go">[(2, 1), (1, 3), (3, 0), (0, 2)]</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.geometry.fan.NormalFan">
<span class="sig-prename descclassname"><span class="pre">sage.geometry.fan.</span></span><span class="sig-name descname"><span class="pre">NormalFan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polytope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.NormalFan" title="Permalink to this definition">#</a></dt>
<dd><p>Construct the normal fan of the given rational <code class="docutils literal notranslate"><span class="pre">polytope</span></code>.</p>
<p>This returns the inner normal fan. For the outer normal fan, use
<code class="docutils literal notranslate"><span class="pre">NormalFan(-P)</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">polytope</span></code> – a full-dimensional <a class="reference internal" href="polyhedron/constructor.html#sage.geometry.polyhedron.constructor.Polyhedron" title="sage.geometry.polyhedron.constructor.Polyhedron"><code class="xref py py-func docutils literal notranslate"><span class="pre">polytope</span></code></a> over <span class="math notranslate nohighlight">\(\QQ\)</span>
or:class:<span class="math notranslate nohighlight">\(lattice polytope
&lt;sage.geometry.lattice_polytope.LatticePolytopeClass&gt;\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lattice</span></code> – <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricLattice</span></code></a>, <span class="math notranslate nohighlight">\(\ZZ^n\)</span>, or any
other object that behaves like these. If not specified, an attempt will
be made to determine an appropriate toric lattice automatically.</p></li>
</ul>
<p>OUTPUT:</p>
<p><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a></p>
<p>See also <a class="reference internal" href="#sage.geometry.fan.FaceFan" title="sage.geometry.fan.FaceFan"><code class="xref py py-func docutils literal notranslate"><span class="pre">FaceFan()</span></code></a>.</p>
<p>EXAMPLES:</p>
<p>Let’s construct the fan corresponding to the product of two projective
lines:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">square</span> <span class="o">=</span> <span class="n">LatticePolytope</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1,  0),</span>
<span class="go">N( 0,  1),</span>
<span class="go">N(-1,  0),</span>
<span class="go">N( 0, -1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">P1xP1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">())</span>
<span class="go">N(-1,  0),</span>
<span class="go">N( 0, -1)</span>
<span class="go">in 2-d lattice N</span>
<span class="go">N(1,  0),</span>
<span class="go">N(0, -1)</span>
<span class="go">in 2-d lattice N</span>
<span class="go">N(1, 0),</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
<span class="go">N( 0, 1),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">cuboctahed</span> <span class="o">=</span> <span class="n">polytopes</span><span class="o">.</span><span class="n">cuboctahedron</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">NormalFan</span><span class="p">(</span><span class="n">cuboctahed</span><span class="p">)</span>
<span class="go">Rational polyhedral fan in 3-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.geometry.fan.</span></span><span class="sig-name descname"><span class="pre">RationalPolyhedralFan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_complete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="cone.html#sage.geometry.cone.IntegralRayCollection" title="sage.geometry.cone.IntegralRayCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegralRayCollection</span></code></a>, <a class="reference external" href="https://docs.python.org/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>, <a class="reference external" href="https://docs.python.org/library/collections.abc.html#collections.abc.Container" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Container</span></code></a></p>
<p>Create a rational polyhedral fan.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This class does not perform any checks of correctness of input nor
does it convert input into the standard representation. Use
<a class="reference internal" href="#sage.geometry.fan.Fan" title="sage.geometry.fan.Fan"><code class="xref py py-func docutils literal notranslate"><span class="pre">Fan()</span></code></a> to construct fans from “raw data” or <a class="reference internal" href="#sage.geometry.fan.FaceFan" title="sage.geometry.fan.FaceFan"><code class="xref py py-func docutils literal notranslate"><span class="pre">FaceFan()</span></code></a> and
<a class="reference internal" href="#sage.geometry.fan.NormalFan" title="sage.geometry.fan.NormalFan"><code class="xref py py-func docutils literal notranslate"><span class="pre">NormalFan()</span></code></a> to get fans associated to polytopes.</p>
</div>
<p>Fans are immutable, but they cache most of the returned values.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cones</span></code> – list of generating cones of the fan, each cone given as a
list of indices of its generating rays in <code class="docutils literal notranslate"><span class="pre">rays</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rays</span></code> – list of immutable primitive vectors in <code class="docutils literal notranslate"><span class="pre">lattice</span></code>
consisting of exactly the rays of the fan (i.e. no “extra” ones);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lattice</span></code> – <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricLattice</span></code></a>, <span class="math notranslate nohighlight">\(\ZZ^n\)</span>, or any
other object that behaves like these. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it will be determined
as <a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.parent" title="(in Parents and Elements v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">parent()</span></code></a> of the first ray. Of course, this cannot be done if
there are no rays, so in this case you must give an appropriate
<code class="docutils literal notranslate"><span class="pre">lattice</span></code> directly;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_complete</span></code> – if given, must be <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> depending on
whether this fan is complete or not. By default, it will be determined
automatically if necessary;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">virtual_rays</span></code> – if given, must be a list of immutable primitive
vectors in <code class="docutils literal notranslate"><span class="pre">lattice</span></code>, see <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.virtual_rays" title="sage.geometry.fan.RationalPolyhedralFan.virtual_rays"><code class="xref py py-meth docutils literal notranslate"><span class="pre">virtual_rays()</span></code></a> for details. By default,
it will be determined automatically if necessary.</p></li>
</ul>
<p>OUTPUT:</p>
<p>rational polyhedral fan</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.Gale_transform">
<span class="sig-name descname"><span class="pre">Gale_transform</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.Gale_transform" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Gale transform of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>A matrix over <span class="math notranslate nohighlight">\(ZZ\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                                   <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">Gale_transform</span><span class="p">()</span>                                                  <span class="c1"># needs palp</span>
<span class="go">[ 1  1  0  0 -2]</span>
<span class="go">[ 0  0  1  1 -2]</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>                                                         <span class="c1"># needs palp</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.Stanley_Reisner_ideal">
<span class="sig-name descname"><span class="pre">Stanley_Reisner_ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ring</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.Stanley_Reisner_ideal" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Stanley-Reisner ideal.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>A polynomial ring in <code class="docutils literal notranslate"><span class="pre">self.nrays()</span></code> variables.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The Stanley-Reisner ideal in the given polynomial ring</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span>
<span class="gp">....: </span>          <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">Stanley_Reisner_ideal</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;A, B, C, D, E&#39;</span><span class="p">))</span>
<span class="go">Ideal (A*E, C*D, A*B*C, B*D*E) of</span>
<span class="go"> Multivariate Polynomial Ring in A, B, C, D, E over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.cartesian_product">
<span class="sig-name descname"><span class="pre">cartesian_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.cartesian_product" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Cartesian product of <code class="docutils literal notranslate"><span class="pre">self</span></code> with <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lattice</span></code> – (optional) the ambient lattice for the
Cartesian product fan. By default, the direct sum of the
ambient lattices of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> is constructed.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">fan</span></code></a> whose cones are all pairwise
Cartesian products of the cones of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">cones</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">Rational polyhedral fan in 3-d lattice K+L</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.common_refinement">
<span class="sig-name descname"><span class="pre">common_refinement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.common_refinement" title="Permalink to this definition">#</a></dt>
<dd><p>Return the common refinement of this fan and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">fan</span></code></a> in the same
<code class="xref py py-meth docutils literal notranslate"><span class="pre">lattice()</span></code> and with the same support as this fan</p></li>
</ul>
<p>OUTPUT:</p>
<p>a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">fan</span></code></a></p>
<p>EXAMPLES:</p>
<p>Refining a fan with itself gives itself:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F0</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F0</span><span class="o">.</span><span class="n">common_refinement</span><span class="p">(</span><span class="n">F0</span><span class="p">)</span> <span class="o">==</span> <span class="n">F0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A more complex example with complete fans:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)])</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F3</span> <span class="o">=</span> <span class="n">F2</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">F1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F4</span> <span class="o">=</span> <span class="n">F1</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">FF</span> <span class="o">=</span> <span class="n">F3</span><span class="o">.</span><span class="n">common_refinement</span><span class="p">(</span><span class="n">F4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F3</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">F4</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">FF</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">13</span>
</pre></div>
</div>
<p>An example with two non-complete fans with the same support:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F5</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F6</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F5</span><span class="o">.</span><span class="n">common_refinement</span><span class="p">(</span><span class="n">F6</span><span class="p">)</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Both fans must live in the same lattice:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F0</span><span class="o">.</span><span class="n">common_refinement</span><span class="p">(</span><span class="n">F1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: the fans are not in the same lattice</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.complex">
<span class="sig-name descname"><span class="pre">complex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_ring=Integer</span> <span class="pre">Ring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extended=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.complex" title="Permalink to this definition">#</a></dt>
<dd><p>Return the chain complex of the fan.</p>
<p>To a <span class="math notranslate nohighlight">\(d\)</span>-dimensional fan <span class="math notranslate nohighlight">\(\Sigma\)</span>, one can canonically
associate a chain complex <span class="math notranslate nohighlight">\(K^\bullet\)</span></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[0 \longrightarrow
\ZZ^{\Sigma(d)} \longrightarrow
\ZZ^{\Sigma(d-1)} \longrightarrow
\cdots \longrightarrow
\ZZ^{\Sigma(0)} \longrightarrow
0\]</div>
</div>
<p>where the leftmost non-zero entry is in degree <span class="math notranslate nohighlight">\(0\)</span> and the
rightmost entry in degree <span class="math notranslate nohighlight">\(d\)</span>. See <a class="reference internal" href="../../../references/index.html#kly1990" id="id1"><span>[Kly1990]</span></a>, eq. (3.2). This
complex computes the homology of <span class="math notranslate nohighlight">\(|\Sigma|\subset N_\RR\)</span> with
arbitrary support,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[H_i(K) = H_{d-i}(|\Sigma|, \ZZ)_{\text{non-cpct}}\]</div>
</div>
<p>For a complete fan, this is just the non-compactly supported
homology of <span class="math notranslate nohighlight">\(\RR^d\)</span>. In this case, <span class="math notranslate nohighlight">\(H_0(K)=\ZZ\)</span> and <span class="math notranslate nohighlight">\(0\)</span> in all
non-zero degrees.</p>
<p>For a complete fan, there is an extended chain complex</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[0 \longrightarrow
\ZZ \longrightarrow
\ZZ^{\Sigma(d)} \longrightarrow
\ZZ^{\Sigma(d-1)} \longrightarrow
\cdots \longrightarrow
\ZZ^{\Sigma(0)} \longrightarrow
0\]</div>
</div>
<p>where we take the first <span class="math notranslate nohighlight">\(\ZZ\)</span> term to be in degree -1. This
complex is an exact sequence, that is, all homology groups
vanish.</p>
<p>The orientation of each cone is chosen as in
<a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.oriented_boundary" title="sage.geometry.fan.RationalPolyhedralFan.oriented_boundary"><code class="xref py py-meth docutils literal notranslate"><span class="pre">oriented_boundary()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">extended</span></code> – Boolean (default:False). Whether to
construct the extended complex, that is, including the
<span class="math notranslate nohighlight">\(\ZZ\)</span>-term at degree -1 or not.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base_ring</span></code> – A ring (default: <code class="docutils literal notranslate"><span class="pre">ZZ</span></code>). The ring to use
instead of <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The complex associated to the fan as a <code class="xref py py-class docutils literal notranslate"><span class="pre">ChainComplex</span></code>. Raises a
<code class="docutils literal notranslate"><span class="pre">ValueError</span></code> if the extended complex is requested for a
non-complete fan.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K_normal</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">();</span> <span class="n">K_normal</span>
<span class="go">Chain complex with at most 4 nonzero terms over Integer Ring</span>
<span class="gp">sage: </span><span class="n">K_normal</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: Z, 1: 0, 2: 0, 3: 0}</span>
<span class="gp">sage: </span><span class="n">K_extended</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">K_extended</span>
<span class="go">Chain complex with at most 5 nonzero terms over Integer Ring</span>
<span class="gp">sage: </span><span class="n">K_extended</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{-1: 0, 0: 0, 1: 0, 2: 0, 3: 0}</span>
</pre></div>
</div>
<p>Homology computations are much faster over <span class="math notranslate nohighlight">\(\QQ\)</span> if you do not
care about the torsion coefficients:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2_123</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                 <span class="c1"># needs palp</span>
<span class="gp">....: </span>                                       <span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Chain complex with at most 4 nonzero terms over Rational Field</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>                                                          <span class="c1"># needs palp</span>
<span class="go">{-1: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
</pre></div>
</div>
<p>The extended complex is only defined for complete fans:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: The extended complex is only defined for complete fans!</span>
</pre></div>
</div>
<p>The definition of the complex does not refer to the ambient
space of the fan, so it does not distinguish a fan from the
same fan embedded in a subspace:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)]),</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])])</span><span class="o">.</span><span class="n">complex</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])])</span><span class="o">.</span><span class="n">complex</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">==</span> <span class="n">K2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Things get more complicated for non-complete fans:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]),</span>
<span class="gp">....: </span>           <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span>
<span class="gp">....: </span>           <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">()</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: 0, 1: 0, 2: Z x Z, 3: 0}</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span>
<span class="gp">....: </span>           <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">()</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: 0, 1: 0, 2: Z, 3: 0}</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">()</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: 0, 1: 0, 2: 0, 3: 0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.cone_containing">
<span class="sig-name descname"><span class="pre">cone_containing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.cone_containing" title="Permalink to this definition">#</a></dt>
<dd><p>Return the smallest cone of <code class="docutils literal notranslate"><span class="pre">self</span></code> containing all given points.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>either one or more indices of rays of <code class="docutils literal notranslate"><span class="pre">self</span></code>, or one or more
objects representing points of the ambient space of <code class="docutils literal notranslate"><span class="pre">self</span></code>, or a
list of such objects (you CANNOT give a list of indices).</p></li>
</ul>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span> <span class="pre">of</span> <span class="pre">fan</span></code></a> whose ambient fan is
<code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We think of the origin as of the smallest cone containing no rays
at all. If there is no ray in <code class="docutils literal notranslate"><span class="pre">self</span></code> that contains all <code class="docutils literal notranslate"><span class="pre">rays</span></code>,
a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> exception will be raised.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(0, -1),</span>
<span class="go">N(0,  1),</span>
<span class="go">N(1,  0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># ray index</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># ray indices</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: there is no cone in</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="go">containing all of the given rays! Ray indices: [0, 1]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># ray indices</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># point</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span> <span class="c1"># point</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">()</span>
<span class="go">0-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">0-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: there is no cone in</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="go">containing all of the given points! Points: [N(-1, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.cone_lattice">
<span class="sig-name descname"><span class="pre">cone_lattice</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.cone_lattice" title="Permalink to this definition">#</a></dt>
<dd><p>Return the cone lattice of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This lattice will have the origin as the bottom (we do not include the
empty set as a cone) and the fan itself as the top.</p>
<p>OUTPUT:</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">finite</span> <span class="pre">poset</span> <span class="pre">&lt;sage.combinat.posets.posets.FinitePoset</span></code> of
<a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal notranslate"><span class="pre">cones</span> <span class="pre">of</span> <span class="pre">fan</span></code></a>, behaving like “regular” cones,
but also containing the information about their relation to this
fan, namely, the contained rays and containing generating cones. The
top of the lattice will be this fan itself (<em>which is not a</em>
<a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span> <span class="pre">of</span> <span class="pre">fan</span></code></a>).</p>
<p>See also <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.cones" title="sage.geometry.fan.RationalPolyhedralFan.cones"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cones()</span></code></a>.</p>
<p>EXAMPLES:</p>
<p>Cone lattices can be computed for arbitrary fans:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(-1, 0),</span>
<span class="go">N( 0, 1),</span>
<span class="go">N( 1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">())</span>
<span class="go">(1, 2)</span>
<span class="go">(0,)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">cone_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Finite poset containing 6 elements with distinguished linear extension</span>
</pre></div>
</div>
<p>These 6 elements are the origin, three rays, one two-dimensional
cone, and the fan itself. Since we do add the fan itself as the
largest face, you should be a little bit careful with this last
element:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">())</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;RationalPolyhedralFan&#39;</span>
<span class="go">object has no attribute &#39;ambient_ray_indices&#39;</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">top</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
<p>For example, you can do</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">l</span><span class="p">])</span>
<span class="go">[()]</span>
<span class="go">[(0,), (1,), (2,)]</span>
<span class="go">[(1, 2)]</span>
</pre></div>
</div>
<p>If the fan is complete, its cone lattice is atomic and coatomic and
can (and will!) be computed in a much more efficient way, but the
interface is exactly the same:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                                   <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">cone_lattice</span><span class="p">()</span>                                                <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>                                         <span class="c1"># needs palp</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">l</span><span class="p">])</span>
<span class="go">[()]</span>
<span class="go">[(0,), (1,), (2,), (3,)]</span>
<span class="go">[(0, 2), (1, 2), (0, 3), (1, 3)]</span>
</pre></div>
</div>
<p>Let’s also consider the cone lattice of a fan generated by a single
cone:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">cone_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Finite poset containing 5 elements with distinguished linear extension</span>
</pre></div>
</div>
<p>Here these 5 elements correspond to the origin, two rays, one
generating cone of dimension two, and the whole fan. While this single
cone “is” the whole fan, it is consistent and convenient to
distinguish them in the cone lattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.cones">
<span class="sig-name descname"><span class="pre">cones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.cones" title="Permalink to this definition">#</a></dt>
<dd><p>Return the specified cones of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dim</span></code> – dimension of the requested cones;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">codim</span></code> – codimension of the requested cones.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can specify at most one input parameter.</p>
</div>
<p>OUTPUT:</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of cones of <code class="docutils literal notranslate"><span class="pre">self</span></code> of the specified (co)dimension,
if either <code class="docutils literal notranslate"><span class="pre">dim</span></code> or <code class="docutils literal notranslate"><span class="pre">codim</span></code> is given. Otherwise <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of
such tuples for all existing dimensions.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="n">codim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(0-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan</span><span class="o">.</span><span class="n">cones</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">cone</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">N(-1, 0)</span>
<span class="go">N(0, 1)</span>
<span class="go">N(1, 0)</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">cones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
</pre></div>
</div>
<p>You cannot specify both dimension and codimension, even if they
“agree”:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">codim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: dimension and codimension</span>
<span class="go">cannot be specified together!</span>
</pre></div>
</div>
<p>But it is OK to ask for cones of too high or low (co)dimension:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="n">codim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.contains" title="Permalink to this definition">#</a></dt>
<dd><p>Check if a given <code class="docutils literal notranslate"><span class="pre">cone</span></code> is equivalent to a cone of the fan.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cone</span></code> – anything.</p></li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">False</span></code> if <code class="docutils literal notranslate"><span class="pre">cone</span></code> is not a cone or if <code class="docutils literal notranslate"><span class="pre">cone</span></code> is not
equivalent to a cone of the fan, <code class="docutils literal notranslate"><span class="pre">True</span></code> otherwise</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Recall that a fan is a (finite) collection of cones. A
cone is contained in a fan if it is equivalent to one of
the cones of the fan. In particular, it is possible that
all rays of the cone are in the fan, but the cone itself
is not.</p>
<p>If you want to know whether a point is in the support of
the fan, you should use <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.support_contains" title="sage.geometry.fan.RationalPolyhedralFan.support_contains"><code class="xref py py-meth docutils literal notranslate"><span class="pre">support_contains()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>We first construct a simple fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
</pre></div>
</div>
<p>Now we check if some cones are in this fan. First, we make sure that
the order of rays of the input cone does not matter (<code class="docutils literal notranslate"><span class="pre">check=False</span></code>
option ensures that rays of these cones will be listed exactly as they
are given):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now we check that a non-generating cone is in our fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span> <span class="ow">in</span> <span class="n">f</span>   <span class="c1"># equivalent to the previous command</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Finally, we test some cones which are not in this fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A point is not a cone:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">lattice</span><span class="p">()(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">n</span>
<span class="go">N(1, 1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.embed">
<span class="sig-name descname"><span class="pre">embed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.embed" title="Permalink to this definition">#</a></dt>
<dd><p>Return the cone equivalent to the given one, but sitting in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>You may need to use this method before calling methods of <code class="docutils literal notranslate"><span class="pre">cone</span></code> that
depend on the ambient structure, such as
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone.ambient_ray_indices" title="sage.geometry.cone.ConvexRationalPolyhedralCone.ambient_ray_indices"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ambient_ray_indices()</span></code></a>
or
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of"><code class="xref py py-meth docutils literal notranslate"><span class="pre">facet_of()</span></code></a>. The
cone returned by this method will have <code class="docutils literal notranslate"><span class="pre">self</span></code> as ambient. If <code class="docutils literal notranslate"><span class="pre">cone</span></code>
does not represent a valid cone of <code class="docutils literal notranslate"><span class="pre">self</span></code>, <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> exception
is raised.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is very quick if <code class="docutils literal notranslate"><span class="pre">self</span></code> is already the ambient
structure of <code class="docutils literal notranslate"><span class="pre">cone</span></code>, so you can use without extra checks and
performance hit even if <code class="docutils literal notranslate"><span class="pre">cone</span></code> is likely to sit in <code class="docutils literal notranslate"><span class="pre">self</span></code> but
in principle may not.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cone</span></code> – a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span></code></a>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a <a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span> <span class="pre">of</span> <span class="pre">fan</span></code></a>, equivalent to <code class="docutils literal notranslate"><span class="pre">cone</span></code> but
sitting inside <code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<p>Let’s take a 3-d fan generated by a cone on 4 rays:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])])</span>
</pre></div>
</div>
<p>Then any ray generates a 1-d cone of this fan, but if you construct
such a cone directly, it will not “sit” inside the fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ray</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ray</span>
<span class="go">1-d cone in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">ray</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0,)</span>
<span class="gp">sage: </span><span class="n">ray</span><span class="o">.</span><span class="n">adjacent</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">ray</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span>
<span class="go">1-d cone in 3-d lattice N</span>
</pre></div>
</div>
<p>If we want to operate with this ray as a part of the fan, we need to
embed it first:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e_ray</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">ray</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e_ray</span>
<span class="go">1-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(0, -1, 1)</span>
<span class="go">in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">e_ray</span> <span class="ow">is</span> <span class="n">ray</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">ray</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(3,)</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">adjacent</span><span class="p">()</span>
<span class="go">(1-d cone of Rational polyhedral fan in 3-d lattice N,</span>
<span class="go"> 1-d cone of Rational polyhedral fan in 3-d lattice N)</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 3-d lattice N</span>
</pre></div>
</div>
<p>Not every cone can be embedded into a fixed fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 1-d cone in 3-d lattice N does not belong</span>
<span class="go">to Rational polyhedral fan in 3-d lattice N!</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 2-d cone in 3-d lattice N does not belong</span>
<span class="go">to Rational polyhedral fan in 3-d lattice N!</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.f_vector">
<span class="sig-name descname"><span class="pre">f_vector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.f_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Return the f-vector of the fan.</p>
<p>This is the tuple <span class="math notranslate nohighlight">\((f_0, f_1, \ldots, f_d)\)</span>
where <span class="math notranslate nohighlight">\(f_i\)</span> is the number of cones of dimension <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">ClusterAlgebra</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">cluster_fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">f_vector</span><span class="p">()</span>
<span class="go">(1, 5, 5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.generating_cone">
<span class="sig-name descname"><span class="pre">generating_cone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.generating_cone" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">n</span></code>-th generating cone of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer, the index of a generating cone.</p></li>
</ul>
<p>OUTPUT:</p>
<p><a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span> <span class="pre">of</span> <span class="pre">fan</span></code></a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                                   <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                                                <span class="c1"># needs palp</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.generating_cones">
<span class="sig-name descname"><span class="pre">generating_cones</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.generating_cones" title="Permalink to this definition">#</a></dt>
<dd><p>Return generating cones of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal notranslate"><span class="pre">cones</span> <span class="pre">of</span> <span class="pre">fan</span></code></a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                                   <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>                                                <span class="c1"># needs palp</span>
<span class="go">(2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N)</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>
<span class="go">(2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 1-d cone of Rational polyhedral fan in 2-d lattice N)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.is_complete">
<span class="sig-name descname"><span class="pre">is_complete</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.is_complete" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is complete.</p>
<p>A rational polyhedral fan is <em>complete</em> if its cones fill the whole
space.</p>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is complete and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                                   <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>                                                     <span class="c1"># needs palp</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.is_equivalent">
<span class="sig-name descname"><span class="pre">is_equivalent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.is_equivalent" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is “mathematically” the same as <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> - fan.</p></li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> define the same fans as
collections of equivalent cones in the same lattice, <code class="docutils literal notranslate"><span class="pre">False</span></code>
otherwise.</p>
<p>There are three different equivalences between fans <span class="math notranslate nohighlight">\(F_1\)</span> and <span class="math notranslate nohighlight">\(F_2\)</span>
in the same lattice:</p>
<ol class="arabic simple">
<li><p>They have the same rays in the same order and the same generating
cones in the same order.
This is tested by <code class="docutils literal notranslate"><span class="pre">F1</span> <span class="pre">==</span> <span class="pre">F2</span></code>.</p></li>
<li><p>They have the same rays and the same generating cones without
taking into account any order.
This is tested by <code class="docutils literal notranslate"><span class="pre">F1.is_equivalent(F2)</span></code>.</p></li>
<li><p>They are in the same orbit of <span class="math notranslate nohighlight">\(GL(n,\ZZ)\)</span> (and, therefore,
correspond to isomorphic toric varieties).
This is tested by <code class="docutils literal notranslate"><span class="pre">F1.is_isomorphic(F2)</span></code>.</p></li>
</ol>
<p>Note that <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.virtual_rays" title="sage.geometry.fan.RationalPolyhedralFan.virtual_rays"><code class="xref py py-meth docutils literal notranslate"><span class="pre">virtual_rays()</span></code></a> are included into consideration for all
of the above equivalences.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan3</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">==</span> <span class="n">fan2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">==</span> <span class="n">fan3</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan3</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.is_isomorphic">
<span class="sig-name descname"><span class="pre">is_isomorphic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.is_isomorphic" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is in the same <span class="math notranslate nohighlight">\(GL(n, \ZZ)\)</span>-orbit as <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>There are three different equivalences between fans <span class="math notranslate nohighlight">\(F_1\)</span> and <span class="math notranslate nohighlight">\(F_2\)</span>
in the same lattice:</p>
<ol class="arabic simple">
<li><p>They have the same rays in the same order and the same generating
cones in the same order.
This is tested by <code class="docutils literal notranslate"><span class="pre">F1</span> <span class="pre">==</span> <span class="pre">F2</span></code>.</p></li>
<li><p>They have the same rays and the same generating cones without
taking into account any order.
This is tested by <code class="docutils literal notranslate"><span class="pre">F1.is_equivalent(F2)</span></code>.</p></li>
<li><p>They are in the same orbit of <span class="math notranslate nohighlight">\(GL(n,\ZZ)\)</span> (and, therefore,
correspond to isomorphic toric varieties).
This is tested by <code class="docutils literal notranslate"><span class="pre">F1.is_isomorphic(F2)</span></code>.</p></li>
</ol>
<p>Note that <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.virtual_rays" title="sage.geometry.fan.RationalPolyhedralFan.virtual_rays"><code class="xref py py-meth docutils literal notranslate"><span class="pre">virtual_rays()</span></code></a> are included into consideration for all
of the above equivalences.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">fan</span></code></a>.</p></li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> are in the same
<span class="math notranslate nohighlight">\(GL(n, \ZZ)\)</span>-orbit, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>If you want to obtain the actual fan isomorphism, use
<a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.isomorphism" title="sage.geometry.fan.RationalPolyhedralFan.isomorphism"><code class="xref py py-meth docutils literal notranslate"><span class="pre">isomorphism()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>Here we pick an <span class="math notranslate nohighlight">\(SL(2,\ZZ)\)</span> matrix <code class="docutils literal notranslate"><span class="pre">m</span></code> and then verify that
the image fan is isomorphic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">cones</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="n">rays</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="p">[</span><span class="n">vector</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">m</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rays</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">==</span> <span class="n">fan2</span>
<span class="go">False</span>
</pre></div>
</div>
<p>These fans are “mirrors” of each other:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">....: </span>           <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">==</span> <span class="n">fan2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">fan1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.is_simplicial">
<span class="sig-name descname"><span class="pre">is_simplicial</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.is_simplicial" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is simplicial.</p>
<p>A rational polyhedral fan is <strong>simplicial</strong> if all of its cones are,
i.e. primitive vectors along generating rays of every cone form a part
of a <em>rational</em> basis of the ambient space.</p>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is simplicial and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                                   <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>                                                   <span class="c1"># needs palp</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In fact, any fan in a two-dimensional ambient space is simplicial.
This is no longer the case in dimension three:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.is_smooth">
<span class="sig-name descname"><span class="pre">is_smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.is_smooth" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is smooth.</p>
<p>A rational polyhedral fan is <strong>smooth</strong> if all of its cones
are, i.e. primitive vectors along generating rays of every
cone form a part of an <em>integral</em> basis of the ambient
space. In this case the corresponding toric variety is smooth.</p>
<p>A fan in an <span class="math notranslate nohighlight">\(n\)</span>-dimensional lattice is smooth up to codimension <span class="math notranslate nohighlight">\(c\)</span>
if all cones of codimension greater than or equal to <span class="math notranslate nohighlight">\(c\)</span> are smooth,
i.e. if all cones of dimension less than or equal to <span class="math notranslate nohighlight">\(n-c\)</span> are smooth.
In this case the singular set of the corresponding toric variety is of
dimension less than <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">codim</span></code> – codimension in which smoothness has to be checked, by
default complete smoothness will be checked.</p></li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is smooth (in codimension <code class="docutils literal notranslate"><span class="pre">codim</span></code>, if it was
given) and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                                   <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>                                                       <span class="c1"># needs palp</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">(</span><span class="n">codim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(-1, -1),</span>
<span class="go">N(-1,  1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">-2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.isomorphism">
<span class="sig-name descname"><span class="pre">isomorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.isomorphism" title="Permalink to this definition">#</a></dt>
<dd><p>Return a fan isomorphism from <code class="docutils literal notranslate"><span class="pre">self</span></code> to <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – fan.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A fan isomorphism. If no such isomorphism exists, a
<a class="reference internal" href="fan_isomorphism.html#sage.geometry.fan_isomorphism.FanNotIsomorphicError" title="sage.geometry.fan_isomorphism.FanNotIsomorphicError"><code class="xref py py-class docutils literal notranslate"><span class="pre">FanNotIsomorphicError</span></code></a>
is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">cones</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="n">rays</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="p">[</span><span class="n">vector</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">m</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rays</span><span class="p">])</span>

<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">isomorphism</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[-2  3]</span>
<span class="go">[ 1 -1]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">isomorphism</span><span class="p">(</span><span class="n">fan1</span><span class="p">)</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1 3]</span>
<span class="go">[1 2]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">isomorphism</span><span class="p">(</span><span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">())</span>                          <span class="c1"># needs palp</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">FanNotIsomorphicError</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.linear_equivalence_ideal">
<span class="sig-name descname"><span class="pre">linear_equivalence_ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ring</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.linear_equivalence_ideal" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ideal generated by linear relations.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>A polynomial ring in <code class="docutils literal notranslate"><span class="pre">self.nrays()</span></code> variables.</p></li>
</ul>
<p>OUTPUT:</p>
<p>Return the ideal, in the given <code class="docutils literal notranslate"><span class="pre">ring</span></code>, generated by the
linear relations of the rays. In toric geometry, this
corresponds to rational equivalence of divisors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span>
<span class="gp">....: </span>          <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">linear_equivalence_ideal</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;A, B, C, D, E&#39;</span><span class="p">))</span>
<span class="go">Ideal (-3*A + 3*C - D + E, -2*A - 2*C - D - E, A + B + C + D + E) of</span>
<span class="go"> Multivariate Polynomial Ring in A, B, C, D, E over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.make_simplicial">
<span class="sig-name descname"><span class="pre">make_simplicial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.make_simplicial" title="Permalink to this definition">#</a></dt>
<dd><p>Construct a simplicial fan subdividing <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>It is a synonym for <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.subdivide" title="sage.geometry.fan.RationalPolyhedralFan.subdivide"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subdivide()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">make_simplicial=True</span></code>
option.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>this functions accepts only keyword arguments. See <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.subdivide" title="sage.geometry.fan.RationalPolyhedralFan.subdivide"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subdivide()</span></code></a>
for documentation.</p></li>
</ul>
<p>OUTPUT:</p>
<p><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">new_fan</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">make_simplicial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">new_fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">new_fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.ngenerating_cones">
<span class="sig-name descname"><span class="pre">ngenerating_cones</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.ngenerating_cones" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of generating cones of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                                   <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>                                               <span class="c1"># needs palp</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.oriented_boundary">
<span class="sig-name descname"><span class="pre">oriented_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.oriented_boundary" title="Permalink to this definition">#</a></dt>
<dd><p>Return the facets bounding <code class="docutils literal notranslate"><span class="pre">cone</span></code> with their induced
orientation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cone</span></code> – a cone of the fan or the whole fan.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The boundary cones of <code class="docutils literal notranslate"><span class="pre">cone</span></code> as a formal linear combination
of cones with coefficients <span class="math notranslate nohighlight">\(\pm 1\)</span>. Each summand is a facet of
<code class="docutils literal notranslate"><span class="pre">cone</span></code> and the coefficient indicates whether their (chosen)
orientation agrees or disagrees with the “outward normal
first” boundary orientation. Note that the orientation of any
individual cone is arbitrary. This method once and for all
picks orientations for all cones and then computes the
boundaries relative to that chosen orientation.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">cone</span></code> is the fan itself, the generating cones with their
orientation relative to the ambient space are returned.</p>
<p>See <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.complex" title="sage.geometry.fan.RationalPolyhedralFan.complex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">complex()</span></code></a> for the associated chain complex. If you
do not require the orientation, use <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone.facets" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cone.facets()</span></code></a>
instead.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">fan</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">bdry</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">cone</span><span class="p">);</span>  <span class="n">bdry</span>
<span class="go">-1-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="go">+ 1-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">bdry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">(-1, 1-d cone of Rational polyhedral fan in 3-d lattice N)</span>
<span class="gp">sage: </span><span class="n">bdry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">(1, 1-d cone of Rational polyhedral fan in 3-d lattice N)</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">bdry</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-0-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">bdry</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-0-d cone of Rational polyhedral fan in 3-d lattice N</span>
</pre></div>
</div>
<p>If you pass the fan itself, this method returns the
orientation of the generating cones which is determined by the
order of the rays in <code class="xref py py-meth docutils literal notranslate"><span class="pre">cone.ray_basis()</span></code></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>                                            <span class="c1"># needs palp</span>
<span class="go">-3-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="go">+ 3-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="go">- 3-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="go">+ 3-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>                                   <span class="c1"># needs palp</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()]</span>
<span class="go">[-1, 1, -1, 1]</span>
</pre></div>
</div>
<p>A non-full dimensional fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span>
<span class="go">0-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Plot <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>any options for toric plots (see <a class="reference internal" href="toric_plotter.html#sage.geometry.toric_plotter.options" title="sage.geometry.toric_plotter.options"><code class="xref py py-func docutils literal notranslate"><span class="pre">toric_plotter.options</span></code></a>), none are mandatory.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a plot</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                                     <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>                                                            <span class="c1"># needs palp sage.plot</span>
<span class="go">Graphics object consisting of 31 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.primitive_collections">
<span class="sig-name descname"><span class="pre">primitive_collections</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.primitive_collections" title="Permalink to this definition">#</a></dt>
<dd><p>Return the primitive collections.</p>
<p>OUTPUT:</p>
<p>Return the subsets <span class="math notranslate nohighlight">\(\{i_1,\dots,i_k\} \subset \{ 1,\dots,n\}\)</span>
such that</p>
<ul class="simple">
<li><p>The points <span class="math notranslate nohighlight">\(\{p_{i_1},\dots,p_{i_k}\}\)</span> do not span a cone of
the fan.</p></li>
<li><p>If you remove any one <span class="math notranslate nohighlight">\(p_{i_j}\)</span> from the set, then they do
span a cone of the fan.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By replacing the multiindices <span class="math notranslate nohighlight">\(\{i_1,\dots,i_k\}\)</span> of each
primitive collection with the monomials <span class="math notranslate nohighlight">\(x_{i_1}\cdots
x_{i_k}\)</span> one generates the Stanley-Reisner ideal in
<span class="math notranslate nohighlight">\(\ZZ[x_1,\dots]\)</span>.</p>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../references/index.html#bat1991" id="id2"><span>[Bat1991]</span></a></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span>
<span class="gp">....: </span>          <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">primitive_collections</span><span class="p">()</span>
<span class="go">[frozenset({0, 4}),</span>
<span class="go"> frozenset({2, 3}),</span>
<span class="go"> frozenset({0, 1, 2}),</span>
<span class="go"> frozenset({1, 3, 4})]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.subdivide">
<span class="sig-name descname"><span class="pre">subdivide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_rays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_simplicial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.subdivide" title="Permalink to this definition">#</a></dt>
<dd><p>Construct a new fan subdividing <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">new_rays</span></code> - list of new rays to be added during subdivision, each
ray must be a list or a vector. May be empty or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_simplicial</span></code> - if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the returned fan is guaranteed to
be simplicial, default is <code class="docutils literal notranslate"><span class="pre">False</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - string with the name of the algorithm used for
subdivision. Currently there is only one available algorithm called
“default”;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> - if <code class="docutils literal notranslate"><span class="pre">True</span></code>, some timing information may be printed
during the process of subdivision.</p></li>
</ul>
<p>OUTPUT:</p>
<p><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a></p>
<p>Currently the “default” algorithm corresponds to iterative stellar
subdivision for each ray in <code class="docutils literal notranslate"><span class="pre">new_rays</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">new_fan</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">new_fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">new_fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">new_fan</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.support_contains">
<span class="sig-name descname"><span class="pre">support_contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.support_contains" title="Permalink to this definition">#</a></dt>
<dd><p>Check if a point is contained in the support of the fan.</p>
<p>The support of a fan is the union of all cones of the fan. If
you want to know whether the fan contains a given cone, you
should use <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.contains" title="sage.geometry.fan.RationalPolyhedralFan.contains"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contains()</span></code></a> instead.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*args</span></code> – an element of <code class="docutils literal notranslate"><span class="pre">self.lattice()</span></code> or something
that can be converted to it (for example, a list of
coordinates).</p></li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">point</span></code> is contained in the support of the
fan, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.toric_variety">
<span class="sig-name descname"><span class="pre">toric_variety</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.toric_variety" title="Permalink to this definition">#</a></dt>
<dd><p>Return the associated toric variety.</p>
<p>INPUT:</p>
<p>same arguments as <a class="reference external" href="../../../schemes/sage/schemes/toric/variety.html#sage.schemes.toric.variety.ToricVariety" title="(in Schemes v10.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">ToricVariety()</span></code></a></p>
<p>OUTPUT:</p>
<p>a toric variety</p>
<p>This is equivalent to the command <code class="docutils literal notranslate"><span class="pre">ToricVariety(self)</span></code> and
is provided only as a convenient alternative method to go from the
fan to the associated toric variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])])</span><span class="o">.</span><span class="n">toric_variety</span><span class="p">()</span>
<span class="go">2-d toric variety covered by 2 affine patches</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.vertex_graph">
<span class="sig-name descname"><span class="pre">vertex_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.vertex_graph" title="Permalink to this definition">#</a></dt>
<dd><p>Return the graph of 1- and 2-cones.</p>
<p>OUTPUT:</p>
<p>An edge-colored graph. The vertices correspond to the 1-cones
(i.e. rays) of
the fan. Two vertices are joined by an edge iff the rays span
a 2-cone of the fan. The edges are colored by pairs of
integers that classify the 2-cones up to <span class="math notranslate nohighlight">\(GL(2,\ZZ)\)</span>
transformation, see
<a class="reference internal" href="cone.html#sage.geometry.cone.classify_cone_2d" title="sage.geometry.cone.classify_cone_2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">classify_cone_2d()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">dP8</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">dP8</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">vertex_graph</span><span class="p">();</span> <span class="n">g</span>
<span class="go">Graph on 4 vertices</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">dP8</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">()</span>  <span class="c1"># all edge labels the same since every cone is smooth</span>
<span class="go">[(1, 0), (1, 0), (1, 0), (1, 0)]</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">Cube_deformation</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">vertex_graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>                                        <span class="c1"># needs sage.groups</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>                        <span class="c1"># needs sage.groups</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan.RationalPolyhedralFan.virtual_rays">
<span class="sig-name descname"><span class="pre">virtual_rays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.virtual_rays" title="Permalink to this definition">#</a></dt>
<dd><p>Return (some of the) virtual rays of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(N\)</span> be the <span class="math notranslate nohighlight">\(D\)</span>-dimensional
<a class="reference internal" href="cone.html#sage.geometry.cone.IntegralRayCollection.lattice" title="sage.geometry.cone.IntegralRayCollection.lattice"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lattice()</span></code></a>
of a <span class="math notranslate nohighlight">\(d\)</span>-dimensional fan <span class="math notranslate nohighlight">\(\Sigma\)</span> in <span class="math notranslate nohighlight">\(N_\RR\)</span>. Then the corresponding
toric variety is of the form <span class="math notranslate nohighlight">\(X \times (\CC^*)^{D-d}\)</span>. The actual
<a class="reference internal" href="cone.html#sage.geometry.cone.IntegralRayCollection.rays" title="sage.geometry.cone.IntegralRayCollection.rays"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rays()</span></code></a> of <span class="math notranslate nohighlight">\(\Sigma\)</span>
give a canonical choice of homogeneous coordinates on <span class="math notranslate nohighlight">\(X\)</span>. This function
returns an arbitrary but fixed choice of virtual rays corresponding to a
(non-canonical) choice of homogeneous coordinates on the torus factor.
Combinatorially primitive integral generators of virtual rays span the
<span class="math notranslate nohighlight">\(D-d\)</span> dimensions of <span class="math notranslate nohighlight">\(N_\QQ\)</span> “missed” by the actual rays. (In general
addition of virtual rays is not sufficient to span <span class="math notranslate nohighlight">\(N\)</span> over <span class="math notranslate nohighlight">\(\ZZ\)</span>.)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may use a particular choice of virtual rays by passing optional
argument <code class="docutils literal notranslate"><span class="pre">virtual_rays</span></code> to the <a class="reference internal" href="#sage.geometry.fan.Fan" title="sage.geometry.fan.Fan"><code class="xref py py-func docutils literal notranslate"><span class="pre">Fan()</span></code></a> constructor.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ray_list</span></code> – a list of integers, the indices of the
requested virtual rays. If not specified, all virtual rays of <code class="docutils literal notranslate"><span class="pre">self</span></code>
will be returned.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a <a class="reference internal" href="point_collection.html#sage.geometry.point_collection.PointCollection" title="sage.geometry.point_collection.PointCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PointCollection</span></code></a> of
primitive integral ray generators. Usually (if the fan is
full-dimensional) this will be empty.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">virtual_rays</span><span class="p">()</span>
<span class="go">N(1, 0, 0, 0),</span>
<span class="go">N(0, 0, 0, 1)</span>
<span class="go">in 4-d lattice N</span>

<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0, 1, 0),</span>
<span class="go">N(0, 1, 1, 0)</span>
<span class="go">in 4-d lattice N</span>

<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">virtual_rays</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="go">N(1, 0, 0, 0)</span>
<span class="go">in 4-d lattice N</span>
</pre></div>
</div>
<p>You can also give virtual ray indices directly, without
packing them into a list:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">virtual_rays</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">N(1, 0, 0, 0)</span>
<span class="go">in 4-d lattice N</span>
</pre></div>
</div>
<p>Make sure that <a class="reference external" href="https://github.com/sagemath/sage/issues/16344">github issue #16344</a> is fixed and one can compute
the virtual rays of fans in non-saturated lattices:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">submodule</span><span class="p">([(</span><span class="mi">2</span><span class="p">,)])</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]])])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">virtual_rays</span><span class="p">())</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.geometry.fan.discard_faces">
<span class="sig-prename descclassname"><span class="pre">sage.geometry.fan.</span></span><span class="sig-name descname"><span class="pre">discard_faces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cones</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.discard_faces" title="Permalink to this definition">#</a></dt>
<dd><p>Return the cones of the given list which are not faces of each other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cones</span></code> – a list of
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cones</span></code></a>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list of
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cones</span></code></a>,
sorted by dimension in decreasing order</p>
<p>EXAMPLES:</p>
<p>Consider all cones of a fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                                        <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="n">cones</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">Sigma</span><span class="o">.</span><span class="n">cones</span><span class="p">())</span>                                            <span class="c1"># needs palp</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">cones</span><span class="p">)</span>                                                                <span class="c1"># needs palp</span>
<span class="go">7</span>
</pre></div>
</div>
<p>Most of them are not necessary to generate this fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.fan</span> <span class="kn">import</span> <span class="n">discard_faces</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">discard_faces</span><span class="p">(</span><span class="n">cones</span><span class="p">))</span>                                                 <span class="c1"># needs palp</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Sigma</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>                                                 <span class="c1"># needs palp</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.geometry.fan.is_Fan">
<span class="sig-prename descclassname"><span class="pre">sage.geometry.fan.</span></span><span class="sig-name descname"><span class="pre">is_Fan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.is_Fan" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">x</span></code> is a Fan.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> – anything.</p></li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">x</span></code> is a fan and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.fan</span> <span class="kn">import</span> <span class="n">is_Fan</span>
<span class="gp">sage: </span><span class="n">is_Fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">();</span> <span class="n">fan</span>                                     <span class="c1"># needs palp</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">is_Fan</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>                                                               <span class="c1"># needs palp</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="fan_morphism.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Morphisms between toric lattices compatible with fans</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="cone_catalog.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Catalog of common polyhedral convex cones</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Rational polyhedral fans</a><ul>
<li><a class="reference internal" href="#sage.geometry.fan.Cone_of_fan"><code class="docutils literal notranslate"><span class="pre">Cone_of_fan</span></code></a><ul>
<li><a class="reference internal" href="#sage.geometry.fan.Cone_of_fan.star_generator_indices"><code class="docutils literal notranslate"><span class="pre">star_generator_indices()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.Cone_of_fan.star_generators"><code class="docutils literal notranslate"><span class="pre">star_generators()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.geometry.fan.FaceFan"><code class="docutils literal notranslate"><span class="pre">FaceFan()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.Fan"><code class="docutils literal notranslate"><span class="pre">Fan()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.Fan2d"><code class="docutils literal notranslate"><span class="pre">Fan2d()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.NormalFan"><code class="docutils literal notranslate"><span class="pre">NormalFan()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan"><code class="docutils literal notranslate"><span class="pre">RationalPolyhedralFan</span></code></a><ul>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.Gale_transform"><code class="docutils literal notranslate"><span class="pre">Gale_transform()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.Stanley_Reisner_ideal"><code class="docutils literal notranslate"><span class="pre">Stanley_Reisner_ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.cartesian_product"><code class="docutils literal notranslate"><span class="pre">cartesian_product()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.common_refinement"><code class="docutils literal notranslate"><span class="pre">common_refinement()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.complex"><code class="docutils literal notranslate"><span class="pre">complex()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.cone_containing"><code class="docutils literal notranslate"><span class="pre">cone_containing()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.cone_lattice"><code class="docutils literal notranslate"><span class="pre">cone_lattice()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.cones"><code class="docutils literal notranslate"><span class="pre">cones()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.contains"><code class="docutils literal notranslate"><span class="pre">contains()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.embed"><code class="docutils literal notranslate"><span class="pre">embed()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.f_vector"><code class="docutils literal notranslate"><span class="pre">f_vector()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.generating_cone"><code class="docutils literal notranslate"><span class="pre">generating_cone()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.generating_cones"><code class="docutils literal notranslate"><span class="pre">generating_cones()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.is_complete"><code class="docutils literal notranslate"><span class="pre">is_complete()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.is_equivalent"><code class="docutils literal notranslate"><span class="pre">is_equivalent()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.is_isomorphic"><code class="docutils literal notranslate"><span class="pre">is_isomorphic()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.is_simplicial"><code class="docutils literal notranslate"><span class="pre">is_simplicial()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.is_smooth"><code class="docutils literal notranslate"><span class="pre">is_smooth()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.isomorphism"><code class="docutils literal notranslate"><span class="pre">isomorphism()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.linear_equivalence_ideal"><code class="docutils literal notranslate"><span class="pre">linear_equivalence_ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.make_simplicial"><code class="docutils literal notranslate"><span class="pre">make_simplicial()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.ngenerating_cones"><code class="docutils literal notranslate"><span class="pre">ngenerating_cones()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.oriented_boundary"><code class="docutils literal notranslate"><span class="pre">oriented_boundary()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.primitive_collections"><code class="docutils literal notranslate"><span class="pre">primitive_collections()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.subdivide"><code class="docutils literal notranslate"><span class="pre">subdivide()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.support_contains"><code class="docutils literal notranslate"><span class="pre">support_contains()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.toric_variety"><code class="docutils literal notranslate"><span class="pre">toric_variety()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.vertex_graph"><code class="docutils literal notranslate"><span class="pre">vertex_graph()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.virtual_rays"><code class="docutils literal notranslate"><span class="pre">virtual_rays()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.geometry.fan.discard_faces"><code class="docutils literal notranslate"><span class="pre">discard_faces()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan.is_Fan"><code class="docutils literal notranslate"><span class="pre">is_Fan()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>