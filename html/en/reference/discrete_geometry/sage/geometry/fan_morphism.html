<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Point collections" href="point_collection.html" /><link rel="prev" title="Rational polyhedral fans" href="fan.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Morphisms between toric lattices compatible with fans - Combinatorial and Discrete Geometry</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Combinatorial and Discrete Geometry</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.0 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Combinatorial and Discrete Geometry</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/arrangement.html">Hyperplane Arrangements</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/library.html">Library of Hyperplane Arrangements</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/hyperplane.html">Hyperplanes</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/affine_subspace.html">Affine Subspaces of a Vector Space</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/plot.html">Plotting of Hyperplane Arrangements</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/library.html">Library of commonly used, famous, or interesting polytopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/constructor.html">Polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/parent.html">Parents for Polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/representation.html">H(yperplane) and V(ertex) representation objects for polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/plot.html">Functions for plotting polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/face.html">A class to keep information about faces of a polyhedron</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/cdd_file_format.html">Generate cdd <code class="docutils literal notranslate"><span class="pre">.ext</span></code> / <code class="docutils literal notranslate"><span class="pre">.ine</span></code> file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/modules/formal_polyhedra_module.html">Formal modules generated by polyhedra</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="lattice_polytope.html">Lattice and reflexive polytopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/lattice_euclidean_group_element.html">Lattice Euclidean Group Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/palp_database.html">Access the PALP database(s) of reflexive lattice polytopes</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/ppl_lattice_polygon.html">Fast Lattice Polygons using PPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/ppl_lattice_polytope.html">Fast Lattice Polytopes using PPL.</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/generating_function.html">Generating Function of Polyhedron’s Integral Points</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/base.html">Combinatorial polyhedron</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/combinatorial_face.html">Combinatorial face of a polyhedron</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/polyhedron_face_lattice.html">PolyhedronFaceLattice</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/face_iterator.html">Face iterator for polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/list_of_faces.html">List of faces</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/combinatorial_polyhedron/conversions.html">Conversions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="polyhedral_complex.html">Finite polyhedral complexes</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="toric_lattice.html">Toric lattices</a></li>
<li class="toctree-l1"><a class="reference internal" href="cone.html">Convex rational polyhedral cones</a></li>
<li class="toctree-l1"><a class="reference internal" href="cone_catalog.html">Catalog of common polyhedral convex cones</a></li>
<li class="toctree-l1"><a class="reference internal" href="fan.html">Rational polyhedral fans</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Morphisms between toric lattices compatible with fans</a></li>
<li class="toctree-l1"><a class="reference internal" href="point_collection.html">Point collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="toric_plotter.html">Toric plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rings/polynomial/groebner_fan.html">Groebner Fans</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base0.html">Base class for polyhedra: Initialization and access to Vrepresentation and Hrepresentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base1.html">Base class for polyhedra: Implementation of the <code class="xref py py-class docutils literal notranslate"><span class="pre">ConvexSet_base</span></code> API</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base2.html">Base class for polyhedra: Methods related to lattice points</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base3.html">Base class for polyhedra: Methods regarding the combinatorics of a polyhedron</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base4.html">Base class for polyhedra: Graph-theoretic methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base5.html">Base class for polyhedra: Methods for constructing new polyhedra</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base6.html">Base class for polyhedra: Methods for plotting and affine hull projection</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base7.html">Base class for polyhedra: Methods for triangulation and volume computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base.html">Base class for polyhedra: Miscellaneous methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base_QQ.html">Base class for polyhedra over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base_ZZ.html">Base class for polyhedra over <span class="math notranslate nohighlight">\(\ZZ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/base_RDF.html">Base class for polyhedra over <code class="docutils literal notranslate"><span class="pre">RDF</span></code></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_cdd.html">The cdd backend for polyhedral computations</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_cdd_rdf.html">The cdd backend for polyhedral computations, floating point version</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_field.html">The Python backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_number_field.html">The Python backend, using number fields internally</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_normaliz.html">The Normaliz backend for polyhedral computations</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_polymake.html">The polymake backend for polyhedral computations</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/backend_ppl.html">The PPL (Parma Polyhedra Library) backend for polyhedral computations</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/double_description.html">Double Description Algorithm for Cones</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedron/double_description_inhomogeneous.html">Double Description for Arbitrary Polyhedra</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="triangulation/point_configuration.html">Triangulations of a point configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="triangulation/base.html">Base classes for triangulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="triangulation/element.html">A triangulation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="abc.html">Abstract base classes for classes in <code class="xref py py-mod docutils literal notranslate"><span class="pre">geometry</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="convex_set.html">Convex Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_expression.html">Linear Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="newton_polygon.html">Newton Polygons</a></li>
<li class="toctree-l1"><a class="reference internal" href="relative_interior.html">Relative Interiors of Polyhedra and Cones</a></li>
<li class="toctree-l1"><a class="reference internal" href="ribbon_graph.html">Ribbon Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="pseudolines.html">Pseudolines</a></li>
<li class="toctree-l1"><a class="reference internal" href="voronoi_diagram.html">Voronoi diagram</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="fan_isomorphism.html">Find isomorphisms between fans</a></li>
<li class="toctree-l1"><a class="reference internal" href="hasse_diagram.html">Construction of finite atomic and coatomic lattices from incidences</a></li>
<li class="toctree-l1"><a class="reference internal" href="integral_points.html">MISSING TITLE</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperplane_arrangement/check_freeness.html">Helper Functions For Freeness Of Hyperplane Arrangements</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="morphisms-between-toric-lattices-compatible-with-fans">
<span id="sage-geometry-fan-morphism"></span><h1>Morphisms between toric lattices compatible with fans<a class="headerlink" href="#morphisms-between-toric-lattices-compatible-with-fans" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.geometry.fan_morphism"></span><p>This module is a part of the framework for toric varieties
(<a class="reference external" href="../../../schemes/sage/schemes/toric/variety.html#module-sage.schemes.toric.variety" title="(in Schemes v10.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">variety</span></code></a>,
<a class="reference external" href="../../../schemes/sage/schemes/toric/fano_variety.html#module-sage.schemes.toric.fano_variety" title="(in Schemes v10.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fano_variety</span></code></a>). Its main purpose is to
provide support for working with lattice morphisms compatible with fans via
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism" title="sage.geometry.fan_morphism.FanMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">FanMorphism</span></code></a> class.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Andrey Novoseltsev (2010-10-17): initial version.</p></li>
<li><dl class="simple">
<dt>Andrey Novoseltsev (2011-04-11): added tests for injectivity/surjectivity,</dt><dd><p>fibration, bundle, as well as some related methods.</p>
</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<p>Let’s consider the face and normal fans of the “diamond” and the projection
to the <span class="math notranslate nohighlight">\(x\)</span>-axis:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">diamond</span> <span class="o">=</span> <span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">diamond</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">normal</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">diamond</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">N</span><span class="mf">.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Free module morphism defined by the matrix</span>
<span class="go">[1 0]</span>
<span class="go">[0 0]</span>
<span class="go">Domain: 2-d lattice N</span>
<span class="go">Codomain: 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">face</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: the image of generating cone #1 of the domain fan</span>
<span class="go">is not contained in a single cone of the codomain fan!</span>
</pre></div>
</div>
<p>Some of the cones of the normal fan fail to be mapped to a single cone of the
face fan. We can rectify the situation in the following way:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1 0]</span>
<span class="go">[0 0]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1,  1),</span>
<span class="go">N( 1, -1),</span>
<span class="go">N(-1, -1),</span>
<span class="go">N(-1,  1),</span>
<span class="go">N( 0, -1),</span>
<span class="go">N( 0,  1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">normal</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1,  1),</span>
<span class="go">N( 1, -1),</span>
<span class="go">N(-1, -1),</span>
<span class="go">N(-1,  1)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>As you see, it was necessary to insert two new rays (to prevent “upper” and
“lower” cones of the normal fan from being mapped to the whole <span class="math notranslate nohighlight">\(x\)</span>-axis).</p>
<dl class="py class">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.geometry.fan_morphism.</span></span><span class="sig-name descname"><span class="pre">FanMorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">morphism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_fan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codomain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdivide</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../modules/sage/modules/free_module_morphism.html#sage.modules.free_module_morphism.FreeModuleMorphism" title="(in Modules v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">FreeModuleMorphism</span></code></a></p>
<p>Create a fan morphism.</p>
<p>Let <span class="math notranslate nohighlight">\(\Sigma_1\)</span> and <span class="math notranslate nohighlight">\(\Sigma_2\)</span> be two fans in lattices <span class="math notranslate nohighlight">\(N_1\)</span> and <span class="math notranslate nohighlight">\(N_2\)</span>
respectively. Let <span class="math notranslate nohighlight">\(\phi\)</span> be a morphism (i.e. a linear map) from <span class="math notranslate nohighlight">\(N_1\)</span> to
<span class="math notranslate nohighlight">\(N_2\)</span>. We say that <span class="math notranslate nohighlight">\(\phi\)</span> is <em>compatible</em> with <span class="math notranslate nohighlight">\(\Sigma_1\)</span> and <span class="math notranslate nohighlight">\(\Sigma_2\)</span>
if every cone <span class="math notranslate nohighlight">\(\sigma_1\in\Sigma_1\)</span> is mapped by <span class="math notranslate nohighlight">\(\phi\)</span> into a single cone
<span class="math notranslate nohighlight">\(\sigma_2\in\Sigma_2\)</span>, i.e. <span class="math notranslate nohighlight">\(\phi(\sigma_1)\subset\sigma_2\)</span> (<span class="math notranslate nohighlight">\(\sigma_2\)</span>
may be different for different <span class="math notranslate nohighlight">\(\sigma_1\)</span>).</p>
<p>By a <strong>fan morphism</strong> we understand a morphism between two lattices
compatible with specified fans in these lattices. Such morphisms behave in
exactly the same way as “regular” morphisms between lattices, but:</p>
<ul class="simple">
<li><p>fan morphisms have a special constructor allowing some automatic
adjustments to the initial fans (see below);</p></li>
<li><p>fan morphisms are aware of the associated fans and they can be
accessed via <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">codomain_fan()</span></code></a> and <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">domain_fan()</span></code></a>;</p></li>
<li><p>fan morphisms can efficiently compute <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.image_cone" title="sage.geometry.fan_morphism.FanMorphism.image_cone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">image_cone()</span></code></a> of a given
cone of the domain fan and <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preimage_cones()</span></code></a> of a given cone of
the codomain fan.</p></li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">morphism</span></code> – either a morphism between domain and codomain, or an
integral matrix defining such a morphism;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">domain_fan</span></code> – a <a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">fan</span></code></a> in the domain;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">codomain</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) either a codomain lattice or a fan in
the codomain. If the codomain fan is not given, the image fan (fan
generated by images of generating cones) of <code class="docutils literal notranslate"><span class="pre">domain_fan</span></code> will be used,
if possible;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subdivide</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) if <code class="docutils literal notranslate"><span class="pre">True</span></code> and <code class="docutils literal notranslate"><span class="pre">domain_fan</span></code> is
not compatible with the codomain fan because it is too coarse, it will be
automatically refined to become compatible (the minimal refinement is
canonical, so there are no choices involved);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) if <code class="docutils literal notranslate"><span class="pre">False</span></code>, given fans and morphism
will be assumed to be compatible. Be careful when using this option,
since wrong assumptions can lead to wrong and hard-to-detect errors. On
the other hand, this option may save you some time;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) if <code class="docutils literal notranslate"><span class="pre">True</span></code>, some information may be
printed during construction of the fan morphism.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a fan morphism.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Here we consider the face and normal fans of the “diamond” and the
projection to the <span class="math notranslate nohighlight">\(x\)</span>-axis:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">diamond</span> <span class="o">=</span> <span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">diamond</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">normal</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">diamond</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">N</span><span class="mf">.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Free module morphism defined by the matrix</span>
<span class="go">[1 0]</span>
<span class="go">[0 0]</span>
<span class="go">Domain: 2-d lattice N</span>
<span class="go">Codomain: 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span> <span class="ow">is</span> <span class="n">face</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note, that since <code class="docutils literal notranslate"><span class="pre">phi</span></code> is compatible with these fans, the returned
fan is exactly the same object as the initial <code class="docutils literal notranslate"><span class="pre">domain_fan</span></code>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">face</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: the image of generating cone #1 of the domain fan</span>
<span class="go">is not contained in a single cone of the codomain fan!</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span> <span class="ow">is</span> <span class="n">normal</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
<p>We had to subdivide two of the four cones of the normal fan, since
they were mapped by <code class="docutils literal notranslate"><span class="pre">phi</span></code> into non-strictly convex cones.</p>
<p>It is possible to omit the codomain fan, in which case the image fan will
be used instead of it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">face</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1, 0),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>Now we demonstrate a more subtle example. We take the first quadrant as our
domain fan. Then we divide the first quadrant into three cones, throw away
the middle one and take the other two as our codomain fan. These fans are
incompatible with the identity lattice morphism since the image of the
domain fan is out of the support of the codomain fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: the image of generating cone #0 of the domain fan</span>
<span class="go">is not contained in a single cone of the codomain fan!</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: morphism defined by</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="go">does not map</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="go">into the support of</span>
<span class="go">Rational polyhedral fan in 2-d lattice N!</span>
</pre></div>
</div>
<p>The problem was detected and handled correctly (i.e. an exception was
raised). However, the used algorithm requires extra checks for this
situation after constructing a potential subdivision and this can take
significant time. You can save about half the time using
<code class="docutils literal notranslate"><span class="pre">check=False</span></code> option, if you know in advance that it is possible to
make fans compatible with the morphism by subdividing the domain fan.
Of course, if your assumption was incorrect, the result will be wrong
and you will get a fan which <em>does</em> map into the support of the
codomain fan, but is <strong>not</strong> a subdivision of the domain fan. You
can test it on the example above:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">....: </span>                 <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Placing ray images (... ms)</span>
<span class="go">Computing chambers (... ms)</span>
<span class="go">Number of domain cones: 1.</span>
<span class="go">Number of chambers: 2.</span>
<span class="go">Cone 0 sits in chambers 0 1 (... ms)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.codomain_fan">
<span class="sig-name descname"><span class="pre">codomain_fan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="Permalink to this definition">#</a></dt>
<dd><p>Return the codomain fan of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dim</span></code> – dimension of the requested cones;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">codim</span></code> – codimension of the requested cones.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a> if no parameters were
given, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cones</span></code></a> otherwise.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">quadrant</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">quadrant_bl</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">quadrant_bl</span><span class="p">,</span> <span class="n">quadrant</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span> <span class="ow">is</span> <span class="n">quadrant</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.domain_fan">
<span class="sig-name descname"><span class="pre">domain_fan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="Permalink to this definition">#</a></dt>
<dd><p>Return the codomain fan of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dim</span></code> – dimension of the requested cones;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">codim</span></code> – codimension of the requested cones.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a> if no parameters were
given, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cones</span></code></a> otherwise.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">quadrant</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">quadrant_bl</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">quadrant_bl</span><span class="p">,</span> <span class="n">quadrant</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span> <span class="ow">is</span> <span class="n">quadrant_bl</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.factor">
<span class="sig-name descname"><span class="pre">factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.factor" title="Permalink to this definition">#</a></dt>
<dd><p>Factor <code class="docutils literal notranslate"><span class="pre">self</span></code> into injective * birational * surjective morphisms.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a triple of <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism" title="sage.geometry.fan_morphism.FanMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">FanMorphism</span></code></a> <span class="math notranslate nohighlight">\((\phi_i, \phi_b, \phi_s)\)</span>, such that
<span class="math notranslate nohighlight">\(\phi_s\)</span> is surjective, <span class="math notranslate nohighlight">\(\phi_b\)</span> is birational, <span class="math notranslate nohighlight">\(\phi_i\)</span> is injective,
and <code class="docutils literal notranslate"><span class="pre">self</span></code> is equal to <span class="math notranslate nohighlight">\(\phi_i \circ \phi_b \circ \phi_s\)</span>.</p></li>
</ul>
<p>Intermediate fans live in the saturation of the image of <code class="docutils literal notranslate"><span class="pre">self</span></code>
as a map between lattices and are the image of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">domain_fan()</span></code></a>
and the restriction of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">codomain_fan()</span></code></a>, i.e. if <code class="docutils literal notranslate"><span class="pre">self</span></code> maps
<span class="math notranslate nohighlight">\(\Sigma \to \Sigma'\)</span>, then we have factorization into</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Sigma
\twoheadrightarrow
\Sigma_s
\to
\Sigma_i
\hookrightarrow
\Sigma.\]</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Sigma_s\)</span> is the finest fan with the smallest support that is
compatible with <code class="docutils literal notranslate"><span class="pre">self</span></code>: any fan morphism from <span class="math notranslate nohighlight">\(\Sigma\)</span> given by
the same map of lattices as <code class="docutils literal notranslate"><span class="pre">self</span></code> factors through <span class="math notranslate nohighlight">\(\Sigma_s\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Sigma_i\)</span> is the coarsest fan of the largest support that is
compatible with <code class="docutils literal notranslate"><span class="pre">self</span></code>: any fan morphism into <span class="math notranslate nohighlight">\(\Sigma'\)</span> given by
the same map of lattices as <code class="docutils literal notranslate"><span class="pre">self</span></code> factors though <span class="math notranslate nohighlight">\(\Sigma_i\)</span>.</p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>We map an affine plane into a projective 3-space in such a way, that it
becomes “a double cover of a chart of the blow up of one of the
coordinate planes”:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P3</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                                             <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">P3</span><span class="p">)</span>                                                   <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>                                               <span class="c1"># optional - palp</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d affine toric variety</span>
<span class="go">  To:   3-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [x : y] to</span>
<span class="go">        [x^2*y : y : 1 : 1]</span>
</pre></div>
</div>
<p>Now we will work with the underlying fan morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">();</span> <span class="n">phi</span>                                         <span class="c1"># optional - palp</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[2 0 0]</span>
<span class="go">[1 1 0]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(),</span> <span class="n">phi</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">phi</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>          <span class="c1"># optional - palp</span>
<span class="go">(False, False, False)</span>
<span class="gp">sage: </span><span class="n">phi_i</span><span class="p">,</span> <span class="n">phi_b</span><span class="p">,</span> <span class="n">phi_s</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>                                    <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">phi_s</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(),</span> <span class="n">phi_b</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">phi_i</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>    <span class="c1"># optional - palp</span>
<span class="go">(True, True, True)</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">factor</span><span class="p">())</span> <span class="o">==</span> <span class="n">phi</span>                                             <span class="c1"># optional - palp</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Double cover (surjective):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">phi_s</span>                                                                 <span class="c1"># optional - palp</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[2 0]</span>
<span class="go">[1 1]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
<span class="gp">sage: </span><span class="n">phi_s</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>                                           <span class="c1"># optional - palp</span>
<span class="go">N(1, 0, 0),</span>
<span class="go">N(1, 1, 0)</span>
<span class="go">in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
</pre></div>
</div>
<p>Blowup chart (birational):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_b</span>                                                                 <span class="c1"># optional - palp</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="go">Domain fan: Rational polyhedral fan in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
<span class="go">Codomain fan: Rational polyhedral fan in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
<span class="gp">sage: </span><span class="n">phi_b</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>                                           <span class="c1"># optional - palp</span>
<span class="go">N(-1, -1, 0),</span>
<span class="go">N( 0,  1, 0),</span>
<span class="go">N( 1,  0, 0)</span>
<span class="go">in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
</pre></div>
</div>
<p>Coordinate plane inclusion (injective):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_i</span>                                                                 <span class="c1"># optional - palp</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">Domain fan: Rational polyhedral fan in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
<span class="go">Codomain fan: Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>                                             <span class="c1"># optional - palp</span>
<span class="go">N( 1,  0,  0),</span>
<span class="go">N( 0,  1,  0),</span>
<span class="go">N( 0,  0,  1),</span>
<span class="go">N(-1, -1, -1)</span>
<span class="go">in 3-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.image_cone">
<span class="sig-name descname"><span class="pre">image_cone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.image_cone" title="Permalink to this definition">#</a></dt>
<dd><p>Return the cone of the codomain fan containing the image of <code class="docutils literal notranslate"><span class="pre">cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cone</span></code> – a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span></code></a> equivalent to a
cone of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">domain_fan()</span></code></a> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span></code></a>
of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">codomain_fan()</span></code></a> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">quadrant</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">quadrant_bl</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">quadrant_bl</span><span class="p">,</span> <span class="n">quadrant</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">image_cone</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">image_cone</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.index" title="Permalink to this definition">#</a></dt>
<dd><p>Return the index of <code class="docutils literal notranslate"><span class="pre">self</span></code> as a map between lattices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cone</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span></code></a> of the
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">codomain_fan()</span></code></a> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>an integer, infinity, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
<p>If no cone was specified, this function computes the index of the
image of <code class="docutils literal notranslate"><span class="pre">self</span></code> in the codomain. If a cone <span class="math notranslate nohighlight">\(\sigma\)</span> was given, the
index of <code class="docutils literal notranslate"><span class="pre">self</span></code> over <span class="math notranslate nohighlight">\(\sigma\)</span> is computed in the sense of
Definition 2.1.7 of <a class="reference internal" href="../../../references/index.html#hly2002" id="id1"><span>[HLY2002]</span></a>: if <span class="math notranslate nohighlight">\(\sigma'\)</span> is any cone of the
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">domain_fan()</span></code></a> of <code class="docutils literal notranslate"><span class="pre">self</span></code> whose relative interior is mapped to the
relative interior of <span class="math notranslate nohighlight">\(\sigma\)</span>, it is the index of the image of
<span class="math notranslate nohighlight">\(N'(\sigma')\)</span> in <span class="math notranslate nohighlight">\(N(\sigma)\)</span>, where <span class="math notranslate nohighlight">\(N'\)</span> and <span class="math notranslate nohighlight">\(N\)</span> are domain and codomain
lattices respectively. While that definition was formulated for the case
of the finite index only, we extend it to the infinite one as well and
return <code class="docutils literal notranslate"><span class="pre">None</span></code> if there is no <span class="math notranslate nohighlight">\(\sigma'\)</span> at all. See examples below for
situations when such things happen. Note also that the index of <code class="docutils literal notranslate"><span class="pre">self</span></code>
is the same as index over the trivial cone.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                           <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>        <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                                   <span class="c1"># optional - palp</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">psi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>        <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                                   <span class="c1"># optional - palp</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">Sigma_p</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">)</span>            <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                                    <span class="c1"># optional - palp</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>Infinite index in the last example indicates that the image has positive
codimension in the codomain. Let’s look at the rays of our fans:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma_p</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1),</span>
<span class="go">N(-1)</span>
<span class="go">in 1-d lattice N</span>
<span class="gp">sage: </span><span class="n">Sigma</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>                                                  <span class="c1"># optional - palp</span>
<span class="go">N( 1,  1),</span>
<span class="go">N( 0,  1),</span>
<span class="go">N(-1, -1),</span>
<span class="go">N( 1,  0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>                            <span class="c1"># optional - palp</span>
<span class="go">N(-1, 0),</span>
<span class="go">N( 1, 0)</span>
<span class="go">in Sublattice &lt;N(1, 0)&gt;</span>
</pre></div>
</div>
<p>We see that one of the rays of the fan of <code class="docutils literal notranslate"><span class="pre">P1</span></code> is mapped to a ray,
while the other one to the interior of some 2-d cone. Both rays
correspond to single points on <code class="docutils literal notranslate"><span class="pre">P1</span></code>, yet one is mapped to the
distinguished point of a torus invariant curve of <code class="docutils literal notranslate"><span class="pre">dP8</span></code> (with the
rest of this curve being uncovered) and the other to a fixed point
of <code class="docutils literal notranslate"><span class="pre">dP8</span></code> (thus completely covering this torus orbit in <code class="docutils literal notranslate"><span class="pre">dP8</span></code>).</p>
<p>We should therefore expect the following behaviour: all indices over
1-d cones are <code class="docutils literal notranslate"><span class="pre">None</span></code>, except for one which is infinite, and all
indices over 2-d cones are <code class="docutils literal notranslate"><span class="pre">None</span></code>, except for one which is 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">Sigma</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>                         <span class="c1"># optional - palp</span>
<span class="go">[None, None, None, +Infinity]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">Sigma</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>                         <span class="c1"># optional - palp</span>
<span class="go">[None, 1, None, None]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.is_birational">
<span class="sig-name descname"><span class="pre">is_birational</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_birational" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is birational.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is birational, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
</ul>
<p>For fan morphisms this check is equivalent to <code class="docutils literal notranslate"><span class="pre">self.index()</span> <span class="pre">==</span> <span class="pre">1</span></code> and
means that the corresponding map between toric varieties is birational.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                           <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>        <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">psi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>        <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">Sigma_p</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">)</span>            <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">psi</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                          <span class="c1"># optional - palp</span>
<span class="go">(1, 2, +Infinity)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">psi</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">xi</span><span class="o">.</span><span class="n">is_birational</span><span class="p">()</span>  <span class="c1"># optional - palp</span>
<span class="go">(True, False, False)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.is_bundle">
<span class="sig-name descname"><span class="pre">is_bundle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_bundle" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a bundle.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a bundle, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
</ul>
<p>Let <span class="math notranslate nohighlight">\(\phi: \Sigma \to \Sigma'\)</span> be a fan morphism such that the
underlying lattice morphism <span class="math notranslate nohighlight">\(\phi: N \to N'\)</span> is surjective. Let
<span class="math notranslate nohighlight">\(\Sigma_0\)</span> be the kernel fan of <span class="math notranslate nohighlight">\(\phi\)</span>. Then <span class="math notranslate nohighlight">\(\phi\)</span> is a <strong>bundle</strong> (or
splitting) if there is a subfan <span class="math notranslate nohighlight">\(\widehat{\Sigma}\)</span> of <span class="math notranslate nohighlight">\(\Sigma\)</span> such
that the following two conditions are satisfied:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Cones of <span class="math notranslate nohighlight">\(\Sigma\)</span> are precisely the cones of the form
<span class="math notranslate nohighlight">\(\sigma_0 + \widehat{\sigma}\)</span>, where <span class="math notranslate nohighlight">\(\sigma_0 \in \Sigma_0\)</span> and
<span class="math notranslate nohighlight">\(\widehat{\sigma} \in \widehat{\Sigma}\)</span>.</p></li>
<li><p>Cones of <span class="math notranslate nohighlight">\(\widehat{\Sigma}\)</span> are in bijection with cones of
<span class="math notranslate nohighlight">\(\Sigma'\)</span> induced by <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> maps lattice points in
every cone <span class="math notranslate nohighlight">\(\widehat{\sigma} \in \widehat{\Sigma}\)</span> bijectively
onto lattice points in <span class="math notranslate nohighlight">\(\phi(\widehat{\sigma})\)</span>.</p></li>
</ol>
</div></blockquote>
<p>If a fan morphism <span class="math notranslate nohighlight">\(\phi: \Sigma \to \Sigma'\)</span> is a bundle, then
<span class="math notranslate nohighlight">\(X_\Sigma\)</span> is a fiber bundle over <span class="math notranslate nohighlight">\(X_{\Sigma'}\)</span> with fibers
<span class="math notranslate nohighlight">\(X_{\Sigma_0, N_0}\)</span>, where <span class="math notranslate nohighlight">\(N_0\)</span> is the kernel lattice of <span class="math notranslate nohighlight">\(\phi\)</span>. See
<a class="reference internal" href="../../../references/index.html#cls2011" id="id2"><span>[CLS2011]</span></a> for more details.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_fibration" title="sage.geometry.fan_morphism.FanMorphism.is_fibration"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_fibration()</span></code></a>, <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.kernel_fan" title="sage.geometry.fan_morphism.FanMorphism.kernel_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kernel_fan()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>We consider several maps between fans of a del Pezzo surface and the
projective line:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                           <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>        <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">psi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>        <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">Sigma_p</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">)</span>            <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>                                               <span class="c1"># optional - palp</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>                                            <span class="c1"># optional - palp</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                                   <span class="c1"># optional - palp</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>                                               <span class="c1"># optional - palp</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>                                            <span class="c1"># optional - palp</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                                   <span class="c1"># optional - palp</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>                                             <span class="c1"># optional - palp</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                                    <span class="c1"># optional - palp</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>The first of these maps induces not only a fibration, but a fiber
bundle structure. The second map is very similar, yet it fails to be
a bundle, as its index is 2. The last map is not even a fibration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.is_dominant">
<span class="sig-name descname"><span class="pre">is_dominant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_dominant" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether the fan morphism is dominant.</p>
<p>A fan morphism <span class="math notranslate nohighlight">\(\phi\)</span> is dominant if it is surjective as a map
of vector spaces. That is, <span class="math notranslate nohighlight">\(\phi_\RR: N_\RR \to N'_\RR\)</span> is
surjective.</p>
<p>If the domain fan is <a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan.is_complete" title="sage.geometry.fan.RationalPolyhedralFan.is_complete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">complete</span></code></a>, then
this implies that the fan morphism is <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_surjective" title="sage.geometry.fan_morphism.FanMorphism.is_surjective"><code class="xref py py-meth docutils literal notranslate"><span class="pre">surjective</span></code></a>.</p>
<p>If the fan morphism is dominant, then the associated morphism
of toric varieties is dominant in the algebraic-geometric
sense (that is, surjective onto a dense subset).</p>
<p>OUTPUT:</p>
<p>Boolean.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">A1</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.is_fibration">
<span class="sig-name descname"><span class="pre">is_fibration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_fibration" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a fibration.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a fibration, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
</ul>
<p>A fan morphism <span class="math notranslate nohighlight">\(\phi: \Sigma \to \Sigma'\)</span> is a <strong>fibration</strong>
if for any cone <span class="math notranslate nohighlight">\(\sigma' \in \Sigma'\)</span> and any primitive
preimage cone <span class="math notranslate nohighlight">\(\sigma \in \Sigma\)</span> corresponding to <span class="math notranslate nohighlight">\(\sigma'\)</span>
the linear map of vector spaces <span class="math notranslate nohighlight">\(\phi_\RR\)</span> induces a bijection
between <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\sigma'\)</span>, and, in addition, <span class="math notranslate nohighlight">\(\phi\)</span> is
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_dominant" title="sage.geometry.fan_morphism.FanMorphism.is_dominant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dominant</span></code></a> (that is, <span class="math notranslate nohighlight">\(\phi_\RR: N_\RR \to
N'_\RR\)</span> is surjective).</p>
<p>If a fan morphism <span class="math notranslate nohighlight">\(\phi: \Sigma \to \Sigma'\)</span> is a fibration, then the
associated morphism between toric varieties <span class="math notranslate nohighlight">\(\tilde{\phi}: X_\Sigma \to
X_{\Sigma'}\)</span> is a fibration in the sense that it is surjective and all
of its fibers have the same dimension, namely <span class="math notranslate nohighlight">\(\dim X_\Sigma -
\dim X_{\Sigma'}\)</span>. These fibers do <em>not</em> have to be isomorphic, i.e. a
fibration is not necessarily a fiber bundle. See <a class="reference internal" href="../../../references/index.html#hly2002" id="id3"><span>[HLY2002]</span></a> for more
details.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_bundle" title="sage.geometry.fan_morphism.FanMorphism.is_bundle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_bundle()</span></code></a>, <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones"><code class="xref py py-meth docutils literal notranslate"><span class="pre">primitive_preimage_cones()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>We consider several maps between fans of a del Pezzo surface and the
projective line:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                           <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>        <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">psi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>        <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">Sigma_p</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">)</span>            <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>                                               <span class="c1"># optional - palp</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>                                            <span class="c1"># optional - palp</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                                   <span class="c1"># optional - palp</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>                                               <span class="c1"># optional - palp</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>                                            <span class="c1"># optional - palp</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                                   <span class="c1"># optional - palp</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>                                             <span class="c1"># optional - palp</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                                    <span class="c1"># optional - palp</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>The first of these maps induces not only a fibration, but a fiber
bundle structure. The second map is very similar, yet it fails to be
a bundle, as its index is 2. The last map is not even a fibration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.is_injective">
<span class="sig-name descname"><span class="pre">is_injective</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_injective" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is injective.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is injective, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
</ul>
<p>Let <span class="math notranslate nohighlight">\(\phi: \Sigma \to \Sigma'\)</span> be a fan morphism such that the
underlying lattice morphism <span class="math notranslate nohighlight">\(\phi: N \to N'\)</span> bijectively maps <span class="math notranslate nohighlight">\(N\)</span> to a
<em>saturated</em> sublattice of <span class="math notranslate nohighlight">\(N'\)</span>. Let <span class="math notranslate nohighlight">\(\psi: \Sigma \to \Sigma'_0\)</span> be the
restriction of <span class="math notranslate nohighlight">\(\phi\)</span> to the image. Then <span class="math notranslate nohighlight">\(\phi\)</span> is <strong>injective</strong> if the
map between cones corresponding to <span class="math notranslate nohighlight">\(\psi\)</span> (injectively) maps each cone
of <span class="math notranslate nohighlight">\(\Sigma\)</span> to a cone of the same dimension.</p>
<p>If a fan morphism <span class="math notranslate nohighlight">\(\phi: \Sigma \to \Sigma'\)</span> is injective, then the
associated morphism between toric varieties <span class="math notranslate nohighlight">\(\tilde{\phi}: X_\Sigma \to
X_{\Sigma'}\)</span> is injective.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.factor" title="sage.geometry.fan_morphism.FanMorphism.factor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">factor()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>Consider the fan of the affine plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
</pre></div>
</div>
<p>We will map several fans consisting of a single ray into the interior
of the 2-cone:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This morphism was not injective since (in the toric varieties
interpretation) the 1-dimensional orbit corresponding to the ray was
mapped to the 0-dimensional orbit corresponding to the 2-cone.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>While the fans in this example are close to the previous one, here the
ray corresponds to a 0-dimensional orbit.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Here the problem is that <code class="docutils literal notranslate"><span class="pre">m</span></code> maps the domain lattice to a
non-saturated sublattice of the codomain. The corresponding map of the
toric varieties is a two-sheeted cover of its image.</p>
<p>We also embed the affine plane into the projective one:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                               <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>                         <span class="c1"># optional - palp</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.is_surjective">
<span class="sig-name descname"><span class="pre">is_surjective</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_surjective" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is surjective.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is surjective, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
</ul>
<p>A fan morphism <span class="math notranslate nohighlight">\(\phi: \Sigma \to \Sigma'\)</span> is <strong>surjective</strong> if the
corresponding map between cones is surjective, i.e. for each cone
<span class="math notranslate nohighlight">\(\sigma' \in \Sigma'\)</span> there is at least one preimage cone <span class="math notranslate nohighlight">\(\sigma \in
\Sigma\)</span> such that the relative interior of <span class="math notranslate nohighlight">\(\sigma\)</span> is mapped to the
relative interior of <span class="math notranslate nohighlight">\(\sigma'\)</span> and, in addition,
<span class="math notranslate nohighlight">\(\phi_\RR: N_\RR \to N'_\RR\)</span> is surjective.</p>
<p>If a fan morphism <span class="math notranslate nohighlight">\(\phi: \Sigma \to \Sigma'\)</span> is surjective, then the
associated morphism between toric varieties <span class="math notranslate nohighlight">\(\tilde{\phi}: X_\Sigma \to
X_{\Sigma'}\)</span> is surjective.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_bundle" title="sage.geometry.fan_morphism.FanMorphism.is_bundle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_bundle()</span></code></a>, <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_fibration" title="sage.geometry.fan_morphism.FanMorphism.is_fibration"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_fibration()</span></code></a>,
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preimage_cones()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">is_complete()</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<p>We check that the blow up of the affine plane at the origin is
surjective:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Bl</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Bl</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It remains surjective if we throw away “south and north poles” of the
exceptional divisor:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Fan</span><span class="p">(</span><span class="n">Bl</span><span class="o">.</span><span class="n">cones</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But a single patch of the blow up does not cover the plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Bl</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.kernel_fan">
<span class="sig-name descname"><span class="pre">kernel_fan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.kernel_fan" title="Permalink to this definition">#</a></dt>
<dd><p>Return the subfan of the domain fan mapped into the origin.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">fan</span></code></a>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The lattice of the kernel fan is the <code class="xref py py-meth docutils literal notranslate"><span class="pre">kernel()</span></code> sublattice of
<code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan" title="sage.geometry.fan_morphism.FanMorphism.preimage_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preimage_fan()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fan</span><span class="p">,</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">kernel_fan</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in Sublattice &lt;N(1, 1)&gt;</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 1)</span>
<span class="go">in Sublattice &lt;N(1, 1)&gt;</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">kernel_fan</span><span class="p">()</span><span class="o">.</span><span class="n">cones</span><span class="p">()</span>
<span class="go">((0-d cone of Rational polyhedral fan in Sublattice &lt;N(1, 1)&gt;,),</span>
<span class="go"> (1-d cone of Rational polyhedral fan in Sublattice &lt;N(1, 1)&gt;,))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.preimage_cones">
<span class="sig-name descname"><span class="pre">preimage_cones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="Permalink to this definition">#</a></dt>
<dd><p>Return cones of the domain fan whose <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.image_cone" title="sage.geometry.fan_morphism.FanMorphism.image_cone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">image_cone()</span></code></a> is <code class="docutils literal notranslate"><span class="pre">cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cone</span></code> – a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span></code></a> equivalent to a
cone of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">codomain_fan()</span></code></a> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cones</span></code></a> of the
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">domain_fan()</span></code></a> of <code class="docutils literal notranslate"><span class="pre">self</span></code>, sorted by dimension.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan" title="sage.geometry.fan_morphism.FanMorphism.preimage_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preimage_fan()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">quadrant</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">quadrant_bl</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">quadrant_bl</span><span class="p">,</span> <span class="n">quadrant</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">preimage_cones</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">preimage_cones</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.preimage_fan">
<span class="sig-name descname"><span class="pre">preimage_fan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan" title="Permalink to this definition">#</a></dt>
<dd><p>Return the subfan of the domain fan mapped into <code class="docutils literal notranslate"><span class="pre">cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cone</span></code> – a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span></code></a> equivalent to a
cone of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">codomain_fan()</span></code></a> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal notranslate"><span class="pre">fan</span></code></a>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The preimage fan of <code class="docutils literal notranslate"><span class="pre">cone</span></code> consists of all cones of the
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">domain_fan()</span></code></a> which are mapped into <code class="docutils literal notranslate"><span class="pre">cone</span></code>, including those
that are mapped into its boundary. So this fan is not necessarily
generated by <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preimage_cones()</span></code></a> of <code class="docutils literal notranslate"><span class="pre">cone</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.kernel_fan" title="sage.geometry.fan_morphism.FanMorphism.kernel_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kernel_fan()</span></code></a>, <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preimage_cones()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadrant_cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant_fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">quadrant_cone</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">quadrant_bl</span> <span class="o">=</span> <span class="n">quadrant_fan</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">....: </span>                 <span class="n">quadrant_bl</span><span class="p">,</span> <span class="n">quadrant_fan</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">preimage_fan</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span><span class="o">.</span><span class="n">cones</span><span class="p">()</span>
<span class="go">((0-d cone of Rational polyhedral fan in 2-d lattice N,),</span>
<span class="go"> (1-d cone of Rational polyhedral fan in 2-d lattice N,))</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">preimage_fan</span><span class="p">(</span><span class="n">quadrant_cone</span><span class="p">)</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">preimage_cones</span><span class="p">(</span><span class="n">quadrant_cone</span><span class="p">))</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones">
<span class="sig-name descname"><span class="pre">primitive_preimage_cones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones" title="Permalink to this definition">#</a></dt>
<dd><p>Return the primitive cones of the domain fan corresponding to <code class="docutils literal notranslate"><span class="pre">cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cone</span></code> – a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span></code></a> equivalent to a
cone of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">codomain_fan()</span></code></a> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal notranslate"><span class="pre">cone</span></code></a>.</p></li>
</ul>
<p>Let <span class="math notranslate nohighlight">\(\phi: \Sigma \to \Sigma'\)</span> be a fan morphism, let <span class="math notranslate nohighlight">\(\sigma \in
\Sigma\)</span>, and let <span class="math notranslate nohighlight">\(\sigma' = \phi(\sigma)\)</span>. Then <span class="math notranslate nohighlight">\(\sigma\)</span> is a
<strong>primitive cone corresponding to</strong> <span class="math notranslate nohighlight">\(\sigma'\)</span> if there is no proper
face <span class="math notranslate nohighlight">\(\tau\)</span> of <span class="math notranslate nohighlight">\(\sigma\)</span> such that <span class="math notranslate nohighlight">\(\phi(\tau) = \sigma'\)</span>.</p>
<p>Primitive cones play an important role for fibration morphisms.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_fibration" title="sage.geometry.fan_morphism.FanMorphism.is_fibration"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_fibration()</span></code></a>, <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preimage_cones()</span></code></a>,
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan" title="sage.geometry.fan_morphism.FanMorphism.preimage_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preimage_fan()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>Consider a projection of a del Pezzo surface onto the projective line:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>                           <span class="c1"># optional - palp</span>
<span class="gp">sage: </span><span class="n">Sigma</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>                                                  <span class="c1"># optional - palp</span>
<span class="go">N( 0,  1),</span>
<span class="go">N(-1,  0),</span>
<span class="go">N(-1, -1),</span>
<span class="go">N( 0, -1),</span>
<span class="go">N( 1,  0),</span>
<span class="go">N( 1,  1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>        <span class="c1"># optional - palp</span>
</pre></div>
</div>
<p>Under this map, one pair of rays is mapped to the origin, one in the
positive direction, and one in the negative one. Also three
2-dimensional cones are mapped in the positive direction and three in
the negative one, so there are 5 preimage cones corresponding to either
of the rays of the codomain fan <code class="docutils literal notranslate"><span class="pre">Sigma_p</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">preimage_cones</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])))</span>                         <span class="c1"># optional - palp</span>
<span class="go">5</span>
</pre></div>
</div>
<p>Yet only rays are primitive:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)]))</span>                    <span class="c1"># optional - palp</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 1-d cone of Rational polyhedral fan in 2-d lattice N)</span>
</pre></div>
</div>
<p>Since all primitive cones are mapped onto their images bijectively, we
get a fibration:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>                                            <span class="c1"># optional - palp</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But since there are several primitive cones corresponding to the same
cone of the codomain fan, this map is not a bundle, even though its
index is 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>                                               <span class="c1"># optional - palp</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                                   <span class="c1"># optional - palp</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.geometry.fan_morphism.FanMorphism.relative_star_generators">
<span class="sig-name descname"><span class="pre">relative_star_generators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain_cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.relative_star_generators" title="Permalink to this definition">#</a></dt>
<dd><p>Return the relative star generators of <code class="docutils literal notranslate"><span class="pre">domain_cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">domain_cone</span></code> – a cone of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">domain_fan()</span></code></a> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_generators()</span></code> of <code class="docutils literal notranslate"><span class="pre">domain_cone</span></code>
viewed as a cone of <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan" title="sage.geometry.fan_morphism.FanMorphism.preimage_fan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preimage_fan()</span></code></a> of <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.image_cone" title="sage.geometry.fan_morphism.FanMorphism.image_cone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">image_cone()</span></code></a> of
<code class="docutils literal notranslate"><span class="pre">domain_cone</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Bl</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Bl</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">Bl</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">relative_star_generators</span><span class="p">(</span><span class="n">c1</span><span class="p">))</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="go">(2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="point_collection.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Point collections</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="fan.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Rational polyhedral fans</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Morphisms between toric lattices compatible with fans</a><ul>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism"><code class="docutils literal notranslate"><span class="pre">FanMorphism</span></code></a><ul>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="docutils literal notranslate"><span class="pre">codomain_fan()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="docutils literal notranslate"><span class="pre">domain_fan()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.factor"><code class="docutils literal notranslate"><span class="pre">factor()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.image_cone"><code class="docutils literal notranslate"><span class="pre">image_cone()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.index"><code class="docutils literal notranslate"><span class="pre">index()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_birational"><code class="docutils literal notranslate"><span class="pre">is_birational()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_bundle"><code class="docutils literal notranslate"><span class="pre">is_bundle()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_dominant"><code class="docutils literal notranslate"><span class="pre">is_dominant()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_fibration"><code class="docutils literal notranslate"><span class="pre">is_fibration()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_injective"><code class="docutils literal notranslate"><span class="pre">is_injective()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_surjective"><code class="docutils literal notranslate"><span class="pre">is_surjective()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.kernel_fan"><code class="docutils literal notranslate"><span class="pre">kernel_fan()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="docutils literal notranslate"><span class="pre">preimage_cones()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan"><code class="docutils literal notranslate"><span class="pre">preimage_fan()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones"><code class="docutils literal notranslate"><span class="pre">primitive_preimage_cones()</span></code></a></li>
<li><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.relative_star_generators"><code class="docutils literal notranslate"><span class="pre">relative_star_generators()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>