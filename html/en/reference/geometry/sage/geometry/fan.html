<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Rational polyhedral fans &mdash; Sage Reference Manual v7.2: Geometry</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '7.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.2: Geometry" href="../../index.html" />
    <link rel="next" title="Morphisms between toric lattices compatible with fans" href="fan_morphism.html" />
    <link rel="prev" title="Convex rational polyhedral cones" href="cone.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fan_morphism.html" title="Morphisms between toric lattices compatible with fans"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cone.html" title="Convex rational polyhedral cones"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Geometry</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="rational-polyhedral-fans">
<span id="sage-geometry-fan"></span><h1>Rational polyhedral fans<a class="headerlink" href="#rational-polyhedral-fans" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.geometry.fan"></span><p>This module was designed as a part of the framework for toric varieties
(<a class="reference external" href="../../../schemes/sage/schemes/toric/variety.html#module-sage.schemes.toric.variety" title="(in Sage Reference Manual: Schemes v7.2)"><code class="xref py py-mod docutils literal"><span class="pre">variety</span></code></a>,
<a class="reference external" href="../../../schemes/sage/schemes/toric/fano_variety.html#module-sage.schemes.toric.fano_variety" title="(in Sage Reference Manual: Schemes v7.2)"><code class="xref py py-mod docutils literal"><span class="pre">fano_variety</span></code></a>). While the emphasis is on
complete full-dimensional fans, arbitrary fans are supported. Work
with distinct lattices. The default lattice is <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></code></a> <span class="math">\(N\)</span> of the appropriate
dimension. The only case when you must specify lattice explicitly is creation
of a 0-dimensional fan, where dimension of the ambient space cannot be
guessed.</p>
<p>A <strong>rational polyhedral fan</strong> is a <em>finite</em> collection of <em>strictly</em> convex
rational polyhedral cones, such that the intersection of any two cones of the
fan is a face of each of them and each face of each cone is also a cone of the
fan.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Andrey Novoseltsev (2010-05-15): initial version.</li>
<li>Andrey Novoseltsev (2010-06-17): substantial improvement during review by
Volker Braun.</li>
</ul>
<p>EXAMPLES:</p>
<p>Use <a class="reference internal" href="#sage.geometry.fan.Fan" title="sage.geometry.fan.Fan"><code class="xref py py-func docutils literal"><span class="pre">Fan()</span></code></a> to construct fans &#8220;explicitly&#8221;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">... </span>            <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
<p>In addition to giving such lists of cones and rays you can also create cones
first using <a class="reference internal" href="cone.html#sage.geometry.cone.Cone" title="sage.geometry.cone.Cone"><code class="xref py py-func docutils literal"><span class="pre">Cone()</span></code></a> and then combine them into a fan.
See the documentation of <a class="reference internal" href="#sage.geometry.fan.Fan" title="sage.geometry.fan.Fan"><code class="xref py py-func docutils literal"><span class="pre">Fan()</span></code></a> for details.</p>
<p>In 2 dimensions there is a unique maximal fan determined by rays, and
you can use <a class="reference internal" href="#sage.geometry.fan.Fan2d" title="sage.geometry.fan.Fan2d"><code class="xref py py-func docutils literal"><span class="pre">Fan2d()</span></code></a> to construct it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan2d</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">(</span><span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan2d</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But keep in mind that in higher dimensions the cone data is essential
and cannot be omitted. Instead of building a fan from scratch, for
this tutorial we will use an easy way to get two fans assosiated to
<a class="reference internal" href="lattice_polytope.html#sage.geometry.lattice_polytope.LatticePolytopeClass" title="sage.geometry.lattice_polytope.LatticePolytopeClass"><code class="xref py py-class docutils literal"><span class="pre">lattice</span> <span class="pre">polytopes</span></code></a>:
<a class="reference internal" href="#sage.geometry.fan.FaceFan" title="sage.geometry.fan.FaceFan"><code class="xref py py-func docutils literal"><span class="pre">FaceFan()</span></code></a> and <a class="reference internal" href="#sage.geometry.fan.NormalFan" title="sage.geometry.fan.NormalFan"><code class="xref py py-func docutils literal"><span class="pre">NormalFan()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>Given such &#8220;automatic&#8221; fans, you may wonder what are their rays and cones:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">M( 1,  0,  0),</span>
<span class="go">M( 0,  1,  0),</span>
<span class="go">M( 0,  0,  1),</span>
<span class="go">M(-1,  0,  0),</span>
<span class="go">M( 0, -1,  0),</span>
<span class="go">M( 0,  0, -1)</span>
<span class="go">in 3-d lattice M</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>
<span class="go">(3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M)</span>
</pre></div>
</div>
<p>The last output is not very illuminating. Let&#8217;s try to improve it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan1</span><span class="p">:</span> <span class="k">print</span> <span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">M(1, 0,  0),</span>
<span class="go">M(0, 1,  0),</span>
<span class="go">M(0, 0, -1)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M( 0, 1,  0),</span>
<span class="go">M(-1, 0,  0),</span>
<span class="go">M( 0, 0, -1)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M(1,  0,  0),</span>
<span class="go">M(0, -1,  0),</span>
<span class="go">M(0,  0, -1)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M(-1,  0,  0),</span>
<span class="go">M( 0, -1,  0),</span>
<span class="go">M( 0,  0, -1)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M(1, 0, 0),</span>
<span class="go">M(0, 1, 0),</span>
<span class="go">M(0, 0, 1)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M( 0, 1, 0),</span>
<span class="go">M( 0, 0, 1),</span>
<span class="go">M(-1, 0, 0)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M(1,  0, 0),</span>
<span class="go">M(0,  0, 1),</span>
<span class="go">M(0, -1, 0)</span>
<span class="go">in 3-d lattice M</span>
<span class="go">M( 0,  0, 1),</span>
<span class="go">M(-1,  0, 0),</span>
<span class="go">M( 0, -1, 0)</span>
<span class="go">in 3-d lattice M</span>
</pre></div>
</div>
<p>You can also do</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan1</span><span class="p">:</span> <span class="k">print</span> <span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0, 1, 5)</span>
<span class="go">(1, 3, 5)</span>
<span class="go">(0, 4, 5)</span>
<span class="go">(3, 4, 5)</span>
<span class="go">(0, 1, 2)</span>
<span class="go">(1, 2, 3)</span>
<span class="go">(0, 2, 4)</span>
<span class="go">(2, 3, 4)</span>
</pre></div>
</div>
<p>to see indices of rays of the fan corresponding to each cone.</p>
<p>While the above cycles were over &#8220;cones in fan&#8221;, it is obvious that we did not
get ALL the cones: every face of every cone in a fan must also be in the fan,
but all of the above cones were of dimension three. The reason for this
behaviour is that in many cases it is enough to work with generating cones of
the fan, i.e. cones which are not faces of bigger cones. When you do need to
work with lower dimensional cones, you can easily get access to them using
<a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.cones" title="sage.geometry.fan.RationalPolyhedralFan.cones"><code class="xref py py-meth docutils literal"><span class="pre">cones()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan1</span><span class="o">.</span><span class="n">cones</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[(0, 1), (0, 2), (1, 2), (1, 3), (2, 3), (0, 4),</span>
<span class="go"> (2, 4), (3, 4), (1, 5), (3, 5), (4, 5), (0, 5)]</span>
</pre></div>
</div>
<p>In fact, you don&#8217;t have to type <code class="docutils literal"><span class="pre">.cones</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan1</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[(0, 1), (0, 2), (1, 2), (1, 3), (2, 3), (0, 4),</span>
<span class="go"> (2, 4), (3, 4), (1, 5), (3, 5), (4, 5), (0, 5)]</span>
</pre></div>
</div>
<p>You may also need to know the inclusion relations between all of the cones of
the fan. In this case check out
<a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.cone_lattice" title="sage.geometry.fan.RationalPolyhedralFan.cone_lattice"><code class="xref py py-meth docutils literal"><span class="pre">cone_lattice()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">fan1</span><span class="o">.</span><span class="n">cone_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Finite poset containing 28 elements with distinguished linear extension</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span>
<span class="go">0-d cone of Rational polyhedral fan in 3-d lattice M</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">top</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 3-d lattice M</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">cone</span>
<span class="go">2-d cone of Rational polyhedral fan in 3-d lattice M</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">hasse_diagram</span><span class="p">()</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">cone</span><span class="p">))</span>
<span class="go">[1-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 1-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M,</span>
<span class="go"> 3-d cone of Rational polyhedral fan in 3-d lattice M]</span>
</pre></div>
</div>
<p>You can check how &#8220;good&#8221; a fan is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The face fan of the octahedron is really good! Time to remember that we have
also constructed its normal fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This one does have some &#8220;problems,&#8221; but we can fix them:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan3</span> <span class="o">=</span> <span class="n">fan2</span><span class="o">.</span><span class="n">make_simplicial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan3</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan3</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note that we had to save the result of
<a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.make_simplicial" title="sage.geometry.fan.RationalPolyhedralFan.make_simplicial"><code class="xref py py-meth docutils literal"><span class="pre">make_simplicial()</span></code></a> in a new fan.
Fans in Sage are immutable, so any operation that does change them constructs
a new fan.</p>
<p>We can also make <code class="docutils literal"><span class="pre">fan3</span></code> smooth, but it will take a bit more work:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cube</span> <span class="o">=</span> <span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">polar</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sk</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">skeleton_points</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">[</span><span class="n">cube</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">sk</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">fan4</span> <span class="o">=</span> <span class="n">fan3</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="n">rays</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan4</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Let&#8217;s see how &#8220;different&#8221; are <code class="docutils literal"><span class="pre">fan2</span></code> and <code class="docutils literal"><span class="pre">fan4</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">fan4</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="n">fan4</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">26</span>
</pre></div>
</div>
<p>Smoothness does not come for free!</p>
<p>Please take a look at the rest of the available functions below and their
complete descriptions. If you need any features that are missing, feel free to
suggest them. (Or implement them on your own and submit a patch to Sage for
inclusion!)</p>
<dl class="class">
<dt id="sage.geometry.fan.Cone_of_fan">
<em class="property">class </em><code class="descclassname">sage.geometry.fan.</code><code class="descname">Cone_of_fan</code><span class="sig-paren">(</span><em>ambient</em>, <em>ambient_ray_indices</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.Cone_of_fan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">sage.geometry.cone.ConvexRationalPolyhedralCone</span></code></a></p>
<p>Construct a cone belonging to a fan.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This class does not check that the input defines a valid cone of a
fan. You must not construct objects of this class directly.</p>
</div>
<p>In addition to all of the properties of &#8220;regular&#8221; <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cones</span></code></a>, such cones know their
relation to the fan.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ambient</span></code> &#8211; fan whose cone is constructed;</li>
<li><code class="docutils literal"><span class="pre">ambient_ray_indices</span></code> &#8211; increasing list or tuple of integers, indices
of rays of <code class="docutils literal"><span class="pre">ambient</span></code> generating this cone.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>cone of <code class="docutils literal"><span class="pre">ambient</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<p>The intended way to get objects of this class is the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cone</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0, 2)</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">star_generator_indices</span><span class="p">()</span>
<span class="go">(0,)</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.geometry.fan.Cone_of_fan.star_generator_indices">
<code class="descname">star_generator_indices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.Cone_of_fan.star_generator_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return indices of generating cones of the &#8220;ambient fan&#8221; containing
<code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>increasing <a class="reference external" href="https://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a> of integers.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">star_generator_indices</span><span class="p">()</span>
<span class="go">(0,)</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>A mistake in this function used to cause the problem reported in
<a class="reference external" href="http://trac.sagemath.org/9782">trac ticket #9782</a>. We check that now everything is working smoothly:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)],</span>
<span class="gp">... </span>          <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.Cone_of_fan.star_generators">
<code class="descname">star_generators</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.Cone_of_fan.star_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Return indices of generating cones of the &#8220;ambient fan&#8221; containing
<code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>increasing <a class="reference external" href="https://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a> of integers.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">star_generators</span><span class="p">()</span>
<span class="go">(2-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.geometry.fan.FaceFan">
<code class="descclassname">sage.geometry.fan.</code><code class="descname">FaceFan</code><span class="sig-paren">(</span><em>polytope</em>, <em>lattice=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.FaceFan" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the face fan of the given rational <code class="docutils literal"><span class="pre">polytope</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">polytope</span></code> &#8211; a <a class="reference internal" href="polyhedron/constructor.html#sage.geometry.polyhedron.constructor.Polyhedron" title="sage.geometry.polyhedron.constructor.Polyhedron"><code class="xref py py-func docutils literal"><span class="pre">polytope</span></code></a> over <span class="math">\(\QQ\)</span> or
a <a class="reference internal" href="lattice_polytope.html#sage.geometry.lattice_polytope.LatticePolytopeClass" title="sage.geometry.lattice_polytope.LatticePolytopeClass"><code class="xref py py-class docutils literal"><span class="pre">lattice</span> <span class="pre">polytope</span></code></a>. A (not
necessarily full-dimensional) polytope contaning the origin in
its <a class="reference internal" href="polyhedron/base.html#sage.geometry.polyhedron.base.Polyhedron_base.relative_interior_contains" title="sage.geometry.polyhedron.base.Polyhedron_base.relative_interior_contains"><code class="xref py py-meth docutils literal"><span class="pre">relative</span> <span class="pre">interior</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">lattice</span></code> &#8211; <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></code></a>, <span class="math">\(\ZZ^n\)</span>, or any
other object that behaves like these. If not specified, an attempt will
be made to determine an appropriate toric lattice automatically.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a>.</li>
</ul>
<p>See also <a class="reference internal" href="#sage.geometry.fan.NormalFan" title="sage.geometry.fan.NormalFan"><code class="xref py py-func docutils literal"><span class="pre">NormalFan()</span></code></a>.</p>
<p>EXAMPLES:</p>
<p>Let&#8217;s construct the fan corresponding to the product of two projective
lines:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">diamond</span> <span class="o">=</span> <span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">diamond</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">M( 1,  0),</span>
<span class="go">M( 0,  1),</span>
<span class="go">M(-1,  0),</span>
<span class="go">M( 0, -1)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">P1xP1</span><span class="p">:</span> <span class="k">print</span> <span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">M(1,  0),</span>
<span class="go">M(0, -1)</span>
<span class="go">in 2-d lattice M</span>
<span class="go">M(-1,  0),</span>
<span class="go">M( 0, -1)</span>
<span class="go">in 2-d lattice M</span>
<span class="go">M(1, 0),</span>
<span class="go">M(0, 1)</span>
<span class="go">in 2-d lattice M</span>
<span class="go">M( 0, 1),</span>
<span class="go">M(-1, 0)</span>
<span class="go">in 2-d lattice M</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cuboctahed</span> <span class="o">=</span> <span class="n">polytopes</span><span class="o">.</span><span class="n">cuboctahedron</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FaceFan</span><span class="p">(</span><span class="n">cuboctahed</span><span class="p">)</span>
<span class="go">Rational polyhedral fan in 3-d lattice M</span>
<span class="gp">sage: </span><span class="n">cuboctahed</span><span class="o">.</span><span class="n">is_lattice_polytope</span><span class="p">(),</span> <span class="n">cuboctahed</span><span class="o">.</span><span class="n">dilation</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_lattice_polytope</span><span class="p">()</span>
<span class="go">(True, False)</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">cuboctahed</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">cuboctahed</span><span class="o">.</span><span class="n">dilation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">lattice_polytope</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">ray</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">FaceFan</span><span class="p">(</span><span class="n">ray</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">face fans are defined only for</span>
<span class="go">polytopes containing the origin as an interior point!</span>

<span class="gp">sage: </span><span class="n">interval_in_QQ2</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">([</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">FaceFan</span><span class="p">(</span><span class="n">interval_in_QQ2</span><span class="p">)</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice M,</span>
<span class="go"> 1-d cone of Rational polyhedral fan in 2-d lattice M)</span>

<span class="gp">sage: </span><span class="n">FaceFan</span><span class="p">(</span><span class="n">Polyhedron</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span> <span class="c1"># origin on facet</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">face fans are defined only for</span>
<span class="go">polytopes containing the origin as an interior point!</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.fan.Fan">
<code class="descclassname">sage.geometry.fan.</code><code class="descname">Fan</code><span class="sig-paren">(</span><em>cones</em>, <em>rays=None</em>, <em>lattice=None</em>, <em>check=True</em>, <em>normalize=True</em>, <em>is_complete=None</em>, <em>virtual_rays=None</em>, <em>discard_faces=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.Fan" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a rational polyhedral fan.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Approximate time to construct a fan consisting of <span class="math">\(n\)</span> cones is <span class="math">\(n^2/5\)</span>
seconds. That is half an hour for 100 cones. This time can be
significantly reduced in the future, but it is still likely to be
<span class="math">\(\sim n^2\)</span> (with, say, <span class="math">\(/500\)</span> instead of <span class="math">\(/5\)</span>). If you know that your
input does form a valid fan, use <code class="docutils literal"><span class="pre">check=False</span></code> option to skip
consistency checks.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cones</span></code> &#8211; list of either
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">Cone</span></code></a> objects
or lists of integers interpreted as indices of generating rays in
<code class="docutils literal"><span class="pre">rays</span></code>. These must be only <strong>maximal</strong> cones of the fan, unless
<code class="docutils literal"><span class="pre">discard_faces=True</span></code> option is specified;</li>
<li><code class="docutils literal"><span class="pre">rays</span></code> &#8211; list of rays given as list or vectors convertible to the
rational extension of <code class="docutils literal"><span class="pre">lattice</span></code>. If <code class="docutils literal"><span class="pre">cones</span></code> are given by
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">Cone</span></code></a> objects
<code class="docutils literal"><span class="pre">rays</span></code> may be determined automatically. You still may give them
explicitly to ensure a particular order of rays in the fan. In this case
you must list all rays that appear in <code class="docutils literal"><span class="pre">cones</span></code>. You can give &#8220;extra&#8221;
ones if it is convenient (e.g. if you have a big list of rays for
several fans), but all &#8220;extra&#8221; rays will be discarded;</li>
<li><code class="docutils literal"><span class="pre">lattice</span></code> &#8211; <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></code></a>, <span class="math">\(\ZZ^n\)</span>, or any
other object that behaves like these. If not specified, an attempt will
be made to determine an appropriate toric lattice automatically;</li>
<li><code class="docutils literal"><span class="pre">check</span></code> &#8211; by default the input data will be checked for correctness
(e.g. that intersection of any two given cones is a face of each). If you
know for sure that the input is correct, you may significantly decrease
construction time using <code class="docutils literal"><span class="pre">check=False</span></code> option;</li>
<li><code class="docutils literal"><span class="pre">normalize</span></code> &#8211; you can further speed up construction using
<code class="docutils literal"><span class="pre">normalize=False</span></code> option. In this case <code class="docutils literal"><span class="pre">cones</span></code> must be a list of
<strong>sorted</strong> <code class="xref py py-class docutils literal"><span class="pre">tuples</span></code> and <code class="docutils literal"><span class="pre">rays</span></code> must be immutable primitive
vectors in <code class="docutils literal"><span class="pre">lattice</span></code>. In general, you should not use this option, it
is designed for code optimization and does not give as drastic
improvement in speed as the previous one;</li>
<li><code class="docutils literal"><span class="pre">is_complete</span></code> &#8211; every fan can determine on its own if it is complete
or not, however it can take quite a bit of time for &#8220;big&#8221; fans with many
generating cones. On the other hand, in some situations it is known in
advance that a certain fan is complete. In this case you can pass
<code class="docutils literal"><span class="pre">is_complete=True</span></code> option to speed up some computations. You may also
pass <code class="docutils literal"><span class="pre">is_complete=False</span></code> option, although it is less likely to be
beneficial. Of course, passing a wrong value can compromise the
integrity of data structures of the fan and lead to wrong results, so
you should be very careful if you decide to use this option;</li>
<li><code class="docutils literal"><span class="pre">virtual_rays</span></code> &#8211; (optional, computed automatically if needed) a list of
ray generators to be used for <code class="xref py py-meth docutils literal"><span class="pre">virtual_rays()</span></code>;</li>
<li><code class="docutils literal"><span class="pre">discard_faces</span></code> &#8211; by default, the fan constructor expects the list of
<strong>maximal</strong> cones. If you provide &#8220;extra&#8221; ones and leave <code class="docutils literal"><span class="pre">check=True</span></code>
(default), an exception will be raised. If you provide &#8220;extra&#8221; cones and
set <code class="docutils literal"><span class="pre">check=False</span></code>, you may get wrong results as assumptions on internal
data structures will be invalid. If you want the fan constructor to
select the maximal cones from the given input, you may provide
<code class="docutils literal"><span class="pre">discard_faces=True</span></code> option (it works both for <code class="docutils literal"><span class="pre">check=True</span></code> and
<code class="docutils literal"><span class="pre">check=False</span></code>).</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">fan</span></code></a>.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">In 2 dimensions you can cyclically order the rays. Hence the
rays determine a unique maximal fan without having to specify
the cones, and you can use <a class="reference internal" href="#sage.geometry.fan.Fan2d" title="sage.geometry.fan.Fan2d"><code class="xref py py-func docutils literal"><span class="pre">Fan2d()</span></code></a> to construct this
fan from just the rays.</p>
</div>
<p>EXAMPLES:</p>
<p>Let&#8217;s construct a fan corresponding to the projective plane in several
ways:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone3</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">you have provided 3 cones, but only 2 of them are maximal!</span>
<span class="go">Use discard_faces=True if you indeed need to construct a fan from</span>
<span class="go">these cones.</span>
</pre></div>
</div>
<p>Oops! There was a typo and <code class="docutils literal"><span class="pre">cone2</span></code> was listed twice as a generating cone
of the fan. If it was intentional (e.g. the list of cones was generated
automatically and it is possible that it contains repetitions or faces of
other cones), use <code class="docutils literal"><span class="pre">discard_faces=True</span></code> option:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">,</span> <span class="n">cone2</span><span class="p">],</span> <span class="n">discard_faces</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>However, in this case it was definitely a typo, since the fan of
<span class="math">\(\mathbb{P}^2\)</span> has 3 maximal cones:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">,</span> <span class="n">cone3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Looks better. An alternative way is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">cones</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">P2a</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="n">rays</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2a</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">==</span> <span class="n">P2a</span>
<span class="go">False</span>
</pre></div>
</div>
<p>That may seem wrong, but it is not:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">P2a</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.is_equivalent" title="sage.geometry.fan.RationalPolyhedralFan.is_equivalent"><code class="xref py py-meth docutils literal"><span class="pre">is_equivalent()</span></code></a> for details.</p>
<p>Yet another way to construct this fan is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2b</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="n">rays</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2b</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">P2a</span> <span class="o">==</span> <span class="n">P2b</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If you try the above examples, you are likely to notice the difference in
speed, so when you are sure that everything is correct, it is a good idea
to use <code class="docutils literal"><span class="pre">check=False</span></code> option. On the other hand, it is usually <strong>NOT</strong> a
good idea to use <code class="docutils literal"><span class="pre">normalize=False</span></code> option:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2c</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="n">rays</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;tuple&#39; object has no attribute &#39;parent&#39;</span>
</pre></div>
</div>
<p>Yet another way is to use functions <a class="reference internal" href="#sage.geometry.fan.FaceFan" title="sage.geometry.fan.FaceFan"><code class="xref py py-func docutils literal"><span class="pre">FaceFan()</span></code></a> and <a class="reference internal" href="#sage.geometry.fan.NormalFan" title="sage.geometry.fan.NormalFan"><code class="xref py py-func docutils literal"><span class="pre">NormalFan()</span></code></a>
to construct fans from <a class="reference internal" href="lattice_polytope.html#sage.geometry.lattice_polytope.LatticePolytopeClass" title="sage.geometry.lattice_polytope.LatticePolytopeClass"><code class="xref py py-class docutils literal"><span class="pre">lattice</span> <span class="pre">polytopes</span></code></a>.</p>
<p>We have not yet used <code class="docutils literal"><span class="pre">lattice</span></code> argument, since if was determined
automatically:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">2-d lattice N</span>
<span class="gp">sage: </span><span class="n">P2b</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">2-d lattice N</span>
</pre></div>
</div>
<p>However, it is necessary to specify it explicitly if you want to construct
a fan without rays or cones:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Fan</span><span class="p">([],</span> <span class="p">[])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">you must specify the lattice</span>
<span class="go">when you construct a fan without rays and cones!</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">Rational polyhedral fan in 2-d lattice L</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">lattice_dim</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.fan.Fan2d">
<code class="descclassname">sage.geometry.fan.</code><code class="descname">Fan2d</code><span class="sig-paren">(</span><em>rays</em>, <em>lattice=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.Fan2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the maximal 2-d fan with given <code class="docutils literal"><span class="pre">rays</span></code>.</p>
<p>In two dimensions we can uniquely construct a fan from just rays,
just by cyclically ordering the rays and constructing as many
cones as possible. This is why we implement a special constructor
for this case.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">rays</span></code> &#8211; list of rays given as list or vectors convertible to
the rational extension of <code class="docutils literal"><span class="pre">lattice</span></code>. Duplicate rays are
removed without changing the ordering of the remaining rays.</li>
<li><code class="docutils literal"><span class="pre">lattice</span></code> &#8211; <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></code></a>, <span class="math">\(\ZZ^n\)</span>, or any
other object that behaves like these. If not specified, an attempt will
be made to determine an appropriate toric lattice automatically.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;myN&#39;</span><span class="p">))</span>
<span class="go">Rational polyhedral fan in 2-d lattice myN</span>
</pre></div>
</div>
<p>The ray order is as specified, even if it is not the cyclic order:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(0, 1),</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">==</span> <span class="n">fan2</span><span class="p">,</span> <span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">(False, True)</span>

<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan</span> <span class="p">]</span>
<span class="go">[(2, 1), (1, 3), (3, 0), (0, 2)]</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>

<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 1-d cone of Rational polyhedral fan in 2-d lattice N)</span>

<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">you must specify a 2-dimensional lattice</span>
<span class="go">when you construct a fan without rays.</span>

<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(3, 4)</span>
<span class="go">in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">the lattice must be 2-dimensional.</span>

<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">only non-zero vectors define rays</span>

<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>         <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>         <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>         <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>         <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>         <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">cone_lattice</span><span class="p">()</span>
<span class="go">Finite poset containing 44 elements with distinguished linear extension</span>

<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.fan.NormalFan">
<code class="descclassname">sage.geometry.fan.</code><code class="descname">NormalFan</code><span class="sig-paren">(</span><em>polytope</em>, <em>lattice=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.NormalFan" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the normal fan of the given rational <code class="docutils literal"><span class="pre">polytope</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">polytope</span></code> &#8211; a full-dimensional <a class="reference internal" href="polyhedron/constructor.html#sage.geometry.polyhedron.constructor.Polyhedron" title="sage.geometry.polyhedron.constructor.Polyhedron"><code class="xref py py-func docutils literal"><span class="pre">polytope</span></code></a> over <span class="math">\(\QQ\)</span>
or:class:<span class="math">\(lattice polytope
&lt;sage.geometry.lattice_polytope.LatticePolytopeClass&gt;\)</span>.</li>
<li><code class="docutils literal"><span class="pre">lattice</span></code> &#8211; <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></code></a>, <span class="math">\(\ZZ^n\)</span>, or any
other object that behaves like these. If not specified, an attempt will
be made to determine an appropriate toric lattice automatically.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a>.</li>
</ul>
<p>See also <a class="reference internal" href="#sage.geometry.fan.FaceFan" title="sage.geometry.fan.FaceFan"><code class="xref py py-func docutils literal"><span class="pre">FaceFan()</span></code></a>.</p>
<p>EXAMPLES:</p>
<p>Let&#8217;s construct the fan corresponding to the product of two projective
lines:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">square</span> <span class="o">=</span> <span class="n">LatticePolytope</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1,  0),</span>
<span class="go">N( 0,  1),</span>
<span class="go">N( 0, -1),</span>
<span class="go">N(-1,  0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">P1xP1</span><span class="p">:</span> <span class="k">print</span> <span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 0, -1),</span>
<span class="go">N(-1,  0)</span>
<span class="go">in 2-d lattice N</span>
<span class="go">N(1,  0),</span>
<span class="go">N(0, -1)</span>
<span class="go">in 2-d lattice N</span>
<span class="go">N(1, 0),</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
<span class="go">N( 0, 1),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">cuboctahed</span> <span class="o">=</span> <span class="n">polytopes</span><span class="o">.</span><span class="n">cuboctahedron</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">NormalFan</span><span class="p">(</span><span class="n">cuboctahed</span><span class="p">)</span>
<span class="go">Rational polyhedral fan in 3-d lattice N</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cuboctahed</span><span class="o">.</span><span class="n">is_lattice_polytope</span><span class="p">(),</span> <span class="n">cuboctahed</span><span class="o">.</span><span class="n">dilation</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_lattice_polytope</span><span class="p">()</span>
<span class="go">(True, False)</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">cuboctahed</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">cuboctahed</span><span class="o">.</span><span class="n">dilation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">lattice_polytope</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.geometry.fan.RationalPolyhedralFan">
<em class="property">class </em><code class="descclassname">sage.geometry.fan.</code><code class="descname">RationalPolyhedralFan</code><span class="sig-paren">(</span><em>cones</em>, <em>rays</em>, <em>lattice</em>, <em>is_complete=None</em>, <em>virtual_rays=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cone.html#sage.geometry.cone.IntegralRayCollection" title="sage.geometry.cone.IntegralRayCollection"><code class="xref py py-class docutils literal"><span class="pre">sage.geometry.cone.IntegralRayCollection</span></code></a>, <code class="xref py py-class docutils literal"><span class="pre">_abcoll.Callable</span></code>, <code class="xref py py-class docutils literal"><span class="pre">_abcoll.Container</span></code></p>
<p>Create a rational polyhedral fan.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This class does not perform any checks of correctness of input nor
does it convert input into the standard representation. Use
<a class="reference internal" href="#sage.geometry.fan.Fan" title="sage.geometry.fan.Fan"><code class="xref py py-func docutils literal"><span class="pre">Fan()</span></code></a> to construct fans from &#8220;raw data&#8221; or <a class="reference internal" href="#sage.geometry.fan.FaceFan" title="sage.geometry.fan.FaceFan"><code class="xref py py-func docutils literal"><span class="pre">FaceFan()</span></code></a> and
<a class="reference internal" href="#sage.geometry.fan.NormalFan" title="sage.geometry.fan.NormalFan"><code class="xref py py-func docutils literal"><span class="pre">NormalFan()</span></code></a> to get fans associated to polytopes.</p>
</div>
<p>Fans are immutable, but they cache most of the returned values.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cones</span></code> &#8211; list of generating cones of the fan, each cone given as a
list of indices of its generating rays in <code class="docutils literal"><span class="pre">rays</span></code>;</li>
<li><code class="docutils literal"><span class="pre">rays</span></code> &#8211; list of immutable primitive vectors in <code class="docutils literal"><span class="pre">lattice</span></code>
consisting of exactly the rays of the fan (i.e. no &#8220;extra&#8221; ones);</li>
<li><code class="docutils literal"><span class="pre">lattice</span></code> &#8211; <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></code></a>, <span class="math">\(\ZZ^n\)</span>, or any
other object that behaves like these. If <code class="docutils literal"><span class="pre">None</span></code>, it will be determined
as <a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.parent" title="(in Sage Reference Manual: Basic Structures v7.2)"><code class="xref py py-func docutils literal"><span class="pre">parent()</span></code></a> of the first ray. Of course, this cannot be done if
there are no rays, so in this case you must give an appropriate
<code class="docutils literal"><span class="pre">lattice</span></code> directly;</li>
<li><code class="docutils literal"><span class="pre">is_complete</span></code> &#8211; if given, must be <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code> depending on
whether this fan is complete or not. By default, it will be determined
automatically if necessary;</li>
<li><code class="docutils literal"><span class="pre">virtual_rays</span></code> &#8211; if given, must the a list of immutable primitive
vectors in <code class="docutils literal"><span class="pre">lattice</span></code>, see <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.virtual_rays" title="sage.geometry.fan.RationalPolyhedralFan.virtual_rays"><code class="xref py py-meth docutils literal"><span class="pre">virtual_rays()</span></code></a> for details. By default,
it will be determined automatically if necessary.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>rational polyhedral fan.</li>
</ul>
<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.Gale_transform">
<code class="descname">Gale_transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.Gale_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Gale transform of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>A matrix over <span class="math">\(ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">Gale_transform</span><span class="p">()</span>
<span class="go">[ 1  1  0  0 -2]</span>
<span class="go">[ 0  0  1  1 -2]</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.Stanley_Reisner_ideal">
<code class="descname">Stanley_Reisner_ideal</code><span class="sig-paren">(</span><em>ring</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.Stanley_Reisner_ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Stanley-Reisner ideal.</p>
<p>INPUT:</p>
<ul class="simple">
<li>A polynomial ring in <code class="docutils literal"><span class="pre">self.nrays()</span></code> variables.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The Stanley-Reisner ideal in the given polynomial ring.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span> <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">Stanley_Reisner_ideal</span><span class="p">(</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;A, B, C, D, E&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="go">Ideal (A*E, C*D, A*B*C, B*D*E) of Multivariate Polynomial Ring in A, B, C, D, E over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.cartesian_product">
<code class="descname">cartesian_product</code><span class="sig-paren">(</span><em>other</em>, <em>lattice=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.cartesian_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Cartesian product of <code class="docutils literal"><span class="pre">self</span></code> with <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a>;</li>
<li><code class="docutils literal"><span class="pre">lattice</span></code> &#8211; (optional) the ambient lattice for the
Cartesian product fan. By default, the direct sum of the
ambient lattices of <code class="docutils literal"><span class="pre">self</span></code> and <code class="docutils literal"><span class="pre">other</span></code> is constructed.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">fan</span></code></a> whose cones are all pairwise
Cartesian products of the cones of <code class="docutils literal"><span class="pre">self</span></code> and <code class="docutils literal"><span class="pre">other</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]],[(</span><span class="mi">1</span><span class="p">,),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span>         <span class="n">cones</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">Rational polyhedral fan in 3-d lattice K+L</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.common_refinement">
<code class="descname">common_refinement</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.common_refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the common refinement of this fan and <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">fan</span></code></a> in the same
<code class="xref py py-meth docutils literal"><span class="pre">lattice()</span></code> and with the same support as this fan</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">fan</span></code></a></li>
</ul>
<p>EXAMPLES:</p>
<p>Refining a fan with itself gives itself:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F0</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F0</span><span class="o">.</span><span class="n">common_refinement</span><span class="p">(</span><span class="n">F0</span><span class="p">)</span> <span class="o">==</span> <span class="n">F0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A more complex example with complete fans:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]],[(</span><span class="mi">1</span><span class="p">,),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)])</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F3</span> <span class="o">=</span> <span class="n">F2</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">F1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F4</span> <span class="o">=</span> <span class="n">F1</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">FF</span> <span class="o">=</span> <span class="n">F3</span><span class="o">.</span><span class="n">common_refinement</span><span class="p">(</span><span class="n">F4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F3</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">F4</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">FF</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">13</span>
</pre></div>
</div>
<p>An example with two non-complete fans with the same support:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F5</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F6</span> <span class="o">=</span> <span class="n">Fan2d</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F5</span><span class="o">.</span><span class="n">common_refinement</span><span class="p">(</span><span class="n">F6</span><span class="p">)</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Both fans must live in the same lattice:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F0</span><span class="o">.</span><span class="n">common_refinement</span><span class="p">(</span><span class="n">F1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">the fans are not in the same lattice</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.complex">
<code class="descname">complex</code><span class="sig-paren">(</span><em>base_ring=Integer Ring</em>, <em>extended=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.complex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the chain complex of the fan.</p>
<p>To a <span class="math">\(d\)</span>-dimensional fan <span class="math">\(\Sigma\)</span>, one can canonically
associate a chain complex <span class="math">\(K^\bullet\)</span></p>
<div class="math">
\[0 \longrightarrow
\ZZ^{\Sigma(d)} \longrightarrow
\ZZ^{\Sigma(d-1)} \longrightarrow
\cdots \longrightarrow
\ZZ^{\Sigma(0)} \longrightarrow
0\]</div>
<p>where the leftmost non-zero entry is in degree <span class="math">\(0\)</span> and the
rightmost entry in degree <span class="math">\(d\)</span>. See <a class="reference internal" href="../../../schemes/sage/schemes/toric/sheaf/klyachko.html#klyachko" id="id1">[Klyachko]</a>, eq. (3.2). This
complex computes the homology of <span class="math">\(|\Sigma|\subset N_\RR\)</span> with
arbitrary support,</p>
<div class="math">
\[H_i(K) = H_{d-i}(|\Sigma|, \ZZ)_{\text{non-cpct}}\]</div>
<p>For a complete fan, this is just the non-compactly supported
homology of <span class="math">\(\RR^d\)</span>. In this case, <span class="math">\(H_0(K)=\ZZ\)</span> and <span class="math">\(0\)</span> in all
non-zero degrees.</p>
<p>For a complete fan, there is an extended chain complex</p>
<div class="math">
\[0 \longrightarrow
\ZZ \longrightarrow
\ZZ^{\Sigma(d)} \longrightarrow
\ZZ^{\Sigma(d-1)} \longrightarrow
\cdots \longrightarrow
\ZZ^{\Sigma(0)} \longrightarrow
0\]</div>
<p>where we take the first <span class="math">\(\ZZ\)</span> term to be in degree -1. This
complex is an exact sequence, that is, all homology groups
vanish.</p>
<p>The orientation of each cone is chosen as in
<a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.oriented_boundary" title="sage.geometry.fan.RationalPolyhedralFan.oriented_boundary"><code class="xref py py-meth docutils literal"><span class="pre">oriented_boundary()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">extended</span></code> &#8211; Boolean (default:False). Whether to
construct the extended complex, that is, including the
<span class="math">\(\ZZ\)</span>-term at degree -1 or not.</li>
<li><code class="docutils literal"><span class="pre">base_ring</span></code> &#8211; A ring (default: <code class="docutils literal"><span class="pre">ZZ</span></code>). The ring to use
instead of <span class="math">\(\ZZ\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>The complex associated to the fan as a <code class="xref py py-class docutils literal"><span class="pre">ChainComplex</span></code>. Raises a
<code class="docutils literal"><span class="pre">ValueError</span></code> if the extended complex is requested for a
non-complete fan.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K_normal</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">();</span> <span class="n">K_normal</span>
<span class="go">Chain complex with at most 4 nonzero terms over Integer Ring</span>
<span class="gp">sage: </span><span class="n">K_normal</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: Z, 1: 0, 2: 0, 3: 0}</span>
<span class="gp">sage: </span><span class="n">K_extended</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">K_extended</span>
<span class="go">Chain complex with at most 5 nonzero terms over Integer Ring</span>
<span class="gp">sage: </span><span class="n">K_extended</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{-1: 0, 0: 0, 1: 0, 2: 0, 3: 0}</span>
</pre></div>
</div>
<p>Homology computations are much faster over <span class="math">\(\QQ\)</span> if you don&#8217;t
care about the torsion coefficients:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2_123</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Chain complex with at most 4 nonzero terms over Rational Field</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{-1: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
</pre></div>
</div>
<p>The extended complex is only defined for complete fans:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The extended complex is only defined for complete fans!</span>
</pre></div>
</div>
<p>The definition of the complex does not refer to the ambient
space of the fan, so it does not distinguish a fan from the
same fan embedded in a subspace:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)]),</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])])</span><span class="o">.</span><span class="n">complex</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])])</span><span class="o">.</span><span class="n">complex</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">==</span> <span class="n">K2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Things get more complicated for non-complete fans:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]),</span>
<span class="gp">... </span>             <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span>
<span class="gp">... </span>             <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">()</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: 0, 1: 0, 2: Z x Z, 3: 0}</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span>
<span class="gp">... </span>             <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">()</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: 0, 1: 0, 2: Z, 3: 0}</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">complex</span><span class="p">()</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: 0, 1: 0, 2: 0, 3: 0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.cone_containing">
<code class="descname">cone_containing</code><span class="sig-paren">(</span><em>*points</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.cone_containing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the smallest cone of <code class="docutils literal"><span class="pre">self</span></code> containing all given points.</p>
<p>INPUT:</p>
<ul class="simple">
<li>either one or more indices of rays of <code class="docutils literal"><span class="pre">self</span></code>, or one or more
objects representing points of the ambient space of <code class="docutils literal"><span class="pre">self</span></code>, or a
list of such objects (you CANNOT give a list of indices).</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A <a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal"><span class="pre">cone</span> <span class="pre">of</span> <span class="pre">fan</span></code></a> whose ambient fan is
<code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We think of the origin as of the smallest cone containing no rays
at all. If there is no ray in <code class="docutils literal"><span class="pre">self</span></code> that contains all <code class="docutils literal"><span class="pre">rays</span></code>,
a <code class="docutils literal"><span class="pre">ValueError</span></code> exception will be raised.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(0,  1),</span>
<span class="go">N(0, -1),</span>
<span class="go">N(1,  0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># ray index</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># ray indices</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">there is no cone in</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="go">containing all of the given rays! Ray indices: [0, 1]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># ray indices</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># point</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span> <span class="c1"># point</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">()</span>
<span class="go">0-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">0-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">there is no cone in</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="go">containing all of the given points! Points: [N(-1, 1)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">... </span>      <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 1, 1)</span>
<span class="go">in 3-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.cone_lattice">
<code class="descname">cone_lattice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.cone_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cone lattice of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>This lattice will have the origin as the bottom (we do not include the
empty set as a cone) and the fan itself as the top.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="xref py py-class docutils literal"><span class="pre">finite</span> <span class="pre">poset</span> <span class="pre">&lt;sage.combinat.posets.posets.FinitePoset</span></code> of
<a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal"><span class="pre">cones</span> <span class="pre">of</span> <span class="pre">fan</span></code></a>, behaving like &#8220;regular&#8221; cones,
but also containing the information about their relation to this
fan, namely, the contained rays and containing generating cones. The
top of the lattice will be this fan itself (<em>which is not a</em>
<a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal"><span class="pre">cone</span> <span class="pre">of</span> <span class="pre">fan</span></code></a>).</li>
</ul>
<p>See also <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.cones" title="sage.geometry.fan.RationalPolyhedralFan.cones"><code class="xref py py-meth docutils literal"><span class="pre">cones()</span></code></a>.</p>
<p>EXAMPLES:</p>
<p>Cone lattices can be computed for arbitrary fans:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 0, 1),</span>
<span class="go">N( 1, 0),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan</span><span class="p">:</span> <span class="k">print</span> <span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="go">(2,)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">cone_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Finite poset containing 6 elements with distinguished linear extension</span>
</pre></div>
</div>
<p>These 6 elements are the origin, three rays, one two-dimensional
cone, and the fan itself. Since we do add the fan itself as the
largest face, you should be a little bit careful with this last
element:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span> <span class="k">print</span> <span class="n">face</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;RationalPolyhedralFan&#39;</span>
<span class="go">object has no attribute &#39;ambient_ray_indices&#39;</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">top</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
<p>For example, you can do</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
<span class="gp">... </span>      <span class="k">print</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>
<span class="go">[()]</span>
<span class="go">[(0,), (1,), (2,)]</span>
<span class="go">[(0, 1)]</span>
</pre></div>
</div>
<p>If the fan is complete, its cone lattice is atomic and coatomic and
can (and will!) be computed in a much more efficient way, but the
interface is exactly the same:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">cone_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
<span class="gp">... </span>      <span class="k">print</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>
<span class="go">[()]</span>
<span class="go">[(0,), (1,), (2,), (3,)]</span>
<span class="go">[(0, 2), (1, 2), (0, 3), (1, 3)]</span>
</pre></div>
</div>
<p>Let&#8217;s also consider the cone lattice of a fan generated by a single
cone:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">cone_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Finite poset containing 5 elements with distinguished linear extension</span>
</pre></div>
</div>
<p>Here these 5 elements correspond to the origin, two rays, one
generating cone of dimension two, and the whole fan. While this single
cone &#8220;is&#8221; the whole fan, it is consistent and convenient to
distinguish them in the cone lattice.</p>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.cones">
<code class="descname">cones</code><span class="sig-paren">(</span><em>dim=None</em>, <em>codim=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.cones" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the specified cones of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">dim</span></code> &#8211; dimension of the requested cones;</li>
<li><code class="docutils literal"><span class="pre">codim</span></code> &#8211; codimension of the requested cones.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can specify at most one input parameter.</p>
</div>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a> of cones of <code class="docutils literal"><span class="pre">self</span></code> of the specified (co)dimension,
if either <code class="docutils literal"><span class="pre">dim</span></code> or <code class="docutils literal"><span class="pre">codim</span></code> is given. Otherwise <a class="reference external" href="https://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a> of
such tuples for all existing dimensions.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="n">codim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(0-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan</span><span class="o">.</span><span class="n">cones</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">cone</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">N(0, 1)</span>
<span class="go">N(1, 0)</span>
<span class="go">N(-1, 0)</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">cones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
</pre></div>
</div>
<p>You cannot specify both dimension and codimension, even if they
&#8220;agree&#8221;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">codim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">dimension and codimension</span>
<span class="go">cannot be specified together!</span>
</pre></div>
</div>
<p>But it is OK to ask for cones of too high or low (co)dimension:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="p">(</span><span class="n">codim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.contains">
<code class="descname">contains</code><span class="sig-paren">(</span><em>cone</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a given <code class="docutils literal"><span class="pre">cone</span></code> is equivalent to a cone of the fan.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cone</span></code> &#8211; anything.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">False</span></code> if <code class="docutils literal"><span class="pre">cone</span></code> is not a cone or if <code class="docutils literal"><span class="pre">cone</span></code> is not
equivalent to a cone of the fan. <code class="docutils literal"><span class="pre">True</span></code> otherwise.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Recall that a fan is a (finite) collection of cones. A
cone is contained in a fan if it is equivalent to one of
the cones of the fan. In particular, it is possible that
all rays of the cone are in the fan, but the cone itself
is not.</p>
<p class="last">If you want to know whether a point is in the support of
the fan, you should use <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.support_contains" title="sage.geometry.fan.RationalPolyhedralFan.support_contains"><code class="xref py py-meth docutils literal"><span class="pre">support_contains()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>We first construct a simple fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
</pre></div>
</div>
<p>Now we check if some cones are in this fan. First, we make sure that
the order of rays of the input cone does not matter (<code class="docutils literal"><span class="pre">check=False</span></code>
option ensures that rays of these cones will be listed exactly as they
are given):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now we check that a non-generating cone is in our fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span> <span class="ow">in</span> <span class="n">f</span>   <span class="c1"># equivalent to the previous command</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Finally, we test some cones which are not in this fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A point is not a cone:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">lattice</span><span class="p">()(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">n</span>
<span class="go">N(1, 1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.embed">
<code class="descname">embed</code><span class="sig-paren">(</span><em>cone</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.embed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cone equivalent to the given one, but sitting in <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>You may need to use this method before calling methods of <code class="docutils literal"><span class="pre">cone</span></code> that
depend on the ambient structure, such as
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone.ambient_ray_indices" title="sage.geometry.cone.ConvexRationalPolyhedralCone.ambient_ray_indices"><code class="xref py py-meth docutils literal"><span class="pre">ambient_ray_indices()</span></code></a>
or
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of"><code class="xref py py-meth docutils literal"><span class="pre">facet_of()</span></code></a>. The
cone returned by this method will have <code class="docutils literal"><span class="pre">self</span></code> as ambient. If <code class="docutils literal"><span class="pre">cone</span></code>
does not represent a valid cone of <code class="docutils literal"><span class="pre">self</span></code>, <code class="docutils literal"><span class="pre">ValueError</span></code> exception
is raised.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method is very quick if <code class="docutils literal"><span class="pre">self</span></code> is already the ambient
structure of <code class="docutils literal"><span class="pre">cone</span></code>, so you can use without extra checks and
performance hit even if <code class="docutils literal"><span class="pre">cone</span></code> is likely to sit in <code class="docutils literal"><span class="pre">self</span></code> but
in principle may not.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cone</span></code> &#8211; a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cone</span></code></a>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal"><span class="pre">cone</span> <span class="pre">of</span> <span class="pre">fan</span></code></a>, equivalent to <code class="docutils literal"><span class="pre">cone</span></code> but
sitting inside <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Let&#8217;s take a 3-d fan generated by a cone on 4 rays:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])])</span>
</pre></div>
</div>
<p>Then any ray generates a 1-d cone of this fan, but if you construct
such a cone directly, it will not &#8220;sit&#8221; inside the fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ray</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ray</span>
<span class="go">1-d cone in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">ray</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0,)</span>
<span class="gp">sage: </span><span class="n">ray</span><span class="o">.</span><span class="n">adjacent</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">ray</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span>
<span class="go">1-d cone in 3-d lattice N</span>
</pre></div>
</div>
<p>If we want to operate with this ray as a part of the fan, we need to
embed it first:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e_ray</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">ray</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e_ray</span>
<span class="go">1-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(0, -1, 1)</span>
<span class="go">in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">e_ray</span> <span class="ow">is</span> <span class="n">ray</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">ray</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(3,)</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">adjacent</span><span class="p">()</span>
<span class="go">(1-d cone of Rational polyhedral fan in 3-d lattice N,</span>
<span class="go"> 1-d cone of Rational polyhedral fan in 3-d lattice N)</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 3-d lattice N</span>
</pre></div>
</div>
<p>Not every cone can be embedded into a fixed fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">1-d cone in 3-d lattice N does not belong</span>
<span class="go">to Rational polyhedral fan in 3-d lattice N!</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">2-d cone in 3-d lattice N does not belong</span>
<span class="go">to Rational polyhedral fan in 3-d lattice N!</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.generating_cone">
<code class="descname">generating_cone</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.generating_cone" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <code class="docutils literal"><span class="pre">n</span></code>-th generating cone of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">n</span></code> &#8211; integer, the index of a generating cone.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal"><span class="pre">cone</span> <span class="pre">of</span> <span class="pre">fan</span></code></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.generating_cones">
<code class="descname">generating_cones</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.generating_cones" title="Permalink to this definition">¶</a></dt>
<dd><p>Return generating cones of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a> of <a class="reference internal" href="#sage.geometry.fan.Cone_of_fan" title="sage.geometry.fan.Cone_of_fan"><code class="xref py py-class docutils literal"><span class="pre">cones</span> <span class="pre">of</span> <span class="pre">fan</span></code></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>
<span class="go">(2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N)</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>
<span class="go">(2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 1-d cone of Rational polyhedral fan in 2-d lattice N)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.is_complete">
<code class="descname">is_complete</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.is_complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">self</span></code> is complete.</p>
<p>A rational polyhedral fan is <em>complete</em> if its cones fill the whole
space.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is complete and <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_complete</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.is_equivalent">
<code class="descname">is_equivalent</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.is_equivalent" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">self</span></code> is &#8220;mathematically&#8221; the same as <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> - fan.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> and <code class="docutils literal"><span class="pre">other</span></code> define the same fans as
collections of equivalent cones in the same lattice, <code class="docutils literal"><span class="pre">False</span></code>
otherwise.</li>
</ul>
<p>There are three different equivalences between fans <span class="math">\(F_1\)</span> and <span class="math">\(F_2\)</span>
in the same lattice:</p>
<ol class="arabic simple">
<li>They have the same rays in the same order and the same generating
cones in the same order.
This is tested by <code class="docutils literal"><span class="pre">F1</span> <span class="pre">==</span> <span class="pre">F2</span></code>.</li>
<li>They have the same rays and the same generating cones without
taking into account any order.
This is tested by <code class="docutils literal"><span class="pre">F1.is_equivalent(F2)</span></code>.</li>
<li>They are in the same orbit of <span class="math">\(GL(n,\ZZ)\)</span> (and, therefore,
correspond to isomorphic toric varieties).
This is tested by <code class="docutils literal"><span class="pre">F1.is_isomorphic(F2)</span></code>.</li>
</ol>
<p>Note that <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.virtual_rays" title="sage.geometry.fan.RationalPolyhedralFan.virtual_rays"><code class="xref py py-meth docutils literal"><span class="pre">virtual_rays()</span></code></a> are included into consideration for all
of the above equivalences.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan3</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">==</span> <span class="n">fan2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">==</span> <span class="n">fan3</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan3</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.is_isomorphic">
<code class="descname">is_isomorphic</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.is_isomorphic" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">self</span></code> is in the same <span class="math">\(GL(n, \ZZ)\)</span>-orbit as <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>There are three different equivalences between fans <span class="math">\(F_1\)</span> and <span class="math">\(F_2\)</span>
in the same lattice:</p>
<ol class="arabic simple">
<li>They have the same rays in the same order and the same generating
cones in the same order.
This is tested by <code class="docutils literal"><span class="pre">F1</span> <span class="pre">==</span> <span class="pre">F2</span></code>.</li>
<li>They have the same rays and the same generating cones without
taking into account any order.
This is tested by <code class="docutils literal"><span class="pre">F1.is_equivalent(F2)</span></code>.</li>
<li>They are in the same orbit of <span class="math">\(GL(n,\ZZ)\)</span> (and, therefore,
correspond to isomorphic toric varieties).
This is tested by <code class="docutils literal"><span class="pre">F1.is_isomorphic(F2)</span></code>.</li>
</ol>
<p>Note that <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.virtual_rays" title="sage.geometry.fan.RationalPolyhedralFan.virtual_rays"><code class="xref py py-meth docutils literal"><span class="pre">virtual_rays()</span></code></a> are included into consideration for all
of the above equivalences.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; a <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">fan</span></code></a>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> and <code class="docutils literal"><span class="pre">other</span></code> are in the same
<span class="math">\(GL(n, \ZZ)\)</span>-orbit, <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">If you want to obtain the actual fan isomorphism, use
<a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.isomorphism" title="sage.geometry.fan.RationalPolyhedralFan.isomorphism"><code class="xref py py-meth docutils literal"><span class="pre">isomorphism()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>Here we pick an <span class="math">\(SL(2,\ZZ)\)</span> matrix <code class="docutils literal"><span class="pre">m</span></code> and then verify that
the image fan is isomorphic:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">cones</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="n">rays</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="p">[</span><span class="n">vector</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">m</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rays</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">==</span> <span class="n">fan2</span>
<span class="go">False</span>
</pre></div>
</div>
<p>These fans are &#8220;mirrors&#8221; of each other:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">==</span> <span class="n">fan2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">fan1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.is_simplicial">
<code class="descname">is_simplicial</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.is_simplicial" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">self</span></code> is simplicial.</p>
<p>A rational polyhedral fan is <strong>simplicial</strong> if all of its cones are,
i.e. primitive vectors along generating rays of every cone form a part
of a <em>rational</em> basis of the ambient space.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is simplicial and <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In fact, any fan in a two-dimensional ambient space is simplicial.
This is no longer the case in dimension three:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.is_smooth">
<code class="descname">is_smooth</code><span class="sig-paren">(</span><em>codim=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.is_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">self</span></code> is smooth.</p>
<p>A rational polyhedral fan is <strong>smooth</strong> if all of its cones
are, i.e. primitive vectors along generating rays of every
cone form a part of an <em>integral</em> basis of the ambient
space. In this case the corresponding toric variety is smooth.</p>
<p>A fan in an <span class="math">\(n\)</span>-dimensional lattice is smooth up to codimension <span class="math">\(c\)</span>
if all cones of codimension greater than or equal to <span class="math">\(c\)</span> are smooth,
i.e. if all cones of dimension less than or equal to <span class="math">\(n-c\)</span> are smooth.
In this case the singular set of the corresponding toric variety is of
dimension less than <span class="math">\(c\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">codim</span></code> &#8211; codimension in which smoothness has to be checked, by
default complete smoothness will be checked.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is smooth (in codimension <code class="docutils literal"><span class="pre">codim</span></code>, if it was
given) and <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">(</span><span class="n">codim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(-1,  1),</span>
<span class="go">N(-1, -1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.isomorphism">
<code class="descname">isomorphism</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.isomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a fan isomorphism from <code class="docutils literal"><span class="pre">self</span></code> to <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; fan.</li>
</ul>
<p>OUTPUT:</p>
<p>A fan isomorphism. If no such isomorphism exists, a
<a class="reference internal" href="fan_isomorphism.html#sage.geometry.fan_isomorphism.FanNotIsomorphicError" title="sage.geometry.fan_isomorphism.FanNotIsomorphicError"><code class="xref py py-class docutils literal"><span class="pre">FanNotIsomorphicError</span></code></a>
is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">cones</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">fan1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="n">rays</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fan2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="p">,</span> <span class="p">[</span><span class="n">vector</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">m</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rays</span><span class="p">])</span>

<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">isomorphism</span><span class="p">(</span><span class="n">fan2</span><span class="p">)</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[-2  3]</span>
<span class="go">[ 1 -1]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">fan2</span><span class="o">.</span><span class="n">isomorphism</span><span class="p">(</span><span class="n">fan1</span><span class="p">)</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1 3]</span>
<span class="go">[1 2]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">fan1</span><span class="o">.</span><span class="n">isomorphism</span><span class="p">(</span><span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">FanNotIsomorphicError</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.linear_equivalence_ideal">
<code class="descname">linear_equivalence_ideal</code><span class="sig-paren">(</span><em>ring</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.linear_equivalence_ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ideal generated by linear relations</p>
<p>INPUT:</p>
<ul class="simple">
<li>A polynomial ring in <code class="docutils literal"><span class="pre">self.nrays()</span></code> variables.</li>
</ul>
<p>OUTPUT:</p>
<p>Returns the ideal, in the given <code class="docutils literal"><span class="pre">ring</span></code>, generated by the
linear relations of the rays. In toric geometry, this
corresponds to rational equivalence of divisors.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span> <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">linear_equivalence_ideal</span><span class="p">(</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;A, B, C, D, E&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="go">Ideal (-3*A + 3*C - D + E, -2*A - 2*C - D - E, A + B + C + D + E) of Multivariate Polynomial Ring in A, B, C, D, E over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.make_simplicial">
<code class="descname">make_simplicial</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.make_simplicial" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a simplicial fan subdividing <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>It is a synonym for <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.subdivide" title="sage.geometry.fan.RationalPolyhedralFan.subdivide"><code class="xref py py-meth docutils literal"><span class="pre">subdivide()</span></code></a> with <code class="docutils literal"><span class="pre">make_simplicial=True</span></code>
option.</p>
<p>INPUT:</p>
<ul class="simple">
<li>this functions accepts only keyword arguments. See <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.subdivide" title="sage.geometry.fan.RationalPolyhedralFan.subdivide"><code class="xref py py-meth docutils literal"><span class="pre">subdivide()</span></code></a>
for documentation.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">new_fan</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">make_simplicial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">new_fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">new_fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.ngenerating_cones">
<code class="descname">ngenerating_cones</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.ngenerating_cones" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of generating cones of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>integer.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.oriented_boundary">
<code class="descname">oriented_boundary</code><span class="sig-paren">(</span><em>cone</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.oriented_boundary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the facets bounding <code class="docutils literal"><span class="pre">cone</span></code> with their induced
orientation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cone</span></code> &#8211; a cone of the fan or the whole fan.</li>
</ul>
<p>OUTPUT:</p>
<p>The boundary cones of <code class="docutils literal"><span class="pre">cone</span></code> as a formal linear combination
of cones with coefficients <span class="math">\(\pm 1\)</span>. Each summand is a facet of
<code class="docutils literal"><span class="pre">cone</span></code> and the coefficient indicates whether their (chosen)
orientation argrees or disagrees with the &#8220;outward normal
first&#8221; boundary orientation. Note that the orientation of any
individial cone is arbitrary. This method once and for all
picks orientations for all cones and then computes the
boundaries relative to that chosen orientation.</p>
<p>If <code class="docutils literal"><span class="pre">cone</span></code> is the fan itself, the generating cones with their
orientation relative to the ambient space are returned.</p>
<p>See <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.complex" title="sage.geometry.fan.RationalPolyhedralFan.complex"><code class="xref py py-meth docutils literal"><span class="pre">complex()</span></code></a> for the associated chain complex. If you
do not require the orientation, use <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone.facets" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facets"><code class="xref py py-meth docutils literal"><span class="pre">cone.facets()</span></code></a>
instead.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">fan</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">bdry</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">cone</span><span class="p">);</span>  <span class="n">bdry</span>
<span class="go">1-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="go">- 1-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">bdry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">(1, 1-d cone of Rational polyhedral fan in 3-d lattice N)</span>
<span class="gp">sage: </span><span class="n">bdry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">(-1, 1-d cone of Rational polyhedral fan in 3-d lattice N)</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">bdry</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-0-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">bdry</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-0-d cone of Rational polyhedral fan in 3-d lattice N</span>
</pre></div>
</div>
<p>If you pass the fan itself, this method returns the
orientation of the generating cones which is determined by the
order of the rays in <code class="xref py py-meth docutils literal"><span class="pre">cone.ray_basis()</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
<span class="go">-3-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="go">+ 3-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="go">- 3-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="go">+ 3-d cone of Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="gp">... </span>   <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">fan</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()]</span>
<span class="go">[-1, 1, -1, 1]</span>
</pre></div>
</div>
<p>A non-full dimensional fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span>
<span class="go">0-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">trivial_cone</span> <span class="o">=</span> <span class="n">fan</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">oriented_boundary</span><span class="p">(</span><span class="n">trivial_cone</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**options</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li>any options for toric plots (see <a class="reference internal" href="toric_plotter.html#sage.geometry.toric_plotter.options" title="sage.geometry.toric_plotter.options"><code class="xref py py-func docutils literal"><span class="pre">toric_plotter.options</span></code></a>), none are mandatory.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a plot.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 31 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.primitive_collections">
<code class="descname">primitive_collections</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.primitive_collections" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the primitive collections.</p>
<p>OUTPUT:</p>
<p>Returns the subsets <span class="math">\(\{i_1,\dots,i_k\} \subset \{ 1,\dots,n\}\)</span>
such that</p>
<ul class="simple">
<li>The points <span class="math">\(\{p_{i_1},\dots,p_{i_k}\}\)</span> do not span a cone of
the fan.</li>
<li>If you remove any one <span class="math">\(p_{i_j}\)</span> from the set, then they do
span a cone of the fan.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By replacing the multiindices <span class="math">\(\{i_1,\dots,i_k\}\)</span> of each
primitive collection with the monomials <span class="math">\(x_{i_1}\cdots
x_{i_k}\)</span> one generates the Stanley-Reisner ideal in
<span class="math">\(\ZZ[x_1,\dots]\)</span>.</p>
</div>
<p>REFERENCES:</p>
<blockquote>
<div>V.V. Batyrev, On the classification of smooth projective
toric varieties, Tohoku Math.J. 43 (1991), 569-585</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span> <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">primitive_collections</span><span class="p">()</span>
<span class="go">[frozenset({0, 4}),</span>
<span class="go"> frozenset({2, 3}),</span>
<span class="go"> frozenset({0, 1, 2}),</span>
<span class="go"> frozenset({1, 3, 4})]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.subdivide">
<code class="descname">subdivide</code><span class="sig-paren">(</span><em>new_rays=None</em>, <em>make_simplicial=False</em>, <em>algorithm='default'</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.subdivide" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a new fan subdividing <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">new_rays</span></code> - list of new rays to be added during subdivision, each
ray must be a list or a vector. May be empty or <code class="docutils literal"><span class="pre">None</span></code> (default);</li>
<li><code class="docutils literal"><span class="pre">make_simplicial</span></code> - if <code class="docutils literal"><span class="pre">True</span></code>, the returned fan is guaranteed to
be simplicial, default is <code class="docutils literal"><span class="pre">False</span></code>;</li>
<li><code class="docutils literal"><span class="pre">algorithm</span></code> - string with the name of the algorithm used for
subdivision. Currently there is only one available algorithm called
&#8220;default&#8221;;</li>
<li><code class="docutils literal"><span class="pre">verbose</span></code> - if <code class="docutils literal"><span class="pre">True</span></code>, some timing information may be printed
during the process of subdivision.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a>.</li>
</ul>
<p>Currently the &#8220;default&#8221; algorithm corresponds to iterative stellar
subdivision for each ray in <code class="docutils literal"><span class="pre">new_rays</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">new_fan</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">new_fan</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">new_fan</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">new_fan</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>We check that Trac #11902 is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">the origin cannot be used for fan subdivision!</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.support_contains">
<code class="descname">support_contains</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.support_contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a point is contained in the support of the fan.</p>
<p>The support of a fan is the union of all cones of the fan. If
you want to know whether the fan contains a given cone, you
should use <a class="reference internal" href="#sage.geometry.fan.RationalPolyhedralFan.contains" title="sage.geometry.fan.RationalPolyhedralFan.contains"><code class="xref py py-meth docutils literal"><span class="pre">contains()</span></code></a> instead.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">*args</span></code> &#8211; an element of <code class="docutils literal"><span class="pre">self.lattice()</span></code> or something
that can be converted to it (for example, a list of
coordinates).</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">point</span></code> is contained in the support of the
fan, <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">cone1</span><span class="p">,</span> <span class="n">cone2</span><span class="p">])</span>
</pre></div>
</div>
<p>We check if some points are in this fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">lattice</span><span class="p">()(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">(</span><span class="n">cone1</span><span class="p">)</span>    <span class="c1"># a cone is not a point of the lattice</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span><span class="o">.</span><span class="n">dual</span><span class="p">()(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="c1">#random output (warning)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span><span class="o">.</span><span class="n">dual</span><span class="p">()(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># 0 converts to the origin in the lattice</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">support_contains</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.vertex_graph">
<code class="descname">vertex_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.vertex_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the graph of 1- and 2-cones.</p>
<p>OUTPUT:</p>
<p>An edge-colored graph. The vertices correspond to the 1-cones
(i.e. rays) of
the fan. Two vertices are joined by an edge iff the rays span
a 2-cone of the fan. The edges are colored by pairs of
integers that classify the 2-cones up to <span class="math">\(GL(2,\ZZ)\)</span>
transformation, see
<a class="reference internal" href="cone.html#sage.geometry.cone.classify_cone_2d" title="sage.geometry.cone.classify_cone_2d"><code class="xref py py-func docutils literal"><span class="pre">classify_cone_2d()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP8</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">dP8</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">vertex_graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span>
<span class="go">Graph on 4 vertices</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">dP8</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">()</span>  <span class="c1"># all edge labels the same since every cone is smooth</span>
<span class="go">[(1, 0), (1, 0), (1, 0), (1, 0)]</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">Cube_deformation</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">vertex_graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan.RationalPolyhedralFan.virtual_rays">
<code class="descname">virtual_rays</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.RationalPolyhedralFan.virtual_rays" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (some of the) virtual rays of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>Let <span class="math">\(N\)</span> be the <span class="math">\(D\)</span>-dimensional
<a class="reference internal" href="cone.html#sage.geometry.cone.IntegralRayCollection.lattice" title="sage.geometry.cone.IntegralRayCollection.lattice"><code class="xref py py-meth docutils literal"><span class="pre">lattice()</span></code></a>
of a <span class="math">\(d\)</span>-dimensional fan <span class="math">\(\Sigma\)</span> in <span class="math">\(N_\RR\)</span>. Then the corresponding
toric variety is of the form <span class="math">\(X \times (\CC^*)^{D-d}\)</span>. The actual
<a class="reference internal" href="cone.html#sage.geometry.cone.IntegralRayCollection.rays" title="sage.geometry.cone.IntegralRayCollection.rays"><code class="xref py py-meth docutils literal"><span class="pre">rays()</span></code></a> of <span class="math">\(\Sigma\)</span>
give a canonical choice of homogeneous coordinates on <span class="math">\(X\)</span>. This function
returns an arbitrary but fixed choice of virtual rays corresponding to a
(non-canonical) choice of homogeneous coordinates on the torus factor.
Combinatorially primitive integral generators of virtual rays span the
<span class="math">\(D-d\)</span> dimensions of <span class="math">\(N_\QQ\)</span> &#8220;missed&#8221; by the actual rays. (In general
addition of virtual rays is not sufficient to span <span class="math">\(N\)</span> over <span class="math">\(\ZZ\)</span>.)</p>
<p>..note:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>You may use a particular choice of virtual rays by passing optional
argument ``virtual_rays`` to the :func:`Fan` constructor.
</pre></div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ray_list</span></code> &#8211; a list of integers, the indices of the
requested virtual rays. If not specified, all virtual rays of <code class="docutils literal"><span class="pre">self</span></code>
will be returned.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="point_collection.html#sage.geometry.point_collection.PointCollection" title="sage.geometry.point_collection.PointCollection"><code class="xref py py-class docutils literal"><span class="pre">PointCollection</span></code></a> of
primitive integral ray generators. Usually (if the fan is
full-dimensional) this will be empty.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">virtual_rays</span><span class="p">()</span>
<span class="go">N(0, 0, 0, 1),</span>
<span class="go">N(0, 0, 1, 0)</span>
<span class="go">in 4-d lattice N</span>

<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0, 1, 0),</span>
<span class="go">N(0, 1, 1, 0)</span>
<span class="go">in 4-d lattice N</span>

<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">virtual_rays</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="go">N(0, 0, 0, 1)</span>
<span class="go">in 4-d lattice N</span>
</pre></div>
</div>
<p>You can also give virtual ray indices directly, without
packing them into a list:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">virtual_rays</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">N(0, 0, 0, 1)</span>
<span class="go">in 4-d lattice N</span>
</pre></div>
</div>
<p>Make sure that <a class="reference external" href="http://trac.sagemath.org/16344">trac ticket #16344</a> is fixed and one can compute
the virtual rays of fans in non-saturated lattices:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">submodule</span><span class="p">([(</span><span class="mi">2</span><span class="p">,)])</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]])])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">virtual_rays</span><span class="p">())</span>
<span class="go">0</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>       <span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([</span><span class="n">N</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">f</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">c</span><span class="p">])</span>
<span class="gp">... </span>       <span class="k">assert</span> <span class="n">matrix</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="n">virtual_rays</span><span class="p">())</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span>
<span class="gp">... </span>       <span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">virtual_rays</span><span class="p">())</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.geometry.fan.discard_faces">
<code class="descclassname">sage.geometry.fan.</code><code class="descname">discard_faces</code><span class="sig-paren">(</span><em>cones</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.discard_faces" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cones of the given list which are not faces of each other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cones</span></code> &#8211; a list of
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cones</span></code></a>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of
<a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cones</span></code></a>,
sorted by dimension in decreasing order.</li>
</ul>
<p>EXAMPLES:</p>
<p>Consider all cones of a fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cones</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">Sigma</span><span class="o">.</span><span class="n">cones</span><span class="p">())</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">cones</span><span class="p">)</span>
<span class="go">7</span>
</pre></div>
</div>
<p>Most of them are not necessary to generate this fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.fan</span> <span class="kn">import</span> <span class="n">discard_faces</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">discard_faces</span><span class="p">(</span><span class="n">cones</span><span class="p">))</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Sigma</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.fan.is_Fan">
<code class="descclassname">sage.geometry.fan.</code><code class="descname">is_Fan</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan.is_Fan" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">x</span></code> is a Fan.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">x</span></code> &#8211; anything.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">x</span></code> is a fan and <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.fan</span> <span class="kn">import</span> <span class="n">is_Fan</span>
<span class="gp">sage: </span><span class="n">is_Fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">is_Fan</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="cone.html"
                                  title="previous chapter">Convex rational polyhedral cones</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="fan_morphism.html"
                                  title="next chapter">Morphisms between toric lattices compatible with fans</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/geometry/fan.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fan_morphism.html" title="Morphisms between toric lattices compatible with fans"
             >next</a> |</li>
        <li class="right" >
          <a href="cone.html" title="Convex rational polyhedral cones"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Geometry</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>