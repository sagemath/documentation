<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Convex rational polyhedral cones &mdash; Sage Reference Manual v6.7: Geometry</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.7: Geometry" href="../../index.html" />
    <link rel="next" title="Rational polyhedral fans" href="fan.html" />
    <link rel="prev" title="Toric lattices" href="toric_lattice.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fan.html" title="Rational polyhedral fans"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="toric_lattice.html" title="Toric lattices"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Geometry</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="convex-rational-polyhedral-cones">
<span id="sage-geometry-cone"></span><h1>Convex rational polyhedral cones<a class="headerlink" href="#convex-rational-polyhedral-cones" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.geometry.cone"></span><p>This module was designed as a part of framework for toric varieties
(<a class="reference external" href="../../../schemes/sage/schemes/toric/variety.html#module-sage.schemes.toric.variety" title="(in Sage Reference Manual v6.7)"><tt class="xref py py-mod docutils literal"><span class="pre">variety</span></tt></a>,
<a class="reference external" href="../../../schemes/sage/schemes/toric/fano_variety.html#module-sage.schemes.toric.fano_variety" title="(in Sage Reference Manual v6.7)"><tt class="xref py py-mod docutils literal"><span class="pre">fano_variety</span></tt></a>). While the emphasis is on
strictly convex cones, non-strictly convex cones are supported as well. Work
with distinct lattices (in the sense of discrete subgroups spanning vector
spaces) is supported. The default lattice is <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><tt class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></tt></a> <span class="math">\(N\)</span> of the appropriate
dimension. The only case when you must specify lattice explicitly is creation
of a 0-dimensional cone, where dimension of the ambient space cannot be
guessed.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Andrey Novoseltsev (2010-05-13): initial version.</li>
<li>Andrey Novoseltsev (2010-06-17): substantial improvement during review by
Volker Braun.</li>
<li>Volker Braun (2010-06-21): various spanned/quotient/dual lattice
computations added.</li>
<li>Volker Braun (2010-12-28): Hilbert basis for cones.</li>
<li>Andrey Novoseltsev (2012-02-23): switch to PointCollection container.</li>
</ul>
<p>EXAMPLES:</p>
<p>Use <a class="reference internal" href="#sage.geometry.cone.Cone" title="sage.geometry.cone.Cone"><tt class="xref py py-func docutils literal"><span class="pre">Cone()</span></tt></a> to construct cones:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">octant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">halfspace</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">positive_xy</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">four_rays</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
<p>For all of the cones above we have provided primitive generating rays, but in
fact this is not necessary - a cone can be constructed from any collection of
rays (from the same space, of course). If there are non-primitive (or even
non-integral) rays, they will be replaced with primitive ones. If there are
extra rays, they will be discarded. Of course, this means that <a class="reference internal" href="#sage.geometry.cone.Cone" title="sage.geometry.cone.Cone"><tt class="xref py py-func docutils literal"><span class="pre">Cone()</span></tt></a>
has to do some work before actually constructing the cone and sometimes it is
not desirable, if you know for sure that your input is already &#8220;good&#8221;. In this
case you can use options <tt class="docutils literal"><span class="pre">check=False</span></tt> to force <a class="reference internal" href="#sage.geometry.cone.Cone" title="sage.geometry.cone.Cone"><tt class="xref py py-func docutils literal"><span class="pre">Cone()</span></tt></a> to use
exactly the directions that you have specified and <tt class="docutils literal"><span class="pre">normalize=False</span></tt> to
force it to use exactly the rays that you have specified. However, it is
better not to use these possibilities without necessity, since cones are
assumed to be represented by a minimal set of primitive generating rays.
See <a class="reference internal" href="#sage.geometry.cone.Cone" title="sage.geometry.cone.Cone"><tt class="xref py py-func docutils literal"><span class="pre">Cone()</span></tt></a> for further documentation on construction.</p>
<p>Once you have a cone, you can perform numerous operations on it. The most
important ones are, probably, ray accessing methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="n">halfspace</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rays</span>
<span class="go">N( 0,  0, 1),</span>
<span class="go">N( 0,  1, 0),</span>
<span class="go">N( 0, -1, 0),</span>
<span class="go">N( 1,  0, 0),</span>
<span class="go">N(-1,  0, 0)</span>
<span class="go">in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">rays</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="go">frozenset({N(-1, 0, 0), N(0, -1, 0), N(0, 0, 1), N(0, 1, 0), N(1, 0, 0)})</span>
<span class="gp">sage: </span><span class="n">rays</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 0  0  1]</span>
<span class="go">[ 0  1  0]</span>
<span class="go">[ 0 -1  0]</span>
<span class="go">[ 1  0  0]</span>
<span class="go">[-1  0  0]</span>
<span class="gp">sage: </span><span class="n">rays</span><span class="o">.</span><span class="n">column_matrix</span><span class="p">()</span>
<span class="go">[ 0  0  0  1 -1]</span>
<span class="go">[ 0  1 -1  0  0]</span>
<span class="go">[ 1  0  0  0  0]</span>
<span class="gp">sage: </span><span class="n">rays</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">N(1, 0, 0)</span>
<span class="go">in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">rays</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">N(1, 0, 0)</span>
<span class="gp">sage: </span><span class="n">halfspace</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">N(1, 0, 0)</span>
</pre></div>
</div>
<p>The method <a class="reference internal" href="#sage.geometry.cone.IntegralRayCollection.rays" title="sage.geometry.cone.IntegralRayCollection.rays"><tt class="xref py py-meth docutils literal"><span class="pre">rays()</span></tt></a> returns a
<a class="reference internal" href="point_collection.html#sage.geometry.point_collection.PointCollection" title="sage.geometry.point_collection.PointCollection"><tt class="xref py py-class docutils literal"><span class="pre">PointCollection</span></tt></a> with the
<span class="math">\(i\)</span>-th element being the primitive integral generator of the <span class="math">\(i\)</span>-th
ray. It is possible to convert this collection to a matrix with either
rows or columns corresponding to these generators. You may also change
the default
<a class="reference internal" href="point_collection.html#sage.geometry.point_collection.PointCollection.output_format" title="sage.geometry.point_collection.PointCollection.output_format"><tt class="xref py py-meth docutils literal"><span class="pre">output_format()</span></tt></a>
of all point collections to be such a matrix.</p>
<p>If you want to do something with each ray of a cone, you can write</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">ray</span> <span class="ow">in</span> <span class="n">positive_xy</span><span class="p">:</span> <span class="k">print</span> <span class="n">ray</span>
<span class="go">N(1, 0, 0)</span>
<span class="go">N(0, 1, 0)</span>
</pre></div>
</div>
<p>There are two dimensions associated to each cone - the dimension of the
subspace spanned by the cone and the dimension of the space where it lives:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">positive_xy</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">positive_xy</span><span class="o">.</span><span class="n">lattice_dim</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>You also may be interested in this dimension:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">dim</span><span class="p">(</span><span class="n">positive_xy</span><span class="o">.</span><span class="n">linear_subspace</span><span class="p">())</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">dim</span><span class="p">(</span><span class="n">halfspace</span><span class="o">.</span><span class="n">linear_subspace</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Or, perhaps, all you care about is whether it is zero or not:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">positive_xy</span><span class="o">.</span><span class="n">is_strictly_convex</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">halfspace</span><span class="o">.</span><span class="n">is_strictly_convex</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>You can also perform these checks:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">positive_xy</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">four_rays</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">positive_xy</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>You can work with subcones that form faces of other cones:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">four_rays</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">face</span>
<span class="go">2-d face of 3-d cone in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(-1, -1, 1),</span>
<span class="go">N(-1,  1, 1)</span>
<span class="go">in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(2, 3)</span>
<span class="gp">sage: </span><span class="n">four_rays</span><span class="o">.</span><span class="n">rays</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">())</span>
<span class="go">N(-1, -1, 1),</span>
<span class="go">N(-1,  1, 1)</span>
<span class="go">in 3-d lattice N</span>
</pre></div>
</div>
<p>If you need to know inclusion relations between faces, you can use</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">four_rays</span><span class="o">.</span><span class="n">face_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">())</span>
<span class="go">[1, 4, 4, 1]</span>
<span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1,  1, 1),</span>
<span class="go">N(1, -1, 1)</span>
<span class="go">in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">hasse_diagram</span><span class="p">()</span><span class="o">.</span><span class="n">neighbors_in</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
<span class="go">[1-d face of 3-d cone in 3-d lattice N,</span>
<span class="go"> 1-d face of 3-d cone in 3-d lattice N]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The order of faces in level sets of
the face lattice may differ from the order of faces returned by
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.faces" title="sage.geometry.cone.ConvexRationalPolyhedralCone.faces"><tt class="xref py py-meth docutils literal"><span class="pre">faces()</span></tt></a>. While the first order is
random, the latter one ensures that one-dimensional faces are listed in
the same order as generating rays.</p>
</div>
<p>When all the functionality provided by cones is not enough, you may want to
check if you can do necessary things using polyhedra corresponding to cones:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">four_rays</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span>
<span class="go">A 3-dimensional polyhedron in ZZ^3 defined as</span>
<span class="go">the convex hull of 1 vertex and 4 rays</span>
</pre></div>
</div>
<p>And of course you are always welcome to suggest new features that should be
added to cones!</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="fulton" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Fulton]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id3">2</a>, <a class="fn-backref" href="#id4">3</a>, <a class="fn-backref" href="#id7">4</a>, <a class="fn-backref" href="#id8">5</a>)</em> Wiliam Fulton, &#8220;Introduction to Toric Varieties&#8221;, Princeton
University Press</td></tr>
</tbody>
</table>
<dl class="function">
<dt id="sage.geometry.cone.Cone">
<tt class="descclassname">sage.geometry.cone.</tt><tt class="descname">Cone</tt><big>(</big><em>rays</em>, <em>lattice=None</em>, <em>check=True</em>, <em>normalize=True</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.Cone" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a (not necessarily strictly) convex rational polyhedral cone.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">rays</span></tt> &#8211; a list of rays. Each ray should be given as a list
or a vector convertible to the rational extension of the given
<tt class="docutils literal"><span class="pre">lattice</span></tt>. May also be specified by a
<a class="reference internal" href="polyhedron/base.html#sage.geometry.polyhedron.base.Polyhedron_base" title="sage.geometry.polyhedron.base.Polyhedron_base"><tt class="xref py py-class docutils literal"><span class="pre">Polyhedron_base</span></tt></a> object;</li>
<li><tt class="docutils literal"><span class="pre">lattice</span></tt> &#8211; <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><tt class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></tt></a>, <span class="math">\(\ZZ^n\)</span>, or any
other object that behaves like these. If not specified, an attempt will
be made to determine an appropriate toric lattice automatically;</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> &#8211; by default the input data will be checked for
correctness (e.g. that all rays have the same number of
components) and generating rays will be constructed from
<tt class="docutils literal"><span class="pre">rays</span></tt>. If you know that the input is a minimal set of
generators of a valid cone, you may significantly decrease
construction time using <tt class="docutils literal"><span class="pre">check=False</span></tt> option;</li>
<li><tt class="docutils literal"><span class="pre">normalize</span></tt> &#8211; you can further speed up construction using
<tt class="docutils literal"><span class="pre">normalize=False</span></tt> option. In this case <tt class="docutils literal"><span class="pre">rays</span></tt> must be a list of
immutable primitive rays in <tt class="docutils literal"><span class="pre">lattice</span></tt>. In general, you should not use
this option, it is designed for code optimization and does not give as
drastic improvement in speed as the previous one.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>convex rational polyhedral cone determined by <tt class="docutils literal"><span class="pre">rays</span></tt>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Let&#8217;s define a cone corresponding to the first quadrant of the plane
(note, you can even mix objects of different types to represent rays, as
long as you let this function to perform all the checks and necessary
conversions!):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">quadrant</span>
<span class="go">2-d cone in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>If you give more rays than necessary, the extra ones will be discarded:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(0, 1),</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>However, this work is not done with <tt class="docutils literal"><span class="pre">check=False</span></tt> option, so use it
carefully!</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(0, 1),</span>
<span class="go">N(1, 1),</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>Even worse things can happen with <tt class="docutils literal"><span class="pre">normalize=False</span></tt> option:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">AttributeError</span>: <span class="n-Identifier">&#39;tuple&#39; object has no attribute &#39;parent&#39;</span>
</pre></div>
</div>
<p>You can construct different &#8220;not&#8221; cones: not full-dimensional, not
strictly convex, not containing any rays:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">one_dimensional_cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">one_dimensional_cone</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">half_plane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">half_plane</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 0, 1),</span>
<span class="go">N( 1, 0),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">half_plane</span><span class="o">.</span><span class="n">is_strictly_convex</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">origin</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">origin</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">Empty collection</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">origin</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">origin</span><span class="o">.</span><span class="n">lattice_dim</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>You may construct the cone above without giving any rays, but in this case
you must provide <tt class="docutils literal"><span class="pre">lattice</span></tt> explicitly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">origin</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">lattice must be given explicitly if there are no rays!</span>
<span class="gp">sage: </span><span class="n">origin</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">origin</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">origin</span><span class="o">.</span><span class="n">lattice_dim</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">origin</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">2-d lattice N</span>
</pre></div>
</div>
<p>Of course, you can also provide <tt class="docutils literal"><span class="pre">lattice</span></tt> in other cases:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">&quot;L&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c1</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">L(1, 0, 0),</span>
<span class="go">L(1, 1, 1)</span>
<span class="go">in 3-d lattice L</span>
</pre></div>
</div>
<p>Or you can construct cones from rays of a particular lattice:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ray1</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ray2</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([</span><span class="n">ray1</span><span class="p">,</span> <span class="n">ray2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c2</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">L(1, 0, 0),</span>
<span class="go">L(1, 1, 1)</span>
<span class="go">in 3-d lattice L</span>
<span class="gp">sage: </span><span class="n">c1</span> <span class="o">==</span> <span class="n">c2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>When the cone in question is not strictly convex, the standard form for
the &#8220;generating rays&#8221; of the linear subspace is &#8220;basis vectors and their
negatives&#8221;, as in the following example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">plane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">plane</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 0,  1),</span>
<span class="go">N( 0, -1),</span>
<span class="go">N( 1,  0),</span>
<span class="go">N(-1,  0)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>The cone can also be specified by a
<a class="reference internal" href="polyhedron/base.html#sage.geometry.polyhedron.base.Polyhedron_base" title="sage.geometry.polyhedron.base.Polyhedron_base"><tt class="xref py py-class docutils literal"><span class="pre">Polyhedron_base</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">plane</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">2-d cone in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">plane</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Nsub</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">span</span><span class="p">([</span> <span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">(</span><span class="n">Nsub</span><span class="o">.</span><span class="n">basis</span><span class="p">())</span>
<span class="go">1-d cone in Sublattice &lt;N(1, 2)&gt;</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([</span><span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="go">0-d cone in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone">
<em class="property">class </em><tt class="descclassname">sage.geometry.cone.</tt><tt class="descname">ConvexRationalPolyhedralCone</tt><big>(</big><em>rays=None</em>, <em>lattice=None</em>, <em>ambient=None</em>, <em>ambient_ray_indices=None</em>, <em>PPL=None</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.geometry.cone.IntegralRayCollection" title="sage.geometry.cone.IntegralRayCollection"><tt class="xref py py-class docutils literal"><span class="pre">sage.geometry.cone.IntegralRayCollection</span></tt></a>, <tt class="xref py py-class docutils literal"><span class="pre">_abcoll.Container</span></tt></p>
<p>Create a convex rational polyhedral cone.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This class does not perform any checks of correctness of input nor
does it convert input into the standard representation. Use
<a class="reference internal" href="#sage.geometry.cone.Cone" title="sage.geometry.cone.Cone"><tt class="xref py py-func docutils literal"><span class="pre">Cone()</span></tt></a> to construct cones.</p>
</div>
<p>Cones are immutable, but they cache most of the returned values.</p>
<p>INPUT:</p>
<p>The input can be either:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">rays</span></tt> &#8211; list of immutable primitive vectors in <tt class="docutils literal"><span class="pre">lattice</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">lattice</span></tt> &#8211; <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><tt class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></tt></a>, <span class="math">\(\ZZ^n\)</span>, or any
other object that behaves like these. If <tt class="docutils literal"><span class="pre">None</span></tt>, it will be determined
as <a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.parent" title="(in Sage Reference Manual: Basic Structures v6.7)"><tt class="xref py py-func docutils literal"><span class="pre">parent()</span></tt></a> of the first ray. Of course, this cannot be done if
there are no rays, so in this case you must give an appropriate
<tt class="docutils literal"><span class="pre">lattice</span></tt> directly.</li>
</ul>
<p>or (these parameters must be given as keywords):</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ambient</span></tt> &#8211; ambient structure of this cone, a bigger <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cone</span></tt></a> or a <a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><tt class="xref py py-class docutils literal"><span class="pre">fan</span></tt></a>, this cone <em>must be a face
of</em> <tt class="docutils literal"><span class="pre">ambient</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">ambient_ray_indices</span></tt> &#8211; increasing list or tuple of integers, indices
of rays of <tt class="docutils literal"><span class="pre">ambient</span></tt> generating this cone.</li>
</ul>
<p>In both cases, the following keyword parameter may be specified in addition:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">PPL</span></tt> &#8211; either <tt class="docutils literal"><span class="pre">None</span></tt> (default) or a
<a class="reference external" href="../../../libs/sage/libs/ppl.html#sage.libs.ppl.C_Polyhedron" title="(in Sage Reference Manual: C/C++ Library Interfaces v6.7)"><tt class="xref py py-class docutils literal"><span class="pre">C_Polyhedron</span></tt></a> representing the cone. This
serves only to cache the polyhedral data if you know it
already. The polyhedron will be set immutable.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>convex rational polyhedral cone.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Every cone has its ambient structure. If it was not specified, it is
this cone itself.</p>
</div>
<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.Hilbert_basis">
<tt class="descname">Hilbert_basis</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.Hilbert_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hilbert basis of the cone.</p>
<p>Given a strictly convex cone <span class="math">\(C\subset \RR^d\)</span>, the Hilbert
basis of <span class="math">\(C\)</span> is the set of all irreducible elements in the
semigroup <span class="math">\(C\cap \ZZ^d\)</span>. It is the unique minimal generating
set over <span class="math">\(\ZZ\)</span> for the integral points <span class="math">\(C\cap \ZZ^d\)</span>.</p>
<p>If the cone <span class="math">\(C\)</span> is not strictly convex, this method finds the
(unique) minimial set of lattice points that need to be added
to the defining rays of the cone to generate the whole
semigroup <span class="math">\(C\cap \ZZ^d\)</span>. But because the rays of the cone are
not unique nor necessarily minimal in this case, neither is
the returned generating set (consisting of the rays plus
additional generators).</p>
<p>See also <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.semigroup_generators" title="sage.geometry.cone.ConvexRationalPolyhedralCone.semigroup_generators"><tt class="xref py py-meth docutils literal"><span class="pre">semigroup_generators()</span></tt></a> if you are not
interested in a minimal set of generators.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>a
<a class="reference internal" href="point_collection.html#sage.geometry.point_collection.PointCollection" title="sage.geometry.point_collection.PointCollection"><tt class="xref py py-class docutils literal"><span class="pre">PointCollection</span></tt></a>. The
rays of <tt class="docutils literal"><span class="pre">self</span></tt> are the first <tt class="docutils literal"><span class="pre">self.nrays()</span></tt> entries.</li>
</ul>
<p>EXAMPLES:</p>
<p>The following command ensures that the output ordering in the examples
below is independent of TOPCOM, you don&#8217;t have to use it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">PointConfiguration</span><span class="o">.</span><span class="n">set_engine</span><span class="p">(</span><span class="s">&#39;internal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We start with a simple case of a non-smooth 2-dimensional cone:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Cone</span><span class="p">([</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">])</span><span class="o">.</span><span class="n">Hilbert_basis</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(1, 2),</span>
<span class="go">N(1, 1)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>Two more complicated example from GAP/toric:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Cone</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">Hilbert_basis</span><span class="p">()</span>
<span class="go">M(0,  1),</span>
<span class="go">M(4, -3),</span>
<span class="go">M(3, -2),</span>
<span class="go">M(2, -1),</span>
<span class="go">M(1,  0)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">Hilbert_basis</span><span class="p">()</span>           <span class="c"># long time</span>
<span class="go">M(10,  -7,  0,  1),</span>
<span class="go">M(-5,  21,  0, -3),</span>
<span class="go">M( 0,  -2,  0,  1),</span>
<span class="go">M(15, -63, 25,  9),</span>
<span class="go">M( 2,  -3,  0,  1),</span>
<span class="go">M( 1,  -4,  1,  1),</span>
<span class="go">M(-1,   3,  0,  0),</span>
<span class="go">M( 4,  -4,  0,  1),</span>
<span class="go">M( 1,  -5,  2,  1),</span>
<span class="go">M( 3,  -5,  1,  1),</span>
<span class="go">M( 6,  -5,  0,  1),</span>
<span class="go">M( 3, -13,  5,  2),</span>
<span class="go">M( 2,  -6,  2,  1),</span>
<span class="go">M( 5,  -6,  1,  1),</span>
<span class="go">M( 0,   1,  0,  0),</span>
<span class="go">M( 8,  -6,  0,  1),</span>
<span class="go">M(-2,   8,  0, -1),</span>
<span class="go">M(10, -42, 17,  6),</span>
<span class="go">M( 7, -28, 11,  4),</span>
<span class="go">M( 5, -21,  9,  3),</span>
<span class="go">M( 6, -21,  8,  3),</span>
<span class="go">M( 5, -14,  5,  2),</span>
<span class="go">M( 2,  -7,  3,  1),</span>
<span class="go">M( 4,  -7,  2,  1),</span>
<span class="go">M( 7,  -7,  1,  1),</span>
<span class="go">M( 0,   0,  1,  0),</span>
<span class="go">M(-3,  14,  0, -2),</span>
<span class="go">M(-1,   7,  0, -1),</span>
<span class="go">M( 1,   0,  0,  0)</span>
<span class="go">in 4-d lattice M</span>
</pre></div>
</div>
<p>Not a strictly convex cone:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">wedge</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">wedge</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">()</span>
<span class="go">(N(1, 0, 0), N(1, 1, 0), N(1, 2, 0), N(0, 0, 1), N(0, 0, -1))</span>
<span class="gp">sage: </span><span class="n">wedge</span><span class="o">.</span><span class="n">Hilbert_basis</span><span class="p">()</span>
<span class="go">N(1, 2,  0),</span>
<span class="go">N(1, 0,  0),</span>
<span class="go">N(0, 0,  1),</span>
<span class="go">N(0, 0, -1),</span>
<span class="go">N(1, 1,  0)</span>
<span class="go">in 3-d lattice N</span>
</pre></div>
</div>
<p>Not full-dimensional cones are ok, too (see
<a class="reference external" href="http://trac.sagemath.org/sage_trac/ticket/11312">http://trac.sagemath.org/sage_trac/ticket/11312</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span><span class="o">.</span><span class="n">Hilbert_basis</span><span class="p">()</span>
<span class="go">N( 1, 1, 0),</span>
<span class="go">N(-1, 1, 0),</span>
<span class="go">N( 0, 1, 0)</span>
<span class="go">in 3-d lattice N</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>The primal Normaliz algorithm, see <a class="reference internal" href="#normaliz" id="id1">[Normaliz]</a>.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="normaliz" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Normaliz]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> Winfried Bruns, Bogdan Ichim, and Christof Soeger:
Normaliz.
<a class="reference external" href="http://www.mathematik.uni-osnabrueck.de/normaliz/">http://www.mathematik.uni-osnabrueck.de/normaliz/</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.Hilbert_coefficients">
<tt class="descname">Hilbert_coefficients</tt><big>(</big><em>point</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.Hilbert_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the expansion coefficients of <tt class="docutils literal"><span class="pre">point</span></tt> with respect to
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.Hilbert_basis" title="sage.geometry.cone.ConvexRationalPolyhedralCone.Hilbert_basis"><tt class="xref py py-meth docutils literal"><span class="pre">Hilbert_basis()</span></tt></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">point</span></tt> &#8211; a <a class="reference internal" href="#sage.geometry.cone.IntegralRayCollection.lattice" title="sage.geometry.cone.IntegralRayCollection.lattice"><tt class="xref py py-meth docutils literal"><span class="pre">lattice()</span></tt></a> point
in the cone, or something that can be converted to a
point. For example, a list or tuple of integers.</li>
</ul>
<p>OUTPUT:</p>
<p>A <span class="math">\(\ZZ\)</span>-vector of length <tt class="docutils literal"><span class="pre">len(self.Hilbert_basis())</span></tt> with nonnegative
components.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the Hilbert basis elements are not necessarily linearly
independent, the expansion coefficients are not unique. However,
this method will always return the same expansion coefficients when
invoked with the same argument.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">Hilbert_coefficients</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(3, 2)</span>
</pre></div>
</div>
<p>A more complicated example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([</span><span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">Hilbert_basis</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(1, 2),</span>
<span class="go">N(1, 1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">Hilbert_coefficients</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="go">(0, 0, 1)</span>
</pre></div>
</div>
<p>The cone need not be strictly convex:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([</span><span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">Hilbert_basis</span><span class="p">()</span>
<span class="go">N(1, 2,  0),</span>
<span class="go">N(1, 0,  0),</span>
<span class="go">N(0, 0,  1),</span>
<span class="go">N(0, 0, -1),</span>
<span class="go">N(1, 1,  0)</span>
<span class="go">in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">Hilbert_coefficients</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<span class="go">(0, 0, 3, 0, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.adjacent">
<tt class="descname">adjacent</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.adjacent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return faces adjacent to <tt class="docutils literal"><span class="pre">self</span></tt> in the ambient face lattice.</p>
<p>Two <em>distinct</em> faces <span class="math">\(F_1\)</span> and <span class="math">\(F_2\)</span> of the same face lattice are
<strong>adjacent</strong> if all of the following conditions hold:</p>
<ul class="simple">
<li><span class="math">\(F_1\)</span> and <span class="math">\(F_2\)</span> have the same dimension <span class="math">\(d\)</span>;</li>
<li><span class="math">\(F_1\)</span> and <span class="math">\(F_2\)</span> share a facet of dimension <span class="math">\(d-1\)</span>;</li>
<li><span class="math">\(F_1\)</span> and <span class="math">\(F_2\)</span> are facets of some face of dimension <span class="math">\(d+1\)</span>, unless
<span class="math">\(d\)</span> is the dimension of the ambient structure.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt></a> of <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cones</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">octant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">octant</span><span class="o">.</span><span class="n">adjacent</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">one_face</span> <span class="o">=</span> <span class="n">octant</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">one_face</span><span class="o">.</span><span class="n">adjacent</span><span class="p">())</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">one_face</span><span class="o">.</span><span class="n">adjacent</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">1-d face of 3-d cone in 3-d lattice N</span>
</pre></div>
</div>
<p>Things are a little bit subtle with fans, as we illustrate below.</p>
<p>First, we create a fan from two cones in the plane:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">... </span>            <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">cone</span><span class="o">.</span><span class="n">adjacent</span><span class="p">())</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The second generating cone is adjacent to this one. Now we create the
same fan, but embedded into the 3-dimensional space:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">... </span>            <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">cone</span><span class="o">.</span><span class="n">adjacent</span><span class="p">())</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The result is as before, since we still have:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Now we add another cone to make the fan 3-dimensional:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)],</span>
<span class="gp">... </span>            <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">cone</span><span class="o">.</span><span class="n">adjacent</span><span class="p">())</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Since now <tt class="docutils literal"><span class="pre">cone</span></tt> has smaller dimension than <tt class="docutils literal"><span class="pre">fan</span></tt>, it and its
adjacent cones must be facets of a bigger one, but since <tt class="docutils literal"><span class="pre">cone</span></tt>
in this example is generating, it is not contained in any other.</p>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.ambient">
<tt class="descname">ambient</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.ambient" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ambient structure of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>cone or fan containing <tt class="docutils literal"><span class="pre">self</span></tt> as a face.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span>
<span class="go">3-d cone in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span> <span class="ow">is</span> <span class="n">cone</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">cone</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">face</span>
<span class="go">1-d face of 3-d cone in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span>
<span class="go">3-d cone in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span> <span class="ow">is</span> <span class="n">cone</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.ambient_ray_indices">
<tt class="descname">ambient_ray_indices</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.ambient_ray_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return indices of rays of the ambient structure generating <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>increasing <a class="reference external" href="http://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt></a> of integers.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">facets</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(1,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.cartesian_product">
<tt class="descname">cartesian_product</tt><big>(</big><em>other</em>, <em>lattice=None</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.cartesian_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Cartesian product of <tt class="docutils literal"><span class="pre">self</span></tt> with <tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> &#8211; a <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cone</span></tt></a>;</li>
<li><tt class="docutils literal"><span class="pre">lattice</span></tt> &#8211; (optional) the ambient lattice for the
Cartesian product cone. By default, the direct sum of the
ambient lattices of <tt class="docutils literal"><span class="pre">self</span></tt> and <tt class="docutils literal"><span class="pre">other</span></tt> is constructed.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cone</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">2-d cone in 2-d lattice N+N</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N+N(1, 0),</span>
<span class="go">N+N(0, 1)</span>
<span class="go">in 2-d lattice N+N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.contains">
<tt class="descname">contains</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a given point is contained in <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li>anything. An attempt will be made to convert all arguments into a
single element of the ambient space of <tt class="docutils literal"><span class="pre">self</span></tt>. If it fails,
<tt class="docutils literal"><span class="pre">False</span></tt> will be returned.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if the given point is contained in <tt class="docutils literal"><span class="pre">self</span></tt>, <tt class="docutils literal"><span class="pre">False</span></tt>
otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">lattice</span><span class="p">()(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">dual_lattice</span><span class="p">()(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="c">#random output (warning)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">dual_lattice</span><span class="p">()(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.dual">
<tt class="descname">dual</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.dual" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dual cone of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cone</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">M(0, 1),</span>
<span class="go">M(3, 1)</span>
<span class="go">in 2-d lattice M</span>
</pre></div>
</div>
<p>Now let&#8217;s look at a more complicated case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">is_strictly_convex</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">M(7, -18, -2),</span>
<span class="go">M(1,  -4,  0)</span>
<span class="go">in 3-d lattice M</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span> <span class="ow">is</span> <span class="n">cone</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We correctly handle the degenerate cases:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>  <span class="c"># empty cone</span>
<span class="go">M( 1,  0),</span>
<span class="go">M(-1,  0),</span>
<span class="go">M( 0,  1),</span>
<span class="go">M( 0, -1)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>  <span class="c"># ray in 2d</span>
<span class="go">M(1,  0),</span>
<span class="go">M(0,  1),</span>
<span class="go">M(0, -1)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>  <span class="c"># line in 2d</span>
<span class="go">M(0,  1),</span>
<span class="go">M(0, -1)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>  <span class="c"># strictly convex cone</span>
<span class="go">M(0, 1),</span>
<span class="go">M(1, 0)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>  <span class="c"># half space</span>
<span class="go">M(0, 1)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>  <span class="c"># whole space</span>
<span class="go">Empty collection</span>
<span class="go">in 2-d lattice M</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.embed">
<tt class="descname">embed</tt><big>(</big><em>cone</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.embed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cone equivalent to the given one, but sitting in <tt class="docutils literal"><span class="pre">self</span></tt> as
a face.</p>
<p>You may need to use this method before calling methods of <tt class="docutils literal"><span class="pre">cone</span></tt> that
depend on the ambient structure, such as
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.ambient_ray_indices" title="sage.geometry.cone.ConvexRationalPolyhedralCone.ambient_ray_indices"><tt class="xref py py-meth docutils literal"><span class="pre">ambient_ray_indices()</span></tt></a>
or
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of"><tt class="xref py py-meth docutils literal"><span class="pre">facet_of()</span></tt></a>. The
cone returned by this method will have <tt class="docutils literal"><span class="pre">self</span></tt> as ambient. If <tt class="docutils literal"><span class="pre">cone</span></tt>
does not represent a valid cone of <tt class="docutils literal"><span class="pre">self</span></tt>, <tt class="docutils literal"><span class="pre">ValueError</span></tt> exception
is raised.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method is very quick if <tt class="docutils literal"><span class="pre">self</span></tt> is already the ambient
structure of <tt class="docutils literal"><span class="pre">cone</span></tt>, so you can use without extra checks and
performance hit even if <tt class="docutils literal"><span class="pre">cone</span></tt> is likely to sit in <tt class="docutils literal"><span class="pre">self</span></tt> but
in principle may not.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">cone</span></tt> &#8211; a <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cone</span></tt></a>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cone</span></tt></a>,
equivalent to <tt class="docutils literal"><span class="pre">cone</span></tt> but sitting inside <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Let&#8217;s take a 3-d cone on 4 rays:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
<p>Then any ray generates a 1-d face of this cone, but if you construct
such a face directly, it will not &#8220;sit&#8221; inside the cone:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ray</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ray</span>
<span class="go">1-d cone in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">ray</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0,)</span>
<span class="gp">sage: </span><span class="n">ray</span><span class="o">.</span><span class="n">adjacent</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">ray</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span>
<span class="go">1-d cone in 3-d lattice N</span>
</pre></div>
</div>
<p>If we want to operate with this ray as a face of the cone, we need to
embed it first:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">e_ray</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">ray</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e_ray</span>
<span class="go">1-d face of 3-d cone in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(0, -1, 1)</span>
<span class="go">in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">e_ray</span> <span class="ow">is</span> <span class="n">ray</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">ray</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(3,)</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">adjacent</span><span class="p">()</span>
<span class="go">(1-d face of 3-d cone in 3-d lattice N,</span>
<span class="go"> 1-d face of 3-d cone in 3-d lattice N)</span>
<span class="gp">sage: </span><span class="n">e_ray</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span>
<span class="go">3-d cone in 3-d lattice N</span>
</pre></div>
</div>
<p>Not every cone can be embedded into a fixed ambient cone:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">1-d cone in 3-d lattice N is not a face</span>
<span class="go">of 3-d cone in 3-d lattice N!</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">2-d cone in 3-d lattice N is not a face</span>
<span class="go">of 3-d cone in 3-d lattice N!</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.face_lattice">
<tt class="descname">face_lattice</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.face_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the face lattice of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>This lattice will have the origin as the bottom (we do not include the
empty set as a face) and this cone itself as the top.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference external" href="../../../combinat/sage/combinat/posets/posets.html#sage.combinat.posets.posets.FinitePoset" title="(in Sage Reference Manual: Combinatorics v6.7)"><tt class="xref py py-class docutils literal"><span class="pre">finite</span> <span class="pre">poset</span></tt></a> of
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cones</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Let&#8217;s take a look at the face lattice of the first quadrant:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">face_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Finite poset containing 4 elements with distinguished linear extension</span>
</pre></div>
</div>
<p>To see all faces arranged by dimension, you can do this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">():</span> <span class="k">print</span> <span class="n">level</span>
<span class="go">[0-d face of 2-d cone in 2-d lattice N]</span>
<span class="go">[1-d face of 2-d cone in 2-d lattice N,</span>
<span class="go"> 1-d face of 2-d cone in 2-d lattice N]</span>
<span class="go">[2-d cone in 2-d lattice N]</span>
</pre></div>
</div>
<p>For a particular face you can look at its actual rays...</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>... or you can see the index of the ray of the original cone that
corresponds to the above one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0,)</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">N(1, 0)</span>
</pre></div>
</div>
<p>An alternative to extracting faces from the face lattice is to use
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.faces" title="sage.geometry.cone.ConvexRationalPolyhedralCone.faces"><tt class="xref py py-meth docutils literal"><span class="pre">faces()</span></tt></a> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">face</span> <span class="ow">is</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The advantage of working with the face lattice directly is that you
can (relatively easily) get faces that are related to the given one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">hasse_diagram</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
<span class="go">[2-d cone in 2-d lattice N,</span>
<span class="go"> 0-d face of 2-d cone in 2-d lattice N]</span>
</pre></div>
</div>
<p>However, you can achieve some of this functionality using
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.facets" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facets"><tt class="xref py py-meth docutils literal"><span class="pre">facets()</span></tt></a>, <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of"><tt class="xref py py-meth docutils literal"><span class="pre">facet_of()</span></tt></a>, and <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.adjacent" title="sage.geometry.cone.ConvexRationalPolyhedralCone.adjacent"><tt class="xref py py-meth docutils literal"><span class="pre">adjacent()</span></tt></a> methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">face</span>
<span class="go">1-d face of 2-d cone in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">facets</span><span class="p">()</span>
<span class="go">(0-d face of 2-d cone in 2-d lattice N,)</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">facet_of</span><span class="p">()</span>
<span class="go">(2-d cone in 2-d lattice N,)</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">adjacent</span><span class="p">()</span>
<span class="go">(1-d face of 2-d cone in 2-d lattice N,)</span>
<span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">adjacent</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>Note that if <tt class="docutils literal"><span class="pre">cone</span></tt> is a face of <tt class="docutils literal"><span class="pre">supercone</span></tt>, then the face
lattice of <tt class="docutils literal"><span class="pre">cone</span></tt> consists of (appropriate) faces of <tt class="docutils literal"><span class="pre">supercone</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">supercone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
<span class="gp">... </span>                    <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">supercone</span><span class="o">.</span><span class="n">face_lattice</span><span class="p">()</span>
<span class="go">Finite poset containing 16 elements with distinguished linear extension</span>
<span class="gp">sage: </span><span class="n">supercone</span><span class="o">.</span><span class="n">face_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">top</span><span class="p">()</span>
<span class="go">4-d cone in 4-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">supercone</span><span class="o">.</span><span class="n">facets</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">cone</span>
<span class="go">3-d face of 4-d cone in 4-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">face_lattice</span><span class="p">()</span>
<span class="go">Finite poset containing 8 elements with distinguished linear extension</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">face_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span>
<span class="go">0-d face of 4-d cone in 4-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">face_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">top</span><span class="p">()</span>
<span class="go">3-d face of 4-d cone in 4-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">face_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">==</span> <span class="n">cone</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">C2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">C1</span> <span class="o">==</span> <span class="n">C2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">C1</span> <span class="ow">is</span> <span class="n">C2</span>
<span class="go">False</span>
</pre></div>
</div>
<p>C1 and C2 are equal, but not identical. We currently want them
to have non identical face lattices, even if the faces
themselves are equal (see #10998):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C1</span><span class="o">.</span><span class="n">face_lattice</span><span class="p">()</span> <span class="ow">is</span> <span class="n">C2</span><span class="o">.</span><span class="n">face_lattice</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">C1</span><span class="o">.</span><span class="n">facets</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0-d face of 1-d cone in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">C2</span><span class="o">.</span><span class="n">facets</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0-d face of 1-d cone in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">C1</span><span class="o">.</span><span class="n">facets</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span> <span class="ow">is</span> <span class="n">C1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">C2</span><span class="o">.</span><span class="n">facets</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span> <span class="ow">is</span> <span class="n">C1</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">C2</span><span class="o">.</span><span class="n">facets</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ambient</span><span class="p">()</span> <span class="ow">is</span> <span class="n">C2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.faces">
<tt class="descname">faces</tt><big>(</big><em>dim=None</em>, <em>codim=None</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.faces" title="Permalink to this definition">¶</a></dt>
<dd><p>Return faces of <tt class="docutils literal"><span class="pre">self</span></tt> of specified (co)dimension.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dim</span></tt> &#8211; integer, dimension of the requested faces;</li>
<li><tt class="docutils literal"><span class="pre">codim</span></tt> &#8211; integer, codimension of the requested faces.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can specify at most one parameter. If you don&#8217;t give any, then
all faces will be returned.</p>
</div>
<p>OUTPUT:</p>
<ul class="simple">
<li>if either <tt class="docutils literal"><span class="pre">dim</span></tt> or <tt class="docutils literal"><span class="pre">codim</span></tt> is given, the output will be a
<a class="reference external" href="http://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt></a> of <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cones</span></tt></a>;</li>
<li>if neither <tt class="docutils literal"><span class="pre">dim</span></tt> nor <tt class="docutils literal"><span class="pre">codim</span></tt> is given, the output will be the
<a class="reference external" href="http://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt></a> of tuples as above, giving faces of all existing
dimensions. If you care about inclusion relations between faces,
consider using <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.face_lattice" title="sage.geometry.cone.ConvexRationalPolyhedralCone.face_lattice"><tt class="xref py py-meth docutils literal"><span class="pre">face_lattice()</span></tt></a> or <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.adjacent" title="sage.geometry.cone.ConvexRationalPolyhedralCone.adjacent"><tt class="xref py py-meth docutils literal"><span class="pre">adjacent()</span></tt></a>,
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of"><tt class="xref py py-meth docutils literal"><span class="pre">facet_of()</span></tt></a>, and <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.facets" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facets"><tt class="xref py py-meth docutils literal"><span class="pre">facets()</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Let&#8217;s take a look at the faces of the first quadrant:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">faces</span><span class="p">()</span>
<span class="go">((0-d face of 2-d cone in 2-d lattice N,),</span>
<span class="go"> (1-d face of 2-d cone in 2-d lattice N,</span>
<span class="go">  1-d face of 2-d cone in 2-d lattice N),</span>
<span class="go"> (2-d cone in 2-d lattice N,))</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(1-d face of 2-d cone in 2-d lattice N,</span>
<span class="go"> 1-d face of 2-d cone in 2-d lattice N)</span>
<span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Now you can look at the actual rays of this face...</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>... or you can see indices of the rays of the orginal cone that
correspond to the above ray:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">face</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0,)</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">N(1, 0)</span>
</pre></div>
</div>
<p>Note that it is OK to ask for faces of too small or high dimension:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">()</span>
</pre></div>
</div>
<p>In the case of non-strictly convex cones even faces of small
non-negative dimension may be missing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">halfplane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">halfplane</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">halfplane</span><span class="o">.</span><span class="n">faces</span><span class="p">()</span>
<span class="go">((1-d face of 2-d cone in 2-d lattice N,),</span>
<span class="go"> (2-d cone in 2-d lattice N,))</span>
<span class="gp">sage: </span><span class="n">plane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">plane</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">plane</span><span class="o">.</span><span class="n">faces</span><span class="p">()</span>
<span class="go">((2-d cone in 2-d lattice N,),)</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Now we check that &#8220;general&#8221; cones whose dimension is smaller than the
dimension of the ambient space work as expected (see <a class="reference external" href="http://trac.sagemath.org/9188">trac ticket #9188</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">faces</span><span class="p">()</span>
<span class="go">((0-d face of 3-d cone in 4-d lattice N,),</span>
<span class="go"> (1-d face of 3-d cone in 4-d lattice N,</span>
<span class="go">  1-d face of 3-d cone in 4-d lattice N,</span>
<span class="go">  1-d face of 3-d cone in 4-d lattice N),</span>
<span class="go"> (2-d face of 3-d cone in 4-d lattice N,</span>
<span class="go">  2-d face of 3-d cone in 4-d lattice N,</span>
<span class="go">  2-d face of 3-d cone in 4-d lattice N),</span>
<span class="go"> (3-d cone in 4-d lattice N,))</span>
</pre></div>
</div>
<p>We also ensure that a call to this function does not break
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.facets" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facets"><tt class="xref py py-meth docutils literal"><span class="pre">facets()</span></tt></a> method (see <a class="reference external" href="http://trac.sagemath.org/9780">trac ticket #9780</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cone</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cone</span><span class="o">.</span><span class="n">facets</span><span class="p">():</span> <span class="k">print</span> <span class="n">f</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 1)</span>
<span class="go">in 2-d lattice N</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">cone</span><span class="o">.</span><span class="n">faces</span><span class="p">())</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cone</span><span class="o">.</span><span class="n">facets</span><span class="p">():</span> <span class="k">print</span> <span class="n">f</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 1)</span>
<span class="go">in 2-d lattice N</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.facet_normals">
<tt class="descname">facet_normals</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.facet_normals" title="Permalink to this definition">¶</a></dt>
<dd><p>Return inward normals to facets of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>For a not full-dimensional cone facet normals will specify
hyperplanes whose intersections with the space spanned by
<tt class="docutils literal"><span class="pre">self</span></tt> give facets of <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
<li>For a not strictly convex cone facet normals will be orthogonal
to the linear subspace of <tt class="docutils literal"><span class="pre">self</span></tt>, i.e. they always will be
elements of the dual cone of <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
<li>The order of normals is random, but consistent with
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.facets" title="sage.geometry.cone.ConvexRationalPolyhedralCone.facets"><tt class="xref py py-meth docutils literal"><span class="pre">facets()</span></tt></a>.</li>
</ol>
</div>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="point_collection.html#sage.geometry.point_collection.PointCollection" title="sage.geometry.point_collection.PointCollection"><tt class="xref py py-class docutils literal"><span class="pre">PointCollection</span></tt></a>.</li>
</ul>
<p>If the ambient <a class="reference internal" href="#sage.geometry.cone.IntegralRayCollection.lattice" title="sage.geometry.cone.IntegralRayCollection.lattice"><tt class="xref py py-meth docutils literal"><span class="pre">lattice()</span></tt></a> of <tt class="docutils literal"><span class="pre">self</span></tt> is a
<a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">lattice</span></tt></a>, the facet nomals
will be elements of the dual lattice. If it is a general lattice (like
<tt class="docutils literal"><span class="pre">ZZ^n</span></tt>) that does not have a <tt class="docutils literal"><span class="pre">dual()</span></tt> method, the facet normals
will be returned as integral vectors.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">facet_normals</span><span class="p">()</span>
<span class="go">M(0, 1),</span>
<span class="go">M(3, 1)</span>
<span class="go">in 2-d lattice M</span>
</pre></div>
</div>
<p>Now let&#8217;s look at a more complicated case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">is_strictly_convex</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">linear_subspace</span><span class="p">()</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">lsg</span> <span class="o">=</span> <span class="p">(</span><span class="n">QQ</span><span class="o">^</span><span class="mi">3</span><span class="p">)(</span><span class="n">cone</span><span class="o">.</span><span class="n">linear_subspace</span><span class="p">()</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span> <span class="n">lsg</span>
<span class="go">(1, 1/4, 5/4)</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">facet_normals</span><span class="p">()</span>
<span class="go">M(7, -18, -2),</span>
<span class="go">M(1,  -4,  0)</span>
<span class="go">in 3-d lattice M</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">lsg</span><span class="o">*</span><span class="n">normal</span> <span class="k">for</span> <span class="n">normal</span> <span class="ow">in</span> <span class="n">cone</span><span class="o">.</span><span class="n">facet_normals</span><span class="p">()]</span>
<span class="go">[0, 0]</span>
</pre></div>
</div>
<p>A lattice that does not have a <tt class="docutils literal"><span class="pre">dual()</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ZZ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">facet_normals</span><span class="p">()</span>
<span class="go">(-1, 1),</span>
<span class="go">( 1, 0)</span>
<span class="go">in Ambient free module of rank 2</span>
<span class="go">over the principal ideal domain Integer Ring</span>
</pre></div>
</div>
<p>We correctly handle the degenerate cases:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">facet_normals</span><span class="p">()</span>  <span class="c"># empty cone</span>
<span class="go">Empty collection</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">facet_normals</span><span class="p">()</span>  <span class="c"># ray in 2d</span>
<span class="go">M(1, 0)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">facet_normals</span><span class="p">()</span>  <span class="c"># line in 2d</span>
<span class="go">Empty collection</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">facet_normals</span><span class="p">()</span>  <span class="c"># strictly convex cone</span>
<span class="go">M(0, 1),</span>
<span class="go">M(1, 0)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">facet_normals</span><span class="p">()</span>  <span class="c"># half space</span>
<span class="go">M(0, 1)</span>
<span class="go">in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">facet_normals</span><span class="p">()</span>  <span class="c"># whole space</span>
<span class="go">Empty collection</span>
<span class="go">in 2-d lattice M</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of">
<tt class="descname">facet_of</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.facet_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <em>cones</em> of the ambient face lattice having <tt class="docutils literal"><span class="pre">self</span></tt> as a facet.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt></a> of <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cones</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">octant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">octant</span><span class="o">.</span><span class="n">facet_of</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">one_face</span> <span class="o">=</span> <span class="n">octant</span><span class="o">.</span><span class="n">faces</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">one_face</span><span class="o">.</span><span class="n">facet_of</span><span class="p">())</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">one_face</span><span class="o">.</span><span class="n">facet_of</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">2-d face of 3-d cone in 3-d lattice N</span>
</pre></div>
</div>
<p>While fan is the top element of its own cone lattice, which is a
variant of a face lattice, we do not refer to cones as its facets:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">octant</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">fan</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">facet_of</span><span class="p">()</span>
<span class="go">()</span>
</pre></div>
</div>
<p>Subcones of generating cones work as before:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">one_cone</span> <span class="o">=</span> <span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">one_cone</span><span class="o">.</span><span class="n">facet_of</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.facets">
<tt class="descname">facets</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.facets" title="Permalink to this definition">¶</a></dt>
<dd><p>Return facets (faces of codimension 1) of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt></a> of <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cones</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">facets</span><span class="p">()</span>
<span class="go">(1-d face of 2-d cone in 2-d lattice N,</span>
<span class="go"> 1-d face of 2-d cone in 2-d lattice N)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.interior_contains">
<tt class="descname">interior_contains</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.interior_contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a given point is contained in the interior of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>For a cone of strictly lower-dimension than the ambient space,
the interior is always empty. You probably want to use
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.relative_interior_contains" title="sage.geometry.cone.ConvexRationalPolyhedralCone.relative_interior_contains"><tt class="xref py py-meth docutils literal"><span class="pre">relative_interior_contains()</span></tt></a> in this case.</p>
<p>INPUT:</p>
<ul class="simple">
<li>anything. An attempt will be made to convert all arguments into a
single element of the ambient space of <tt class="docutils literal"><span class="pre">self</span></tt>. If it fails,
<tt class="docutils literal"><span class="pre">False</span></tt> will be returned.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if the given point is contained in the interior of
<tt class="docutils literal"><span class="pre">self</span></tt>, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">interior_contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">interior_contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.intersection">
<tt class="descname">intersection</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the intersection of two cones.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cone</span></tt></a>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">cone</span></tt></a>.</li>
</ul>
<p>Raises <tt class="docutils literal"><span class="pre">ValueError</span></tt> if the ambient space dimensions are not
compatible.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">cone2</span><span class="p">)</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(-1, 3),</span>
<span class="go">N( 2, 5)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>It is OK to intersect cones living in sublattices of the same ambient
lattice:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">cone1</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ns</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">submodule</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone3</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">Ns</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">cone1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">cone3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 1)</span>
<span class="go">in Sublattice &lt;N(1, 1)&gt;</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(1, 1)&gt;</span>
</pre></div>
</div>
<p>But you cannot intersect cones from incompatible lattices without
explicit conversion:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">cone1</span><span class="o">.</span><span class="n">dual</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">2-d lattice N and 2-d lattice M</span>
<span class="go">have different ambient lattices!</span>
<span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">Cone</span><span class="p">(</span><span class="n">cone1</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">(),</span> <span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(3, 1),</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.is_equivalent">
<tt class="descname">is_equivalent</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_equivalent" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> is &#8220;mathematically&#8221; the same as <tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - cone.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> and <tt class="docutils literal"><span class="pre">other</span></tt> define the same cones as sets of
points in the same lattice, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>There are three different equivalences between cones <span class="math">\(C_1\)</span> and <span class="math">\(C_2\)</span>
in the same lattice:</p>
<ol class="arabic simple">
<li>They have the same generating rays in the same order.
This is tested by <tt class="docutils literal"><span class="pre">C1</span> <span class="pre">==</span> <span class="pre">C2</span></tt>.</li>
<li>They describe the same sets of points.
This is tested by <tt class="docutils literal"><span class="pre">C1.is_equivalent(C2)</span></tt>.</li>
<li>They are in the same orbit of <span class="math">\(GL(n,\ZZ)\)</span> (and, therefore,
correspond to isomorphic affine toric varieties).
This is tested by <tt class="docutils literal"><span class="pre">C1.is_isomorphic(C2)</span></tt>.</li>
</ol>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1, 0),</span>
<span class="go">N(-1, 3)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone2</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(-1, 3),</span>
<span class="go">N( 1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">==</span> <span class="n">cone2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">cone2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.is_face_of">
<tt class="descname">is_face_of</tt><big>(</big><em>cone</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_face_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> forms a face of another <tt class="docutils literal"><span class="pre">cone</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">cone</span></tt> &#8211; cone.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> is a face of <tt class="docutils literal"><span class="pre">cone</span></tt>, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">is_face_of</span><span class="p">(</span><span class="n">quadrant</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">is_face_of</span><span class="p">(</span><span class="n">quadrant</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone2</span><span class="o">.</span><span class="n">is_face_of</span><span class="p">(</span><span class="n">quadrant</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Being a face means more than just saturating a facet
inequality:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">octant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">is_face_of</span><span class="p">(</span><span class="n">octant</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.is_isomorphic">
<tt class="descname">is_isomorphic</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_isomorphic" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> is in the same <span class="math">\(GL(n, \ZZ)\)</span>-orbit as <tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> - cone.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> and <tt class="docutils literal"><span class="pre">other</span></tt> are in the same
<span class="math">\(GL(n, \ZZ)\)</span>-orbit, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>There are three different equivalences between cones <span class="math">\(C_1\)</span> and <span class="math">\(C_2\)</span>
in the same lattice:</p>
<ol class="arabic simple">
<li>They have the same generating rays in the same order.
This is tested by <tt class="docutils literal"><span class="pre">C1</span> <span class="pre">==</span> <span class="pre">C2</span></tt>.</li>
<li>They describe the same sets of points.
This is tested by <tt class="docutils literal"><span class="pre">C1.is_equivalent(C2)</span></tt>.</li>
<li>They are in the same orbit of <span class="math">\(GL(n,\ZZ)\)</span> (and, therefore,
correspond to isomorphic affine toric varieties).
This is tested by <tt class="docutils literal"><span class="pre">C1.is_isomorphic(C2)</span></tt>.</li>
</ol>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span> <span class="c"># a GL(2,ZZ)-matrix</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([</span><span class="n">m</span><span class="o">*</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">cone1</span><span class="o">.</span><span class="n">rays</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">cone2</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">cone2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.cone</span> <span class="kn">import</span> <span class="n">classify_cone_2d</span>
<span class="gp">sage: </span><span class="n">classify_cone_2d</span><span class="p">(</span><span class="o">*</span><span class="n">cone1</span><span class="o">.</span><span class="n">rays</span><span class="p">())</span>
<span class="go">(1, 0)</span>
<span class="gp">sage: </span><span class="n">classify_cone_2d</span><span class="p">(</span><span class="o">*</span><span class="n">cone2</span><span class="o">.</span><span class="n">rays</span><span class="p">())</span>
<span class="go">(3, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.is_proper">
<tt class="descname">is_proper</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_proper" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether or not this cone is proper.</p>
<p>A cone is said to be proper if it is closed, convex, solid,
and contains no lines. This cone is assumed to be closed and
convex; therefore it is proper if it is solid and contains no
lines.</p>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">True</span></tt> if this cone is proper, and <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_strictly_convex" title="sage.geometry.cone.ConvexRationalPolyhedralCone.is_strictly_convex"><tt class="xref py py-meth docutils literal"><span class="pre">is_strictly_convex()</span></tt></a>, <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_solid" title="sage.geometry.cone.ConvexRationalPolyhedralCone.is_solid"><tt class="xref py py-meth docutils literal"><span class="pre">is_solid()</span></tt></a></p>
</div>
<p>EXAMPLES:</p>
<p>The nonnegative orthant is always proper:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">is_proper</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">octant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">octant</span><span class="o">.</span><span class="n">is_proper</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>However, if we embed the two-dimensional nonnegative quadrant
into three-dimensional space, then the resulting cone no longer
has interior, so it is not solid, and thus not proper:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">is_proper</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Likewise, a half-space contains at least one line, so it is not
proper:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">halfspace</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">halfspace</span><span class="o">.</span><span class="n">is_proper</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.is_simplicial">
<tt class="descname">is_simplicial</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_simplicial" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> is simplicial.</p>
<p>A cone is called <strong>simplicial</strong> if primitive vectors along its
generating rays form a part of a <em>rational</em> basis of the ambient
space.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> is simplicial, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone2</span><span class="o">.</span><span class="n">is_simplicial</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.is_smooth">
<tt class="descname">is_smooth</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> is smooth.</p>
<p>A cone is called <strong>smooth</strong> if primitive vectors along its
generating rays form a part of an <em>integral</em> basis of the
ambient space. Equivalently, they generate the whole lattice
on the linear subspace spanned by the rays.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> is smooth, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone2</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The following cones are the same up to a <span class="math">\(SL(2,\ZZ)\)</span>
coordinate transformation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.is_solid">
<tt class="descname">is_solid</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_solid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether or not this cone is solid.</p>
<p>A cone is said to be solid if it has nonempty interior. That
is, if its extreme rays span the entire ambient space.</p>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">True</span></tt> if this cone is solid, and <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_proper" title="sage.geometry.cone.ConvexRationalPolyhedralCone.is_proper"><tt class="xref py py-meth docutils literal"><span class="pre">is_proper()</span></tt></a></p>
</div>
<p>EXAMPLES:</p>
<p>The nonnegative orthant is always solid:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">is_solid</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">octant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">octant</span><span class="o">.</span><span class="n">is_solid</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>However, if we embed the two-dimensional nonnegative quadrant
into three-dimensional space, then the resulting cone no longer
has interior, so it is not solid:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">is_solid</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.is_strictly_convex">
<tt class="descname">is_strictly_convex</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_strictly_convex" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> is strictly convex.</p>
<p>A cone is called <strong>strictly convex</strong> if it does not contain any lines.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> is strictly convex, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone1</span><span class="o">.</span><span class="n">is_strictly_convex</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cone2</span><span class="o">.</span><span class="n">is_strictly_convex</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.is_trivial">
<tt class="descname">is_trivial</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.is_trivial" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the cone has no rays.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if the cone has no rays, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c0</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c0</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c0</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.lattice_polytope">
<tt class="descname">lattice_polytope</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.lattice_polytope" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lattice polytope associated to <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>The vertices of this polytope are primitive vectors along the
generating rays of <tt class="docutils literal"><span class="pre">self</span></tt> and the origin, if <tt class="docutils literal"><span class="pre">self</span></tt> is strictly
convex. In this case the origin is the last vertex, so the <span class="math">\(i\)</span>-th ray
of the cone always corresponds to the <span class="math">\(i\)</span>-th vertex of the polytope.</p>
<p>See also <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.polyhedron" title="sage.geometry.cone.ConvexRationalPolyhedralCone.polyhedron"><tt class="xref py py-meth docutils literal"><span class="pre">polyhedron()</span></tt></a>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="lattice_polytope.html#sage.geometry.lattice_polytope.LatticePolytopeClass" title="sage.geometry.lattice_polytope.LatticePolytopeClass"><tt class="xref py py-class docutils literal"><span class="pre">LatticePolytope</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">lp</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">lattice_polytope</span><span class="p">()</span>
<span class="go">doctest:...: DeprecationWarning: lattice_polytope(...) is deprecated!</span>
<span class="go">See http://trac.sagemath.org/16180 for details.            </span>
<span class="gp">sage: </span><span class="n">lp</span>
<span class="go">2-d lattice polytope in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">lp</span><span class="o">.</span><span class="n">vertices_pc</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(0, 1),</span>
<span class="go">N(0, 0)</span>
<span class="go">in 2-d lattice N</span>

<span class="gp">sage: </span><span class="n">line</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">lp</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lattice_polytope</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lp</span>
<span class="go">1-d lattice polytope in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">lp</span><span class="o">.</span><span class="n">vertices_pc</span><span class="p">()</span>
<span class="go">N( 1, 0),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.line_set">
<tt class="descname">line_set</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.line_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a set of lines generating the linear subspace of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="xref py py-class docutils literal"><span class="pre">frozenset</span></tt> of primitive vectors in the lattice of <tt class="docutils literal"><span class="pre">self</span></tt>
giving directions of lines that span the linear subspace of
<tt class="docutils literal"><span class="pre">self</span></tt>. These lines are arbitrary, but fixed. See also
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.lines" title="sage.geometry.cone.ConvexRationalPolyhedralCone.lines"><tt class="xref py py-meth docutils literal"><span class="pre">lines()</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">halfplane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">halfplane</span><span class="o">.</span><span class="n">line_set</span><span class="p">()</span>
<span class="go">doctest:...: DeprecationWarning: line_set(...) is deprecated, please use lines().set() instead!</span>
<span class="go">See http://trac.sagemath.org/12544 for details.</span>
<span class="go">frozenset({N(1, 0)})</span>
<span class="gp">sage: </span><span class="n">fullplane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fullplane</span><span class="o">.</span><span class="n">line_set</span><span class="p">()</span>
<span class="go">frozenset({N(0, 1), N(1, 0)})</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.linear_subspace">
<tt class="descname">linear_subspace</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.linear_subspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the largest linear subspace contained inside of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>subspace of the ambient space of <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">halfplane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">halfplane</span><span class="o">.</span><span class="n">linear_subspace</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.lines">
<tt class="descname">lines</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Return lines generating the linear subspace of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt></a> of primitive vectors in the lattice of <tt class="docutils literal"><span class="pre">self</span></tt>
giving directions of lines that span the linear subspace of
<tt class="docutils literal"><span class="pre">self</span></tt>. These lines are arbitrary, but fixed. If you do not care
about the order, see also <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.line_set" title="sage.geometry.cone.ConvexRationalPolyhedralCone.line_set"><tt class="xref py py-meth docutils literal"><span class="pre">line_set()</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">halfplane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">halfplane</span><span class="o">.</span><span class="n">lines</span><span class="p">()</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fullplane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fullplane</span><span class="o">.</span><span class="n">lines</span><span class="p">()</span>
<span class="go">N(0, 1),</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.orthogonal_sublattice">
<tt class="descname">orthogonal_sublattice</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.orthogonal_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>The sublattice (in the dual lattice) orthogonal to the
sublattice spanned by the cone.</p>
<p>Let <span class="math">\(M=\)</span> <tt class="docutils literal"><span class="pre">self.dual_lattice()</span></tt> be the lattice dual to the
ambient lattice of the given cone <span class="math">\(\sigma\)</span>. Then, in the
notation of <a class="reference internal" href="#fulton" id="id2">[Fulton]</a>, this method returns the sublattice</p>
<div class="math">
\[M(\sigma) \stackrel{\text{def}}{=}
\sigma^\perp \cap M
\subset M\]</div>
<p>INPUT:</p>
<ul class="simple">
<li>either nothing or something that can be turned into an element of
this lattice.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>if no arguments were given, a <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLattice_sublattice_with_basis" title="sage.geometry.toric_lattice.ToricLattice_sublattice_with_basis"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">sublattice</span></tt></a>,
otherwise the corresponding element of it.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">orthogonal_sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;&gt;</span>
<span class="gp">sage: </span><span class="n">c12</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c12</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(1, -1, 1), N(0, 1, 0)&gt;</span>
<span class="gp">sage: </span><span class="n">c12</span><span class="o">.</span><span class="n">orthogonal_sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;M(1, 0, -1)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.plot">
<tt class="descname">plot</tt><big>(</big><em>**options</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li>any options for toric plots (see <a class="reference internal" href="toric_plotter.html#sage.geometry.toric_plotter.options" title="sage.geometry.toric_plotter.options"><tt class="xref py py-func docutils literal"><span class="pre">toric_plotter.options</span></tt></a>), none are mandatory.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a plot.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 9 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.polyhedron">
<tt class="descname">polyhedron</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.polyhedron" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the polyhedron associated to <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>Mathematically this polyhedron is the same as <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="polyhedron/base.html#sage.geometry.polyhedron.base.Polyhedron_base" title="sage.geometry.polyhedron.base.Polyhedron_base"><tt class="xref py py-class docutils literal"><span class="pre">Polyhedron_base</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span>
<span class="go">A 2-dimensional polyhedron in ZZ^2 defined as the convex hull</span>
<span class="go">of 1 vertex and 2 rays</span>
<span class="gp">sage: </span><span class="n">line</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">line</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span>
<span class="go">A 1-dimensional polyhedron in ZZ^2 defined as the convex hull</span>
<span class="go">of 1 vertex and 1 line</span>
</pre></div>
</div>
<p>Here is an example of a trivial cone (see <a class="reference external" href="http://trac.sagemath.org/10237">trac ticket #10237</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">origin</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ZZ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">origin</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span>
<span class="go">A 0-dimensional polyhedron in ZZ^2 defined as the convex hull</span>
<span class="go">of 1 vertex</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.relative_interior_contains">
<tt class="descname">relative_interior_contains</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.relative_interior_contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a given point is contained in the relative interior of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>For a full-dimensional cone the relative interior is simply
the interior, so this method will do the same check as
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.interior_contains" title="sage.geometry.cone.ConvexRationalPolyhedralCone.interior_contains"><tt class="xref py py-meth docutils literal"><span class="pre">interior_contains()</span></tt></a>. For a strictly lower-dimensional cone, the
relative interior is the cone without its facets.</p>
<p>INPUT:</p>
<ul class="simple">
<li>anything. An attempt will be made to convert all arguments into a
single element of the ambient space of <tt class="docutils literal"><span class="pre">self</span></tt>. If it fails,
<tt class="docutils literal"><span class="pre">False</span></tt> will be returned.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if the given point is contained in the relative
interior of <tt class="docutils literal"><span class="pre">self</span></tt>, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">relative_interior_contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">interior_contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">relative_interior_contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">interior_contains</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.relative_orthogonal_quotient">
<tt class="descname">relative_orthogonal_quotient</tt><big>(</big><em>supercone</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.relative_orthogonal_quotient" title="Permalink to this definition">¶</a></dt>
<dd><p>The quotient of the dual spanned lattice by the dual of the
supercone&#8217;s spanned lattice.</p>
<p>In the notation of <a class="reference internal" href="#fulton" id="id3">[Fulton]</a>, if <tt class="docutils literal"><span class="pre">supercone</span></tt> = <span class="math">\(\rho &gt;
\sigma\)</span> = <tt class="docutils literal"><span class="pre">self</span></tt> is a cone that contains <span class="math">\(\sigma\)</span> as a face,
then <span class="math">\(M(\rho)\)</span> = <tt class="docutils literal"><span class="pre">supercone.orthogonal_sublattice()</span></tt> is a
saturated sublattice of <span class="math">\(M(\sigma)\)</span> =
<tt class="docutils literal"><span class="pre">self.orthogonal_sublattice()</span></tt>. This method returns the
quotient lattice. The lifts of the quotient generators are
<span class="math">\(\dim(\rho)-\dim(\sigma)\)</span> linearly independent M-lattice
lattice points that, together with <span class="math">\(M(\rho)\)</span>, generate
<span class="math">\(M(\sigma)\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLattice_quotient" title="sage.geometry.toric_lattice.ToricLattice_quotient"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">lattice</span> <span class="pre">quotient</span></tt></a>.</li>
</ul>
<p>If we call the output <tt class="docutils literal"><span class="pre">Mrho</span></tt>, then</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">Mrho.cover()</span> <span class="pre">==</span> <span class="pre">self.orthogonal_sublattice()</span></tt>, and</li>
<li><tt class="docutils literal"><span class="pre">Mrho.relations()</span> <span class="pre">==</span> <span class="pre">supercone.orthogonal_sublattice()</span></tt>.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><span class="math">\(M(\sigma) / M(\rho)\)</span> has no torsion since the sublattice
<span class="math">\(M(\rho)\)</span> is saturated.</li>
<li>In the codimension one case, (a lift of) the generator of
<span class="math">\(M(\sigma) / M(\rho)\)</span> is chosen to be positive on <span class="math">\(\sigma\)</span>.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">orthogonal_sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;M(0, 0, 3, -1)&gt;</span>
<span class="gp">sage: </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">facets</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">.</span><span class="n">orthogonal_sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;M(0, 1, 1, 0), M(0, 0, 3, -1)&gt;</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">.</span><span class="n">is_face_of</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">.</span><span class="n">relative_orthogonal_quotient</span><span class="p">(</span><span class="n">rho</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">1-d lattice, quotient</span>
<span class="go">of Sublattice &lt;M(0, 1, 1, 0), M(0, 0, 3, -1)&gt;</span>
<span class="go">by Sublattice &lt;M(0, 0, 3, -1)&gt;</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(M[0, 1, 1, 0],)</span>
</pre></div>
</div>
<p>Different codimension:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">facets</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">.</span><span class="n">orthogonal_sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;M(1, 0, 2, -1), M(0, 1, 1, 0), M(0, 0, 3, -1)&gt;</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">orthogonal_sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;M(0, 1, 1, 0), M(0, 0, 3, -1)&gt;</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">.</span><span class="n">relative_orthogonal_quotient</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(M[-1, 0, -2, 1],)</span>
</pre></div>
</div>
<p>Sign choice in the codimension one case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sigma1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>  <span class="c"># 3d</span>
<span class="gp">sage: </span><span class="n">sigma2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>  <span class="c"># 3d</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">sigma1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">sigma2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">relative_orthogonal_quotient</span><span class="p">(</span><span class="n">sigma1</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(M[-5, -2, 3],)</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">relative_orthogonal_quotient</span><span class="p">(</span><span class="n">sigma2</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(M[5, 2, -3],)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.relative_quotient">
<tt class="descname">relative_quotient</tt><big>(</big><em>subcone</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.relative_quotient" title="Permalink to this definition">¶</a></dt>
<dd><p>The quotient of the spanned lattice by the lattice spanned by
a subcone.</p>
<p>In the notation of <a class="reference internal" href="#fulton" id="id4">[Fulton]</a>, let <span class="math">\(N\)</span> be the ambient lattice
and <span class="math">\(N_\sigma\)</span> the sublattice spanned by the given cone
<span class="math">\(\sigma\)</span>. If <span class="math">\(\rho &lt; \sigma\)</span> is a subcone, then <span class="math">\(N_\rho\)</span> =
<tt class="docutils literal"><span class="pre">rho.sublattice()</span></tt> is a saturated sublattice of <span class="math">\(N_\sigma\)</span> =
<tt class="docutils literal"><span class="pre">self.sublattice()</span></tt>. This method returns the quotient
lattice. The lifts of the quotient generators are
<span class="math">\(\dim(\sigma)-\dim(\rho)\)</span> linearly independent primitive
lattice lattice points that, together with <span class="math">\(N_\rho\)</span>, generate
<span class="math">\(N_\sigma\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLattice_quotient" title="sage.geometry.toric_lattice.ToricLattice_quotient"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">lattice</span> <span class="pre">quotient</span></tt></a>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>The quotient <span class="math">\(N_\sigma / N_\rho\)</span> of spanned sublattices
has no torsion since the sublattice <span class="math">\(N_\rho\)</span> is saturated.</li>
<li>In the codimension one case, the generator of
<span class="math">\(N_\sigma / N_\rho\)</span> is chosen to be in the same direction as the
image <span class="math">\(\sigma / N_\rho\)</span></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">rho</span>   <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(-1, -1, 1, 3), N(1, 0, 0, 0), N(1, 1, 0, 0)&gt;</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(-1, 1, 1, 3), N(0, -1, 0, 0)&gt;</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">.</span><span class="n">relative_quotient</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="go">1-d lattice, quotient</span>
<span class="go">of Sublattice &lt;N(-1, -1, 1, 3), N(1, 0, 0, 0), N(1, 1, 0, 0)&gt;</span>
<span class="go">by Sublattice &lt;N(1, 0, -1, -3), N(0, 1, 0, 0)&gt;</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">.</span><span class="n">relative_quotient</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(N[1, 1, 0, 0],)</span>
</pre></div>
</div>
<p>More complicated example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">N_sigma</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N_sigma</span>
<span class="go">Sublattice &lt;N(-1, 1, 1), N(1, 2, 3), N(0, 1, 1)&gt;</span>
<span class="gp">sage: </span><span class="n">N_rho</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N_rho</span>
<span class="go">Sublattice &lt;N(1, -1, 1), N(1, 2, 3)&gt;</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">.</span><span class="n">relative_quotient</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(N[0, 1, 1],)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N_sigma</span> <span class="o">==</span> <span class="n">N</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="n">N_rho</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
<span class="gp">... </span>             <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">sigma</span><span class="o">.</span><span class="n">relative_quotient</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Sign choice in the codimension one case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sigma1</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>  <span class="c"># 3d</span>
<span class="gp">sage: </span><span class="n">sigma2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>  <span class="c"># 3d</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">sigma1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">sigma2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(1, -1, 1), N(1, 2, 3)&gt;</span>
<span class="gp">sage: </span><span class="n">sigma1</span><span class="o">.</span><span class="n">relative_quotient</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="go">1-d lattice, quotient</span>
<span class="go">of Sublattice &lt;N(-1, 1, 1), N(1, 2, 3), N(0, 1, 1)&gt;</span>
<span class="go">by Sublattice &lt;N(1, 2, 3), N(0, 3, 2)&gt;</span>
<span class="gp">sage: </span><span class="n">sigma1</span><span class="o">.</span><span class="n">relative_quotient</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(N[0, 1, 1],)</span>
<span class="gp">sage: </span><span class="n">sigma2</span><span class="o">.</span><span class="n">relative_quotient</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(N[-1, 0, -2],)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.semigroup_generators">
<tt class="descname">semigroup_generators</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.semigroup_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Return generators for the semigroup of lattice points of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="point_collection.html#sage.geometry.point_collection.PointCollection" title="sage.geometry.point_collection.PointCollection"><tt class="xref py py-class docutils literal"><span class="pre">PointCollection</span></tt></a>
of lattice points generating the semigroup of lattice points
contained in <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">No attempt is made to return a minimal set of generators, see
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.Hilbert_basis" title="sage.geometry.cone.ConvexRationalPolyhedralCone.Hilbert_basis"><tt class="xref py py-meth docutils literal"><span class="pre">Hilbert_basis()</span></tt></a> for that.</p>
</div>
<p>EXAMPLES:</p>
<p>The following command ensures that the output ordering in the examples
below is independent of TOPCOM, you don&#8217;t have to use it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">PointConfiguration</span><span class="o">.</span><span class="n">set_engine</span><span class="p">(</span><span class="s">&#39;internal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We start with a simple case of a non-smooth 2-dimensional cone:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Cone</span><span class="p">([</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">])</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">()</span>
<span class="go">N(1, 1),</span>
<span class="go">N(1, 0),</span>
<span class="go">N(1, 2)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>A non-simplicial cone works, too:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">()</span>
<span class="go">(N(1, 0, 0), N(0, 0, 1), N(0, 1, 0), N(3, 0, -1), N(1, -1, 0))</span>
</pre></div>
</div>
<p>GAP&#8217;s toric package thinks this is challenging:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span> <span class="n">cone</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">()</span> <span class="p">)</span>
<span class="go">2806</span>
</pre></div>
</div>
<p>The cone need not be strictly convex:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">halfplane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">halfplane</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">()</span>
<span class="go">(N(0, 1), N(1, 0), N(-1, 0))</span>
<span class="gp">sage: </span><span class="n">line</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">line</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">()</span>
<span class="go">(N(1, 1, 1), N(-1, -1, -1))</span>
<span class="gp">sage: </span><span class="n">wedge</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">wedge</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">()</span>
<span class="go">(N(1, 0, 0), N(1, 1, 0), N(1, 2, 0), N(0, 0, 1), N(0, 0, -1))</span>
</pre></div>
</div>
<p>Nor does it have to be full-dimensional (see
<a class="reference external" href="http://trac.sagemath.org/sage_trac/ticket/11312">http://trac.sagemath.org/sage_trac/ticket/11312</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">()</span>
<span class="go">N( 0, 1, 0),</span>
<span class="go">N( 1, 1, 0),</span>
<span class="go">N(-1, 1, 0)</span>
<span class="go">in 3-d lattice N</span>
</pre></div>
</div>
<p>Neither full-dimensional nor simplicial:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 1, 0]</span>
<span class="gp">sage: </span><span class="n">cone3d</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">[</span> <span class="n">A</span><span class="o">*</span><span class="n">vector</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cone3d</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span> <span class="p">]</span>
<span class="gp">sage: </span><span class="n">gens</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">(</span><span class="n">rays</span><span class="p">)</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">();</span> <span class="n">gens</span>
<span class="go">(N(1, -1, 1, 15), N(0, 1, -2, 0), N(-2, -1, 0, 17), N(3, -4, 5, 45), N(3, 0, 1, -2))</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span><span class="n">gens</span><span class="p">))</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">cone3d</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">()</span> <span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">Cone</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">())</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">())</span>
<span class="go">10</span>

<span class="gp">sage: </span><span class="n">trivial_cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([],</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">trivial_cone</span><span class="o">.</span><span class="n">semigroup_generators</span><span class="p">()</span>
<span class="go">Empty collection</span>
<span class="go">in 3-d lattice N</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>If the cone is not simplicial, it is first triangulated. Each
simplicial subcone has the integral points of the spaned
parallelotope as generators. This is the first step of the
primal Normaliz algorithm, see <a class="reference internal" href="#normaliz" id="id5">[Normaliz]</a>. For each
simplicial cone (of dimension <span class="math">\(d\)</span>), the integral points of the
open parallelotope</p>
<div class="math">
\[\begin{split}par \langle x_1, \dots, x_d \rangle =
\ZZ^n \cap
\left\{
q_1 x_1 + \cdots +q_d x_d
:~
0 \leq q_i &lt; 1
\right\}\end{split}\]</div>
<p>are then computed <a class="reference internal" href="#brunskoch" id="id6">[BrunsKoch]</a>.</p>
<p>Finally, the the union of the generators of all simplicial
subcones is returned.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="brunskoch" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[BrunsKoch]</a></td><td>W. Bruns and R. Koch,
Computing the integral closure of an affine semigroup.
Uni. Iaggelonicae Acta Math. 39, (2001), 59-70</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.strict_quotient">
<tt class="descname">strict_quotient</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.strict_quotient" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quotient of <tt class="docutils literal"><span class="pre">self</span></tt> by the linear subspace.</p>
<p>We define the <strong>strict quotient</strong> of a cone to be the image of this
cone in the quotient of the ambient space by the linear subspace of
the cone, i.e. it is the &#8220;complementary part&#8221; to the linear subspace.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>cone.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">halfplane</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ssc</span> <span class="o">=</span> <span class="n">halfplane</span><span class="o">.</span><span class="n">strict_quotient</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ssc</span>
<span class="go">1-d cone in 1-d lattice N</span>
<span class="gp">sage: </span><span class="n">ssc</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1)</span>
<span class="go">in 1-d lattice N</span>
<span class="gp">sage: </span><span class="n">line</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ssc</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strict_quotient</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ssc</span>
<span class="go">0-d cone in 1-d lattice N</span>
<span class="gp">sage: </span><span class="n">ssc</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">Empty collection</span>
<span class="go">in 1-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.sublattice">
<tt class="descname">sublattice</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>The sublattice spanned by the cone.</p>
<p>Let <span class="math">\(\sigma\)</span> be the given cone and <span class="math">\(N=\)</span> <tt class="docutils literal"><span class="pre">self.lattice()</span></tt> the
ambient lattice. Then, in the notation of <a class="reference internal" href="#fulton" id="id7">[Fulton]</a>, this
method returns the sublattice</p>
<div class="math">
\[N_\sigma \stackrel{\text{def}}{=} \mathop{span}( N\cap \sigma )\]</div>
<p>INPUT:</p>
<ul class="simple">
<li>either nothing or something that can be turned into an element of
this lattice.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>if no arguments were given, a <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLattice_sublattice_with_basis" title="sage.geometry.toric_lattice.ToricLattice_sublattice_with_basis"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">sublattice</span></tt></a>,
otherwise the corresponding element of it.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>The sublattice spanned by the cone is the saturation of
the sublattice generated by the rays of the cone.</li>
<li>See
<tt class="xref py py-meth docutils literal"><span class="pre">sage.geometry.cone.IntegralRayCollection.ray_basis()</span></tt>
if you only need a <span class="math">\(\QQ\)</span>-basis.</li>
<li>The returned lattice points are usually not rays of the
cone. In fact, for a non-smooth cone the rays do not
generate the sublattice <span class="math">\(N_\sigma\)</span>, but only a finite
index sublattice.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">N( 1,  1, 1),</span>
<span class="go">N( 1, -1, 1),</span>
<span class="go">N(-1, -1, 1)</span>
<span class="go">in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">cone</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(-1, -1, 1), N(1, 0, 0), N(1, 1, 0)&gt;</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span> <span class="n">cone</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="p">)</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">2-d cone in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1,  2, 3),</span>
<span class="go">N(4, -5, 1)</span>
<span class="go">in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(1, 2, 3), N(4, -5, 1)&gt;</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sublattice</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">N(5, -3, 4)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sublattice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">element [1, 0, 0] is not in free module</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.sublattice_complement">
<tt class="descname">sublattice_complement</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.sublattice_complement" title="Permalink to this definition">¶</a></dt>
<dd><p>A complement of the sublattice spanned by the cone.</p>
<p>In other words, <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.sublattice" title="sage.geometry.cone.ConvexRationalPolyhedralCone.sublattice"><tt class="xref py py-meth docutils literal"><span class="pre">sublattice()</span></tt></a> and
<a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.sublattice_complement" title="sage.geometry.cone.ConvexRationalPolyhedralCone.sublattice_complement"><tt class="xref py py-meth docutils literal"><span class="pre">sublattice_complement()</span></tt></a> together form a
<span class="math">\(\ZZ\)</span>-basis for the ambient <a class="reference internal" href="#sage.geometry.cone.IntegralRayCollection.lattice" title="sage.geometry.cone.IntegralRayCollection.lattice"><tt class="xref py py-meth docutils literal"><span class="pre">lattice()</span></tt></a>.</p>
<p>In the notation of <a class="reference internal" href="#fulton" id="id8">[Fulton]</a>, let <span class="math">\(\sigma\)</span> be the given cone
and <span class="math">\(N=\)</span> <tt class="docutils literal"><span class="pre">self.lattice()</span></tt> the ambient lattice. Then this
method returns</p>
<div class="math">
\[N(\sigma) \stackrel{\text{def}}{=} N / N_\sigma\]</div>
<p>lifted (non-canonically) to a sublattice of <span class="math">\(N\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li>either nothing or something that can be turned into an element of
this lattice.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>if no arguments were given, a <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLattice_sublattice_with_basis" title="sage.geometry.toric_lattice.ToricLattice_sublattice_with_basis"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">sublattice</span></tt></a>,
otherwise the corresponding element of it.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C2_Z2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>     <span class="c"># C^2/Z_2</span>
<span class="gp">sage: </span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">C2_Z2</span><span class="o">.</span><span class="n">facets</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c2</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(1, 2)&gt;</span>
<span class="gp">sage: </span><span class="n">c2</span><span class="o">.</span><span class="n">sublattice_complement</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(0, 1)&gt;</span>
</pre></div>
</div>
<p>A more complicated example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(1, 2, 3), N(4, -5, 1)&gt;</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sublattice_complement</span><span class="p">()</span>
<span class="go">Sublattice &lt;N(0, -6, -5)&gt;</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span> <span class="n">c</span><span class="o">.</span><span class="n">sublattice</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">sublattice_complement</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span>
<span class="go">[ 1  2  3]</span>
<span class="go">[ 4 -5  1]</span>
<span class="go">[ 0 -6 -5]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.ConvexRationalPolyhedralCone.sublattice_quotient">
<tt class="descname">sublattice_quotient</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.ConvexRationalPolyhedralCone.sublattice_quotient" title="Permalink to this definition">¶</a></dt>
<dd><p>The quotient of the ambient lattice by the sublattice spanned
by the cone.</p>
<p>INPUT:</p>
<ul class="simple">
<li>either nothing or something that can be turned into an element of
this lattice.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>if no arguments were given, a <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLattice_quotient" title="sage.geometry.toric_lattice.ToricLattice_quotient"><tt class="xref py py-class docutils literal"><span class="pre">quotient</span> <span class="pre">of</span> <span class="pre">a</span> <span class="pre">toric</span> <span class="pre">lattice</span></tt></a>,
otherwise the corresponding element of it.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C2_Z2</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>     <span class="c"># C^2/Z_2</span>
<span class="gp">sage: </span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">C2_Z2</span><span class="o">.</span><span class="n">facets</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c2</span><span class="o">.</span><span class="n">sublattice_quotient</span><span class="p">()</span>
<span class="go">1-d lattice, quotient of 2-d lattice N by Sublattice &lt;N(1, 2)&gt;</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">C2_Z2</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n_bar</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">sublattice_quotient</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="n">n_bar</span>
<span class="go">N[1, 1]</span>
<span class="gp">sage: </span><span class="n">n_bar</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
<span class="go">N(1, 1)</span>
<span class="gp">sage: </span><span class="n">vector</span><span class="p">(</span><span class="n">n_bar</span><span class="p">)</span>
<span class="go">(-1)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.geometry.cone.IntegralRayCollection">
<em class="property">class </em><tt class="descclassname">sage.geometry.cone.</tt><tt class="descname">IntegralRayCollection</tt><big>(</big><em>rays</em>, <em>lattice</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.IntegralRayCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v6.7)"><tt class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></tt></a>, <tt class="xref py py-class docutils literal"><span class="pre">_abcoll.Hashable</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">_abcoll.Iterable</span></tt></p>
<p>Create a collection of integral rays.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">No correctness check or normalization is performed on the input data.
This class is designed for internal operations and you probably should
not use it directly.</p>
</div>
<p>This is a base class for <a class="reference internal" href="#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><tt class="xref py py-class docutils literal"><span class="pre">convex</span> <span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">cones</span></tt></a> and <a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><tt class="xref py py-class docutils literal"><span class="pre">fans</span></tt></a>.</p>
<p>Ray collections are immutable, but they cache most of the returned values.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">rays</span></tt> &#8211; list of immutable vectors in <tt class="docutils literal"><span class="pre">lattice</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">lattice</span></tt> &#8211; <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><tt class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></tt></a>, <span class="math">\(\ZZ^n\)</span>, or any
other object that behaves like these. If <tt class="docutils literal"><span class="pre">None</span></tt>, it will be determined
as <a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.parent" title="(in Sage Reference Manual: Basic Structures v6.7)"><tt class="xref py py-func docutils literal"><span class="pre">parent()</span></tt></a> of the first ray. Of course, this cannot be done if
there are no rays, so in this case you must give an appropriate
<tt class="docutils literal"><span class="pre">lattice</span></tt> directly. Note that <tt class="docutils literal"><span class="pre">None</span></tt> is <em>not</em> the default value -
you always <em>must</em> give this argument explicitly, even if it is <tt class="docutils literal"><span class="pre">None</span></tt>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>collection of given integral rays.</li>
</ul>
<dl class="method">
<dt id="sage.geometry.cone.IntegralRayCollection.cartesian_product">
<tt class="descname">cartesian_product</tt><big>(</big><em>other</em>, <em>lattice=None</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.IntegralRayCollection.cartesian_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Cartesian product of <tt class="docutils literal"><span class="pre">self</span></tt> with <tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> &#8211; an <a class="reference internal" href="#sage.geometry.cone.IntegralRayCollection" title="sage.geometry.cone.IntegralRayCollection"><tt class="xref py py-class docutils literal"><span class="pre">IntegralRayCollection</span></tt></a>;</li>
<li><tt class="docutils literal"><span class="pre">lattice</span></tt> &#8211; (optional) the ambient lattice for the result. By
default, the direct sum of the ambient lattices of <tt class="docutils literal"><span class="pre">self</span></tt> and
<tt class="docutils literal"><span class="pre">other</span></tt> is constructed.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>an <a class="reference internal" href="#sage.geometry.cone.IntegralRayCollection" title="sage.geometry.cone.IntegralRayCollection"><tt class="xref py py-class docutils literal"><span class="pre">IntegralRayCollection</span></tt></a>.</li>
</ul>
<p>By the Cartesian product of ray collections <span class="math">\((r_0, \dots, r_{n-1})\)</span> and
<span class="math">\((s_0, \dots, s_{m-1})\)</span> we understand the ray collection of the form
<span class="math">\(((r_0, 0), \dots, (r_{n-1}, 0), (0, s_0), \dots, (0, s_{m-1}))\)</span>, which
is suitable for Cartesian products of cones and fans. The ray order is
guaranteed to be as described.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>    <span class="c"># indirect doctest</span>
<span class="go">2-d cone in 2-d lattice N+N</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N+N(1, 0),</span>
<span class="go">N+N(0, 1)</span>
<span class="go">in 2-d lattice N+N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.IntegralRayCollection.dim">
<tt class="descname">dim</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.IntegralRayCollection.dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the subspace spanned by rays of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>integer.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">lattice_dim</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.IntegralRayCollection.dual_lattice">
<tt class="descname">dual_lattice</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.IntegralRayCollection.dual_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dual of the ambient lattice of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>lattice. If possible (that is, if <a class="reference internal" href="#sage.geometry.cone.IntegralRayCollection.lattice" title="sage.geometry.cone.IntegralRayCollection.lattice"><tt class="xref py py-meth docutils literal"><span class="pre">lattice()</span></tt></a> has a
<tt class="docutils literal"><span class="pre">dual()</span></tt> method), the dual lattice is returned. Otherwise,
<span class="math">\(\ZZ^n\)</span> is returned, where <span class="math">\(n\)</span> is the dimension of <a class="reference internal" href="#sage.geometry.cone.IntegralRayCollection.lattice" title="sage.geometry.cone.IntegralRayCollection.lattice"><tt class="xref py py-meth docutils literal"><span class="pre">lattice()</span></tt></a>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">dual_lattice</span><span class="p">()</span>
<span class="go">2-d lattice M</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([],</span> <span class="n">ZZ</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">dual_lattice</span><span class="p">()</span>
<span class="go">Ambient free module of rank 3</span>
<span class="go">over the principal ideal domain Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.IntegralRayCollection.lattice">
<tt class="descname">lattice</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.IntegralRayCollection.lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ambient lattice of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>lattice.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">2-d lattice N</span>
<span class="gp">sage: </span><span class="n">Cone</span><span class="p">([],</span> <span class="n">ZZ</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="go">Ambient free module of rank 3</span>
<span class="go">over the principal ideal domain Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.IntegralRayCollection.lattice_dim">
<tt class="descname">lattice_dim</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.IntegralRayCollection.lattice_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the ambient lattice of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>integer.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">lattice_dim</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.IntegralRayCollection.nrays">
<tt class="descname">nrays</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.geometry.cone.IntegralRayCollection.nrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of rays of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>integer.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.IntegralRayCollection.plot">
<tt class="descname">plot</tt><big>(</big><em>**options</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.IntegralRayCollection.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li>any options for toric plots (see <a class="reference internal" href="toric_plotter.html#sage.geometry.toric_plotter.options" title="sage.geometry.toric_plotter.options"><tt class="xref py py-func docutils literal"><span class="pre">toric_plotter.options</span></tt></a>), none are mandatory.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a plot.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 9 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.IntegralRayCollection.ray">
<tt class="descname">ray</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.IntegralRayCollection.ray" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <tt class="docutils literal"><span class="pre">n</span></tt>-th ray of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span></tt> &#8211; integer, an index of a ray of <tt class="docutils literal"><span class="pre">self</span></tt>. Enumeration of rays
starts with zero.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>ray, an element of the lattice of <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">N(1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.cone.IntegralRayCollection.rays">
<tt class="descname">rays</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.IntegralRayCollection.rays" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (some of the) rays of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ray_list</span></tt> &#8211; a list of integers, the indices of the requested
rays. If not specified, all rays of <tt class="docutils literal"><span class="pre">self</span></tt> will be returned.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="point_collection.html#sage.geometry.point_collection.PointCollection" title="sage.geometry.point_collection.PointCollection"><tt class="xref py py-class docutils literal"><span class="pre">PointCollection</span></tt></a>
of primitive integral ray generators.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 0, 1),</span>
<span class="go">N( 1, 0),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">rays</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">N( 0, 1),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>You can also give ray indices directly, without packing them into a
list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">rays</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">N( 0, 1),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.geometry.cone.classify_cone_2d">
<tt class="descclassname">sage.geometry.cone.</tt><tt class="descname">classify_cone_2d</tt><big>(</big><em>ray0</em>, <em>ray1</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.classify_cone_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math">\((d,k)\)</span> classifying the lattice cone spanned by the two rays.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ray0</span></tt>, <tt class="docutils literal"><span class="pre">ray1</span></tt> &#8211; two primitive integer vectors. The
generators of the two rays generating the two-dimensional cone.</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">True</span></tt>). Whether to check the
input rays for consistency.</li>
</ul>
<p>OUTPUT:</p>
<p>A pair <span class="math">\((d,k)\)</span> of integers classifying the cone up to <span class="math">\(GL(2, \ZZ)\)</span>
equivalence. See Proposition 10.1.1 of <a class="reference internal" href="../../../schemes/sage/schemes/toric/variety.html#cls" id="id9">[CLS]</a> for the
definition. We return the unique <span class="math">\((d,k)\)</span> with minmial <span class="math">\(k\)</span>, see
Proposition 10.1.3 of <a class="reference internal" href="../../../schemes/sage/schemes/toric/variety.html#cls" id="id10">[CLS]</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ray0</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ray1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.cone</span> <span class="kn">import</span> <span class="n">classify_cone_2d</span>
<span class="gp">sage: </span><span class="n">classify_cone_2d</span><span class="p">(</span><span class="n">ray0</span><span class="p">,</span> <span class="n">ray1</span><span class="p">)</span>
<span class="go">(3, 2)</span>

<span class="gp">sage: </span><span class="n">ray0</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ray1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">classify_cone_2d</span><span class="p">(</span><span class="n">ray0</span><span class="p">,</span> <span class="n">ray1</span><span class="p">)</span>
<span class="go">(3, 1)</span>

<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[(</span><span class="mi">19</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">115</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="o">-</span><span class="mi">42</span><span class="p">,</span> <span class="o">-</span><span class="mi">298</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>   <span class="c"># check that it is in GL(3,ZZ)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">classify_cone_2d</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">ray0</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">ray1</span><span class="p">)</span>
<span class="go">(3, 1)</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check using the connection between the Hilbert basis of the cone
spanned by the two rays (in arbitrary dimension) and the
Hirzebruch-Jung continued fraction expansion, see Chapter 10 of
<a class="reference internal" href="../../../schemes/sage/schemes/toric/variety.html#cls" id="id11">[CLS]</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.cone</span> <span class="kn">import</span> <span class="n">normalize_rays</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="go">....:     ray0 = random_vector(ZZ, 3)</span>
<span class="go">....:     ray1 = random_vector(ZZ, 3)</span>
<span class="go">....:     if ray0.is_zero() or ray1.is_zero(): continue</span>
<span class="go">....:     ray0, ray1 = normalize_rays([ray0, ray1], ZZ^3)</span>
<span class="go">....:     d, k = classify_cone_2d(ray0, ray1, check=True)</span>
<span class="go">....:     assert (d,k) == classify_cone_2d(ray1, ray0)</span>
<span class="go">....:     if d == 0: continue</span>
<span class="go">....:     frac = (k/d).continued_fraction_list(&quot;hj&quot;)</span>
<span class="go">....:     if len(frac)&gt;100: continue   # avoid expensive computation</span>
<span class="go">....:     hilb = Cone([ray0, ray1]).Hilbert_basis()</span>
<span class="go">....:     assert len(hilb) == len(frac) + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.cone.is_Cone">
<tt class="descclassname">sage.geometry.cone.</tt><tt class="descname">is_Cone</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.is_Cone" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">x</span></tt> is a cone.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> &#8211; anything.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">x</span></tt> is a cone and <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.cone</span> <span class="kn">import</span> <span class="n">is_Cone</span>
<span class="gp">sage: </span><span class="n">is_Cone</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span>
<span class="go">2-d cone in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">is_Cone</span><span class="p">(</span><span class="n">quadrant</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.cone.normalize_rays">
<tt class="descclassname">sage.geometry.cone.</tt><tt class="descname">normalize_rays</tt><big>(</big><em>rays</em>, <em>lattice</em><big>)</big><a class="headerlink" href="#sage.geometry.cone.normalize_rays" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize a list of rational rays: make them primitive and immutable.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">rays</span></tt> &#8211; list of rays which can be converted to the rational
extension of <tt class="docutils literal"><span class="pre">lattice</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">lattice</span></tt> &#8211; <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><tt class="xref py py-class docutils literal"><span class="pre">ToricLattice</span></tt></a>, <span class="math">\(\ZZ^n\)</span>, or any
other object that behaves like these. If <tt class="docutils literal"><span class="pre">None</span></tt>, an attempt will
be made to determine an appropriate toric lattice automatically.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>list of immutable primitive vectors of the <tt class="docutils literal"><span class="pre">lattice</span></tt> in the same
directions as original <tt class="docutils literal"><span class="pre">rays</span></tt>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.cone</span> <span class="kn">import</span> <span class="n">normalize_rays</span>
<span class="gp">sage: </span><span class="n">normalize_rays</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="p">)],</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">[N(0, 1), N(0, 1), N(3, 2), N(3, 14)]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;L&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">normalize_rays</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="p">)],</span> <span class="n">L</span><span class="o">.</span><span class="n">dual</span><span class="p">())</span>
<span class="go">[L*(0, 1), L*(0, 1), L*(3, 2), L*(3, 14)]</span>
<span class="gp">sage: </span><span class="n">ray_in_L</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">normalize_rays</span><span class="p">([</span><span class="n">ray_in_L</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="p">)],</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">[L(0, 1), L(0, 1), L(3, 2), L(3, 14)]</span>
<span class="gp">sage: </span><span class="n">normalize_rays</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="p">)],</span> <span class="n">ZZ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 1), (3, 2), (3, 14)]</span>
<span class="gp">sage: </span><span class="n">normalize_rays</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="p">)],</span> <span class="n">ZZ</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">cannot convert (0, 1) to</span>
<span class="go">Vector space of dimension 3 over Rational Field!</span>
<span class="gp">sage: </span><span class="n">normalize_rays</span><span class="p">([],</span> <span class="n">ZZ</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="toric_lattice.html"
                                  title="previous chapter">Toric lattices</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="fan.html"
                                  title="next chapter">Rational polyhedral fans</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/geometry/cone.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fan.html" title="Rational polyhedral fans"
             >next</a> |</li>
        <li class="right" >
          <a href="toric_lattice.html" title="Toric lattices"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Geometry</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>