<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="\(p\)-adic \(L\)-functions of elliptic curves" href="padic_lseries.html" /><link rel="prev" title="\(L\)-series for elliptic curves" href="lseries_ell.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Heegner points on elliptic curves over the rational numbers - Elliptic curves</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Elliptic curves</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.1 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Elliptic curves</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="constructor.html">Elliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian.html">Construct elliptic curves as Jacobians</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_point.html">Points on elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_generic.html">Elliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_field.html">Elliptic curves over a general field</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_finite_field.html">Elliptic curves over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="formal_group.html">Formal groups of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hom.html">Elliptic-curve morphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_morphism.html">Isomorphisms between Weierstrass models of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_curve_isogeny.html">Isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_velusqrt.html">Square‑root Vélu algorithm for elliptic-curve isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_composite.html">Composite morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_scalar.html">Scalar-multiplication morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_frobenius.html">Frobenius isogenies of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_small_degree.html">Isogenies of small prime degree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_rational_field.html">Elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ec_database.html">Tables of elliptic curves of given rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_number_field.html">Elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="height.html">Canonical heights for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="saturation.html">Saturation of Mordell-Weil groups of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_torsion.html">Torsion subgroups of elliptic curves over number fields (including <span class="math notranslate nohighlight">\(\QQ\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps.html">Galois representations attached to elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps_number_field.html">Galois representations for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_class.html">Isogeny class of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="sha_tate.html">Tate-Shafarevich group</a></li>
<li class="toctree-l1"><a class="reference internal" href="cm.html">Complex multiplication for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="Qcurves.html">Testing whether elliptic curves over number fields are <span class="math notranslate nohighlight">\(\QQ\)</span>-curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_local_data.html">Local data for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="kodaira_symbol.html">Kodaira symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_tate_curve.html">Tate’s parametrisation of <span class="math notranslate nohighlight">\(p\)</span>-adic curves with multiplicative reduction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_wp.html">Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice.html">Period lattices of elliptic curves and related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice_region.html">Regions in fundamental domains of period lattices</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="modular_parametrization.html">Modular parametrization of elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_modular_symbols.html">Modular symbols attached to elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="mod_sym_num.html">Modular symbols by numerical integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lseries_ell.html"><span class="math notranslate nohighlight">\(L\)</span>-series for elliptic curves</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Heegner points on elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_lseries.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="descent_two_isogeny.html">Descent on elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span> with a 2-isogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_egros.html">Elliptic curves with prescribed good reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_padic_field.html">Elliptic curves over padic fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="gp_simon.html">Denis Simon’s PARI scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="mod5family.html">Elliptic curves with congruent mod-5 representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_transform.html">Morphism to bring a genus-one curve into Weierstrass form</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/constructor.html">Hyperelliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_generic.html">Hyperelliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_finite_field.html">Hyperelliptic curves over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_padic_field.html">Hyperelliptic curves over a <span class="math notranslate nohighlight">\(p\)</span>-adic field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_rational_field.html">Hyperelliptic curves over the rationals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/mestre.html">Mestre’s algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/monsky_washnitzer.html">Computation of Frobenius matrix on Monsky-Washnitzer cohomology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hypellfrob.html">Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over a</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_generic.html">Jacobian of a general hyperelliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_g2.html">Jacobian of a hyperelliptic curve of genus 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_homset.html">Rational point sets on a Jacobian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_morphism.html">Jacobian ‘morphism’ as a class in the Picard group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_g2.html">Hyperelliptic curves of genus 2 over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/invariants.html">Compute invariants of quintics and sextics via ‘Ueberschiebung’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/kummer_surface.html">Kummer surfaces over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/genus2reduction.html">Conductor and reduction types for genus 2 curves</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="heegner-points-on-elliptic-curves-over-the-rational-numbers">
<span id="sage-schemes-elliptic-curves-heegner"></span><h1>Heegner points on elliptic curves over the rational numbers<a class="headerlink" href="#heegner-points-on-elliptic-curves-over-the-rational-numbers" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.heegner"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein (August 2009)– most of the initial version</p></li>
<li><p>Robert Bradshaw (July 2009) – an early version of some specific code</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;433a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="mi">201</span><span class="p">);</span> <span class="n">z</span>
<span class="go">(-4/3 : 1/9*a : 1)</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">Abelian group of points on Elliptic Curve defined by y^2 + x*y = x^3 + 1</span>
<span class="go"> over Number Field in a with defining polynomial x^2 - 12*x + 111</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(Fractional ideal (1/2*a + 1)) * (Fractional ideal (-1/2*a + 1))</span>
</pre></div>
</div>
<p>Next try an inert prime:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Fractional ideal (5)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x^6 + x^5 - 1/4*x^4 + 19/10*x^3 + 31/20*x^2 - 7/10*x + 49/100)^2</span>
<span class="gp">sage: </span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">x^12 - x^11 + 6/5*x^10 - 33/40*x^9 - 89/320*x^8 + 3287/800*x^7</span>
<span class="go"> - 5273/1600*x^6 + 993/4000*x^5 + 823/320*x^4 - 2424/625*x^3</span>
<span class="go"> + 12059/12500*x^2 + 3329/25000*x + 123251/250000</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">(</span><span class="mi">300</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^6 + x^5 - 1/4*x^4 + 19/10*x^3 + 31/20*x^2 - 7/10*x + 49/100</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">-1 * 2^-9 * 5^-9 * 7^2 * 281^2 * 1021^2</span>
</pre></div>
</div>
<p>We find some Mordell-Weil generators in the rank 1 case using Heegner points:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;43a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">()</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">();</span> <span class="n">z</span> <span class="o">==</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="o">-</span><span class="n">z</span> <span class="o">==</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;997a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[-19, -23, -31, -35, -39, -40, -52, -55, -56, -59]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">()</span>
<span class="go">x - 141/49</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">();</span> <span class="n">z</span> <span class="o">==</span> <span class="n">E</span><span class="p">(</span><span class="mi">141</span><span class="o">/</span><span class="mi">49</span><span class="p">,</span> <span class="o">-</span><span class="mi">162</span><span class="o">/</span><span class="mi">343</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="ow">or</span> <span class="o">-</span><span class="n">z</span> <span class="o">==</span> <span class="n">E</span><span class="p">(</span><span class="mi">141</span><span class="o">/</span><span class="mi">49</span><span class="p">,</span> <span class="o">-</span><span class="mi">162</span><span class="o">/</span><span class="mi">343</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Here we find that the Heegner point generates a subgroup of index 3:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;92b1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[-7]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">();</span> <span class="n">z</span> <span class="o">==</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="ow">or</span> <span class="o">-</span><span class="n">z</span> <span class="o">==</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator</span><span class="p">()</span>
<span class="go">0.0498083972980648</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.448275575682583</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">P</span> <span class="c1"># a generator</span>
<span class="go">(1 : 1 : 1)</span>
<span class="gp">sage: </span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span>
<span class="go">(0 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The above is consistent with the following analytic computation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">3.0000?</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">GaloisAutomorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>An abstract automorphism of a ring class field.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>make <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism" title="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaloisAutomorphism</span></code></a> derive from GroupElement, so
that one gets powers for free, etc.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism.domain">
<span class="sig-name descname"><span class="pre">domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism.domain" title="Permalink to this definition">#</a></dt>
<dd><p>Return the domain of this automorphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism.parent" title="Permalink to this definition">#</a></dt>
<dd><p>Return the parent of this automorphism, which is a Galois
group of a ring class field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">GaloisAutomorphismComplexConjugation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism" title="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaloisAutomorphism</span></code></a></p>
<p>The complex conjugation automorphism of a ring class field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">conj</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">conj</span>
<span class="go">Complex conjugation automorphism of Ring class field extension</span>
<span class="go"> of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">conj</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation.order">
<span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation.order" title="Permalink to this definition">#</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">conj</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">conj</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">GaloisAutomorphismQuadraticForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadratic_form</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism" title="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaloisAutomorphism</span></code></a></p>
<p>An automorphism of a ring class field defined by a quadratic form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">())[</span><span class="mi">0</span><span class="p">];</span> <span class="n">sigma</span>
<span class="go">Class field automorphism defined by x^2 + 45*y^2</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span> <span class="o">==</span> <span class="n">sigma</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.alpha" title="Permalink to this definition">#</a></dt>
<dd><p>Optional data that specified element corresponding element of
<span class="math notranslate nohighlight">\((\mathcal{O}_K / c\mathcal{O}_K)^* / (\ZZ/c\ZZ)^*\)</span>, via class
field theory.</p>
<p>This is a generator of the ideal corresponding to this
automorphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K3</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">orb</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">alpha</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">]);</span> <span class="n">orb</span> <span class="c1"># random (the sign depends on the database being installed or not)</span>
<span class="go">[1, 1/2*sqrt_minus_52 + 1, -1/2*sqrt_minus_52, 1/2*sqrt_minus_52 - 1]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">])</span> <span class="c1"># this is just for testing</span>
<span class="go">[-13, -sqrt_minus_52 - 12, sqrt_minus_52 - 12, 1]</span>

<span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">orb</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">alpha</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">]);</span> <span class="n">orb</span> <span class="c1"># random (the sign depends on the database being installed or not)</span>
<span class="go">[1, -1/2*sqrt_minus_52, 1/2*sqrt_minus_52 + 1, 1/2*sqrt_minus_52 - 1,</span>
<span class="go"> 1/2*sqrt_minus_52 - 2, -1/2*sqrt_minus_52 - 2]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">])</span> <span class="c1"># just for testing</span>
<span class="go">[-13, -sqrt_minus_52 - 12, sqrt_minus_52 - 12,</span>
<span class="go"> -2*sqrt_minus_52 - 9, 2*sqrt_minus_52 - 9, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.ideal">
<span class="sig-name descname"><span class="pre">ideal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.ideal" title="Permalink to this definition">#</a></dt>
<dd><p>Return ideal of ring of integers of quadratic imaginary field
corresponding to this quadratic form.  This is the ideal</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(I = \left(A, \frac{-B+ c\sqrt{D}}{2}\right) \mathcal{O}_K\)</span>.</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">F</span><span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="go">Fractional ideal (2, 1/2*sqrt_minus_20 + 1)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">G</span><span class="p">]</span>
<span class="go">[(1, 3/2*sqrt_minus_20), (2, 3/2*sqrt_minus_20 - 1),</span>
<span class="go"> (5, 3/2*sqrt_minus_20), (7, 3/2*sqrt_minus_20 - 2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.order">
<span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the multiplicative order of this Galois group automorphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K3</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
<span class="go">[1, 2, 4, 4]</span>
<span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
<span class="go">[1, 2, 3, 3, 6, 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.p1_element">
<span class="sig-name descname"><span class="pre">p1_element</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.p1_element" title="Permalink to this definition">#</a></dt>
<dd><p>Return element of the projective line corresponding to this
automorphism.</p>
<p>This only makes sense if this automorphism is in the Galois
group <span class="math notranslate nohighlight">\(\textrm{Gal}(K_c/K_1)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K3</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">p1_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
<span class="go">[(0, 1), (1, 0), (1, 1), (1, 2)]</span>

<span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">p1_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
<span class="go">[(0, 1), (1, 0), (1, 1), (1, 2), (1, 3), (1, 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.quadratic_form">
<span class="sig-name descname"><span class="pre">quadratic_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.quadratic_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return reduced quadratic form corresponding to this Galois
automorphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">s</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">x^2 + 45*y^2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">GaloisGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base=Rational</span> <span class="pre">Field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>A Galois group of a ring class field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="go">Complex conjugation automorphism of Ring class field extension of QQ[sqrt(-7)]</span>
<span class="go"> of conductor 5</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisGroup.base_field">
<span class="sig-name descname"><span class="pre">base_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.base_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the base field, which the field fixed by all the
automorphisms in this Galois group.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Kc</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">();</span> <span class="n">Kc</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Kc</span><span class="o">.</span><span class="n">galois_group</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Rational Field</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">Kc</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Kc</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="go"> over Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go">  with sqrt_minus_7 = 2.645751311064591?*I</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go"> with sqrt_minus_7 = 2.645751311064591?*I</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Kc</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">Kc</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="go"> over Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisGroup.cardinality">
<span class="sig-name descname"><span class="pre">cardinality</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.cardinality" title="Permalink to this definition">#</a></dt>
<dd><p>Return the cardinality of this Galois group.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">55</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">120</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisGroup.complex_conjugation">
<span class="sig-name descname"><span class="pre">complex_conjugation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.complex_conjugation" title="Permalink to this definition">#</a></dt>
<dd><p>Return the automorphism of <code class="docutils literal notranslate"><span class="pre">self</span></code> determined by complex
conjugation.  The base field must be the rational numbers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="go">Complex conjugation automorphism of Ring class field extension</span>
<span class="go"> of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisGroup.field">
<span class="sig-name descname"><span class="pre">field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ring class field that this Galois group acts on.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisGroup.is_kolyvagin">
<span class="sig-name descname"><span class="pre">is_kolyvagin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.is_kolyvagin" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if conductor <span class="math notranslate nohighlight">\(c\)</span> is prime to the discriminant of the
quadratic field, <span class="math notranslate nohighlight">\(c\)</span> is squarefree and each prime dividing <span class="math notranslate nohighlight">\(c\)</span>
is inert.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">.</span><span class="n">is_kolyvagin</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K7</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K7</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">.</span><span class="n">is_kolyvagin</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K25</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K25</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">.</span><span class="n">is_kolyvagin</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisGroup.kolyvagin_generators">
<span class="sig-name descname"><span class="pre">kolyvagin_generators</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.kolyvagin_generators" title="Permalink to this definition">#</a></dt>
<dd><p>Assuming this Galois group <span class="math notranslate nohighlight">\(G\)</span> is of the form
<span class="math notranslate nohighlight">\(G=\textrm{Gal}(K_c/K_1)\)</span>, with <span class="math notranslate nohighlight">\(c=p_1\dots p_n\)</span> satisfying the
Kolyvagin hypothesis, this function returns noncanonical
choices of lifts of generators for each of the cyclic factors
of <span class="math notranslate nohighlight">\(G\)</span> corresponding to the primes dividing <span class="math notranslate nohighlight">\(c\)</span>.  Thus the
<span class="math notranslate nohighlight">\(i\)</span>-th returned valued is an element of <span class="math notranslate nohighlight">\(G\)</span> that maps to the
identity element of <span class="math notranslate nohighlight">\(\textrm{Gal}(K_p/K_1)\)</span> for all <span class="math notranslate nohighlight">\(p \neq p_i\)</span> and
to a choice of generator of <span class="math notranslate nohighlight">\(\textrm{Gal}(K_{p_i}/K_1)\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>list of elements of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K3</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">kolyvagin_generators</span><span class="p">()</span>
<span class="go">(Class field automorphism defined by 9*x^2 - 6*x*y + 14*y^2,)</span>

<span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">kolyvagin_generators</span><span class="p">()</span>
<span class="go">(Class field automorphism defined by 17*x^2 - 14*x*y + 22*y^2,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.GaloisGroup.lift_of_hilbert_class_field_galois_group">
<span class="sig-name descname"><span class="pre">lift_of_hilbert_class_field_galois_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.lift_of_hilbert_class_field_galois_group" title="Permalink to this definition">#</a></dt>
<dd><p>Assuming this Galois group <span class="math notranslate nohighlight">\(G\)</span> is of the form <span class="math notranslate nohighlight">\(G=\textrm{Gal}(K_c/K)\)</span>,
this function returns noncanonical choices of lifts of the
elements of the quotient group <span class="math notranslate nohighlight">\(\textrm{Gal}(K_1/K)\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>tuple of elements of self</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K5</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">lift_of_hilbert_class_field_galois_group</span><span class="p">()</span>
<span class="go">(Class field automorphism defined by x^2 + 325*y^2,</span>
<span class="go"> Class field automorphism defined by 2*x^2 + 2*x*y + 163*y^2)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">K5</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">HeegnerPoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>A Heegner point of level <span class="math notranslate nohighlight">\(N\)</span>, discriminant <span class="math notranslate nohighlight">\(D\)</span> and conductor <span class="math notranslate nohighlight">\(c\)</span>
is any point on a modular curve or elliptic curve that is
concocted in some way from a quadratic imaginary <span class="math notranslate nohighlight">\(\tau\)</span> in the upper
half plane with <span class="math notranslate nohighlight">\(\Delta(\tau) = D c = \Delta(N \tau)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">HeegnerPoint</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">13</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point of level 389, discriminant -7, and conductor 13</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPoint&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.conductor">
<span class="sig-name descname"><span class="pre">conductor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.conductor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the conductor of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -67 and conductor 7</span>
<span class="go"> on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.discriminant">
<span class="sig-name descname"><span class="pre">discriminant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.discriminant" title="Permalink to this definition">#</a></dt>
<dd><p>Return the discriminant of the quadratic imaginary field
associated to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -67 and conductor 7</span>
<span class="go"> on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-67</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.level">
<span class="sig-name descname"><span class="pre">level</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.level" title="Permalink to this definition">#</a></dt>
<dd><p>Return the level of this Heegner point, which is the level of the
modular curve <span class="math notranslate nohighlight">\(X_0(N)\)</span> on which this is a Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">389</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.quadratic_field">
<span class="sig-name descname"><span class="pre">quadratic_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.quadratic_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the quadratic number field of discriminant <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go"> with sqrt_minus_7 = 2.645751311064591?*I</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_40 with defining polynomial x^2 + 40</span>
<span class="go"> with sqrt_minus_40 = 6.324555320336759?*I</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span> <span class="ow">is</span> <span class="n">P</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.rings.number_field.number_field.NumberField_quadratic_with_category&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.quadratic_order">
<span class="sig-name descname"><span class="pre">quadratic_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.quadratic_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order in the quadratic imaginary field of conductor
<span class="math notranslate nohighlight">\(c\)</span>, where <span class="math notranslate nohighlight">\(c\)</span> is the conductor of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">()</span>
<span class="go">Order in Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go"> with sqrt_minus_7 = 2.645751311064591?*I</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1, 5*sqrt_minus_7]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">()</span>
<span class="go">Order in Number Field in sqrt_minus_40 with defining polynomial x^2 + 40</span>
<span class="go"> with sqrt_minus_40 = 6.324555320336759?*I</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1, 11*sqrt_minus_40]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.ring_class_field">
<span class="sig-name descname"><span class="pre">ring_class_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.ring_class_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ring class field associated to this Heegner point.
This is an extension <span class="math notranslate nohighlight">\(K_c\)</span> over <span class="math notranslate nohighlight">\(K\)</span>, where <span class="math notranslate nohighlight">\(K\)</span> is the
quadratic imaginary field and <span class="math notranslate nohighlight">\(c\)</span> is the conductor associated
to this Heegner point.  This Heegner point is defined over
<span class="math notranslate nohighlight">\(K_c\)</span> and the Galois group <span class="math notranslate nohighlight">\(Gal(K_c/K)\)</span> acts transitively on
the Galois conjugates of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">22</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">132</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">30</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">HeegnerPointOnEllipticCurve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint" title="sage.schemes.elliptic_curves.heegner.HeegnerPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeegnerPoint</span></code></a></p>
<p>A Heegner point on a curve associated to an order in a quadratic
imaginary field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve&#39;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.conjugates_over_K">
<span class="sig-name descname"><span class="pre">conjugates_over_K</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.conjugates_over_K" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(Gal(K_c/K)\)</span> conjugates of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;77a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">y</span>
<span class="go">Heegner point of discriminant -52 and conductor 5</span>
<span class="go"> on elliptic curve of conductor 77</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">([</span><span class="n">z</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">y</span><span class="o">.</span><span class="n">conjugates_over_K</span><span class="p">()])</span>
<span class="go">[77*x^2 + 52*x*y + 13*y^2, 154*x^2 + 206*x*y + 71*y^2, 539*x^2 + 822*x*y + 314*y^2,</span>
<span class="go"> 847*x^2 + 1284*x*y + 487*y^2, 1001*x^2 + 52*x*y + y^2, 1078*x^2 + 822*x*y + 157*y^2,</span>
<span class="go"> 1309*x^2 + 360*x*y + 25*y^2, 1309*x^2 + 2054*x*y + 806*y^2,</span>
<span class="go"> 1463*x^2 + 976*x*y + 163*y^2, 2233*x^2 + 2824*x*y + 893*y^2,</span>
<span class="go"> 2387*x^2 + 2054*x*y + 442*y^2, 3619*x^2 + 3286*x*y + 746*y^2]</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">77*x^2 + 52*x*y + 13*y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.curve">
<span class="sig-name descname"><span class="pre">curve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.curve" title="Permalink to this definition">#</a></dt>
<dd><p>Return the elliptic curve on which this is a Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span> <span class="ow">is</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.heegner_point_on_X0N">
<span class="sig-name descname"><span class="pre">heegner_point_on_X0N</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.heegner_point_on_X0N" title="Permalink to this definition">#</a></dt>
<dd><p>Return Heegner point on <span class="math notranslate nohighlight">\(X_0(N)\)</span> that maps to this Heegner point on <span class="math notranslate nohighlight">\(E\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve</span>
<span class="go"> of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">heegner_point_on_X0N</span><span class="p">()</span>
<span class="go">Heegner point 5/74*sqrt(-7) - 11/74 of discriminant -7 and conductor 5</span>
<span class="go"> on X_0(37)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.kolyvagin_cohomology_class">
<span class="sig-name descname"><span class="pre">kolyvagin_cohomology_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.kolyvagin_cohomology_class" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Kolyvagin class associated to this Heegner point.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> – positive integer that divides the gcd of <span class="math notranslate nohighlight">\(a_p\)</span>
and <span class="math notranslate nohighlight">\(p+1\)</span> for all <span class="math notranslate nohighlight">\(p\)</span> dividing the conductor.  If <span class="math notranslate nohighlight">\(n\)</span> is
<code class="docutils literal notranslate"><span class="pre">None</span></code>, choose the largest valid <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Kolyvagin cohomology class c(5) in H^1(K,E[3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.kolyvagin_point">
<span class="sig-name descname"><span class="pre">kolyvagin_point</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.kolyvagin_point" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Kolyvagin point corresponding to this Heegner
point.</p>
<p>This is the point obtained by applying the Kolyvagin
operator <span class="math notranslate nohighlight">\(J_c I_c\)</span> in the group ring of the Galois group to
this Heegner point.   It is a point that defines an element
of <span class="math notranslate nohighlight">\(H^1(K, E[n])\)</span>, under certain hypotheses on <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">y</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">();</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>  <span class="c1"># abs tol 1e-15</span>
<span class="go">(-3.36910401903861e-16 - 2.22076195576076e-16*I</span>
<span class="go"> : 3.33066907387547e-16 + 2.22076195576075e-16*I : 1.00000000000000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.map_to_complex_numbers">
<span class="sig-name descname"><span class="pre">map_to_complex_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.map_to_complex_numbers" title="Permalink to this definition">#</a></dt>
<dd><p>Return the point in the subfield <span class="math notranslate nohighlight">\(M\)</span> of the complex numbers
(well defined only modulo the period lattice) corresponding to
this Heegner point.</p>
<p>EXAMPLES:</p>
<p>We compute a nonzero Heegner point over a ring class field on
a curve of rank 2:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">map_to_complex_numbers</span><span class="p">()</span>
<span class="go">1.49979679635196 + 0.369156204821526*I</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">map_to_complex_numbers</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1.4997967963519640592142411892 + 0.36915620482152626830089145962*I</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">map_to_complex_numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1.5 + 0.37*I</span>
</pre></div>
</div>
<p>Here we see that the Heegner point is 0 since it lies in the
lattice:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">map_to_complex_numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">0.0034 - 3.9*I</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">map_to_complex_numbers</span><span class="p">()</span>
<span class="go">4.71844785465692e-15 - 3.94347540310330*I</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(2.49021256085505, 1.97173770155165*I)</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">3.94347540310330*I</span>
</pre></div>
</div>
<p>You can also directly coerce to the complex field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">ComplexField</span><span class="p">(</span><span class="mi">100</span><span class="p">)(</span><span class="n">y</span><span class="p">);</span> <span class="n">z</span> <span class="c1"># real part approx. 0</span>
<span class="go">-... - 3.9434754031032964088448153963*I</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">(0.00000000000000000000000000000 : 1.0000000000000000000000000000 : 0.00000000000000000000000000000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.numerical_approx">
<span class="sig-name descname"><span class="pre">numerical_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.numerical_approx" title="Permalink to this definition">#</a></dt>
<dd><p>Return a numerical approximation to this Heegner point
computed using a working precision of prec bits.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The answer is <em>not</em> provably correct to prec bits!  A
priori, due to rounding and other errors, it is possible that
not a single digit is correct.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p>prec     – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) the working precision</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>  <span class="c1"># abs tol 1e-15</span>
<span class="go">(-3.36910401903861e-16 - 2.22076195576076e-16*I</span>
<span class="go"> : 3.33066907387547e-16 + 2.22076195576075e-16*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># expect random digits</span>
<span class="go">(0.0030 - 0.0028*I : -0.0030 + 0.0028*I : 1.0)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">100</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># expect random digits</span>
<span class="go">8.4...e-31 + 6.0...e-31*I</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -40 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">(-3.15940603400359e-16 + 1.41421356237309*I</span>
<span class="go"> : 1.00000000000000 - 1.41421356237309*I : 1.00000000000000)</span>
</pre></div>
</div>
<p>A rank 2 curve, where all Heegner points of conductor 1 are 0:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">(0.000000000000000 : 1.00000000000000 : 0.000000000000000)</span>
</pre></div>
</div>
<p>However, Heegner points of bigger conductor are often nonzero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve</span>
<span class="go"> of conductor 389</span>
<span class="gp">sage: </span><span class="n">numerical_approx</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">(0.675507556926807 + 0.344749649302635*I</span>
<span class="go"> : -0.377142931401887 + 0.843366227137146*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">(0.6755075569268... + 0.3447496493026...*I</span>
<span class="go"> : -0.3771429314018... + 0.8433662271371...*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">(0.1795583794118... + 0.02035501750912...*I</span>
<span class="go"> : -0.5573941377055... + 0.2738940831635...*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">(1.034302915374... - 3.302744319777...*I</span>
<span class="go"> : 1.323937875767... + 6.908264226850...*I : 1.00000000000000)</span>
</pre></div>
</div>
<p>We find (probably) the defining polynomial of the
<span class="math notranslate nohighlight">\(x\)</span>-coordinate of <span class="math notranslate nohighlight">\(P\)</span>, which defines a class field.  The shape of
the discriminant below is strong confirmation – but not proof
– that this polynomial is correct:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">70</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span> <span class="n">f</span>
<span class="go">1225*x^6 + 1750*x^5 - 21675*x^4 - 380*x^3 + 110180*x^2 - 129720*x + 48771</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2^6 * 3^2 * 5^11 * 7^4 * 13^2 * 19^6 * 199^2 * 719^2 * 26161^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.point_exact">
<span class="sig-name descname"><span class="pre">point_exact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lll'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.point_exact" title="Permalink to this definition">#</a></dt>
<dd><p>Return exact point on the elliptic curve over a number field
defined by computing this Heegner point to the given number of
bits of precision.   A ValueError is raised if the precision
is clearly insignificant to define a point on the curve.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is in theory possible for this function to not raise a
ValueError, find a point on the curve, but via some very
unlikely coincidence that point is not actually this Heegner
point.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently we make an arbitrary choice of <span class="math notranslate nohighlight">\(y\)</span>-coordinate for
the lift of the <span class="math notranslate nohighlight">\(x\)</span>-coordinate.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – integer (default: 53)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – see the description of the algorithm
parameter for the <code class="docutils literal notranslate"><span class="pre">x_poly_exact</span></code> method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> – string (default: ‘a’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">optimize</span></code> – bool (default; False) if <code class="docutils literal notranslate"><span class="pre">True</span></code>, try to
optimize defining polynomial for the number field that
the point is defined over.  Off by default, since this
can be very expensive.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5</span>
<span class="go"> on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^12 + 6*x^11 + 90089/1715*x^10 + 71224/343*x^9 + 52563964/588245*x^8 - 483814934/588245*x^7 - 156744579/16807*x^6 - 2041518032/84035*x^5 + 1259355443184/14706125*x^4 + 3094420220918/14706125*x^3 + 123060442043827/367653125*x^2 + 82963044474852/367653125*x + 211679465261391/1838265625</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">500</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span> <span class="n">f</span> <span class="o">/</span> <span class="n">f</span><span class="o">.</span><span class="n">leading_coefficient</span><span class="p">()</span>
<span class="go">x^12 + 6*x^11 + 90089/1715*x^10 + 71224/343*x^9 + 52563964/588245*x^8 - 483814934/588245*x^7 - 156744579/16807*x^6 - 2041518032/84035*x^5 + 1259355443184/14706125*x^4 + 3094420220918/14706125*x^3 + 123060442043827/367653125*x^2 + 82963044474852/367653125*x + 211679465261391/1838265625</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">(0 : 1 : 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.quadratic_form">
<span class="sig-name descname"><span class="pre">quadratic_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.quadratic_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return the integral primitive positive definite binary
quadratic form associated to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">389*x^2 + 147*x*y + 14*y^2</span>

<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">778</span><span class="p">,</span><span class="mi">925</span><span class="p">,</span><span class="mi">275</span><span class="p">));</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve</span>
<span class="go"> of conductor 389</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">778*x^2 + 925*x*y + 275*y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.satisfies_kolyvagin_hypothesis">
<span class="sig-name descname"><span class="pre">satisfies_kolyvagin_hypothesis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.satisfies_kolyvagin_hypothesis" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if this Heegner point and <span class="math notranslate nohighlight">\(n\)</span> satisfy the
Kolyvagin hypothesis, i.e., that each prime dividing the
conductor <span class="math notranslate nohighlight">\(c\)</span> of <code class="docutils literal notranslate"><span class="pre">self</span></code> is inert in K and coprime to <span class="math notranslate nohighlight">\(ND\)</span>.
Moreover, if <span class="math notranslate nohighlight">\(n\)</span> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, also check that for each prime
<span class="math notranslate nohighlight">\(p\)</span> dividing <span class="math notranslate nohighlight">\(c\)</span> we have that <span class="math notranslate nohighlight">\(n | \gcd(a_p(E), p+1)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> – positive integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.tau" title="Permalink to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(\tau\)</span> in the upper half plane that maps via the
modular parametrization to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tau</span><span class="p">()</span>
<span class="go">5/778*sqrt_minus_7 - 147/778</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.x_poly_exact">
<span class="sig-name descname"><span class="pre">x_poly_exact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lll'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.x_poly_exact" title="Permalink to this definition">#</a></dt>
<dd><p>Return irreducible polynomial over the rational numbers
satisfied by the <span class="math notranslate nohighlight">\(x\)</span> coordinate of this Heegner point.  A
ValueError is raised if the precision is clearly insignificant
to define a point on the curve.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is in theory possible for this function to not raise a
ValueError, find a polynomial, but via some very unlikely
coincidence that point is not actually this Heegner point.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – integer (default: 53)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – ‘conjugates’ or ‘lll’ (default); if
‘conjugates’, compute numerically all the
conjugates <code class="docutils literal notranslate"><span class="pre">y[i]</span></code> of the Heegner point and construct
the characteristic polynomial as the product
<span class="math notranslate nohighlight">\(f(X)=(X-y[i])\)</span>.  If ‘lll’, compute only one of the
conjugates <code class="docutils literal notranslate"><span class="pre">y[0]</span></code>, then uses the LLL algorithm to
guess <span class="math notranslate nohighlight">\(f(X)\)</span>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>We compute some <span class="math notranslate nohighlight">\(x\)</span>-coordinate polynomials of some conductor 1
Heegner points:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">()</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
<span class="go">[x, x, x^2 + 2, x^5 - x^4 + x^3 + x^2 - 2*x + 1, x - 6,</span>
<span class="go"> x^7 - 2*x^6 + 9*x^5 - 10*x^4 - x^3 + 8*x^2 - 5*x + 1,</span>
<span class="go"> x^3 + 5*x^2 + 10*x + 4, x^4 - 10*x^3 + 10*x^2 + 12*x - 12,</span>
<span class="go"> x^8 - 5*x^7 + 7*x^6 + 13*x^5 - 10*x^4 - 4*x^3 + x^2 - 5*x + 7,</span>
<span class="go"> x^6 - 2*x^5 + 11*x^4 - 24*x^3 + 30*x^2 - 16*x + 4]</span>
</pre></div>
</div>
<p>We compute <span class="math notranslate nohighlight">\(x\)</span>-coordinate polynomials for some Heegner points
of conductor bigger than 1 on a rank 2 curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5</span>
<span class="go"> on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: insufficient precision to determine Heegner point</span>
<span class="go">(fails discriminant test)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
<span class="go">x^6 + 10/7*x^5 - 867/49*x^4 - 76/245*x^3 + 3148/35*x^2 - 25944/245*x + 48771/1225</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="go">x^10 + 282527/52441*x^9 + 27049007420/2750058481*x^8 - 22058564794/2750058481*x^7</span>
<span class="go"> - 140054237301/2750058481*x^6 + 696429998952/30250643291*x^5</span>
<span class="go"> + 2791387923058/30250643291*x^4 - 3148473886134/30250643291*x^3</span>
<span class="go"> + 1359454055022/30250643291*x^2 - 250620385365/30250643291*x</span>
<span class="go"> + 181599685425/332757076201</span>
</pre></div>
</div>
<p>Here we compute a Heegner point of conductor 5 on a rank 3 curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5</span>
<span class="go"> on elliptic curve of conductor 5077</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="go">x^6 + 1108754853727159228/72351048803252547*x^5 + 88875505551184048168/1953478317687818769*x^4 - 2216200271166098662132/3255797196146364615*x^3 + 14941627504168839449851/9767391588439093845*x^2 - 3456417460183342963918/3255797196146364615*x + 1306572835857500500459/5426328660243941025</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/sagemath/sage/issues/34121">github issue #34121</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">PE</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">PE</span>
<span class="go">(a : -4*a + 3 : 1)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">7</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">PE</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">HeegnerPointOnX0N</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint" title="sage.schemes.elliptic_curves.heegner.HeegnerPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeegnerPoint</span></code></a></p>
<p>A Heegner point as a point on the modular curve <span class="math notranslate nohighlight">\(X_0(N)\)</span>, which we
view as the upper half plane modulo the action of <span class="math notranslate nohighlight">\(\Gamma_0(N)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point 5/74*sqrt(-7) - 11/74 of discriminant -7 and conductor 5 on X_0(37)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">37</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go"> with sqrt_minus_7 = 2.645751311064591?*I</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">37*x^2 + 11*x*y + 2*y^2</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">()</span>
<span class="go">Order in Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go"> with sqrt_minus_7 = 2.645751311064591?*I</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">()</span>
<span class="go">5/74*sqrt_minus_7 - 11/74</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.atkin_lehner_act">
<span class="sig-name descname"><span class="pre">atkin_lehner_act</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.atkin_lehner_act" title="Permalink to this definition">#</a></dt>
<dd><p>Given an integer Q dividing the level N such that <span class="math notranslate nohighlight">\(\gcd(Q, N/Q) = 1\)</span>, return the
image of this Heegner point under the Atkin-Lehner operator <span class="math notranslate nohighlight">\(W_Q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q\)</span> – positive divisor of <span class="math notranslate nohighlight">\(N\)</span>; if not given, default to <span class="math notranslate nohighlight">\(N\)</span></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">atkin_lehner_act</span><span class="p">()</span>
<span class="go">Heegner point 5/199168*sqrt(-7) - 631/199168 of discriminant -7</span>
<span class="go"> and conductor 5 on X_0(389)</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="n">D</span><span class="o">=-</span><span class="mi">11</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point 1/90*sqrt(-11) - 13/90 of discriminant -11 on X_0(45)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">atkin_lehner_act</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Heegner point 1/90*sqrt(-11) + 23/90 of discriminant -11 on X_0(45)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">atkin_lehner_act</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span> <span class="n">y</span>
<span class="go">Heegner point 1/90*sqrt(-11) - 23/90 of discriminant -11 on X_0(45)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">atkin_lehner_act</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span> <span class="n">z</span>
<span class="go">Heegner point 1/90*sqrt(-11) - 13/90 of discriminant -11 on X_0(45)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.galois_orbit_over_K">
<span class="sig-name descname"><span class="pre">galois_orbit_over_K</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.galois_orbit_over_K" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(Gal(K_c/K)\)</span>-orbit of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point 3/778*sqrt(-7) - 223/778 of discriminant -7</span>
<span class="go"> and conductor 3 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">galois_orbit_over_K</span><span class="p">()</span>
<span class="go">[Heegner point 3/778*sqrt(-7) - 223/778 of discriminant -7 and conductor 3 on X_0(389),</span>
<span class="go"> Heegner point 3/1556*sqrt(-7) - 223/1556 of discriminant -7 and conductor 3 on X_0(389),</span>
<span class="go"> Heegner point 3/1556*sqrt(-7) - 1001/1556 of discriminant -7 and conductor 3 on X_0(389),</span>
<span class="go"> Heegner point 3/3112*sqrt(-7) - 223/3112 of discriminant -7 and conductor 3 on X_0(389)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.map_to_curve">
<span class="sig-name descname"><span class="pre">map_to_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.map_to_curve" title="Permalink to this definition">#</a></dt>
<dd><p>Return the image of this Heegner point on the elliptic curve
<span class="math notranslate nohighlight">\(E\)</span>, which must also have conductor <span class="math notranslate nohighlight">\(N\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the
level of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point 5/778*sqrt(-7) - 147/778 of discriminant -7</span>
<span class="go"> and conductor 5 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">map_to_curve</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">));</span> <span class="n">y</span>
<span class="go">Heegner point of discriminant -7 and conductor 5</span>
<span class="go"> on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span><span class="o">.</span><span class="n">cremona_label</span><span class="p">()</span>
<span class="go">&#39;389a1&#39;</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">heegner_point_on_X0N</span><span class="p">()</span>
<span class="go">Heegner point 5/778*sqrt(-7) - 147/778 of discriminant -7</span>
<span class="go"> and conductor 5 on X_0(389)</span>
</pre></div>
</div>
<p>You can also directly apply the modular parametrization of the elliptic curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point 1/74*sqrt(-7) - 17/74 of discriminant -7 on X_0(37)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">);</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_parametrization</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 37</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Draw a point at <span class="math notranslate nohighlight">\((x,y)\)</span> where this Heegner point is
represented by the point <span class="math notranslate nohighlight">\(\tau = x + i y\)</span> in the upper half
plane.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">kwds</span></code> get passed onto the point plotting command.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pointsize</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.quadratic_form">
<span class="sig-name descname"><span class="pre">quadratic_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.quadratic_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return the integral primitive positive-definite binary
quadratic form associated to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">389*x^2 + 147*x*y + 14*y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.reduced_quadratic_form">
<span class="sig-name descname"><span class="pre">reduced_quadratic_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.reduced_quadratic_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return reduced binary quadratic corresponding to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">389*x^2 + 147*x*y + 14*y^2</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">reduced_quadratic_form</span><span class="p">()</span>
<span class="go">4*x^2 - x*y + 11*y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.tau" title="Permalink to this definition">#</a></dt>
<dd><p>Return an element <code class="docutils literal notranslate"><span class="pre">tau</span></code> in the upper half plane that corresponds
to this particular Heegner point.</p>
<p>Actually, <code class="docutils literal notranslate"><span class="pre">tau</span></code> is in the quadratic imaginary field K associated
to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">();</span> <span class="n">tau</span>
<span class="go">5/74*sqrt_minus_7 - 11/74</span>
<span class="gp">sage: </span><span class="mi">37</span> <span class="o">*</span> <span class="n">tau</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">37*x^2 + 11*x + 2</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">37*x^2 + 11*x*y + 2*y^2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">HeegnerPoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>The set of Heegner points with given parameters.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">);</span> <span class="n">H</span>
<span class="go">Set of all Heegner points on X_0(389)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPoints_level&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">HeegnerPoints</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints.level">
<span class="sig-name descname"><span class="pre">level</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints.level" title="Permalink to this definition">#</a></dt>
<dd><p>Return the level <span class="math notranslate nohighlight">\(N\)</span> of the modular curve <span class="math notranslate nohighlight">\(X_0(N)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">389</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">HeegnerPoints_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints" title="sage.schemes.elliptic_curves.heegner.HeegnerPoints"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeegnerPoints</span></code></a></p>
<p>Return the infinite set of all Heegner points on <span class="math notranslate nohighlight">\(X_0(N)\)</span> for all
quadratic imaginary fields.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span> <span class="n">H</span>
<span class="go">Set of all Heegner points on X_0(11)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPoints_level&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level.discriminants">
<span class="sig-name descname"><span class="pre">discriminants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level.discriminants" title="Permalink to this definition">#</a></dt>
<dd><p>Return the first <span class="math notranslate nohighlight">\(n\)</span> quadratic imaginary discriminants that
satisfy the Heegner hypothesis for <span class="math notranslate nohighlight">\(N\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> – nonnegative integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weak</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code> only require
weak Heegner hypothesis, which is the same as usual but
without the condition that <span class="math notranslate nohighlight">\(\gcd(D,N)=1\)</span>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">discriminants</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[-7, -11, -40, -47, -67]</span>
</pre></div>
</div>
<p>The default is 10:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">discriminants</span><span class="p">()</span>
<span class="go">[-7, -11, -40, -47, -67, -71, -83, -84, -95, -104]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">discriminants</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">[-7, -11, -40, -47, -67, -71, -83, -84, -95, -104, -107, -115, -120, -123, -127]</span>
</pre></div>
</div>
<p>The discriminant -111 satisfies only the weak Heegner hypothesis, since it
is divisible by 37:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">discriminants</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">weak</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[-7, -11, -40, -47, -67, -71, -83, -84, -95, -104, -107, -111, -115, -120, -123]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level.reduce_mod">
<span class="sig-name descname"><span class="pre">reduce_mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level.reduce_mod" title="Permalink to this definition">#</a></dt>
<dd><p>Return object that allows for computation with Heegner points
of level <span class="math notranslate nohighlight">\(N\)</span> modulo the prime <span class="math notranslate nohighlight">\(\ell\)</span>, represented using
quaternion algebras.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\ell\)</span> – prime</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">HeegnerPoints_level_disc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints" title="sage.schemes.elliptic_curves.heegner.HeegnerPoints"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeegnerPoints</span></code></a></p>
<p>Set of Heegner points of given level and all conductors associated
to a quadratic imaginary field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">H</span>
<span class="go">Set of all Heegner points on X_0(389) associated to QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">_repr_</span><span class="p">()</span>
<span class="go">&#39;Set of all Heegner points on X_0(389) associated to QQ[sqrt(-7)]&#39;</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go"> with sqrt_minus_7 = 2.645751311064591?*I</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">()</span>
<span class="go">[1, 3, 5, 13, 15, 17, 19, 31, 39, 41]</span>

<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.discriminant">
<span class="sig-name descname"><span class="pre">discriminant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.discriminant" title="Permalink to this definition">#</a></dt>
<dd><p>Return the discriminant of the quadratic imaginary extension <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.kolyvagin_conductors">
<span class="sig-name descname"><span class="pre">kolyvagin_conductors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.kolyvagin_conductors" title="Permalink to this definition">#</a></dt>
<dd><p>Return the first <span class="math notranslate nohighlight">\(n\)</span> conductors that are squarefree products
of distinct primes inert in the quadratic imaginary field
<span class="math notranslate nohighlight">\(K = \QQ(\sqrt{D})\)</span>.  If <span class="math notranslate nohighlight">\(r\)</span> is specified, return only
conductors that are a product of <span class="math notranslate nohighlight">\(r\)</span> distinct primes all inert
in <span class="math notranslate nohighlight">\(K\)</span>.  If <span class="math notranslate nohighlight">\(r = 0\)</span>, always return the list <code class="docutils literal notranslate"><span class="pre">[1]</span></code>,
no matter what.</p>
<p>If the optional elliptic curve <span class="math notranslate nohighlight">\(E\)</span> and integer <span class="math notranslate nohighlight">\(m\)</span> are given,
then only include conductors <span class="math notranslate nohighlight">\(c\)</span> such that for each prime
divisor <span class="math notranslate nohighlight">\(p\)</span> of <span class="math notranslate nohighlight">\(c\)</span> we have <span class="math notranslate nohighlight">\(m \mid \gcd(a_p(E), p+1)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r\)</span> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) nonnegative integer or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> – positive integer</p></li>
<li><p><span class="math notranslate nohighlight">\(E\)</span> – an elliptic curve</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – a positive integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[3, 5, 13, 17, 19, 31, 41, 47, 59, 61]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">[3, 5, 13, 17, 19, 31, 41, 47, 59, 61, 73, 83, 89, 97, 101]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[3, 5, 13, 17, 19]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[5, 17, 41, 59, 83]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[85, 205, 295, 415, 697]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.quadratic_field">
<span class="sig-name descname"><span class="pre">quadratic_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.quadratic_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the quadratic imaginary field <span class="math notranslate nohighlight">\(K = \QQ(\sqrt{D})\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go"> with sqrt_minus_7 = 2.645751311064591?*I</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">HeegnerPoints_level_disc_cond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level" title="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeegnerPoints_level</span></code></a>, <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc" title="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeegnerPoints_level_disc</span></code></a></p>
<p>The set of Heegner points of given level, discriminant, and conductor.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">H</span>
<span class="go">All Heegner points of conductor 5 on X_0(389) associated to QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">389</span>

<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Heegner point 5/778*sqrt(-7) - 147/778 of discriminant -7 and conductor 5 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">betas</span><span class="p">()</span>
<span class="go">(147, 631)</span>

<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go"> with sqrt_minus_7 = 2.645751311064591?*I</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>

<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">()</span>
<span class="go">[1, 3, 5, 13, 15, 17, 19, 31, 39, 41]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.betas">
<span class="sig-name descname"><span class="pre">betas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.betas" title="Permalink to this definition">#</a></dt>
<dd><p>Return the square roots of <span class="math notranslate nohighlight">\(D c^2\)</span> modulo <span class="math notranslate nohighlight">\(4 N\)</span> all reduced
mod <span class="math notranslate nohighlight">\(2 N\)</span>, without multiplicity.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">X</span>
<span class="go">All Heegner points of conductor 1 on X_0(45) associated to QQ[sqrt(-11)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]</span>
<span class="go">[45*x^2 + 13*x*y + y^2,</span>
<span class="go"> 45*x^2 + 23*x*y + 3*y^2,</span>
<span class="go"> 45*x^2 + 67*x*y + 25*y^2,</span>
<span class="go"> 45*x^2 + 77*x*y + 33*y^2]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">betas</span><span class="p">()</span>
<span class="go">(13, 23, 67, 77)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">(Heegner point 1/90*sqrt(-11) - 13/90 of discriminant -11 on X_0(45),)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>
<span class="go">[45*x^2 + 13*x*y + y^2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.conductor">
<span class="sig-name descname"><span class="pre">conductor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.conductor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the level of the conductor.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Returns plot of all the representatives in the upper half
plane of the Heegner points in this set of Heegner points.</p>
<p>The inputs to this function get passed onto the point command.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pointsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>           <span class="c1"># optional - sage.plot</span>
<span class="go">Graphics object consisting of 12 graphics primitives</span>
<span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pointsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>        <span class="c1"># optional - sage.plot</span>
<span class="go">Graphics object consisting of 48 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.points">
<span class="sig-name descname"><span class="pre">points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.points" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Heegner points in <code class="docutils literal notranslate"><span class="pre">self</span></code>.  If <span class="math notranslate nohighlight">\(\beta\)</span> is given,
return only those Heegner points with given <span class="math notranslate nohighlight">\(\beta\)</span>, i.e.,
whose quadratic form has <span class="math notranslate nohighlight">\(B\)</span> congruent to <span class="math notranslate nohighlight">\(\beta\)</span> modulo <span class="math notranslate nohighlight">\(2 N\)</span>.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">self.beta()</span></code> to get a list of betas.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">H</span>
<span class="go">All Heegner points of conductor 5 on X_0(389) associated to QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">()</span>
<span class="go">(Heegner point 5/778*sqrt(-7) - 147/778 of discriminant -7 and conductor 5</span>
<span class="go">  on X_0(389),</span>
<span class="go"> ...,</span>
<span class="go"> Heegner point 5/5446*sqrt(-7) - 757/778 of discriminant -7 and conductor 5</span>
<span class="go">  on X_0(389))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">betas</span><span class="p">()</span>
<span class="go">(147, 631)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="mi">147</span><span class="p">)]</span>
<span class="go">[5/778*sqrt_minus_7 - 147/778, 5/1556*sqrt_minus_7 - 147/1556,</span>
<span class="go"> 5/1556*sqrt_minus_7 - 925/1556, 5/3112*sqrt_minus_7 - 1703/3112,</span>
<span class="go"> 5/3112*sqrt_minus_7 - 2481/3112, 5/5446*sqrt_minus_7 - 21/778]</span>

<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="mi">631</span><span class="p">)]</span>
<span class="go">[5/778*sqrt_minus_7 - 631/778, 5/1556*sqrt_minus_7 - 631/1556,</span>
<span class="go"> 5/1556*sqrt_minus_7 - 1409/1556, 5/3112*sqrt_minus_7 - 631/3112,</span>
<span class="go"> 5/3112*sqrt_minus_7 - 1409/3112, 5/5446*sqrt_minus_7 - 757/778]</span>
</pre></div>
</div>
<p>The result is cached and is a tuple (since it is immutable):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">()</span> <span class="ow">is</span> <span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
<span class="go">&lt;... &#39;tuple&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.ring_class_field">
<span class="sig-name descname"><span class="pre">ring_class_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.ring_class_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ring class field associated to this set of Heegner
points.  This is an extension <span class="math notranslate nohighlight">\(K_c\)</span> over <span class="math notranslate nohighlight">\(K\)</span>, where <span class="math notranslate nohighlight">\(K\)</span> is the
quadratic imaginary field and <span class="math notranslate nohighlight">\(c\)</span> the conductor associated to
this Heegner point.  This Heegner point is defined over <span class="math notranslate nohighlight">\(K_c\)</span>
and the Galois group <span class="math notranslate nohighlight">\(Gal(K_c/K)\)</span> acts transitively on the
Galois conjugates of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.satisfies_kolyvagin_hypothesis">
<span class="sig-name descname"><span class="pre">satisfies_kolyvagin_hypothesis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.satisfies_kolyvagin_hypothesis" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> satisfies the Kolyvagin hypothesis, i.e.,
that each prime dividing the conductor <span class="math notranslate nohighlight">\(c\)</span> of <code class="docutils literal notranslate"><span class="pre">self</span></code> is inert in
<span class="math notranslate nohighlight">\(K\)</span> and coprime to <span class="math notranslate nohighlight">\(ND\)</span>.</p>
<p>EXAMPLES:</p>
<p>The prime 5 is inert, but the prime 11 is not:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">HeegnerQuatAlg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>Heegner points viewed as supersingular points on the modular curve
<span class="math notranslate nohighlight">\(X_0(N)/\mathbf{F}_{\ell}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">13</span><span class="p">);</span> <span class="n">H</span>
<span class="go">Heegner points on X_0(11) over F_13</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.brandt_module">
<span class="sig-name descname"><span class="pre">brandt_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.brandt_module" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Brandt module of right ideal classes that we
used to represent the set of supersingular points on
the modular curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">()</span>
<span class="go">Brandt module of dimension 2 of level 3*11 of weight 2 over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.cyclic_subideal_p1">
<span class="sig-name descname"><span class="pre">cyclic_subideal_p1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.cyclic_subideal_p1" title="Permalink to this definition">#</a></dt>
<dd><p>Compute dictionary mapping 2-tuples that defined normalized
elements of <span class="math notranslate nohighlight">\(P^1(\ZZ/c\ZZ)\)</span></p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(I\)</span> – right ideal of Eichler order or in quaternion algebra</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – square free integer (currently must be odd prime
and coprime to level, discriminant, characteristic, etc.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>dictionary mapping 2-tuples (u,v) to ideals</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">()</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">cyclic_subideal_p1</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((0, 1),</span>
<span class="go">  Fractional ideal (2 + 2*j + 32*k, 2*i + 8*j + 82*k, 12*j + 60*k, 132*k)),</span>
<span class="go"> ((1, 0),</span>
<span class="go">  Fractional ideal (2 + 10*j + 28*k, 2*i + 4*j + 62*k, 12*j + 60*k, 132*k)),</span>
<span class="go"> ((1, 1),</span>
<span class="go">  Fractional ideal (2 + 2*j + 76*k, 2*i + 4*j + 106*k, 12*j + 60*k, 132*k)),</span>
<span class="go"> ((1, 2),</span>
<span class="go">  Fractional ideal (2 + 10*j + 116*k, 2*i + 8*j + 38*k, 12*j + 60*k, 132*k))]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">cyclic_subideal_p1</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
<span class="go">18</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.ell">
<span class="sig-name descname"><span class="pre">ell</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.ell" title="Permalink to this definition">#</a></dt>
<dd><p>Return the prime <span class="math notranslate nohighlight">\(\ell\)</span> modulo which we are working.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ell</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.galois_group_over_hilbert_class_field">
<span class="sig-name descname"><span class="pre">galois_group_over_hilbert_class_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.galois_group_over_hilbert_class_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Galois group of the extension of ring class fields
<span class="math notranslate nohighlight">\(K_c\)</span> over the Hilbert class field <span class="math notranslate nohighlight">\(K_{1}\)</span> of the quadratic
imaginary field of discriminant <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – fundamental discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – conductor (square-free integer)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">galois_group_over_hilbert_class_field</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 41</span>
<span class="go"> over Hilbert class field of QQ[sqrt(-7)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.galois_group_over_quadratic_field">
<span class="sig-name descname"><span class="pre">galois_group_over_quadratic_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.galois_group_over_quadratic_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Galois group of the extension of ring class fields
<span class="math notranslate nohighlight">\(K_c\)</span> over the quadratic imaginary field <span class="math notranslate nohighlight">\(K\)</span> of discriminant <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – fundamental discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – conductor (square-free integer)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">galois_group_over_quadratic_field</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 41</span>
<span class="go"> over Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go">  with sqrt_minus_7 = 2.645751311064591?*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_conductors">
<span class="sig-name descname"><span class="pre">heegner_conductors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_conductors" title="Permalink to this definition">#</a></dt>
<dd><p>Return the first <span class="math notranslate nohighlight">\(n\)</span> negative fundamental discriminants
coprime to <span class="math notranslate nohighlight">\(N\ell\)</span> such that <span class="math notranslate nohighlight">\(\ell\)</span> is inert in the
corresponding quadratic imaginary field and that field
satisfies the Heegner hypothesis.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – negative integer; a fundamental Heegner discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> – positive integer (default: 5)</p></li>
</ul>
<p>OUTPUT: A list.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_conductors</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[1, 2, 4, 5, 8]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_conductors</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">[1, 2, 4, 5, 8, 10, 13, 16, 17, 19]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_discriminants">
<span class="sig-name descname"><span class="pre">heegner_discriminants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_discriminants" title="Permalink to this definition">#</a></dt>
<dd><p>Return the first <span class="math notranslate nohighlight">\(n\)</span> negative fundamental discriminants
coprime to <span class="math notranslate nohighlight">\(N\ell\)</span> such that <span class="math notranslate nohighlight">\(\ell\)</span> is inert in the
corresponding quadratic imaginary field and that field
satisfies the Heegner hypothesis, and <span class="math notranslate nohighlight">\(N\)</span> is the level.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> – positive integer (default: 5)</p></li>
</ul>
<p>OUTPUT: A list.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">()</span>
<span class="go">[-7, -19, -40, -43, -52]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[-7, -19, -40, -43, -52, -79, -127, -139, -151, -184]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_divisor">
<span class="sig-name descname"><span class="pre">heegner_divisor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_divisor" title="Permalink to this definition">#</a></dt>
<dd><p>Return Heegner divisor as an element of the Brandt module
corresponding to the discriminant <span class="math notranslate nohighlight">\(D\)</span> and conductor <span class="math notranslate nohighlight">\(c\)</span>, which
both must be coprime to <span class="math notranslate nohighlight">\(N\ell\)</span>.</p>
<p>More precisely, we compute the sum of the reductions of the
<span class="math notranslate nohighlight">\(\textrm{Gal}(K_1/K)\)</span>-conjugates of each choice of <span class="math notranslate nohighlight">\(y_1\)</span>,
where the choice comes from choosing the ideal <span class="math notranslate nohighlight">\(\mathcal{N}\)</span>.
Then we apply the Hecke operator <span class="math notranslate nohighlight">\(T_c\)</span> to this sum.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – discriminant (negative integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – conductor (positive integer)</p></li>
</ul>
<p>OUTPUT: A Brandt module element.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">()</span>
<span class="go">[-8, -39, -43, -51, -79]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
<span class="go">(1, 0, 0, 1, 0, 0)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">39</span><span class="p">)</span>
<span class="go">(1, 2, 2, 1, 2, 0)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">43</span><span class="p">)</span>
<span class="go">(1, 0, 0, 1, 0, 0)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">51</span><span class="p">)</span>
<span class="go">(1, 0, 0, 1, 0, 2)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">79</span><span class="p">)</span>
<span class="go">(3, 2, 2, 3, 0, 0)</span>

<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">39</span><span class="p">)</span><span class="o">.</span><span class="n">element</span><span class="p">())</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">39</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_cyclic_subideals">
<span class="sig-name descname"><span class="pre">kolyvagin_cyclic_subideals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_quaternion</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_cyclic_subideals" title="Permalink to this definition">#</a></dt>
<dd><p>Return list of pairs <span class="math notranslate nohighlight">\((J, n)\)</span> where <span class="math notranslate nohighlight">\(J\)</span> runs through the
cyclic subideals of <span class="math notranslate nohighlight">\(I\)</span> of index <span class="math notranslate nohighlight">\((\ZZ/p\ZZ)^2\)</span>, and <span class="math notranslate nohighlight">\(J \sim
\alpha^n(J_0)\)</span> for some fixed choice of cyclic subideal <span class="math notranslate nohighlight">\(J_0\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(I\)</span> – right ideal of the quaternion algebra</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha_quaternion</span></code> – image in the quaternion algebra
of generator <span class="math notranslate nohighlight">\(\alpha\)</span> for <span class="math notranslate nohighlight">\((\mathcal{O}_K / c\mathcal{O}_K)^* / (\ZZ/c\ZZ)^*\)</span>.</p></li>
</ul>
<p>OUTPUT: A list of 2-tuples.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">()</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">49</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_generators</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">number_field</span><span class="p">(),</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">alpha_quaternion</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">alpha_quaternion</span>
<span class="go">1 - 77/192*i - 5/128*j - 137/384*k</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_cyclic_subideals</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">alpha_quaternion</span><span class="p">)</span>
<span class="go">[(Fractional ideal (2 + 2/3*i + 364*j + 231928/3*k,</span>
<span class="go">                    4/3*i + 946*j + 69338/3*k,</span>
<span class="go">                    1280*j + 49920*k, 94720*k), 0),</span>
<span class="go"> (Fractional ideal (2 + 2/3*i + 108*j + 31480/3*k,</span>
<span class="go">                    4/3*i + 434*j + 123098/3*k,</span>
<span class="go">                    1280*j + 49920*k, 94720*k), 1),</span>
<span class="go"> (Fractional ideal (2 + 2/3*i + 876*j + 7672/3*k,</span>
<span class="go">                    4/3*i + 434*j + 236762/3*k,</span>
<span class="go">                    1280*j + 49920*k, 94720*k), 2),</span>
<span class="go"> (Fractional ideal (2 + 2/3*i + 364*j + 61432/3*k,</span>
<span class="go">                    4/3*i + 178*j + 206810/3*k,</span>
<span class="go">                    1280*j + 49920*k, 94720*k), 3),</span>
<span class="go"> (Fractional ideal (2 + 2/3*i + 876*j + 178168/3*k,</span>
<span class="go">                    4/3*i + 1202*j + 99290/3*k,</span>
<span class="go">                    1280*j + 49920*k, 94720*k), 4),</span>
<span class="go"> (Fractional ideal (2 + 2/3*i + 1132*j + 208120/3*k,</span>
<span class="go">                    4/3*i + 946*j + 183002/3*k,</span>
<span class="go">                    1280*j + 49920*k, 94720*k), 5)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_generator">
<span class="sig-name descname"><span class="pre">kolyvagin_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_generator" title="Permalink to this definition">#</a></dt>
<dd><p>Return element in <span class="math notranslate nohighlight">\(K\)</span> that maps to the multiplicative generator
for the quotient group</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\((\mathcal{O}_K / p \mathcal{O}_K)^* / (\ZZ/p\ZZ)^*\)</span></p>
</div></blockquote>
<p>of the form <span class="math notranslate nohighlight">\(\sqrt{D}+n\)</span> with <span class="math notranslate nohighlight">\(n\geq 1\)</span> minimal.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K\)</span> – quadratic imaginary field</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – inert prime</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">()</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">49</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_generator</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">number_field</span><span class="p">(),</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">a + 1</span>
</pre></div>
</div>
<p>This function requires that <span class="math notranslate nohighlight">\(p\)</span> be prime, but <code class="docutils literal notranslate"><span class="pre">kolyvagin_generators</span></code> works in general:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_generator</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">number_field</span><span class="p">(),</span> <span class="mi">5</span><span class="o">*</span><span class="mi">17</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: p must be prime</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_generators</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">number_field</span><span class="p">(),</span> <span class="mi">5</span><span class="o">*</span><span class="mi">17</span><span class="p">)</span>
<span class="go">[-34*a + 1, 35*a + 106]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_generators">
<span class="sig-name descname"><span class="pre">kolyvagin_generators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_generators" title="Permalink to this definition">#</a></dt>
<dd><p>Return elements in <span class="math notranslate nohighlight">\(\mathcal{O}_K\)</span> that map to multiplicative generators
for the factors of the quotient group</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\((\mathcal{O}_K / c \mathcal{O}_K)^* / (\ZZ/c\ZZ)^*\)</span></p>
</div></blockquote>
<p>corresponding to the prime divisors of c.  Each generator is
of the form <span class="math notranslate nohighlight">\(\sqrt{D}+n\)</span> with <span class="math notranslate nohighlight">\(n\geq 1\)</span> minimal.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K\)</span> – quadratic imaginary field</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – square free product of inert prime</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">()</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">49</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_generators</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">number_field</span><span class="p">(),</span> <span class="mi">5</span><span class="o">*</span><span class="mi">17</span><span class="p">)</span>
<span class="go">[-34*a + 1, 35*a + 106]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_point_on_curve">
<span class="sig-name descname"><span class="pre">kolyvagin_point_on_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_point_on_curve" title="Permalink to this definition">#</a></dt>
<dd><p>Compute image of the Kolyvagin divisor <span class="math notranslate nohighlight">\(P_c\)</span> in
<span class="math notranslate nohighlight">\(E(\GF{\ell^2}) / p E(\GF{\ell^2})\)</span>.</p>
<p>Note that this image is by definition only well defined up to
scalars.  However, doing multiple computations will always
yield the same result, and working modulo different <span class="math notranslate nohighlight">\(\ell\)</span> is
compatible (since we always choose the same generator for
<span class="math notranslate nohighlight">\(\textrm{Gal}(K_c/K_1)\)</span>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – fundamental negative discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – conductor</p></li>
<li><p><span class="math notranslate nohighlight">\(E\)</span> – elliptic curve of conductor the level of self</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – odd prime number such that we consider image in
<span class="math notranslate nohighlight">\(E(\GF{\ell^2}) / p E(\GF{\ell^2})\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bound</span></code> – integer (default: 10)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_point_on_curve</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_sigma_operator">
<span class="sig-name descname"><span class="pre">kolyvagin_sigma_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_sigma_operator" title="Permalink to this definition">#</a></dt>
<dd><p>Return the action of the Kolyvagin sigma operator on the <span class="math notranslate nohighlight">\(r\)</span>-th
basis vector.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – fundamental discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – conductor (square-free integer, need not be prime)</p></li>
<li><p><span class="math notranslate nohighlight">\(r\)</span> – nonnegative integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bound</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>), if given, controls
precision of computation of theta series, which could
impact performance, but does not impact correctness</p></li>
</ul>
<p>EXAMPLES:</p>
<p>We first try to verify Kolyvagin’s conjecture for a rank 2
curve by working modulo 5, but we are unlucky with <span class="math notranslate nohighlight">\(c=17\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">389</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_dual_elliptic_curve_factor</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># long time (4s on sage.math, 2012)</span>
<span class="gp">sage: </span><span class="n">k118</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">118</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k104</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">104</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k104</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>  <span class="c1"># long time</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[0, 0]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k118</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>  <span class="c1"># long time</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[0, 0]</span>
</pre></div>
</div>
<p>Next we try again with <span class="math notranslate nohighlight">\(c=41\)</span> and this does work, in that we
get something nonzero, when dotting with V:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="mi">41</span>
<span class="gp">sage: </span><span class="n">k118</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">118</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k104</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">104</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k118</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>  <span class="c1"># long time</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[2, 0]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k104</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>  <span class="c1"># long time</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[1, 0]</span>
</pre></div>
</div>
<p>By the way, the above is the first ever provable verification
of Kolyvagin’s conjecture for any curve of rank at least 2.</p>
<p>Another example, but where the curve has rank 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">nonzero_positions</span><span class="p">()</span>
<span class="go">[49, 51]</span>
<span class="gp">sage: </span><span class="n">k49</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">49</span><span class="p">);</span> <span class="n">k49</span>
<span class="go">(79, 32, 31, 11, 53, 37, 1, 23, 15, 7, 0, 0, 0, 64, 32, 34, 53, 0, 27, 27, 0, 0, 0, 26, 0, 0, 18, 0, 22, 0, 53, 19, 27, 10, 0, 0, 0, 30, 35, 38, 0, 0, 0, 53, 0, 0, 4, 0, 0, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">k51</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">51</span><span class="p">);</span> <span class="n">k51</span>
<span class="go">(20, 12, 57, 0, 0, 0, 0, 52, 23, 15, 0, 7, 0, 0, 19, 4, 0, 73, 11, 0, 104, 31, 0, 38, 31, 0, 0, 31, 5, 47, 0, 27, 35, 0, 57, 32, 24, 10, 0, 8, 0, 31, 41, 0, 0, 0, 16, 0, 0, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_dual_elliptic_curve_factor</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">),</span> <span class="n">q</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">V</span>
<span class="go">Vector space of degree 52 and dimension 2 over Ring of integers modulo 3</span>
<span class="go">Basis matrix:</span>
<span class="go">2 x 52 dense matrix over Ring of integers modulo 3</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k49</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k51</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
<p>An example with <span class="math notranslate nohighlight">\(c\)</span> a product of two primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">389</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_dual_elliptic_curve_factor</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">),</span> <span class="n">q</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">17</span><span class="o">*</span><span class="mi">41</span><span class="p">,</span> <span class="mi">104</span><span class="p">)</span>     <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">k</span>                                                 <span class="c1"># long time</span>
<span class="go">(990, 656, 219, ..., 246, 534, 1254)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>   <span class="c1"># long time (but only because depends on something slow)</span>
<span class="go">[0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.left_orders">
<span class="sig-name descname"><span class="pre">left_orders</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.left_orders" title="Permalink to this definition">#</a></dt>
<dd><p>Return the left orders associated to the representative right
ideals in the Brandt module.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()</span>
<span class="go">[Order of Quaternion Algebra (-1, -3) with base ring Rational Field</span>
<span class="go">  with basis (1/2 + 1/2*j + 7*k, 1/2*i + 13/2*k, j + 3*k, 11*k),</span>
<span class="go"> Order of Quaternion Algebra (-1, -3) with base ring Rational Field</span>
<span class="go">  with basis (1/2 + 1/2*j + 7*k, 1/4*i + 1/2*j + 63/4*k, j + 14*k, 22*k)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.level">
<span class="sig-name descname"><span class="pre">level</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.level" title="Permalink to this definition">#</a></dt>
<dd><p>Return the level.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_dual_elliptic_curve_factor">
<span class="sig-name descname"><span class="pre">modp_dual_elliptic_curve_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_dual_elliptic_curve_factor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the factor of the Brandt module space modulo <span class="math notranslate nohighlight">\(p\)</span>
corresponding to the elliptic curve <span class="math notranslate nohighlight">\(E\)</span>, cut out using
Hecke operators up to <code class="docutils literal notranslate"><span class="pre">bound</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E\)</span> – elliptic curve of conductor equal to the level of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bound</span></code> – positive integer (default: 10)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_dual_elliptic_curve_factor</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">),</span> <span class="n">q</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">V</span>
<span class="go">Vector space of degree 52 and dimension 2 over Ring of integers modulo 3</span>
<span class="go"> Basis matrix: 2 x 52 dense matrix over Ring of integers modulo 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_splitting_data">
<span class="sig-name descname"><span class="pre">modp_splitting_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_splitting_data" title="Permalink to this definition">#</a></dt>
<dd><p>Return mod <span class="math notranslate nohighlight">\(p\)</span> splitting data for the quaternion algebra at the
unramified prime <span class="math notranslate nohighlight">\(p\)</span>.  This is a pair of <span class="math notranslate nohighlight">\(2\times 2\)</span> matrices
<span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span> over the finite field <span class="math notranslate nohighlight">\(\GF{p}\)</span> such that if the
quaternion algebra has generators <span class="math notranslate nohighlight">\(i, j, k\)</span>, then the
homomorphism sending <span class="math notranslate nohighlight">\(i\)</span> to <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(j\)</span> to <span class="math notranslate nohighlight">\(B\)</span> maps any
maximal order homomorphically onto the ring of <span class="math notranslate nohighlight">\(2\times 2\)</span> matrices.</p>
<p>Because of how the homomorphism is defined, we must assume that the
prime <span class="math notranslate nohighlight">\(p\)</span> is odd.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – unramified odd prime</p></li>
</ul>
<p>OUTPUT: A 2-tuple of matrices over finite field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">I</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span>
<span class="go">[ 0 12]</span>
<span class="go">[ 1  0]</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">[7 3]</span>
<span class="go">[3 6]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">^</span><span class="mi">2</span>
<span class="go">[12  0]</span>
<span class="go">[ 0 12]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">^</span><span class="mi">2</span>
<span class="go">[6 0]</span>
<span class="go">[0 6]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">*</span><span class="n">J</span> <span class="o">==</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The following is a good test because of the asserts in the code:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">200</span><span class="p">)]</span>
</pre></div>
</div>
<p>Some edge cases:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[ 0 10]  [6 1]</span>
<span class="go">[ 1  0], [1 5]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Proper error handling:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: p (=7) must be an unramified prime</span>

<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: p must be odd</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_splitting_map">
<span class="sig-name descname"><span class="pre">modp_splitting_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_splitting_map" title="Permalink to this definition">#</a></dt>
<dd><p>Return (algebra) map from the (<span class="math notranslate nohighlight">\(p\)</span>-integral) quaternion algebra to
the set of <span class="math notranslate nohighlight">\(2\times 2\)</span> matrices over <span class="math notranslate nohighlight">\(\GF{p}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – prime number</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_map</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">();</span> <span class="n">B</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="n">k</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="go">[12  3]</span>
<span class="go">[10  5]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">[12  3]</span>
<span class="go">[10  5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.optimal_embeddings">
<span class="sig-name descname"><span class="pre">optimal_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.optimal_embeddings" title="Permalink to this definition">#</a></dt>
<dd><p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – negative fundamental discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – integer coprime</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> – Eichler order</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
<span class="go">[Embedding sending sqrt(-7) to i - j - k,</span>
<span class="go"> Embedding sending sqrt(-7) to -i + j + k]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
<span class="go">[Embedding sending 2*sqrt(-7) to 5*i - k,</span>
<span class="go"> Embedding sending 2*sqrt(-7) to -5*i + k,</span>
<span class="go"> Embedding sending 2*sqrt(-7) to 2*i - 2*j - 2*k,</span>
<span class="go"> Embedding sending 2*sqrt(-7) to -2*i + 2*j + 2*k]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.quadratic_field">
<span class="sig-name descname"><span class="pre">quadratic_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.quadratic_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return our fixed choice of quadratic imaginary field of
discriminant <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – fundamental discriminant</p></li>
</ul>
<p>OUTPUT: A quadratic number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go"> with sqrt_minus_7 = 2.645751311064591?*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.quaternion_algebra">
<span class="sig-name descname"><span class="pre">quaternion_algebra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.quaternion_algebra" title="Permalink to this definition">#</a></dt>
<dd><p>Return the rational quaternion algebra used to implement self.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.rational_kolyvagin_divisor">
<span class="sig-name descname"><span class="pre">rational_kolyvagin_divisor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.rational_kolyvagin_divisor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Kolyvagin divisor as an element of the Brandt module
corresponding to the discriminant <span class="math notranslate nohighlight">\(D\)</span> and conductor <span class="math notranslate nohighlight">\(c\)</span>, which
both must be coprime to <span class="math notranslate nohighlight">\(N\ell\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – discriminant (negative integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – conductor (positive integer)</p></li>
</ul>
<p>OUTPUT: Brandt module element (or tuple of them).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">389</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">rational_kolyvagin_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span> <span class="n">k</span>  <span class="c1"># long time (5s on sage.math, 2013)</span>
<span class="go">(2, 0, 0, 0, 0, 0, 16, 0, 0, 0, 0, 4, 0, 0, 9, 11, 0, 6, 0, 0, 7, 0, 0, 0, 0, 14, 12, 13, 15, 17, 0, 0, 0, 0, 8, 0, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_dual_elliptic_curve_factor</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">),</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>  <span class="c1"># long time</span>
<span class="go">[0, 0]</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">rational_kolyvagin_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">59</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[2, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.right_ideals">
<span class="sig-name descname"><span class="pre">right_ideals</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.right_ideals" title="Permalink to this definition">#</a></dt>
<dd><p>Return representative right ideals in the Brandt module.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="go">(Fractional ideal (2 + 2*j + 28*k, 2*i + 26*k, 4*j + 12*k, 44*k),</span>
<span class="go"> Fractional ideal (2 + 2*j + 28*k, 2*i + 4*j + 38*k, 8*j + 24*k, 88*k))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.satisfies_heegner_hypothesis">
<span class="sig-name descname"><span class="pre">satisfies_heegner_hypothesis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.satisfies_heegner_hypothesis" title="Permalink to this definition">#</a></dt>
<dd><p>The fundamental discriminant <span class="math notranslate nohighlight">\(D\)</span> must be coprime to <span class="math notranslate nohighlight">\(N\ell\)</span>,
and must define a quadratic imaginary field <span class="math notranslate nohighlight">\(K\)</span> in which <span class="math notranslate nohighlight">\(\ell\)</span>
is inert.  Also, all primes dividing <span class="math notranslate nohighlight">\(N\)</span> must split in <span class="math notranslate nohighlight">\(K\)</span>,
and <span class="math notranslate nohighlight">\(c\)</span> must be squarefree and coprime to <span class="math notranslate nohighlight">\(ND\ell\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – negative integer</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – positive integer (default: 1)</p></li>
</ul>
<p>OUTPUT: A boolean.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">.-</span><span class="mi">100</span><span class="p">]</span> <span class="k">if</span> <span class="n">H</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="n">D</span><span class="p">)]</span>
<span class="go">[-8, -39, -43, -51, -79, -95]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">HeegnerQuatAlgEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>The homomorphism <span class="math notranslate nohighlight">\(\mathcal{O} \to R\)</span>, where <span class="math notranslate nohighlight">\(\mathcal{O}\)</span> is the
order of conductor <span class="math notranslate nohighlight">\(c\)</span> in the quadratic field of discriminant <span class="math notranslate nohighlight">\(D\)</span>,
and <span class="math notranslate nohighlight">\(R\)</span> is an Eichler order in a quaternion algebra.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span> <span class="n">f</span>
<span class="go">Embedding sending 2*sqrt(-7) to -5*i + k</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.beta">
<span class="sig-name descname"><span class="pre">beta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.beta" title="Permalink to this definition">#</a></dt>
<dd><p>Return the element <span class="math notranslate nohighlight">\(\beta\)</span> in the quaternion algebra order
that <span class="math notranslate nohighlight">\(c\sqrt{D}\)</span> maps to.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">beta</span><span class="p">()</span>
<span class="go">-5*i + k</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.codomain">
<span class="sig-name descname"><span class="pre">codomain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.codomain" title="Permalink to this definition">#</a></dt>
<dd><p>Return the codomain of this embedding.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -3) with base ring Rational Field</span>
<span class="go"> with basis (1/2 + 1/2*j + 7*k, 1/2*i + 13/2*k, j + 3*k, 11*k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.conjugate">
<span class="sig-name descname"><span class="pre">conjugate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.conjugate" title="Permalink to this definition">#</a></dt>
<dd><p>Return the conjugate of this embedding, which is also an
embedding.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">Embedding sending 2*sqrt(-7) to 5*i - k</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">Embedding sending 2*sqrt(-7) to -5*i + k</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain">
<span class="sig-name descname"><span class="pre">domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain" title="Permalink to this definition">#</a></dt>
<dd><p>Return the domain of this embedding.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Order in Number Field in a with defining polynomial x^2 + 7</span>
<span class="go"> with a = 2.645751311064591?*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain_conductor">
<span class="sig-name descname"><span class="pre">domain_conductor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain_conductor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the conductor of the domain.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain_conductor</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain_gen">
<span class="sig-name descname"><span class="pre">domain_gen</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain_gen" title="Permalink to this definition">#</a></dt>
<dd><p>Return the specific generator <span class="math notranslate nohighlight">\(c \sqrt{D}\)</span> for the domain
order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">domain_gen</span><span class="p">()</span>
<span class="go">2*a</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">domain_gen</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-28</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.matrix">
<span class="sig-name descname"><span class="pre">matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return matrix over <span class="math notranslate nohighlight">\(\QQ\)</span> of this morphism, with respect to the
basis 1, <span class="math notranslate nohighlight">\(c\sqrt{D}\)</span> of the domain and the basis <span class="math notranslate nohighlight">\(1,i,j,k\)</span> of
the ambient rational quaternion algebra (which contains the
domain).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span> <span class="n">f</span>
<span class="go">Embedding sending sqrt(-7) to -i + j + k</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 1  0  0  0]</span>
<span class="go">[ 0 -1  1  1]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 1  0  0  0]</span>
<span class="go">[ 0  1 -1 -1]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">KolyvaginCohomologyClass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kolyvagin_point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>A Kolyvagin cohomology class in <span class="math notranslate nohighlight">\(H^1(K,E[n])\)</span> or <span class="math notranslate nohighlight">\(H^1(K,E)[n]\)</span>
attached to a Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">c</span>
<span class="go">Kolyvagin cohomology class c(1) in H^1(K,E[3])</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClassEn&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="o">==</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Kolyvagin cohomology class c(1) in H^1(K,E[5])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.conductor">
<span class="sig-name descname"><span class="pre">conductor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.conductor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the integer <span class="math notranslate nohighlight">\(c\)</span> such that this cohomology class is associated
to the Heegner point <span class="math notranslate nohighlight">\(y_c\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.heegner_point">
<span class="sig-name descname"><span class="pre">heegner_point</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.heegner_point" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Heegner point <span class="math notranslate nohighlight">\(y_c\)</span> to which this cohomology class
is associated.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">()</span>
<span class="go">Heegner point of discriminant -7 and conductor 5</span>
<span class="go"> on elliptic curve of conductor 37</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.kolyvagin_point">
<span class="sig-name descname"><span class="pre">kolyvagin_point</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.kolyvagin_point" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Kolyvagin point <span class="math notranslate nohighlight">\(P_c\)</span> to which this cohomology
class is associated.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="go">Kolyvagin point of discriminant -7 and conductor 5</span>
<span class="go"> on elliptic curve of conductor 37</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.n">
<span class="sig-name descname"><span class="pre">n</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.n" title="Permalink to this definition">#</a></dt>
<dd><p>Return the integer <span class="math notranslate nohighlight">\(n\)</span> so that this is a cohomology class in
<span class="math notranslate nohighlight">\(H^1(K,E[n])\)</span> or <span class="math notranslate nohighlight">\(H^1(K,E)[n]\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">t</span>
<span class="go">Kolyvagin cohomology class c(1) in H^1(K,E[3])</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClassEn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">KolyvaginCohomologyClassEn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kolyvagin_point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClassEn" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass" title="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">KolyvaginCohomologyClass</span></code></a></p>
<p>EXAMPLES:</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">KolyvaginPoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">heegner_point</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint" title="sage.schemes.elliptic_curves.heegner.HeegnerPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeegnerPoint</span></code></a></p>
<p>A Kolyvagin point.</p>
<p>EXAMPLES:</p>
<p>We create a few Kolyvagin points:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Kolyvagin point of discriminant -7 on elliptic curve of conductor 11</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Kolyvagin point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">)</span>
<span class="go">Kolyvagin point of discriminant -67 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">Kolyvagin point of discriminant -7 and conductor 5</span>
<span class="go"> on elliptic curve of conductor 389</span>
</pre></div>
</div>
<p>One can also associated a Kolyvagin point to a Heegner point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">y</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="go">Kolyvagin point of discriminant -7 on elliptic curve of conductor 37</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.curve">
<span class="sig-name descname"><span class="pre">curve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.curve" title="Permalink to this definition">#</a></dt>
<dd><p>Return the elliptic curve over <span class="math notranslate nohighlight">\(\QQ\)</span> on which this Kolyvagin
point sits.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.heegner_point">
<span class="sig-name descname"><span class="pre">heegner_point</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.heegner_point" title="Permalink to this definition">#</a></dt>
<dd><p>This Kolyvagin point <span class="math notranslate nohighlight">\(P_c\)</span> is associated to some Heegner point
<span class="math notranslate nohighlight">\(y_c\)</span> via Kolyvagin’s construction.  This function returns that
point <span class="math notranslate nohighlight">\(y_c\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -67 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">();</span> <span class="n">y</span>
<span class="go">Heegner point of discriminant -67 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span> <span class="ow">is</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.index" title="Permalink to this definition">#</a></dt>
<dd><p>Return index of this Kolyvagin point in the full group of
<span class="math notranslate nohighlight">\(K_c\)</span> rational points on <span class="math notranslate nohighlight">\(E\)</span>.</p>
<p>When the conductor is 1, this is computed numerically using
the Gross-Zagier formula and explicit point search, and it may
be off by <span class="math notranslate nohighlight">\(2\)</span>. See the documentation for <code class="docutils literal notranslate"><span class="pre">E.heegner_index</span></code>,
where <span class="math notranslate nohighlight">\(E\)</span> is the curve attached to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">);</span> <span class="n">P</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.kolyvagin_cohomology_class">
<span class="sig-name descname"><span class="pre">kolyvagin_cohomology_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.kolyvagin_cohomology_class" title="Permalink to this definition">#</a></dt>
<dd><p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> – positive integer that divides the gcd of <span class="math notranslate nohighlight">\(a_p\)</span>
and <span class="math notranslate nohighlight">\(p+1\)</span> for all <span class="math notranslate nohighlight">\(p\)</span> dividing the conductor.  If <span class="math notranslate nohighlight">\(n\)</span> is
<code class="docutils literal notranslate"><span class="pre">None</span></code>, choose the largest valid <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Kolyvagin cohomology class c(5) in H^1(K,E[3])</span>

<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">()</span>
<span class="go">Kolyvagin cohomology class c(5) in H^1(K,E[2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.mod">
<span class="sig-name descname"><span class="pre">mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.mod" title="Permalink to this definition">#</a></dt>
<dd><p>Return the trace of the reduction <span class="math notranslate nohighlight">\(Q\)</span> modulo a prime over <span class="math notranslate nohighlight">\(p\)</span> of this
Kolyvagin point as an element of <span class="math notranslate nohighlight">\(E(\GF{p})\)</span>, where
<span class="math notranslate nohighlight">\(p\)</span> is any prime that is inert in <span class="math notranslate nohighlight">\(K\)</span> that is coprime to <span class="math notranslate nohighlight">\(NDc\)</span>.</p>
<p>The point <span class="math notranslate nohighlight">\(Q\)</span> is only well defined up to an element of
<span class="math notranslate nohighlight">\((p+1) E(\GF{p})\)</span>, i.e., it gives a well defined element
of the abelian group <span class="math notranslate nohighlight">\(E(\GF{p}) / (p+1) E(\GF{p})\)</span>.</p>
<p>See <a class="reference internal" href="../../../../references/index.html#st2011b" id="id2"><span>[St2011b]</span></a>, Proposition 5.4 for a proof of the above
well-definedness assertion.</p>
<p>EXAMPLES:</p>
<p>A Kolyvagin point on a rank 1 curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(2 : 2 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(6 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">trace_to_real_numerical</span><span class="p">()</span>
<span class="go">(1.61355529131986 : -2.18446840788880 : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">_trace_exact_conductor_1</span><span class="p">()</span>  <span class="c1"># the actual point we&#39;re reducing</span>
<span class="go">(1357/841 : -53277/24389 : 1)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">_trace_exact_conductor_1</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="n">E</span><span class="o">.</span><span class="n">regulator</span><span class="p">())</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">12.0000000000000</span>
</pre></div>
</div>
<p>Here the Kolyvagin point is a torsion point (since <span class="math notranslate nohighlight">\(E\)</span> has
rank 1), and we reduce it modulo several primes.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>  <span class="c1"># long time (4s on sage.math, 2013)</span>
<span class="go">(1 : 2 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="go">(1 : 4 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: p must be coprime to conductors and discriminant</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: p must be coprime to conductors and discriminant</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="go">(3 : 4 : 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.numerical_approx">
<span class="sig-name descname"><span class="pre">numerical_approx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.numerical_approx" title="Permalink to this definition">#</a></dt>
<dd><p>Return a numerical approximation to this Kolyvagin point using
prec bits of working precision.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – precision in bits (default: 53)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span> <span class="c1"># approx. (0 : 0 : 1)</span>
<span class="go">(...e-16 - ...e-16*I : ...e-16 + ...e-16*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">100</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="o">^-</span><span class="mi">99</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -7 and conductor 5</span>
<span class="go"> on elliptic curve of conductor 389</span>
</pre></div>
</div>
<p>Numerical approximation is only implemented for points of conductor 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Plot a Kolyvagin point <span class="math notranslate nohighlight">\(P_1\)</span> if it is defined over the
rational numbers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pointsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">E</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>              <span class="c1"># optional - sage.plot</span>
<span class="go">Graphics object consisting of 3 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.point_exact">
<span class="sig-name descname"><span class="pre">point_exact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.point_exact" title="Permalink to this definition">#</a></dt>
<dd><p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – precision in bits (default: 53)</p></li>
</ul>
<p>EXAMPLES:</p>
<p>A rank 1 curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">()</span>
<span class="go">(6 : -15 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="go">(6 : -15 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">RuntimeError: insufficient precision to find exact point</span>
</pre></div>
</div>
<p>A rank 0 curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">()</span>
<span class="go">(-1/2*sqrt_minus_7 + 1/2 : -2*sqrt_minus_7 - 2 : 1)</span>
</pre></div>
</div>
<p>A rank 2 curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">()</span>
<span class="go">(0 : 1 : 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.satisfies_kolyvagin_hypothesis">
<span class="sig-name descname"><span class="pre">satisfies_kolyvagin_hypothesis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.satisfies_kolyvagin_hypothesis" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if this Kolyvagin point satisfies the Heegner
hypothesis for <span class="math notranslate nohighlight">\(n\)</span>, so that it defines a Galois equivariant
element of <span class="math notranslate nohighlight">\(E(K_c)/n E(K_c)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Kolyvagin cohomology class c(5) in H^1(K,E[3])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.trace_to_real_numerical">
<span class="sig-name descname"><span class="pre">trace_to_real_numerical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.trace_to_real_numerical" title="Permalink to this definition">#</a></dt>
<dd><p>Return the trace of this Kolyvagin point down to the real
numbers, computed numerically using prec bits of working
precision.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">PP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">PP</span><span class="p">]</span>
<span class="go">[6.00000000000000, -15.0000000000000, 1.00000000000000]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1e-14</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">PP</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">trace_to_real_numerical</span><span class="p">()</span>
<span class="go">(1.61355529131986 : -2.18446840788880 : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">trace_to_real_numerical</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>  <span class="c1"># abs tol 1e-21</span>
<span class="go">(1.6135552913198573127230 : -2.1844684078888023289187 : 1.0000000000000000000000)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">RingClassField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>A Ring class field of a quadratic imaginary field of given conductor.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a <em>ring</em> class field, not a ray class field. In
general, the ring class field of given conductor is a subfield
of the ray class field of the same conductor.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="go">Hilbert class field of QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">55</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 55</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField.absolute_degree">
<span class="sig-name descname"><span class="pre">absolute_degree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.absolute_degree" title="Permalink to this definition">#</a></dt>
<dd><p>Return the absolute degree of this field over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField.conductor">
<span class="sig-name descname"><span class="pre">conductor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.conductor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the conductor of this ring class field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K5</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K5</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_H">
<span class="sig-name descname"><span class="pre">degree_over_H</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_H" title="Permalink to this definition">#</a></dt>
<dd><p>Return the degree of this field over the Hilbert class field <span class="math notranslate nohighlight">\(H\)</span> of <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">59</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">59</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">59</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Some examples in which prime dividing c is inert:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">36</span>
</pre></div>
</div>
<p>The prime dividing c is split.  For example, in the first case
<span class="math notranslate nohighlight">\(O_K/cO_K\)</span> is isomorphic to a direct sum of two copies of
<code class="docutils literal notranslate"><span class="pre">GF(2)</span></code>, so the units are trivial:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Now c is ramified:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">49</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://github.com/sagemath/sage/issues/15218">github issue #15218</a> is solved:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;19a&quot;</span><span class="p">);</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">domain</span><span class="p">();</span> <span class="n">H</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_K">
<span class="sig-name descname"><span class="pre">degree_over_K</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_K" title="Permalink to this definition">#</a></dt>
<dd><p>Return the relative degree of this ring class field over the
quadratic imaginary field <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">();</span> <span class="n">K5</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">K5</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">K5</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">())</span>
<span class="go">&lt;... &#39;sage.rings.integer.Integer&#39;&gt;</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">24</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_Q">
<span class="sig-name descname"><span class="pre">degree_over_Q</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_Q" title="Permalink to this definition">#</a></dt>
<dd><p>Return the absolute degree of this field over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField.discriminant_of_K">
<span class="sig-name descname"><span class="pre">discriminant_of_K</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.discriminant_of_K" title="Permalink to this definition">#</a></dt>
<dd><p>Return the discriminant of the quadratic imaginary field <span class="math notranslate nohighlight">\(K\)</span> contained in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K5</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K5</span><span class="o">.</span><span class="n">discriminant_of_K</span><span class="p">()</span>
<span class="go">-7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField.galois_group">
<span class="sig-name descname"><span class="pre">galois_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base=Rational</span> <span class="pre">Field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.galois_group" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Galois group of <code class="docutils literal notranslate"><span class="pre">self</span></code> over base.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base</span></code> – (default: <span class="math notranslate nohighlight">\(\QQ\)</span>) a subfield of <code class="docutils literal notranslate"><span class="pre">self</span></code> or <span class="math notranslate nohighlight">\(\QQ\)</span></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="go"> over Hilbert class field of QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 15</span>
<span class="go"> over Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField.is_subfield">
<span class="sig-name descname"><span class="pre">is_subfield</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.is_subfield" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if this ring class field is a subfield of the ring class field <span class="math notranslate nohighlight">\(M\)</span>.
If <span class="math notranslate nohighlight">\(M\)</span> is not a ring class field, then a TypeError is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField.quadratic_field">
<span class="sig-name descname"><span class="pre">quadratic_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.quadratic_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the quadratic imaginary field <span class="math notranslate nohighlight">\(K = \QQ(\sqrt{D})\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="go"> with sqrt_minus_7 = 2.645751311064591?*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.RingClassField.ramified_primes">
<span class="sig-name descname"><span class="pre">ramified_primes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.ramified_primes" title="Permalink to this definition">#</a></dt>
<dd><p>Return the primes of <span class="math notranslate nohighlight">\(\ZZ\)</span> that ramify in this ring class field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K55</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">55</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K55</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[5, 7, 11]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[7]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.class_number">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">class_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.class_number" title="Permalink to this definition">#</a></dt>
<dd><p>Return the class number of the quadratic field with fundamental
discriminant <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="o">-</span><span class="mi">163</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>A <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></a> is raised when <span class="math notranslate nohighlight">\(D\)</span> is not a fundamental
discriminant:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: D (=-5) must be a fundamental discriminant</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.ell_heegner_discriminants">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">ell_heegner_discriminants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.ell_heegner_discriminants" title="Permalink to this definition">#</a></dt>
<dd><p>Return the list of self’s Heegner discriminants between -1 and
-bound.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bound</span> <span class="pre">(int)</span></code> – upper bound for -discriminant</p></li>
</ul>
<p>OUTPUT: The list of Heegner discriminants between -1 and -bound for
the given elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>                     <span class="c1"># indirect doctest</span>
<span class="go">[-7, -8, -19, -24]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.ell_heegner_discriminants_list">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">ell_heegner_discriminants_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.ell_heegner_discriminants_list" title="Permalink to this definition">#</a></dt>
<dd><p>Return the list of self’s first <span class="math notranslate nohighlight">\(n\)</span> Heegner discriminants smaller
than -5.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">(int)</span></code> – the number of discriminants to compute</p></li>
</ul>
<p>OUTPUT: The list of the first n Heegner discriminants smaller than
-5 for the given elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>                     <span class="c1"># indirect doctest</span>
<span class="go">[-7, -8, -19, -24]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.ell_heegner_point">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">ell_heegner_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.ell_heegner_point" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the Heegner point on this curve associated to the
quadratic imaginary field <span class="math notranslate nohighlight">\(K=\QQ(\sqrt{D})\)</span>.</p>
<p>If the optional parameter <span class="math notranslate nohighlight">\(c\)</span> is given, returns the higher Heegner
point associated to the order of conductor <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span>        – a Heegner discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span>        – (default: 1) conductor, must be coprime to <span class="math notranslate nohighlight">\(DN\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span>        – binary quadratic form or 3-tuple <span class="math notranslate nohighlight">\((A,B,C)\)</span> of coefficients
of <span class="math notranslate nohighlight">\(AX^2 + BXY + CY^2\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code>  – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
<p>OUTPUT: The Heegner point <span class="math notranslate nohighlight">\(y_c\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[-7, -11, -40, -47, -67, -71, -83, -84, -95, -104]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>                          <span class="c1"># indirect doctest</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">();</span> <span class="n">z</span> <span class="o">==</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="ow">or</span> <span class="o">-</span><span class="n">z</span> <span class="o">==</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">point_exact</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(a : -a + 1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">47</span><span class="p">)</span><span class="o">.</span><span class="n">point_exact</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(a : a^4 + a - 1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Number Field in a with defining polynomial x^5 - x^4 + x^3 + x^2 - 2*x + 1</span>
</pre></div>
</div>
<p>Working out the details manually:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">47</span><span class="p">)</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^5 - x^4 + x^3 + x^2 - 2*x + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">47^2</span>
</pre></div>
</div>
<p>The Heegner hypothesis is checked:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: N (=389) and D (=-5) must satisfy the Heegner hypothesis</span>
</pre></div>
</div>
<p>We can specify the quadratic form:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">778</span><span class="p">,</span><span class="mi">925</span><span class="p">,</span><span class="mi">275</span><span class="p">));</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5</span>
<span class="go"> on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">778*x^2 + 925*x*y + 275*y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.heegner_index">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">heegner_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descent_second_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_mwrank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_index" title="Permalink to this definition">#</a></dt>
<dd><p>Return an interval that contains the index of the Heegner
point <span class="math notranslate nohighlight">\(y_K\)</span> in the group of <span class="math notranslate nohighlight">\(K\)</span>-rational points modulo torsion
on this elliptic curve, computed using the Gross-Zagier
formula and/or a point search, or possibly half the index
if the rank is greater than one.</p>
<p>If the curve has rank &gt; 1, then the returned index is infinity.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">min_p</span></code> is bigger than 2 then the index can be off by
any prime less than <code class="docutils literal notranslate"><span class="pre">min_p</span></code>. This function returns the
index divided by <span class="math notranslate nohighlight">\(2\)</span> exactly when the rank of <span class="math notranslate nohighlight">\(E(K)\)</span> is
greater than 1 and <span class="math notranslate nohighlight">\(E(\QQ)_{/tor} \oplus E^D(\QQ)_{/tor}\)</span>
has index <span class="math notranslate nohighlight">\(2\)</span> in <span class="math notranslate nohighlight">\(E(K)_{/tor}\)</span>, where the second factor
undergoes a twist.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span> <span class="pre">(int)</span></code> – Heegner discriminant</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_p</span> <span class="pre">(int)</span></code> – (default: 2) only rule out primes
= min_p dividing the index.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose_mwrank</span> <span class="pre">(bool)</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); print lots of
mwrank search status information when computing regulator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span> <span class="pre">(int)</span></code> – (default: 5), use prec*sqrt(N) +
20 terms of L-series in computations, where N is the conductor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">descent_second_limit</span></code> – (default: 12)- used in 2-descent
when computing regulator of the twist</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_rank</span></code> – whether to check if the rank is at least 2 by
computing the Mordell-Weil rank directly.</p></li>
</ul>
<p>OUTPUT: an interval that contains the index, or half the index</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="go">[-7, -8, -19, -24, -35, -39, -40, -43]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1.00000?</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[-3, -4, -7, -11, -40, -47, -67, -71, -83, -84, -95]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">95</span><span class="p">)</span>          <span class="c1"># long time (1 second)</span>
<span class="go">2.00000?</span>
</pre></div>
</div>
<p>This tests doing direct computation of the Mordell-Weil group.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;675b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="go">3.0000?</span>
</pre></div>
</div>
<p>Currently discriminants -3 and -4 are not supported:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: Discriminant (=-3) must not be -3 or -4.</span>
</pre></div>
</div>
<p>The curve 681b returns the true index, which is <span class="math notranslate nohighlight">\(3\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;681b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">);</span> <span class="n">I</span>
<span class="go">3.0000?</span>
</pre></div>
</div>
<p>In fact, whenever the returned index has a denominator of
<span class="math notranslate nohighlight">\(2\)</span>, the true index is got by multiplying the returned
index by <span class="math notranslate nohighlight">\(2\)</span>. Unfortunately, this is not an if and only if
condition, i.e., sometimes the index must be multiplied by
<span class="math notranslate nohighlight">\(2\)</span> even though the denominator is not <span class="math notranslate nohighlight">\(2\)</span>.</p>
<p>This example demonstrates the <code class="docutils literal notranslate"><span class="pre">descent_second_limit</span></code> option,
which can be used to fine tune the 2-descent used to compute
the regulator of the twist:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1228</span><span class="p">,</span><span class="o">-</span><span class="mi">16267</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">RuntimeError: ...</span>
</pre></div>
</div>
<p>However when we search higher, we find the points we need:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="n">descent_second_limit</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">check_rank</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">2.00000?</span>
</pre></div>
</div>
<p>Two higher rank examples (of ranks 2 and 3):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="n">check_rank</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0.001?</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="n">check_rank</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.heegner_index_bound">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">heegner_index_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_index_bound" title="Permalink to this definition">#</a></dt>
<dd><p>Assume <code class="docutils literal notranslate"><span class="pre">self</span></code> has rank 0.</p>
<p>Return a list <span class="math notranslate nohighlight">\(v\)</span> of primes such that if an odd prime <span class="math notranslate nohighlight">\(p\)</span> divides
the index of the Heegner point in the group of rational points
modulo torsion, then <span class="math notranslate nohighlight">\(p\)</span> is in <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>If 0 is in the interval of the height of the Heegner point
computed to the given prec, then this function returns <span class="math notranslate nohighlight">\(v =
0\)</span>. This does not mean that the Heegner point is torsion, just
that it is very likely torsion.</p>
<p>If we obtain no information from a search up to <code class="docutils literal notranslate"><span class="pre">max_height</span></code>,
e.g., if the Siksek et al. bound is bigger than <code class="docutils literal notranslate"><span class="pre">max_height</span></code>,
then we return <span class="math notranslate nohighlight">\(v = -1\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span> <span class="pre">(int)</span></code> – (default: 0) Heegner discriminant; if
0, use the first discriminant -4 that satisfies the Heegner
hypothesis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">(bool)</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span> <span class="pre">(int)</span></code> – (default: 5), use <span class="math notranslate nohighlight">\(prec \cdot \sqrt(N) + 20\)</span>
terms of <span class="math notranslate nohighlight">\(L\)</span>-series in computations, where <span class="math notranslate nohighlight">\(N\)</span> is the conductor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_height</span> <span class="pre">(float)</span></code> – should be = 21; bound on
logarithmic naive height used in point searches. Make smaller to
make this function faster, at the expense of possibly obtaining a
worse answer. A good range is between 13 and 21.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – list or int (bad primes or 0 or -1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> – the discriminant that was used (this is
useful if <span class="math notranslate nohighlight">\(D\)</span> was automatically selected).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exact</span></code> – either False, or the exact Heegner index
(up to factors of 2)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index_bound</span><span class="p">()</span>
<span class="go">([2], -7, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.heegner_point">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">heegner_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_point" title="Permalink to this definition">#</a></dt>
<dd><p>Return a specific Heegner point of level <span class="math notranslate nohighlight">\(N\)</span> with given
discriminant and conductor.  If <span class="math notranslate nohighlight">\(D\)</span> is not specified, then the
first valid Heegner discriminant is used.  If <span class="math notranslate nohighlight">\(c\)</span> is not given,
then <span class="math notranslate nohighlight">\(c=1\)</span> is used.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> – level (positive integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> – discriminant (optional: default first valid <span class="math notranslate nohighlight">\(D\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – conductor (positive integer, optional, default: 1)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">Heegner point 1/778*sqrt(-7) - 185/778 of discriminant -7 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Heegner point 1/778*sqrt(-7) - 185/778 of discriminant -7 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Heegner point 5/778*sqrt(-7) - 147/778 of discriminant -7 and conductor 5 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="go">Heegner point 1/778*sqrt(-20) - 165/389 of discriminant -20 on X_0(389)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.heegner_point_height">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">heegner_point_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_point_height" title="Permalink to this definition">#</a></dt>
<dd><p>Use the Gross-Zagier formula to compute the Neron-Tate canonical
height over <span class="math notranslate nohighlight">\(K\)</span> of the Heegner point corresponding to <span class="math notranslate nohighlight">\(D\)</span>, as an
interval (it is computed to some precision using <span class="math notranslate nohighlight">\(L\)</span>-functions).</p>
<p>If the curve has rank at least 2, then the returned height is the
exact Sage integer 0.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span> <span class="pre">(int)</span></code> – fundamental discriminant (=/= -3, -4)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span> <span class="pre">(int)</span></code> – (default: 2), use <span class="math notranslate nohighlight">\(prec \cdot \sqrt(N) + 20\)</span>
terms of <span class="math notranslate nohighlight">\(L\)</span>-series in computations, where <span class="math notranslate nohighlight">\(N\)</span> is the
conductor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_rank</span></code> – whether to check if the rank is at least 2 by
computing the Mordell-Weil rank directly.</p></li>
</ul>
<p>OUTPUT: Interval that contains the height of the Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point_height</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0.22227?</span>
</pre></div>
</div>
<p>Some higher rank examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point_height</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point_height</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point_height</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="n">check_rank</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0.0000?</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.heegner_points">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">heegner_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_points" title="Permalink to this definition">#</a></dt>
<dd><p>Return all Heegner points of given level <span class="math notranslate nohighlight">\(N\)</span>.  Can also restrict
to Heegner points with specified discriminant <span class="math notranslate nohighlight">\(D\)</span> and optionally
conductor <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> – level (positive integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> – discriminant (negative integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – conductor (positive integer)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Set of all Heegner points on X_0(389) associated to QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">All Heegner points of conductor 1 on X_0(389) associated to QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">All Heegner points of conductor 5 on X_0(389) associated to QQ[sqrt(-7)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.heegner_sha_an">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">heegner_sha_an</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_sha_an" title="Permalink to this definition">#</a></dt>
<dd><p>Return the conjectural (analytic) order of Sha for E over the field <span class="math notranslate nohighlight">\(K=\QQ(\sqrt{D})\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – negative integer; the Heegner discriminant</p></li>
<li><p>prec – integer (default: 53); bits of precision to
compute analytic order of Sha</p></li>
</ul>
<p>OUTPUT:</p>
<p>(floating point number) an approximation to the conjectural order of Sha.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Often you’ll want to do <code class="docutils literal notranslate"><span class="pre">proof.elliptic_curve(False)</span></code> when
using this function, since often the twisted elliptic
curves that come up have enormous conductor, and Sha is
nontrivial, which makes provably finding the Mordell-Weil
group using 2-descent difficult.</p>
</div>
<p>EXAMPLES:</p>
<p>An example where E has conductor 11:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>                                  <span class="c1"># long time</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
<p>The cache works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span> <span class="ow">is</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>          <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Lower precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>                               <span class="c1"># long time</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>Checking that the cache works for any precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="ow">is</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>    <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Next we consider a rank 1 curve with nontrivial Sha over the
quadratic imaginary field <span class="math notranslate nohighlight">\(K\)</span>; however, there is no Sha for <span class="math notranslate nohighlight">\(E\)</span>
over <span class="math notranslate nohighlight">\(\QQ\)</span> or for the quadratic twist of <span class="math notranslate nohighlight">\(E\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span>                                 <span class="c1"># long time</span>
<span class="go">4.00000000000000</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>                     <span class="c1"># long time</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>                                          <span class="c1"># long time</span>
<span class="go">1</span>
</pre></div>
</div>
<p>A rank 2 curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>                             <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>                                  <span class="c1"># long time</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
<p>If we remove the hypothesis that <span class="math notranslate nohighlight">\(E(K)\)</span> has rank 1 in Conjecture
2.3 in <a class="reference internal" href="../../../../references/index.html#gz1986" id="id3"><span>[GZ1986]</span></a> page 311, then that conjecture is
false, as the following example shows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;65a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">56</span><span class="p">)</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="o">-</span><span class="mi">56</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.is_inert">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">is_inert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.is_inert" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if p is an inert prime in the field <span class="math notranslate nohighlight">\(\QQ(\sqrt{D})\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – fundamental discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – prime integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_inert</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_inert</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_inert</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.is_kolyvagin_conductor">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">is_kolyvagin_conductor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.is_kolyvagin_conductor" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <span class="math notranslate nohighlight">\(c\)</span> is a Kolyvagin conductor for level <span class="math notranslate nohighlight">\(N\)</span>,
discriminant <span class="math notranslate nohighlight">\(D\)</span>, mod <span class="math notranslate nohighlight">\(n\)</span>, etc., i.e., <span class="math notranslate nohighlight">\(c\)</span> is divisible by exactly
<span class="math notranslate nohighlight">\(r\)</span> prime factors, is coprime to <span class="math notranslate nohighlight">\(ND\)</span>, each prime dividing <span class="math notranslate nohighlight">\(c\)</span> is
inert, and if <span class="math notranslate nohighlight">\(E\)</span> is not <code class="docutils literal notranslate"><span class="pre">None</span></code> then <span class="math notranslate nohighlight">\(n | \gcd(p+1, a_p(E))\)</span>
for each prime <span class="math notranslate nohighlight">\(p\)</span> dividing <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> – level (positive integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(E\)</span> – elliptic curve or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> – negative fundamental discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(r\)</span> – number of prime factors (nonnegative integer) or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> – torsion order (i.e., do we get class in <span class="math notranslate nohighlight">\((E(K_c)/n E(K_c))^{Gal(K_c/K)}\)</span>?)</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – conductor (positive integer)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.heegner</span> <span class="kn">import</span> <span class="n">is_kolyvagin_conductor</span>
<span class="gp">sage: </span><span class="n">is_kolyvagin_conductor</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_kolyvagin_conductor</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_kolyvagin_conductor</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_kolyvagin_conductor</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">),</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_kolyvagin_conductor</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">),</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.is_ramified">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">is_ramified</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.is_ramified" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if p is a ramified prime in the field <span class="math notranslate nohighlight">\(\QQ(\sqrt{D})\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – fundamental discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – prime integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_ramified</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_ramified</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_ramified</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.is_split">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">is_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.is_split" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if p is a split prime in the field <span class="math notranslate nohighlight">\(\QQ(\sqrt{D})\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – fundamental discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – prime integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_split</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_split</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_split</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.kolyvagin_point">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">kolyvagin_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.kolyvagin_point" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Kolyvagin point on this curve associated to the
quadratic imaginary field <span class="math notranslate nohighlight">\(K=\QQ(\sqrt{D})\)</span> and conductor <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span>        – a Heegner discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span>        – (default: 1) conductor, must be coprime to <span class="math notranslate nohighlight">\(DN\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code>  – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
<p>OUTPUT: The Kolyvagin point <span class="math notranslate nohighlight">\(P\)</span> of conductor <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -67 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">(6.00000000000000 : -15.0000000000000 : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># a generator</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">g</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mi">6</span><span class="o">*</span><span class="n">g</span>
<span class="go">(6 : -15 : 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.kolyvagin_reduction_data">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">kolyvagin_reduction_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.kolyvagin_reduction_data" title="Permalink to this definition">#</a></dt>
<dd><p>Given an elliptic curve of positive rank and a prime <span class="math notranslate nohighlight">\(q\)</span>, this
function returns data about how to use Kolyvagin’s <span class="math notranslate nohighlight">\(q\)</span>-torsion
Heegner point Euler system to do computations with this curve.
See the precise description of the output below.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E\)</span> – elliptic curve over <span class="math notranslate nohighlight">\(\QQ\)</span> of rank 1 or 2</p></li>
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(q\)</span> – an odd prime that does not divide the order of the</dt><dd><p>rational torsion subgroup of <span class="math notranslate nohighlight">\(E\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">first_only</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) whether two only return</dt><dd><p>the first prime that one can work modulo to get data about
the Euler system</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT in the rank 1 case or when the default flag <code class="docutils literal notranslate"><span class="pre">first_only=True</span></code>:</p>
<ul class="simple">
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(\ell\)</span> – first good odd prime satisfying the Kolyvagin</dt><dd><p>condition that <span class="math notranslate nohighlight">\(q\)</span> divides gcd(a_{ell},ell+1)` and the
reduction map is surjective to <span class="math notranslate nohighlight">\(E(\GF{\ell}) / q
E(\GF{\ell})\)</span></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(D\)</span> – discriminant of the first quadratic imaginary field</dt><dd><p><span class="math notranslate nohighlight">\(K\)</span> that satisfies the Heegner hypothesis for <span class="math notranslate nohighlight">\(E\)</span> such that
both <span class="math notranslate nohighlight">\(\ell\)</span> is inert in <span class="math notranslate nohighlight">\(K\)</span>, and the twist <span class="math notranslate nohighlight">\(E^D\)</span> has analytic
rank <span class="math notranslate nohighlight">\(\leq 1\)</span></p>
</dd>
</dl>
</li>
<li><p><span class="math notranslate nohighlight">\(h_D\)</span> – the class number of <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p>the dimension of the Brandt module <span class="math notranslate nohighlight">\(B(\ell,N)\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is
the conductor of <span class="math notranslate nohighlight">\(E\)</span></p></li>
</ul>
<p>OUTPUT in the rank 2 case:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\ell_1\)</span> – first prime (as above in the rank 1 case) where
reduction map is surjective</p></li>
<li><p><span class="math notranslate nohighlight">\(\ell_2\)</span> – second prime (as above) where reduction map is
surjective</p></li>
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(D\)</span> – discriminant of the first quadratic imaginary field</dt><dd><p><span class="math notranslate nohighlight">\(K\)</span> that satisfies the Heegner hypothesis for <span class="math notranslate nohighlight">\(E\)</span> such that
both <span class="math notranslate nohighlight">\(\ell_1\)</span> and <span class="math notranslate nohighlight">\(\ell_2\)</span> are simultaneously inert in <span class="math notranslate nohighlight">\(K\)</span>,
and the twist <span class="math notranslate nohighlight">\(E^D\)</span> has analytic rank <span class="math notranslate nohighlight">\(\leq 1\)</span></p>
</dd>
</dl>
</li>
<li><p><span class="math notranslate nohighlight">\(h_D\)</span> – the class number of <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p>the dimension of the Brandt module <span class="math notranslate nohighlight">\(B(\ell_1,N)\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is
the conductor of <span class="math notranslate nohighlight">\(E\)</span></p></li>
<li><p>the dimension of the Brandt module <span class="math notranslate nohighlight">\(B(\ell_2,N)\)</span></p></li>
</ul>
<p>EXAMPLES:</p>
<p>Import this function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.heegner</span> <span class="kn">import</span> <span class="n">kolyvagin_reduction_data</span>
</pre></div>
</div>
<p>A rank 1 example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">(17, -7, 1, 52)</span>
</pre></div>
</div>
<p>A rank 3 example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">(11, -47, 5, 4234)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">5077</span><span class="p">,</span> <span class="o">-</span><span class="mi">47</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">....: </span>   <span class="k">if</span> <span class="n">c</span> <span class="o">%</span> <span class="mi">11</span><span class="p">]</span>
<span class="go">[667, 943, 1189, 2461]</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">667</span><span class="p">)</span>
<span class="go">23 * 29</span>
</pre></div>
</div>
<p>A rank 4 example (the first Kolyvagin class that we could try to
compute would be <span class="math notranslate nohighlight">\(P_{23\cdot 29\cdot 41}\)</span>, and would require
working in a space of dimension 293060 (so prohibitive at
present):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">elliptic_curves</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>              <span class="c1"># long time</span>
<span class="go">(11, -71, 7, 293060)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">293060</span><span class="p">,</span> <span class="o">-</span><span class="mi">71</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[11, 17, 23, 41]</span>
</pre></div>
</div>
<p>The first rank 2 example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">(5, -7, 1, 130)</span>
<span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(5, 17, -7, 1, 130, 520)</span>
</pre></div>
</div>
<p>A large <span class="math notranslate nohighlight">\(q = 7\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;1143c1&#39;</span><span class="p">),</span> <span class="mi">7</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(13, 83, -59, 3, 1536, 10496)</span>
</pre></div>
</div>
<p>Additive reduction:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;2350g1&#39;</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(19, 239, -311, 19, 6480, 85680)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.make_monic">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">make_monic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.make_monic" title="Permalink to this definition">#</a></dt>
<dd><p>Return a monic integral polynomial <span class="math notranslate nohighlight">\(g\)</span> and an integer <span class="math notranslate nohighlight">\(d\)</span> such
that if <span class="math notranslate nohighlight">\(\alpha\)</span> is a root of <span class="math notranslate nohighlight">\(g\)</span>, then <span class="math notranslate nohighlight">\(\alpha/d\)</span> is a root of <span class="math notranslate nohighlight">\(f\)</span>.
In other words, <span class="math notranslate nohighlight">\(c f(x) = g(d x)\)</span> for some scalar <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f\)</span> – polynomial over the rational numbers</p></li>
</ul>
<p>OUTPUT: A monic integral polynomial and an integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.heegner</span> <span class="kn">import</span> <span class="n">make_monic</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">make_monic</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">(x^3 + 14*x^2 - 21*x + 45, 3)</span>
</pre></div>
</div>
<p>In this example we verify that <code class="docutils literal notranslate"><span class="pre">make_monic</span></code> does what we claim it does:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">7</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">();</span> <span class="n">f</span>
<span class="go">x^3 - 2*x^2 + 247/147*x - 4967/9261</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">make_monic</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="go">(x^3 - 42*x^2 + 741*x - 4967, 21)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^3 - 2*x^2 + 247/147*x - 4967/9261</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.nearby_rational_poly">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">nearby_rational_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.nearby_rational_poly" title="Permalink to this definition">#</a></dt>
<dd><p>Return a polynomial whose coefficients are rational numbers close
to the coefficients of <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f\)</span> – polynomial with real floating point entries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> – passed on to <code class="docutils literal notranslate"><span class="pre">nearby_rational</span></code> method</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.heegner</span> <span class="kn">import</span> <span class="n">nearby_rational_poly</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">nearby_rational_poly</span><span class="p">(</span><span class="mf">2.1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">max_error</span><span class="o">=</span><span class="mf">10e-16</span><span class="p">)</span>
<span class="go">21/10*X^2 + 7/2*X - 6/5</span>
<span class="gp">sage: </span><span class="n">nearby_rational_poly</span><span class="p">(</span><span class="mf">2.1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">max_error</span><span class="o">=</span><span class="mf">10e-17</span><span class="p">)</span>
<span class="go">4728779608739021/2251799813685248*X^2 + 7/2*X - 5404319552844595/4503599627370496</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="mi">4728779608739021</span><span class="o">/</span><span class="mi">2251799813685248</span>  <span class="o">-</span> <span class="mi">21</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="go">8.88178419700125e-17</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.quadratic_order">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">quadratic_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.quadratic_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return order of conductor <span class="math notranslate nohighlight">\(c\)</span> in quadratic field with fundamental
discriminant <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – fundamental discriminant</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> – conductor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> – string (default: ‘a’)</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>order <span class="math notranslate nohighlight">\(R\)</span> of conductor <span class="math notranslate nohighlight">\(c\)</span> in an imaginary quadratic field</p></li>
<li><p>the element <span class="math notranslate nohighlight">\(c\sqrt{D}\)</span> as an element of <span class="math notranslate nohighlight">\(R\)</span></p></li>
</ul>
<p>The generator for the field is named ‘a’ by default.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(Order in Number Field in a with defining polynomial x^2 + 7</span>
<span class="go">  with a = 2.645751311064591?*I,</span>
<span class="go"> 3*a)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
<span class="go">(Order in Number Field in alpha with defining polynomial x^2 + 7</span>
<span class="go">  with alpha = 2.645751311064591?*I,</span>
<span class="go"> 3*alpha)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.satisfies_heegner_hypothesis">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">satisfies_heegner_hypothesis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.satisfies_heegner_hypothesis" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> precisely when <span class="math notranslate nohighlight">\(D\)</span> is a fundamental discriminant that
satisfies the Heegner hypothesis for this elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.satisfies_weak_heegner_hypothesis">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">satisfies_weak_heegner_hypothesis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.satisfies_weak_heegner_hypothesis" title="Permalink to this definition">#</a></dt>
<dd><p>Check that <span class="math notranslate nohighlight">\(D\)</span> satisfies the weak Heegner hypothesis relative to <span class="math notranslate nohighlight">\(N\)</span>.
This is all that is needed to define Heegner points.</p>
<p>The condition is that <span class="math notranslate nohighlight">\(D&lt;0\)</span> is a fundamental discriminant and that
each unramified prime dividing <span class="math notranslate nohighlight">\(N\)</span> splits in <span class="math notranslate nohighlight">\(K=\QQ(\sqrt{D})\)</span> and
each ramified prime exactly divides <span class="math notranslate nohighlight">\(N\)</span>.  We also do not require
that <span class="math notranslate nohighlight">\(D&lt;-4\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> – positive integer</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> – negative integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">satisfies_weak_heegner_hypothesis</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">37</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">37</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="o">-</span><span class="mi">40</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="n">D</span><span class="p">)]</span>
<span class="go">[-3, -4, -7, -11, -40]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="n">D</span><span class="p">)]</span>
<span class="go">[-3, -4, -7, -11, -40, -47, -67, -71, -83, -84, -95]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[-7, -11, -40, -47, -67, -71, -83, -84, -95, -104]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.heegner.simplest_rational_poly">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.heegner.</span></span><span class="sig-name descname"><span class="pre">simplest_rational_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.simplest_rational_poly" title="Permalink to this definition">#</a></dt>
<dd><p>Return a polynomial whose coefficients are as simple as possible
rationals that are also close to the coefficients of f.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f\)</span> – polynomial with real floating point entries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – positive integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.heegner</span> <span class="kn">import</span> <span class="n">simplest_rational_poly</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">simplest_rational_poly</span><span class="p">(</span><span class="mf">2.1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">21/10*X^2 + 7/2*X - 6/5</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="padic_lseries.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions of elliptic curves</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="lseries_ell.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="math notranslate nohighlight">\(L\)</span>-series for elliptic curves</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Heegner points on elliptic curves over the rational numbers</a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism"><code class="docutils literal notranslate"><span class="pre">GaloisAutomorphism</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism.domain"><code class="docutils literal notranslate"><span class="pre">domain()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism.parent"><code class="docutils literal notranslate"><span class="pre">parent()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation"><code class="docutils literal notranslate"><span class="pre">GaloisAutomorphismComplexConjugation</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation.order"><code class="docutils literal notranslate"><span class="pre">order()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm"><code class="docutils literal notranslate"><span class="pre">GaloisAutomorphismQuadraticForm</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.alpha"><code class="docutils literal notranslate"><span class="pre">alpha()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.ideal"><code class="docutils literal notranslate"><span class="pre">ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.order"><code class="docutils literal notranslate"><span class="pre">order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.p1_element"><code class="docutils literal notranslate"><span class="pre">p1_element()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.quadratic_form"><code class="docutils literal notranslate"><span class="pre">quadratic_form()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup"><code class="docutils literal notranslate"><span class="pre">GaloisGroup</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.base_field"><code class="docutils literal notranslate"><span class="pre">base_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.cardinality"><code class="docutils literal notranslate"><span class="pre">cardinality()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.complex_conjugation"><code class="docutils literal notranslate"><span class="pre">complex_conjugation()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.field"><code class="docutils literal notranslate"><span class="pre">field()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.is_kolyvagin"><code class="docutils literal notranslate"><span class="pre">is_kolyvagin()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.kolyvagin_generators"><code class="docutils literal notranslate"><span class="pre">kolyvagin_generators()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.lift_of_hilbert_class_field_galois_group"><code class="docutils literal notranslate"><span class="pre">lift_of_hilbert_class_field_galois_group()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint"><code class="docutils literal notranslate"><span class="pre">HeegnerPoint</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.conductor"><code class="docutils literal notranslate"><span class="pre">conductor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.discriminant"><code class="docutils literal notranslate"><span class="pre">discriminant()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.level"><code class="docutils literal notranslate"><span class="pre">level()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.quadratic_field"><code class="docutils literal notranslate"><span class="pre">quadratic_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.quadratic_order"><code class="docutils literal notranslate"><span class="pre">quadratic_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.ring_class_field"><code class="docutils literal notranslate"><span class="pre">ring_class_field()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve"><code class="docutils literal notranslate"><span class="pre">HeegnerPointOnEllipticCurve</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.conjugates_over_K"><code class="docutils literal notranslate"><span class="pre">conjugates_over_K()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.curve"><code class="docutils literal notranslate"><span class="pre">curve()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.heegner_point_on_X0N"><code class="docutils literal notranslate"><span class="pre">heegner_point_on_X0N()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.kolyvagin_cohomology_class"><code class="docutils literal notranslate"><span class="pre">kolyvagin_cohomology_class()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.kolyvagin_point"><code class="docutils literal notranslate"><span class="pre">kolyvagin_point()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.map_to_complex_numbers"><code class="docutils literal notranslate"><span class="pre">map_to_complex_numbers()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.numerical_approx"><code class="docutils literal notranslate"><span class="pre">numerical_approx()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.point_exact"><code class="docutils literal notranslate"><span class="pre">point_exact()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.quadratic_form"><code class="docutils literal notranslate"><span class="pre">quadratic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.satisfies_kolyvagin_hypothesis"><code class="docutils literal notranslate"><span class="pre">satisfies_kolyvagin_hypothesis()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.tau"><code class="docutils literal notranslate"><span class="pre">tau()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.x_poly_exact"><code class="docutils literal notranslate"><span class="pre">x_poly_exact()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N"><code class="docutils literal notranslate"><span class="pre">HeegnerPointOnX0N</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.atkin_lehner_act"><code class="docutils literal notranslate"><span class="pre">atkin_lehner_act()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.galois_orbit_over_K"><code class="docutils literal notranslate"><span class="pre">galois_orbit_over_K()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.map_to_curve"><code class="docutils literal notranslate"><span class="pre">map_to_curve()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.quadratic_form"><code class="docutils literal notranslate"><span class="pre">quadratic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.reduced_quadratic_form"><code class="docutils literal notranslate"><span class="pre">reduced_quadratic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.tau"><code class="docutils literal notranslate"><span class="pre">tau()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints"><code class="docutils literal notranslate"><span class="pre">HeegnerPoints</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints.level"><code class="docutils literal notranslate"><span class="pre">level()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level"><code class="docutils literal notranslate"><span class="pre">HeegnerPoints_level</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level.discriminants"><code class="docutils literal notranslate"><span class="pre">discriminants()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level.reduce_mod"><code class="docutils literal notranslate"><span class="pre">reduce_mod()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc"><code class="docutils literal notranslate"><span class="pre">HeegnerPoints_level_disc</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.discriminant"><code class="docutils literal notranslate"><span class="pre">discriminant()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.kolyvagin_conductors"><code class="docutils literal notranslate"><span class="pre">kolyvagin_conductors()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.quadratic_field"><code class="docutils literal notranslate"><span class="pre">quadratic_field()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond"><code class="docutils literal notranslate"><span class="pre">HeegnerPoints_level_disc_cond</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.betas"><code class="docutils literal notranslate"><span class="pre">betas()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.conductor"><code class="docutils literal notranslate"><span class="pre">conductor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.points"><code class="docutils literal notranslate"><span class="pre">points()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.ring_class_field"><code class="docutils literal notranslate"><span class="pre">ring_class_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.satisfies_kolyvagin_hypothesis"><code class="docutils literal notranslate"><span class="pre">satisfies_kolyvagin_hypothesis()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg"><code class="docutils literal notranslate"><span class="pre">HeegnerQuatAlg</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.brandt_module"><code class="docutils literal notranslate"><span class="pre">brandt_module()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.cyclic_subideal_p1"><code class="docutils literal notranslate"><span class="pre">cyclic_subideal_p1()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.ell"><code class="docutils literal notranslate"><span class="pre">ell()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.galois_group_over_hilbert_class_field"><code class="docutils literal notranslate"><span class="pre">galois_group_over_hilbert_class_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.galois_group_over_quadratic_field"><code class="docutils literal notranslate"><span class="pre">galois_group_over_quadratic_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_conductors"><code class="docutils literal notranslate"><span class="pre">heegner_conductors()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_discriminants"><code class="docutils literal notranslate"><span class="pre">heegner_discriminants()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_divisor"><code class="docutils literal notranslate"><span class="pre">heegner_divisor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_cyclic_subideals"><code class="docutils literal notranslate"><span class="pre">kolyvagin_cyclic_subideals()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_generator"><code class="docutils literal notranslate"><span class="pre">kolyvagin_generator()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_generators"><code class="docutils literal notranslate"><span class="pre">kolyvagin_generators()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_point_on_curve"><code class="docutils literal notranslate"><span class="pre">kolyvagin_point_on_curve()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_sigma_operator"><code class="docutils literal notranslate"><span class="pre">kolyvagin_sigma_operator()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.left_orders"><code class="docutils literal notranslate"><span class="pre">left_orders()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.level"><code class="docutils literal notranslate"><span class="pre">level()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_dual_elliptic_curve_factor"><code class="docutils literal notranslate"><span class="pre">modp_dual_elliptic_curve_factor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_splitting_data"><code class="docutils literal notranslate"><span class="pre">modp_splitting_data()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_splitting_map"><code class="docutils literal notranslate"><span class="pre">modp_splitting_map()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.optimal_embeddings"><code class="docutils literal notranslate"><span class="pre">optimal_embeddings()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.quadratic_field"><code class="docutils literal notranslate"><span class="pre">quadratic_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.quaternion_algebra"><code class="docutils literal notranslate"><span class="pre">quaternion_algebra()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.rational_kolyvagin_divisor"><code class="docutils literal notranslate"><span class="pre">rational_kolyvagin_divisor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.right_ideals"><code class="docutils literal notranslate"><span class="pre">right_ideals()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.satisfies_heegner_hypothesis"><code class="docutils literal notranslate"><span class="pre">satisfies_heegner_hypothesis()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding"><code class="docutils literal notranslate"><span class="pre">HeegnerQuatAlgEmbedding</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.beta"><code class="docutils literal notranslate"><span class="pre">beta()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.codomain"><code class="docutils literal notranslate"><span class="pre">codomain()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.conjugate"><code class="docutils literal notranslate"><span class="pre">conjugate()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain"><code class="docutils literal notranslate"><span class="pre">domain()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain_conductor"><code class="docutils literal notranslate"><span class="pre">domain_conductor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain_gen"><code class="docutils literal notranslate"><span class="pre">domain_gen()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.matrix"><code class="docutils literal notranslate"><span class="pre">matrix()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass"><code class="docutils literal notranslate"><span class="pre">KolyvaginCohomologyClass</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.conductor"><code class="docutils literal notranslate"><span class="pre">conductor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.heegner_point"><code class="docutils literal notranslate"><span class="pre">heegner_point()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.kolyvagin_point"><code class="docutils literal notranslate"><span class="pre">kolyvagin_point()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.n"><code class="docutils literal notranslate"><span class="pre">n()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClassEn"><code class="docutils literal notranslate"><span class="pre">KolyvaginCohomologyClassEn</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint"><code class="docutils literal notranslate"><span class="pre">KolyvaginPoint</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.curve"><code class="docutils literal notranslate"><span class="pre">curve()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.heegner_point"><code class="docutils literal notranslate"><span class="pre">heegner_point()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.index"><code class="docutils literal notranslate"><span class="pre">index()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.kolyvagin_cohomology_class"><code class="docutils literal notranslate"><span class="pre">kolyvagin_cohomology_class()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.mod"><code class="docutils literal notranslate"><span class="pre">mod()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.numerical_approx"><code class="docutils literal notranslate"><span class="pre">numerical_approx()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.point_exact"><code class="docutils literal notranslate"><span class="pre">point_exact()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.satisfies_kolyvagin_hypothesis"><code class="docutils literal notranslate"><span class="pre">satisfies_kolyvagin_hypothesis()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.trace_to_real_numerical"><code class="docutils literal notranslate"><span class="pre">trace_to_real_numerical()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField"><code class="docutils literal notranslate"><span class="pre">RingClassField</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField.absolute_degree"><code class="docutils literal notranslate"><span class="pre">absolute_degree()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField.conductor"><code class="docutils literal notranslate"><span class="pre">conductor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_H"><code class="docutils literal notranslate"><span class="pre">degree_over_H()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_K"><code class="docutils literal notranslate"><span class="pre">degree_over_K()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_Q"><code class="docutils literal notranslate"><span class="pre">degree_over_Q()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField.discriminant_of_K"><code class="docutils literal notranslate"><span class="pre">discriminant_of_K()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField.galois_group"><code class="docutils literal notranslate"><span class="pre">galois_group()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField.is_subfield"><code class="docutils literal notranslate"><span class="pre">is_subfield()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField.quadratic_field"><code class="docutils literal notranslate"><span class="pre">quadratic_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.RingClassField.ramified_primes"><code class="docutils literal notranslate"><span class="pre">ramified_primes()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.class_number"><code class="docutils literal notranslate"><span class="pre">class_number()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.ell_heegner_discriminants"><code class="docutils literal notranslate"><span class="pre">ell_heegner_discriminants()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.ell_heegner_discriminants_list"><code class="docutils literal notranslate"><span class="pre">ell_heegner_discriminants_list()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.ell_heegner_point"><code class="docutils literal notranslate"><span class="pre">ell_heegner_point()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.heegner_index"><code class="docutils literal notranslate"><span class="pre">heegner_index()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.heegner_index_bound"><code class="docutils literal notranslate"><span class="pre">heegner_index_bound()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.heegner_point"><code class="docutils literal notranslate"><span class="pre">heegner_point()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.heegner_point_height"><code class="docutils literal notranslate"><span class="pre">heegner_point_height()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.heegner_points"><code class="docutils literal notranslate"><span class="pre">heegner_points()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.heegner_sha_an"><code class="docutils literal notranslate"><span class="pre">heegner_sha_an()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.is_inert"><code class="docutils literal notranslate"><span class="pre">is_inert()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.is_kolyvagin_conductor"><code class="docutils literal notranslate"><span class="pre">is_kolyvagin_conductor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.is_ramified"><code class="docutils literal notranslate"><span class="pre">is_ramified()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.is_split"><code class="docutils literal notranslate"><span class="pre">is_split()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.kolyvagin_point"><code class="docutils literal notranslate"><span class="pre">kolyvagin_point()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.kolyvagin_reduction_data"><code class="docutils literal notranslate"><span class="pre">kolyvagin_reduction_data()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.make_monic"><code class="docutils literal notranslate"><span class="pre">make_monic()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.nearby_rational_poly"><code class="docutils literal notranslate"><span class="pre">nearby_rational_poly()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.quadratic_order"><code class="docutils literal notranslate"><span class="pre">quadratic_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.satisfies_heegner_hypothesis"><code class="docutils literal notranslate"><span class="pre">satisfies_heegner_hypothesis()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.satisfies_weak_heegner_hypothesis"><code class="docutils literal notranslate"><span class="pre">satisfies_weak_heegner_hypothesis()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.simplest_rational_poly"><code class="docutils literal notranslate"><span class="pre">simplest_rational_poly()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>