<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Regions in fundamental domains of period lattices" href="period_lattice_region.html" /><link rel="prev" title="Weierstrass \(\wp\)-function for elliptic curves" href="ell_wp.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Period lattices of elliptic curves and related functions - Elliptic curves</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Elliptic curves</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.2 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Elliptic curves</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="constructor.html">Elliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian.html">Construct elliptic curves as Jacobians</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_point.html">Points on elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_generic.html">Elliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_field.html">Elliptic curves over a general field</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_finite_field.html">Elliptic curves over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="formal_group.html">Formal groups of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hom.html">Elliptic-curve morphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_morphism.html">Isomorphisms between Weierstrass models of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_curve_isogeny.html">Isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_velusqrt.html">Square‑root Vélu algorithm for elliptic-curve isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_composite.html">Composite morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_scalar.html">Scalar-multiplication morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_frobenius.html">Frobenius isogenies of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_small_degree.html">Isogenies of small prime degree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_rational_field.html">Elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ec_database.html">Tables of elliptic curves of given rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_number_field.html">Elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="height.html">Canonical heights for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="saturation.html">Saturation of Mordell-Weil groups of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_torsion.html">Torsion subgroups of elliptic curves over number fields (including <span class="math notranslate nohighlight">\(\QQ\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps.html">Galois representations attached to elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps_number_field.html">Galois representations for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_class.html">Isogeny class of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="sha_tate.html">Tate-Shafarevich group</a></li>
<li class="toctree-l1"><a class="reference internal" href="cm.html">Complex multiplication for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="Qcurves.html">Testing whether elliptic curves over number fields are <span class="math notranslate nohighlight">\(\QQ\)</span>-curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_local_data.html">Local data for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="kodaira_symbol.html">Kodaira symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_tate_curve.html">Tate’s parametrisation of <span class="math notranslate nohighlight">\(p\)</span>-adic curves with multiplicative reduction</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ell_wp.html">Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function for elliptic curves</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Period lattices of elliptic curves and related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice_region.html">Regions in fundamental domains of period lattices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modular_parametrization.html">Modular parametrization of elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_modular_symbols.html">Modular symbols attached to elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="mod_sym_num.html">Modular symbols by numerical integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lseries_ell.html"><span class="math notranslate nohighlight">\(L\)</span>-series for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="heegner.html">Heegner points on elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_lseries.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="descent_two_isogeny.html">Descent on elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span> with a 2-isogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_egros.html">Elliptic curves with prescribed good reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_padic_field.html">Elliptic curves over padic fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="gp_simon.html">Denis Simon’s PARI scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="mod5family.html">Elliptic curves with congruent mod-5 representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_transform.html">Morphism to bring a genus-one curve into Weierstrass form</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/constructor.html">Hyperelliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_generic.html">Hyperelliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_finite_field.html">Hyperelliptic curves over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_padic_field.html">Hyperelliptic curves over a <span class="math notranslate nohighlight">\(p\)</span>-adic field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_rational_field.html">Hyperelliptic curves over the rationals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/mestre.html">Mestre’s algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/monsky_washnitzer.html">Computation of Frobenius matrix on Monsky-Washnitzer cohomology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hypellfrob.html">Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over a</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_generic.html">Jacobian of a general hyperelliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_g2.html">Jacobian of a hyperelliptic curve of genus 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_homset.html">Rational point sets on a Jacobian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_morphism.html">Jacobian ‘morphism’ as a class in the Picard group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_g2.html">Hyperelliptic curves of genus 2 over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/invariants.html">Compute invariants of quintics and sextics via ‘Ueberschiebung’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/kummer_surface.html">Kummer surfaces over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/genus2reduction.html">Conductor and reduction types for genus 2 curves</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="period-lattices-of-elliptic-curves-and-related-functions">
<span id="sage-schemes-elliptic-curves-period-lattice"></span><h1>Period lattices of elliptic curves and related functions<a class="headerlink" href="#period-lattices-of-elliptic-curves-and-related-functions" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.period_lattice"></span><p>Let <span class="math notranslate nohighlight">\(E\)</span> be an elliptic curve defined over a number field <span class="math notranslate nohighlight">\(K\)</span>
(including <span class="math notranslate nohighlight">\(\QQ\)</span>).  We attach a period lattice (a discrete rank 2
subgroup of <span class="math notranslate nohighlight">\(\CC\)</span>) to each embedding of <span class="math notranslate nohighlight">\(K\)</span> into <span class="math notranslate nohighlight">\(\CC\)</span>.</p>
<p>In the case of real embeddings, the lattice is stable under complex
conjugation and is called a real lattice.  These have two types:
rectangular, (the real curve has two connected components and positive
discriminant) or non-rectangular (one connected component, negative
discriminant).</p>
<p>The periods are computed to arbitrary precision using the AGM (Gauss’s
Arithmetic-Geometric Mean).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>                                                  <span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>                                                <span class="c1"># needs sage.rings.number_field</span>
</pre></div>
</div>
<p>First we try a real embedding:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>                                            <span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">);</span> <span class="n">L</span>                                                  <span class="c1"># needs sage.rings.number_field</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 = x^3 + x^2 + a*x + a</span>
<span class="go"> over Number Field in a with defining polynomial x^3 - 2</span>
<span class="go"> with respect to the embedding Ring morphism:</span>
<span class="go">   From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">   To:   Algebraic Real Field</span>
<span class="go">   Defn: a |--&gt; 1.259921049894873?</span>
</pre></div>
</div>
<p>The first basis period is real:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>                                                                     <span class="c1"># needs sage.rings.number_field</span>
<span class="go">(3.81452977217855, 1.90726488608927 + 1.34047785962440*I)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>                                                                   <span class="c1"># needs sage.rings.number_field</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For a basis <span class="math notranslate nohighlight">\(\omega_1,\omega_2\)</span> normalised so that <span class="math notranslate nohighlight">\(\omega_1/\omega_2\)</span>
is in the fundamental region of the upper half-plane, use the function
<code class="docutils literal notranslate"><span class="pre">normalised_basis()</span></code> instead:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">()</span>                                                          <span class="c1"># needs sage.rings.number_field</span>
<span class="go">(1.90726488608927 - 1.34047785962440*I, -1.90726488608927 - 1.34047785962440*I)</span>
</pre></div>
</div>
<p>Next a complex embedding:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>                                         <span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">);</span> <span class="n">L</span>                                                  <span class="c1"># needs sage.rings.number_field</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 = x^3 + x^2 + a*x + a</span>
<span class="go"> over Number Field in a with defining polynomial x^3 - 2</span>
<span class="go"> with respect to the embedding Ring morphism:</span>
<span class="go">   From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">   To:   Algebraic Field</span>
<span class="go">   Defn: a |--&gt; -0.6299605249474365? - 1.091123635971722?*I</span>
</pre></div>
</div>
<p>In this case, the basis <span class="math notranslate nohighlight">\(\omega_1\)</span>, <span class="math notranslate nohighlight">\(\omega_2\)</span> is always normalised so
that <span class="math notranslate nohighlight">\(\tau = \omega_1/\omega_2\)</span> is in the fundamental region in the
upper half plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">();</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span>
<span class="go">(-1.37588604166076 - 2.58560946624443*I, -2.10339907847356 + 0.428378776460622*I)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">w1</span><span class="o">/</span><span class="n">w2</span><span class="p">;</span> <span class="n">tau</span>
<span class="go">0.387694505032876 + 1.30821088214407*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">()</span>
<span class="go">(-1.37588604166076 - 2.58560946624443*I, -2.10339907847356 + 0.428378776460622*I)</span>
</pre></div>
</div>
<p>We test that bug <a class="reference external" href="https://github.com/sagemath/sage/issues/8415">github issue #8415</a> (caused by a PARI bug fixed in v2.3.5) is OK:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 + y = x^3 + (-1)*x</span>
<span class="go"> over Number Field in a with defining polynomial x^2 + 7</span>
<span class="go">  with a = 2.645751311064591?*I</span>
<span class="go"> with respect to the embedding Ring morphism:</span>
<span class="go">   From: Number Field in a with defining polynomial x^2 + 7</span>
<span class="go">         with a = 2.645751311064591?*I</span>
<span class="go">   To:   Algebraic Field</span>
<span class="go">   Defn: a |--&gt; -2.645751311064591?*I</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../../references/index.html#ct2013" id="id1"><span>[CT2013]</span></a></p></li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>?: initial version.</p></li>
<li><p>John Cremona:</p>
<ul>
<li><p>Adapted to handle real embeddings of number fields, September 2008.</p></li>
<li><p>Added basis_matrix function, November 2008</p></li>
<li><p>Added support for complex embeddings, May 2009.</p></li>
<li><p>Added complex elliptic logs, March 2010; enhanced, October 2010.</p></li>
</ul>
</li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.period_lattice.</span></span><span class="sig-name descname"><span class="pre">PeriodLattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_ring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_ring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../modules/sage/modules/free_module.html#sage.modules.free_module.FreeModule_generic_pid" title="(in Modules v10.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">FreeModule_generic_pid</span></code></a></p>
<p>The class for the period lattice of an algebraic variety.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.period_lattice.</span></span><span class="sig-name descname"><span class="pre">PeriodLattice_ell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice" title="sage.schemes.elliptic_curves.period_lattice.PeriodLattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeriodLattice</span></code></a></p>
<p>The class for the period lattice of an elliptic curve.</p>
<p>Currently supported are elliptic curves defined over <span class="math notranslate nohighlight">\(\QQ\)</span>, and
elliptic curves defined over a number field with a real or complex
embedding, where the lattice constructed depends on that
embedding.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis">
<span class="sig-name descname"><span class="pre">basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sage'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis" title="Permalink to this definition">#</a></dt>
<dd><p>Return a basis for this period lattice as a 2-tuple.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – precision in bits (default
precision if <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string, default ‘sage’) – choice of
implementation (for real embeddings only) between ‘sage’
(native Sage implementation) or ‘pari’ (use the PARI
library: only available for real embeddings).</p></li>
</ul>
<p>OUTPUT:</p>
<p>(tuple of Complex) <span class="math notranslate nohighlight">\((\omega_1,\omega_2)\)</span> where the lattice is
<span class="math notranslate nohighlight">\(\ZZ\omega_1 + \ZZ\omega_2\)</span>.  If the lattice is real then
<span class="math notranslate nohighlight">\(\omega_1\)</span> is real and positive, <span class="math notranslate nohighlight">\(\Im(\omega_2)&gt;0\)</span> and
<span class="math notranslate nohighlight">\(\Re(\omega_1/\omega_2)\)</span> is either <span class="math notranslate nohighlight">\(0\)</span> (for rectangular
lattices) or <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> (for non-rectangular lattices).
Otherwise, <span class="math notranslate nohighlight">\(\omega_1/\omega_2\)</span> is in the fundamental region of
the upper half-plane.  If the latter normalisation is required
for real lattices, use the function <code class="docutils literal notranslate"><span class="pre">normalised_basis()</span></code>
instead.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(2.99345864623196, 2.45138938198679*I)</span>
</pre></div>
</div>
<p>This shows that the issue reported at <a class="reference external" href="https://github.com/sagemath/sage/issues/3954">github issue #3954</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b1</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b2</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b1</span> <span class="o">==</span> <span class="n">b2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This shows that the issue reported at <a class="reference external" href="https://github.com/sagemath/sage/issues/4064">github issue #4064</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Real Field with 30 bits of precision</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Real Field with 100 bits of precision</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="go">(3.81452977217854509, 1.90726488608927255 + 1.34047785962440202*I)</span>

<span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">();</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span>
<span class="go">(-1.37588604166076 - 2.58560946624443*I, -2.10339907847356 + 0.428378776460622*I)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">w1</span><span class="o">/</span><span class="n">w2</span><span class="p">;</span> <span class="n">tau</span>
<span class="go">0.387694505032876 + 1.30821088214407*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis_matrix">
<span class="sig-name descname"><span class="pre">basis_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalised</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the basis matrix of this period lattice.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None``(default))</span> <span class="pre">--</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">in</span>
<span class="pre">bits</span> <span class="pre">(default</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">if</span> <span class="pre">``None</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalised</span></code> (bool, default False) – if True and the
embedding is real, use the normalised basis (see
<code class="docutils literal notranslate"><span class="pre">normalised_basis()</span></code>) instead of the default.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A 2x2 real matrix whose rows are the lattice basis vectors,
after identifying <span class="math notranslate nohighlight">\(\CC\)</span> with <span class="math notranslate nohighlight">\(\RR^2\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[ 2.99345864623196 0.000000000000000]</span>
<span class="go">[0.000000000000000  2.45138938198679]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="go">[ 3.81452977217854509 0.000000000000000000]</span>
<span class="go">[ 1.90726488608927255  1.34047785962440202]</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/sagemath/sage/issues/4388">github issue #4388</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[ 1.26920930427955 0.000000000000000]</span>
<span class="go">[0.634604652139777  1.45881661693850]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">(</span><span class="n">normalised</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[0.634604652139777 -1.45881661693850]</span>
<span class="go">[-1.26920930427955 0.000000000000000]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[ 2.49021256085505 0.000000000000000]</span>
<span class="go">[0.000000000000000  1.97173770155165]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">(</span><span class="n">normalised</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[ 2.49021256085505 0.000000000000000]</span>
<span class="go">[0.000000000000000 -1.97173770155165]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.complex_area">
<span class="sig-name descname"><span class="pre">complex_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.complex_area" title="Permalink to this definition">#</a></dt>
<dd><p>Return the area of a fundamental domain for the period lattice
of the elliptic curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None``(default))</span> <span class="pre">--</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">in</span>
<span class="pre">bits</span> <span class="pre">(default</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">if</span> <span class="pre">``None</span></code>).</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">complex_area</span><span class="p">()</span>
<span class="go">7.33813274078958</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">embs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span> <span class="k">for</span> <span class="n">emb</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)]</span>
<span class="go">[False, False, True]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span><span class="o">.</span><span class="n">complex_area</span><span class="p">()</span> <span class="k">for</span> <span class="n">emb</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span>
<span class="go">[6.02796894766694, 6.02796894766694, 5.11329270448345]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.coordinates">
<span class="sig-name descname"><span class="pre">coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rounding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.coordinates" title="Permalink to this definition">#</a></dt>
<dd><p>Return the coordinates of a complex number w.r.t. the lattice basis</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">z</span></code> (complex) – A complex number.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rounding</span></code> (default <code class="docutils literal notranslate"><span class="pre">None</span></code>) – whether and how to round the</dt><dd><p>output (see below).</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<p>When <code class="docutils literal notranslate"><span class="pre">rounding</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code> (the default), returns a tuple
of reals <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> such that <span class="math notranslate nohighlight">\(z=xw_1+yw_2\)</span> where <span class="math notranslate nohighlight">\(w_1\)</span>, <span class="math notranslate nohighlight">\(w_2\)</span>
are a basis for the lattice (normalised in the case of complex
embeddings).</p>
<p>When <code class="docutils literal notranslate"><span class="pre">rounding</span></code> is <code class="docutils literal notranslate"><span class="pre">'round'</span></code>, returns a tuple of integers <span class="math notranslate nohighlight">\(n_1\)</span>,
<span class="math notranslate nohighlight">\(n_2\)</span> which are the closest integers to the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> defined
above.  If <span class="math notranslate nohighlight">\(z\)</span> is in the lattice these are the coordinates of
<span class="math notranslate nohighlight">\(z\)</span> with respect to the lattice basis.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">rounding</span></code> is <code class="docutils literal notranslate"><span class="pre">'floor'</span></code>, returns a tuple of integers
<span class="math notranslate nohighlight">\(n_1\)</span>, <span class="math notranslate nohighlight">\(n_2\)</span> which are the integer parts to the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>
defined above. These are used in <a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.reduce" title="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.reduce"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reduce()</span></code></a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">zP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">zP</span>
<span class="go">0.47934825019021931612953301006 + 0.98586885077582410221120384908*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">zP</span><span class="p">)</span>
<span class="go">(0.19249290511394227352563996419, 0.50000000000000000000000000000)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">w</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">zP</span><span class="p">),</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">))])</span>
<span class="go">0.47934825019021931612953301006 + 0.98586885077582410221120384908*I</span>

<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">w1</span> <span class="o">+</span> <span class="mi">23</span><span class="o">*</span><span class="n">w2</span><span class="p">)</span>
<span class="go">(12.000000000000000000000000000, 23.000000000000000000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">w1</span> <span class="o">+</span> <span class="mi">23</span><span class="o">*</span><span class="n">w2</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="s1">&#39;floor&#39;</span><span class="p">)</span>
<span class="go">(11, 22)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">w1</span> <span class="o">+</span> <span class="mi">23</span><span class="o">*</span><span class="n">w2</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">)</span>
<span class="go">(12, 23)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.curve">
<span class="sig-name descname"><span class="pre">curve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.curve" title="Permalink to this definition">#</a></dt>
<dd><p>Return the elliptic curve associated with this period lattice.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span> <span class="ow">is</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span> <span class="ow">is</span> <span class="n">E</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>                 <span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span> <span class="ow">is</span> <span class="n">E</span>                                                        <span class="c1"># needs sage.rings.number_field</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.e_log_RC">
<span class="sig-name descname"><span class="pre">e_log_RC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.e_log_RC" title="Permalink to this definition">#</a></dt>
<dd><p>Return the elliptic logarithm of a real or complex point.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xP,</span> <span class="pre">yP</span></code> (real or complex) – Coordinates of a point on
the embedded elliptic curve associated with this period
lattice.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – real precision in bits
(default real precision if None).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reduce</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the result
is reduced with respect to the period lattice basis.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(complex number) The elliptic logarithm of the point <span class="math notranslate nohighlight">\((xP,yP)\)</span>
with respect to this period lattice.  If <span class="math notranslate nohighlight">\(E\)</span> is the elliptic
curve and <span class="math notranslate nohighlight">\(\sigma:K\to\CC\)</span> the embedding, the returned
value <span class="math notranslate nohighlight">\(z\)</span> is such that <span class="math notranslate nohighlight">\(z\pmod{L}\)</span> maps to <span class="math notranslate nohighlight">\((xP,yP)=\sigma(P)\)</span>
under the standard Weierstrass isomorphism from <span class="math notranslate nohighlight">\(\CC/L\)</span> to
<span class="math notranslate nohighlight">\(\sigma(E)\)</span>.  If <code class="docutils literal notranslate"><span class="pre">reduce</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the output is reduced
so that it is in the fundamental period parallelogram with
respect to the normalised lattice basis.</p>
<p>ALGORITHM:</p>
<p>Uses the complex AGM.  See <a class="reference internal" href="../../../../references/index.html#ct2013" id="id2"><span>[CT2013]</span></a> for details.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="p">[</span><span class="n">RR</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()]</span>
</pre></div>
</div>
<p>The elliptic log from the real coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">0.479348250190219 + 0.985868850775824*I</span>
</pre></div>
</div>
<p>The same elliptic log from the algebraic point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">0.479348250190219 + 0.985868850775824*I</span>
</pre></div>
</div>
<p>A number field example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">real_places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">3.51086196882538</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">3.51086196882538</span>
</pre></div>
</div>
<p>Elliptic logs of real points which do not come from algebraic
points:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">ER</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">v</span><span class="p">(</span><span class="n">ai</span><span class="p">)</span> <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">a_invariants</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">ER</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mf">12.34</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span>
<span class="go">(12.3400000000000, -43.3628968710567)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">0.284656841192041</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="n">ER</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">1.34921304541057</span>
</pre></div>
</div>
<p>Elliptic logs of complex points:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">1.68207104397706 - 1.87873661686704*I</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">1.68207104397706 - 1.87873661686704*I</span>
<span class="gp">sage: </span><span class="n">EC</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">v</span><span class="p">(</span><span class="n">ai</span><span class="p">)</span> <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">a_invariants</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="n">EC</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">2.06711431204080 - 1.73451485683471*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.ei">
<span class="sig-name descname"><span class="pre">ei</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.ei" title="Permalink to this definition">#</a></dt>
<dd><p>Return the x-coordinates of the 2-division points of the elliptic curve associated
with this period lattice, as elements of <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ei</span><span class="p">()</span>
<span class="go">[-1.107159871688768?, 0.2695944364054446?, 0.8375654352833230?]</span>
</pre></div>
</div>
<p>In the following example, we should have one purely real 2-division point coordinate,
and two conjugate purely imaginary coordinates.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ei</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">real</span><span class="p">())</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">real</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">1e-14</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x1</span><span class="o">.</span><span class="n">imag</span><span class="p">(),</span> <span class="n">x2</span><span class="o">.</span><span class="n">imag</span><span class="p">(),</span> <span class="n">x3</span>
<span class="go">(-1.122462048309373?, 1.122462048309373?, -1.000000000000000?)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>                 <span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ei</span><span class="p">()</span>                                                                <span class="c1"># needs sage.rings.number_field</span>
<span class="go">[-1.000000000000000? + 0.?e-1...*I,</span>
<span class="go"> -0.9720806486198328? - 0.561231024154687?*I,</span>
<span class="go"> 0.9720806486198328? + 0.561231024154687?*I]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.elliptic_exponential">
<span class="sig-name descname"><span class="pre">elliptic_exponential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_curve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.elliptic_exponential" title="Permalink to this definition">#</a></dt>
<dd><p>Return the elliptic exponential of a complex number.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">z</span></code> (complex) – A complex number (viewed modulo this period lattice).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_curve</span></code> (bool, default True):  see below.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">to_curve</span></code> is False, a 2-tuple of real or complex
numbers representing the point <span class="math notranslate nohighlight">\((x,y) = (\wp(z),\wp'(z))\)</span>
where <span class="math notranslate nohighlight">\(\wp\)</span> denotes the Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function with
respect to this lattice.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">to_curve</span></code> is True, the point <span class="math notranslate nohighlight">\((X,Y) =
(x-b_2/12,y-(a_1(x-b_2/12)-a_3)/2)\)</span> as a point in <span class="math notranslate nohighlight">\(E(\RR)\)</span>
or <span class="math notranslate nohighlight">\(E(\CC)\)</span>, with <span class="math notranslate nohighlight">\((x,y) = (\wp(z),\wp'(z))\)</span> as above, where
<span class="math notranslate nohighlight">\(E\)</span> is the elliptic curve over <span class="math notranslate nohighlight">\(\RR\)</span> or <span class="math notranslate nohighlight">\(\CC\)</span> whose period
lattice this is.</p></li>
<li><p>If the lattice is real and <span class="math notranslate nohighlight">\(z\)</span> is also real then the output
is a pair of real numbers if <code class="docutils literal notranslate"><span class="pre">to_curve</span></code> is True, or a
point in <span class="math notranslate nohighlight">\(E(\RR)\)</span> if <code class="docutils literal notranslate"><span class="pre">to_curve</span></code> is False.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The precision is taken from that of the input <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">z</span>
<span class="go">1.17044757240090</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">(0.999999999999999 : -2.00000000000000 : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + 1.00000000000000*x*y + 1.00000000000000*y</span>
<span class="go"> = x^3 + 1.00000000000000*x^2 - 8.00000000000000*x + 6.00000000000000</span>
<span class="go"> over Real Field with 53 bits of precision</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">to_curve</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(1.41666666666667, -2.00000000000000)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">201</span><span class="p">);</span> <span class="n">z</span>
<span class="go">1.17044757240089592298992188482371493504472561677451007994189</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">(1.00000000000000000000000000000000000000000000000000000000000</span>
<span class="go"> : -2.00000000000000000000000000000000000000000000000000000000000</span>
<span class="go"> : 1.00000000000000000000000000000000000000000000000000000000000)</span>
</pre></div>
</div>
<p>Examples over number fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">embs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Li</span> <span class="o">=</span> <span class="p">[</span><span class="n">EK</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">zi</span> <span class="o">=</span> <span class="p">[</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
<span class="go">[-1.00000000000000, -1.00000000000000, 1.00000000000000]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="go">[-1.00000000000000, -1.00000000000000, 1.00000000000000]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
<span class="go">[-1.00000000000000, -1.00000000000000, 1.00000000000000]</span>

<span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">zi</span> <span class="o">=</span> <span class="p">[</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Li</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(-1.62996052494744 - 1.09112363597172*I</span>
<span class="go"> : 1.79370052598410 - 1.37472963699860*I</span>
<span class="go"> : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">embs</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>
<span class="go">[-1.62996052494744 - 1.09112363597172*I,</span>
<span class="go"> 1.79370052598410 - 1.37472963699860*I,</span>
<span class="go"> 1.00000000000000]</span>
<span class="gp">sage: </span><span class="n">Li</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(-1.62996052494744 + 1.09112363597172*I</span>
<span class="go"> : 1.79370052598410 + 1.37472963699860*I</span>
<span class="go"> : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">embs</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>
<span class="go">[-1.62996052494744 + 1.09112363597172*I,</span>
<span class="go"> 1.79370052598410 + 1.37472963699860*I,</span>
<span class="go"> 1.00000000000000]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
<span class="go">[0.259921049894873, -0.587401051968199, 1.00000000000000]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">embs</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>
<span class="go">[0.259921049894873, -0.587401051968200, 1.00000000000000]</span>
</pre></div>
</div>
<p>Test to show that <a class="reference external" href="https://github.com/sagemath/sage/issues/8820">github issue #8820</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">CDF</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span><span class="mf">.1</span><span class="p">))</span>
<span class="go">(0.0000142854026029... - 49.9960001066650*I</span>
<span class="go"> : 249.520141250950 + 250.019855549131*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">CDF</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span><span class="mf">.1</span><span class="p">),</span> <span class="n">to_curve</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(0.0000142854026029447 - 49.9960001066650*I,</span>
<span class="go"> 500.040282501900 + 500.039711098263*I)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(z=0\)</span> is treated as a special case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0.000000000000000 : 1.00000000000000 : 0.000000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">to_curve</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(+infinity, +infinity)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(0.000000000000000 : 1.00000000000000 : 0.000000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Abelian group of points on Elliptic Curve defined by</span>
<span class="go"> y^2 + 1.00000000000000*y = x^3 + (-1.00000000000000)*x</span>
<span class="go"> over Complex Field with 53 bits of precision</span>
</pre></div>
</div>
<p>Very small <span class="math notranslate nohighlight">\(z\)</span> are handled properly (see <a class="reference external" href="https://github.com/sagemath/sage/issues/8820">github issue #8820</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="mf">1e-100</span><span class="p">)</span>
<span class="go">(0.000000000000000 : 1.00000000000000 : 0.000000000000000)</span>
</pre></div>
</div>
<p>The elliptic exponential of <span class="math notranslate nohighlight">\(z\)</span> is returned as (0 : 1 : 0) if
the coordinates of z with respect to the period lattice are
approximately integral:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="n">log</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">/</span><span class="mf">0.8</span>
<span class="go">415.241011860920</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">((</span><span class="n">RealField</span><span class="p">(</span><span class="mi">415</span><span class="p">)(</span><span class="mf">1e-100</span><span class="p">)))</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>            <span class="c1"># needs sage.rings.number_field</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">((</span><span class="n">RealField</span><span class="p">(</span><span class="mi">420</span><span class="p">)(</span><span class="mf">1e-100</span><span class="p">)))</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>            <span class="c1"># needs sage.rings.number_field</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.elliptic_logarithm">
<span class="sig-name descname"><span class="pre">elliptic_logarithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.elliptic_logarithm" title="Permalink to this definition">#</a></dt>
<dd><p>Return the elliptic logarithm of a point.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> (point) – A point on the elliptic curve associated
with this period lattice.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – real precision in bits
(default real precision if None).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reduce</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the result
is reduced with respect to the period lattice basis.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(complex number) The elliptic logarithm of the point <span class="math notranslate nohighlight">\(P\)</span> with
respect to this period lattice.  If <span class="math notranslate nohighlight">\(E\)</span> is the elliptic curve
and <span class="math notranslate nohighlight">\(\sigma:K\to\CC\)</span> the embedding, the returned value <span class="math notranslate nohighlight">\(z\)</span>
is such that <span class="math notranslate nohighlight">\(z\pmod{L}\)</span> maps to <span class="math notranslate nohighlight">\(\sigma(P)\)</span> under the
standard Weierstrass isomorphism from <span class="math notranslate nohighlight">\(\CC/L\)</span> to <span class="math notranslate nohighlight">\(\sigma(E)\)</span>.
If <code class="docutils literal notranslate"><span class="pre">reduce</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the output is reduced so that it is
in the fundamental period parallelogram with respect to the
normalised lattice basis.</p>
<p>ALGORITHM:</p>
<p>Uses the complex AGM.  See <a class="reference internal" href="../../../../references/index.html#ct2013" id="id3"><span>[CT2013]</span></a> for details.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">real_flag</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">is_on_identity_component</span> <span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
<span class="go">0.4793482501902193161295330101 + 0.9858688507758241022112038491*I</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">E</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_on_identity_component</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
<span class="go">1.931128271542559442488585220</span>
</pre></div>
</div>
<p>Note that this is actually the inverse of the Weierstrass isomorphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># abs tol 1e-26</span>
<span class="go">(3.000000000000000000000000000 : 5.000000000000000000000000000 : 1.000000000000000000000000000)</span>
</pre></div>
</div>
<p>An example with negative discriminant, and a torsion point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">real_flag</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mi">61</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">0.253841860855911</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">real_period</span><span class="p">()</span> <span class="o">/</span> <span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">5.00000000000000</span>
</pre></div>
</div>
<p>An example where precision is problematic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">85357462</span><span class="p">,</span> <span class="mi">303528987048</span><span class="p">])</span>  <span class="c1">#18074g1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">4458713781401</span><span class="o">/</span><span class="mi">835903744</span><span class="p">,</span> <span class="o">-</span><span class="mi">64466909836503771</span><span class="o">/</span><span class="mi">24167649046528</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ei</span><span class="p">()</span>
<span class="go">[5334.003952567705? - 1.964393150436?e-6*I,</span>
<span class="go"> 5334.003952567705? + 1.964393150436?e-6*I,</span>
<span class="go"> -10668.25790513541?]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.27656204014107061464076203097</span>
</pre></div>
</div>
<p>Some complex examples, taken from the paper by Cremona and Thongjunthug:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a4</span> <span class="o">=</span> <span class="mi">9</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">a6</span> <span class="o">=</span> <span class="mi">21</span> <span class="o">-</span> <span class="n">i</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">a6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">e1</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">;</span> <span class="n">e2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span> <span class="n">e3</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span> <span class="o">+</span> <span class="n">i</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, the output is reduced with respect to the
normalised lattice basis, so that its coordinates with respect
to that basis lie in the interval [0,1):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">z</span>                              <span class="c1"># needs sage.rings.number_field</span>
<span class="go">0.70448375537782208460499649302 - 0.79246725643650979858266018068*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>                                                      <span class="c1"># needs sage.rings.number_field</span>
<span class="go">(0.46247636364807931766105406092, 0.79497588726808704200760395829)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">reduce=False</span></code> this step can be omitted.  In this case
the coordinates are usually in the interval [-0.5,0.5), but
this is not guaranteed.  This option is mainly for testing
purposes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span> <span class="n">z</span>                <span class="c1"># needs sage.rings.number_field</span>
<span class="go">0.57002153834710752778063503023 + 0.46476340520469798857457031393*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>                                                      <span class="c1"># needs sage.rings.number_field</span>
<span class="go">(0.46247636364807931766105406092, -0.20502411273191295799239604171)</span>
</pre></div>
</div>
<p>The elliptic logs of the 2-torsion points are half-periods:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>                              <span class="c1"># needs sage.rings.number_field</span>
<span class="go">0.64607575874356525952487867052 + 0.22379609053909448304176885364*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>                              <span class="c1"># needs sage.rings.number_field</span>
<span class="go">0.71330686725892253793705940192 - 0.40481924028150941053684639367*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>                              <span class="c1"># needs sage.rings.number_field</span>
<span class="go">0.067231108515357278412180731396 - 0.62861533082060389357861524731*I</span>
</pre></div>
</div>
<p>We check this by doubling and seeing that the resulting
coordinates are integers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>             <span class="c1"># needs sage.rings.number_field</span>
<span class="go">(1.0000000000000000000000000000, 0.00000000000000000000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>             <span class="c1"># needs sage.rings.number_field</span>
<span class="go">(1.0000000000000000000000000000, 1.0000000000000000000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>             <span class="c1"># needs sage.rings.number_field</span>
<span class="go">(0.00000000000000000000000000000, 1.0000000000000000000000000000)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">a4</span> <span class="o">=</span> <span class="o">-</span><span class="mi">78</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">104</span>
<span class="gp">sage: </span><span class="n">a6</span> <span class="o">=</span> <span class="o">-</span><span class="mi">216</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">312</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">a6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="mi">14</span> <span class="o">-</span> <span class="mi">7</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">0.297147783912228 - 0.546125549639461*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="go">(0.628653378040238, 0.371417754610223)</span>
<span class="gp">sage: </span><span class="n">e1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">;</span> <span class="n">e2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">i</span><span class="p">;</span> <span class="n">e3</span> <span class="o">=</span> <span class="o">-</span><span class="n">e1</span> <span class="o">-</span> <span class="n">e2</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
<span class="go">(0.500000000000000, 0.500000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
<span class="go">(1.00000000000000, 0.500000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
<span class="go">(0.500000000000000, 0.000000000000000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.gens">
<span class="sig-name descname"><span class="pre">gens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sage'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.gens" title="Permalink to this definition">#</a></dt>
<dd><p>Return a basis for this period lattice as a 2-tuple.</p>
<p>This is an alias for
<a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis" title="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">basis()</span></code></a>.
See the docstring there for a more in-depth explanation and further
examples.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – precision in bits (default
precision if <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string, default ‘sage’) – choice of
implementation (for real embeddings only) between ‘sage’
(native Sage implementation) or ‘pari’ (use the PARI
library: only available for real embeddings).</p></li>
</ul>
<p>OUTPUT:</p>
<p>(tuple of Complex) <span class="math notranslate nohighlight">\((\omega_1,\omega_2)\)</span> where the lattice is
<span class="math notranslate nohighlight">\(\ZZ\omega_1 + \ZZ\omega_2\)</span>.  If the lattice is real then
<span class="math notranslate nohighlight">\(\omega_1\)</span> is real and positive, <span class="math notranslate nohighlight">\(\Im(\omega_2)&gt;0\)</span> and
<span class="math notranslate nohighlight">\(\Re(\omega_1/\omega_2)\)</span> is either <span class="math notranslate nohighlight">\(0\)</span> (for rectangular
lattices) or <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> (for non-rectangular lattices).
Otherwise, <span class="math notranslate nohighlight">\(\omega_1/\omega_2\)</span> is in the fundamental region of
the upper half-plane.  If the latter normalisation is required
for real lattices, use the function <code class="docutils literal notranslate"><span class="pre">normalised_basis()</span></code>
instead.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(2.99345864623196, 2.45138938198679*I)</span>

<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">(2.9934586462319596298320099794, 2.4513893819867900608542248319*I)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.is_real">
<span class="sig-name descname"><span class="pre">is_real</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.is_real" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this period lattice is real.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>                                          <span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>                                        <span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span> <span class="k">for</span> <span class="n">emb</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)]</span>         <span class="c1"># needs sage.rings.number_field</span>
<span class="go">[False, False, True]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>The lattice is real if it is associated to a real embedding;
such lattices are stable under conjugation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.is_rectangular">
<span class="sig-name descname"><span class="pre">is_rectangular</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.is_rectangular" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if this period lattice is rectangular.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only defined for real lattices; a <a class="reference external" href="https://docs.python.org/library/exceptions.html#RuntimeError" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>
is raised for non-real lattices.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1.26920930427955, 0.634604652139777 + 1.45881661693850*I)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">is_rectangular</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1.08852159290423, 1.76761067023379*I)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">is_rectangular</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>The period lattice is rectangular precisely if the
discriminant of the Weierstrass equation is positive, or
equivalently if the number of real components is 2.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.normalised_basis">
<span class="sig-name descname"><span class="pre">normalised_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sage'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.normalised_basis" title="Permalink to this definition">#</a></dt>
<dd><p>Return a normalised basis for this period lattice as a 2-tuple.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – precision in bits (default
precision if <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string, default ‘sage’) – choice of
implementation (for real embeddings only) between ‘sage’
(native Sage implementation) or ‘pari’ (use the PARI
library: only available for real embeddings).</p></li>
</ul>
<p>OUTPUT:</p>
<p>(tuple of Complex) <span class="math notranslate nohighlight">\((\omega_1,\omega_2)\)</span> where the lattice has
the form <span class="math notranslate nohighlight">\(\ZZ\omega_1 + \ZZ\omega_2\)</span>.  The basis is normalised
so that <span class="math notranslate nohighlight">\(\omega_1/\omega_2\)</span> is in the fundamental region of
the upper half-plane.  For an alternative normalisation for
real lattices (with the first period real), use the function
basis() instead.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">()</span>
<span class="go">(2.99345864623196, -2.45138938198679*I)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="go">(1.90726488608927255 - 1.34047785962440202*I,</span>
<span class="go">-1.90726488608927255 - 1.34047785962440202*I)</span>

<span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">();</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span>
<span class="go">(-1.37588604166076 - 2.58560946624443*I,</span>
<span class="go"> -2.10339907847356 + 0.428378776460622*I)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">w1</span><span class="o">/</span><span class="n">w2</span><span class="p">;</span> <span class="n">tau</span>
<span class="go">0.387694505032876 + 1.30821088214407*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.omega">
<span class="sig-name descname"><span class="pre">omega</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bsd_normalise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.omega" title="Permalink to this definition">#</a></dt>
<dd><p>Return the real or complex volume of this period lattice.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None``(default))</span> <span class="pre">--</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">in</span>
<span class="pre">bits</span> <span class="pre">(default</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">if</span> <span class="pre">``None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bsd_normalise</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) – flag to use
BSD normalisation in the complex case.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(real) For real lattices, this is the real period times the
number of connected components.  For non-real lattices it is
the complex area, or double the area if <code class="docutils literal notranslate"><span class="pre">bsd_normalise</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the curve is given by a <em>global minimal</em> Weierstrass
equation, then with <code class="docutils literal notranslate"><span class="pre">bsd_normalise</span></code> = <code class="docutils literal notranslate"><span class="pre">True</span></code>, this
gives the correct period in the BSD conjecture: the product
of this quantity over all embeddings appears in the BSD
formula. In general a correction factor is required to make
allowance for the model.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">5.98691729246392</span>
</pre></div>
</div>
<p>This is not a minimal model:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">432</span><span class="o">*</span><span class="mi">6</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">0.486109385710056</span>
</pre></div>
</div>
<p>If you were to plug the above omega into the BSD conjecture,
you would get an incorrect value, out by a factor of 2.  The
following works though:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">0.972218771420113</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">omega</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="go">3.81452977217854509</span>
</pre></div>
</div>
<p>A complex example (taken from J.E.Cremona and E.Whitley,
<em>Periods of cusp forms and elliptic curves over imaginary
quadratic fields</em>, Mathematics of Computation 62 No. 205
(1994), 407-429).  See <a class="reference external" href="https://github.com/sagemath/sage/issues/29645">github issue #29645</a> and <a class="reference external" href="https://github.com/sagemath/sage/issues/29782">github issue #29782</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">8.80694160502647</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">omega</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="go">8.8069416050264741493250743632295462227858630765392114070032</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">omega</span><span class="p">(</span><span class="n">bsd_normalise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">17.6138832100529</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.real_period">
<span class="sig-name descname"><span class="pre">real_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sage'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.real_period" title="Permalink to this definition">#</a></dt>
<dd><p>Return the real period of this period lattice.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – real precision in
bits (default real precision if <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string, default ‘sage’) – choice of
implementation (for real embeddings only) between ‘sage’
(native Sage implementation) or ‘pari’ (use the PARI
library: only available for real embeddings).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only defined for real lattices; a <a class="reference external" href="https://docs.python.org/library/exceptions.html#RuntimeError" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>
is raised for non-real lattices.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">real_period</span><span class="p">()</span>
<span class="go">2.99345864623196</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">real_period</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="go">3.81452977217854509</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.reduce">
<span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.reduce" title="Permalink to this definition">#</a></dt>
<dd><p>Reduce a complex number modulo the lattice</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">z</span></code> (complex) – A complex number.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(complex) the reduction of <span class="math notranslate nohighlight">\(z\)</span> modulo the lattice, lying in
the fundamental period parallelogram with respect to the
lattice basis.  For curves defined over the reals (i.e. real
embeddings) the output will be real when possible.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">zP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">zP</span>
<span class="go">0.47934825019021931612953301006 + 0.98586885077582410221120384908*I</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">zP</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">w1</span> <span class="o">-</span> <span class="mi">20</span><span class="o">*</span><span class="n">w2</span><span class="p">;</span> <span class="n">z</span>
<span class="go">25.381473858740770069343110929 - 38.448885180257139986236950114*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">0.47934825019021931612953301006 + 0.98586885077582410221120384908*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span>
<span class="go">0.958696500380439</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">))</span>
<span class="go">0.958696500380439</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">w1</span> <span class="o">-</span> <span class="mi">20</span><span class="o">*</span><span class="n">w2</span><span class="p">)</span>
<span class="go">0.958696500380444</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Return the value of the Weierstrass sigma function for this elliptic curve  period lattice.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">z</span></code> – a complex number</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">prec</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – real precision in bits</dt><dd><p>(default real precision if None).</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">flag</span></code> –</p>
<p>0: (default) ???;</p>
<p>1: computes an arbitrary determination of log(sigma(z))</p>
<p>2, 3: same using the product expansion instead of theta series. ???</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The reason for the ???’s above, is that the PARI
documentation for ellsigma is very vague.  Also this is
only implemented for curves defined over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
</div>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>This function does not use any of the PeriodLattice functions
and so should be moved to ell_rational_field.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">sigma</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">2.60912163570108 - 0.200865080824587*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sage'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.tau" title="Permalink to this definition">#</a></dt>
<dd><p>Return the upper half-plane parameter in the fundamental region.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – precision in bits (default
precision if <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string, default ‘sage’) – choice of
implementation (for real embeddings only) between ‘sage’
(native Sage implementation) or ‘pari’ (use the PARI
library: only available for real embeddings).</p></li>
</ul>
<p>OUTPUT:</p>
<p>(Complex) <span class="math notranslate nohighlight">\(\tau = \omega_1/\omega_2\)</span> where the lattice has the
form <span class="math notranslate nohighlight">\(\ZZ\omega_1 + \ZZ\omega_2\)</span>, normalised so that <span class="math notranslate nohighlight">\(\tau =
\omega_1/\omega_2\)</span> is in the fundamental region of the upper
half-plane.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">tau</span><span class="p">()</span>
<span class="go">1.22112736076463*I</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">tau</span><span class="p">();</span> <span class="n">tau</span>
<span class="go">-0.338718341018919 + 0.940887817679340*I</span>
<span class="gp">sage: </span><span class="n">tau</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="o">-</span><span class="mf">0.5</span> <span class="o">&lt;=</span> <span class="n">tau</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mf">0.5</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="c1"># needs sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">tau</span><span class="p">();</span> <span class="n">tau</span>
<span class="go">0.387694505032876 + 1.30821088214407*I</span>
<span class="gp">sage: </span><span class="n">tau</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1.36444961115933</span>
<span class="gp">sage: </span><span class="o">-</span><span class="mf">0.5</span> <span class="o">&lt;=</span> <span class="n">tau</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mf">0.5</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.extended_agm_iteration">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.period_lattice.</span></span><span class="sig-name descname"><span class="pre">extended_agm_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.extended_agm_iteration" title="Permalink to this definition">#</a></dt>
<dd><p>Internal function for the extended AGM used in elliptic logarithm computation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code> (real or complex) – three real or complex numbers.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(3-tuple) <span class="math notranslate nohighlight">\((a_0,b_0,c_0)\)</span>, the limit of the iteration <span class="math notranslate nohighlight">\((a,b,c) \mapsto ((a+b)/2,\sqrt{ab},(c+\sqrt(c^2+b^2-a^2))/2)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.real_mpfr</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.period_lattice</span> <span class="kn">import</span> <span class="n">extended_agm_iteration</span>
<span class="gp">sage: </span><span class="n">extended_agm_iteration</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">RR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">RR</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">(1.45679103104691, 1.45679103104691, 3.21245294970054)</span>
<span class="gp">sage: </span><span class="n">extended_agm_iteration</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">CC</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">CC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="go">(1.46242448156430 + 2.47791311676267*I,</span>
<span class="go"> 1.46242448156430 + 2.47791311676267*I,</span>
<span class="go"> 3.22202144343535 + 4.28383734262540*I)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.normalise_periods">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.period_lattice.</span></span><span class="sig-name descname"><span class="pre">normalise_periods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.normalise_periods" title="Permalink to this definition">#</a></dt>
<dd><p>Normalise the period basis <span class="math notranslate nohighlight">\((w_1,w_2)\)</span> so that <span class="math notranslate nohighlight">\(w_1/w_2\)</span> is in the fundamental region.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">w1,w2</span></code> (complex) – two complex numbers with non-real ratio</p></li>
</ul>
<p>OUTPUT:</p>
<p>(tuple) <span class="math notranslate nohighlight">\(((\omega_1',\omega_2'),[a,b,c,d])\)</span> where <span class="math notranslate nohighlight">\(a,b,c,d\)</span> are
integers such that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(ad-bc=\pm1\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\((\omega_1',\omega_2') = (a\omega_1+b\omega_2,c\omega_1+d\omega_2)\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau=\omega_1'/\omega_2'\)</span> is in the upper half plane;</p></li>
<li><p><span class="math notranslate nohighlight">\(|\tau|\ge1\)</span> and <span class="math notranslate nohighlight">\(|\Re(\tau)|\le\frac{1}{2}\)</span>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.real_mpfr sage.symbolic</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.period_lattice</span> <span class="kn">import</span> <span class="n">reduce_tau</span><span class="p">,</span> <span class="n">normalise_periods</span>
<span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="n">CC</span><span class="p">(</span><span class="mf">1.234</span><span class="p">,</span> <span class="mf">3.456</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">CC</span><span class="p">(</span><span class="mf">1.234</span><span class="p">,</span> <span class="mf">3.456000001</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="o">/</span><span class="n">w2</span>    <span class="c1"># in lower half plane!</span>
<span class="go">0.999999999743367 - 9.16334785827644e-11*I</span>
<span class="gp">sage: </span><span class="n">w1w2</span><span class="p">,</span> <span class="n">abcd</span> <span class="o">=</span> <span class="n">normalise_periods</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">abcd</span>
<span class="gp">sage: </span><span class="n">w1w2</span> <span class="o">==</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">w1</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">w2</span><span class="p">,</span> <span class="n">c</span><span class="o">*</span><span class="n">w1</span><span class="o">+</span><span class="n">d</span><span class="o">*</span><span class="n">w2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w1w2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">w1w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">1.23400010389203e9*I</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">*</span><span class="n">d</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="c1"># note change of orientation</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.period_lattice.reduce_tau">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.period_lattice.</span></span><span class="sig-name descname"><span class="pre">reduce_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.reduce_tau" title="Permalink to this definition">#</a></dt>
<dd><p>Transform a point in the upper half plane to the fundamental region.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tau</span></code> (complex) – a complex number with positive imaginary part</p></li>
</ul>
<p>OUTPUT:</p>
<p>(tuple) <span class="math notranslate nohighlight">\((\tau',[a,b,c,d])\)</span> where <span class="math notranslate nohighlight">\(a,b,c,d\)</span> are integers such that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(ad-bc=1\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau'=(a\tau+b)/(c\tau+d)\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(|\tau'|\ge1\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(|\Re(\tau')|\le\frac{1}{2}\)</span>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.real_mpfr sage.symbolic</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.period_lattice</span> <span class="kn">import</span> <span class="n">reduce_tau</span>
<span class="gp">sage: </span><span class="n">reduce_tau</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">1.23</span><span class="p">,</span><span class="mf">3.45</span><span class="p">))</span>
<span class="go">(0.230000000000000 + 3.45000000000000*I, [1, -1, 0, 1])</span>
<span class="gp">sage: </span><span class="n">reduce_tau</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">1.23</span><span class="p">,</span><span class="mf">0.0345</span><span class="p">))</span>
<span class="go">(-0.463960069171512 + 1.35591888067914*I, [-5, 6, 4, -5])</span>
<span class="gp">sage: </span><span class="n">reduce_tau</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">1.23</span><span class="p">,</span><span class="mf">0.0000345</span><span class="p">))</span>
<span class="go">(0.130000000001761 + 2.89855072463768*I, [13, -16, 100, -123])</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="period_lattice_region.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Regions in fundamental domains of period lattices</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="ell_wp.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function for elliptic curves</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Period lattices of elliptic curves and related functions</a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice"><code class="docutils literal notranslate"><span class="pre">PeriodLattice</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell"><code class="docutils literal notranslate"><span class="pre">PeriodLattice_ell</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis"><code class="docutils literal notranslate"><span class="pre">basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis_matrix"><code class="docutils literal notranslate"><span class="pre">basis_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.complex_area"><code class="docutils literal notranslate"><span class="pre">complex_area()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.coordinates"><code class="docutils literal notranslate"><span class="pre">coordinates()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.curve"><code class="docutils literal notranslate"><span class="pre">curve()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.e_log_RC"><code class="docutils literal notranslate"><span class="pre">e_log_RC()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.ei"><code class="docutils literal notranslate"><span class="pre">ei()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.elliptic_exponential"><code class="docutils literal notranslate"><span class="pre">elliptic_exponential()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.elliptic_logarithm"><code class="docutils literal notranslate"><span class="pre">elliptic_logarithm()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.gens"><code class="docutils literal notranslate"><span class="pre">gens()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.is_real"><code class="docutils literal notranslate"><span class="pre">is_real()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.is_rectangular"><code class="docutils literal notranslate"><span class="pre">is_rectangular()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.normalised_basis"><code class="docutils literal notranslate"><span class="pre">normalised_basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.omega"><code class="docutils literal notranslate"><span class="pre">omega()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.real_period"><code class="docutils literal notranslate"><span class="pre">real_period()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.reduce"><code class="docutils literal notranslate"><span class="pre">reduce()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.sigma"><code class="docutils literal notranslate"><span class="pre">sigma()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.tau"><code class="docutils literal notranslate"><span class="pre">tau()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.extended_agm_iteration"><code class="docutils literal notranslate"><span class="pre">extended_agm_iteration()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.normalise_periods"><code class="docutils literal notranslate"><span class="pre">normalise_periods()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.reduce_tau"><code class="docutils literal notranslate"><span class="pre">reduce_tau()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>