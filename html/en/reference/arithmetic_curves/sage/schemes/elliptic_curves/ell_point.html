<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Elliptic curves over a general ring" href="ell_generic.html" /><link rel="prev" title="Construct elliptic curves as Jacobians" href="jacobian.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Points on elliptic curves - Elliptic curves</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZGD13B5572"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ZGD13B5572');
</script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Elliptic curves</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 9.8 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Elliptic curves</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="constructor.html">Elliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian.html">Construct elliptic curves as Jacobians</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Points on elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_generic.html">Elliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_field.html">Elliptic curves over a general field</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_finite_field.html">Elliptic curves over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="formal_group.html">Formal groups of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hom.html">Elliptic-curve morphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_morphism.html">Isomorphisms between Weierstrass models of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_curve_isogeny.html">Isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_velusqrt.html">√élu algorithm for elliptic-curve isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_composite.html">Composite morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_scalar.html">Scalar-multiplication morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_frobenius.html">Frobenius isogenies of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_small_degree.html">Isogenies of small prime degree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_rational_field.html">Elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ec_database.html">Tables of elliptic curves of given rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_number_field.html">Elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="height.html">Canonical heights for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="saturation.html">Saturation of Mordell-Weil groups of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_torsion.html">Torsion subgroups of elliptic curves over number fields (including <span class="math notranslate nohighlight">\(\QQ\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps.html">Galois representations attached to elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps_number_field.html">Galois representations for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_class.html">Isogeny class of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="sha_tate.html">Tate-Shafarevich group</a></li>
<li class="toctree-l1"><a class="reference internal" href="cm.html">Complex multiplication for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="Qcurves.html">Testing whether elliptic curves over number fields are <span class="math notranslate nohighlight">\(\QQ\)</span>-curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_local_data.html">Local data for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="kodaira_symbol.html">Kodaira symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_tate_curve.html">Tate’s parametrisation of <span class="math notranslate nohighlight">\(p\)</span>-adic curves with multiplicative reduction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_wp.html">Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice.html">Period lattices of elliptic curves and related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice_region.html">Regions in fundamental domains of period lattices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modular_parametrization.html">Modular parametrization of elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_modular_symbols.html">Modular symbols attached to elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="mod_sym_num.html">Modular symbols by numerical integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lseries_ell.html"><span class="math notranslate nohighlight">\(L\)</span>-series for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="heegner.html">Heegner points on elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_lseries.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="descent_two_isogeny.html">Descent on elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span> with a 2-isogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_egros.html">Elliptic curves with prescribed good reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_padic_field.html">Elliptic curves over padic fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="gp_simon.html">Denis Simon’s PARI scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="mod5family.html">Elliptic curves with congruent mod-5 representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_transform.html">Morphism to bring a genus-one curve into Weierstrass form</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/constructor.html">Hyperelliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_generic.html">Hyperelliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_finite_field.html">Hyperelliptic curves over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_padic_field.html">Hyperelliptic curves over a <span class="math notranslate nohighlight">\(p\)</span>-adic field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_rational_field.html">Hyperelliptic curves over the rationals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/mestre.html">Mestre’s algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/monsky_washnitzer.html">Computation of Frobenius matrix on Monsky-Washnitzer cohomology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hypellfrob.html">Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over a</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_generic.html">Jacobian of a general hyperelliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_g2.html">Jacobian of a hyperelliptic curve of genus 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_homset.html">Rational point sets on a Jacobian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_morphism.html">Jacobian ‘morphism’ as a class in the Picard group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_g2.html">Hyperelliptic curves of genus 2 over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/invariants.html">Compute invariants of quintics and sextics via ‘Ueberschiebung’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/kummer_surface.html">Kummer surfaces over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/genus2reduction.html">Conductor and reduction types for genus 2 curves</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="points-on-elliptic-curves">
<span id="sage-schemes-elliptic-curves-ell-point"></span><h1>Points on elliptic curves<a class="headerlink" href="#points-on-elliptic-curves" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.ell_point"></span><p>The base class <code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint_field</span></code>, derived from
<code class="docutils literal notranslate"><span class="pre">AdditiveGroupElement</span></code>, provides support for points on elliptic
curves defined over general fields.  The derived classes
<code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint_number_field</span></code> and
<code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint_finite_field</span></code> provide further support for point
on curves defined over number fields (including the rational field
<span class="math notranslate nohighlight">\(\QQ\)</span>) and over finite fields.</p>
<p>The class <code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint</span></code>, which is based on
<code class="docutils literal notranslate"><span class="pre">SchemeMorphism_point_projective_ring</span></code>, currently has little extra
functionality.</p>
<p>EXAMPLES:</p>
<p>An example over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(-1 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(0 : -1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">+</span><span class="n">Q</span>
<span class="go">(4 : 8 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">-</span><span class="n">Q</span>
<span class="go">(1 : 0 : 1)</span>
<span class="gp">sage: </span><span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">Q</span>
<span class="go">(328/361 : -2800/6859 : 1)</span>
</pre></div>
</div>
<p>An example over a number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(0 : i : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="mi">101</span><span class="o">*</span><span class="n">P</span><span class="o">-</span><span class="mi">100</span><span class="o">*</span><span class="n">P</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example over a finite field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="mi">101</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">40</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">69</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">84</span> <span class="p">,</span> <span class="mi">58</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">73</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">1032210</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">1032210</span>
</pre></div>
</div>
<p>Arithmetic with a point over an extension of a finite field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x over Finite Field in a of size 5^2</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="mi">5</span><span class="o">*</span><span class="n">P</span>
<span class="go">(2*a + 3 : 2*a : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">*</span><span class="mi">5</span>
<span class="go">(2*a + 3 : 2*a : 1)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">+</span> <span class="n">P</span> <span class="o">+</span> <span class="n">P</span> <span class="o">+</span> <span class="n">P</span> <span class="o">+</span> <span class="n">P</span>
<span class="go">(2*a + 3 : 2*a : 1)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">n</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Arithmetic over <span class="math notranslate nohighlight">\(\ZZ/N\ZZ\)</span> with composite <span class="math notranslate nohighlight">\(N\)</span> is supported.  When an
operation tries to invert a non-invertible element, a
ZeroDivisionError is raised and a factorization of the modulus appears
in the error message:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1715761513</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">N</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">13</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">LCM</span><span class="p">([</span><span class="mf">2..60</span><span class="p">])</span><span class="o">*</span><span class="n">P</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ZeroDivisionError: Inverse of 26927 does not exist (characteristic = 1715761513 = 26927*63719)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein (2005) – Initial version</p></li>
<li><p>Robert Bradshaw et al….</p></li>
<li><p>John Cremona (Feb 2008) – Point counting and group structure for
non-prime fields, Frobenius endomorphism and order, elliptic logs</p></li>
<li><p>John Cremona (Aug 2008) – Introduced <code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint_number_field</span></code> class</p></li>
<li><p>Tobias Nagel, Michael Mardaus, John Cremona (Dec 2008) – <span class="math notranslate nohighlight">\(p\)</span>-adic elliptic logarithm over <span class="math notranslate nohighlight">\(\QQ\)</span></p></li>
<li><p>David Hansen (Jan 2009) – Added <code class="docutils literal notranslate"><span class="pre">weil_pairing</span></code> function to <code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint_finite_field</span></code> class</p></li>
<li><p>Mariah Lenox (March 2011) – Added <code class="docutils literal notranslate"><span class="pre">tate_pairing</span></code> and <code class="docutils literal notranslate"><span class="pre">ate_pairing</span></code>
functions to <code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint_finite_field</span></code> class</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.ell_point.</span></span><span class="sig-name descname"><span class="pre">EllipticCurvePoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../schemes/sage/schemes/projective/projective_point.html#sage.schemes.projective.projective_point.SchemeMorphism_point_projective_ring" title="(in Schemes v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_point_projective_ring</span></code></a></p>
<p>A point on an elliptic curve.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.ell_point.</span></span><span class="sig-name descname"><span class="pre">EllipticCurvePoint_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../schemes/sage/schemes/projective/projective_point.html#sage.schemes.projective.projective_point.SchemeMorphism_point_abelian_variety_field" title="(in Schemes v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_point_abelian_variety_field</span></code></a></p>
<p>A point on an elliptic curve over a field.  The point has coordinates
in the base field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>               <span class="c1"># brackets are optional</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>     <span class="c1"># entries are coerced</span>
<span class="go">(0 : 0 : 1)</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mf">0.000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(0 : 0 : 1)</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: Coordinates [1, 0, 0] do not define a point on</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">QQ</span><span class="p">);</span> <span class="n">S</span>
<span class="go">Abelian group of points on Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">160</span><span class="p">,</span><span class="mi">308</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="o">-</span><span class="mi">120</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">36</span><span class="o">+</span><span class="mi">48</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span>  <span class="c1"># long time (3s)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">==</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span>
<span class="go">((0 : t : 1), (0 : -t : 1), (0 : 1 : 0))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order">
<span class="sig-name descname"><span class="pre">additive_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>If the point is zero, returns 1, otherwise raise a
NotImplementedError.</p>
<p>For curves over number fields and finite fields, see below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">order()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: Computation of order of a point not implemented over general fields.</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.ate_pairing">
<span class="sig-name descname"><span class="pre">ate_pairing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.ate_pairing" title="Permalink to this definition">#</a></dt>
<dd><p>Return ate pairing of <span class="math notranslate nohighlight">\(n\)</span>-torsion points <span class="math notranslate nohighlight">\(P=self\)</span> and <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>Also known as the <span class="math notranslate nohighlight">\(n\)</span>-th modified ate pairing. <span class="math notranslate nohighlight">\(P\)</span> is <span class="math notranslate nohighlight">\(GF(q)\)</span>-rational,
and <span class="math notranslate nohighlight">\(Q\)</span> must be an element of <span class="math notranslate nohighlight">\(Ker(\pi-p)\)</span>, where <span class="math notranslate nohighlight">\(\pi\)</span> is the
<span class="math notranslate nohighlight">\(q\)</span>-frobenius map (and hence <span class="math notranslate nohighlight">\(Q\)</span> is <span class="math notranslate nohighlight">\(GF(q^k)\)</span>-rational).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P=self</span></code> – a point of order <span class="math notranslate nohighlight">\(n\)</span>, in <span class="math notranslate nohighlight">\(ker(\pi-1)\)</span>, where
<span class="math notranslate nohighlight">\(\pi\)</span> is the <span class="math notranslate nohighlight">\(q\)</span>-Frobenius map (e.g., <span class="math notranslate nohighlight">\(P\)</span> is <span class="math notranslate nohighlight">\(q-rational\)</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – a point of order <span class="math notranslate nohighlight">\(n\)</span> in <span class="math notranslate nohighlight">\(ker(\pi-q)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – the order of <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – the embedding degree.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> – the trace of Frobenius of the curve over <span class="math notranslate nohighlight">\(GF(q)\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">q</span></code> – (default: None) the size of base field (the “big”
field is <span class="math notranslate nohighlight">\(GF(q^k)\)</span>). <span class="math notranslate nohighlight">\(q\)</span> needs to be set only if its value
cannot be deduced.</p></li>
</ul>
<p>OUTPUT:</p>
<p>FiniteFieldElement in <span class="math notranslate nohighlight">\(GF(q^k)\)</span> – the ate pairing of <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>EXAMPLES:</p>
<p>An example with embedding degree 6:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7549</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">157</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">14</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[];</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">modulus</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">3050</span><span class="p">,</span> <span class="mi">5371</span><span class="p">);</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">6908</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3231</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">6708*a^5 + 4230*a^4 + 4350*a^3 + 2064*a^2 + 4022*a + 6733</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Another example with embedding degree 7 and positive trace:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2213</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">49</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1093</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">28</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[];</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">modulus</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">1583</span><span class="p">,</span> <span class="mi">1734</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="mi">1729</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">1767</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">245</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">980</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1592</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1883</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">722</span>
<span class="gp">sage: </span><span class="n">Qy</span> <span class="o">=</span> <span class="mi">1299</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">1877</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1030</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1513</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1457</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">309</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1636</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">1665*a^6 + 1538*a^5 + 1979*a^4 + 239*a^3 + 2134*a^2 + 2151*a + 654</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Another example with embedding degree 7 and negative trace:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2017</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">29</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">70</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[];</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">modulus</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">369</span><span class="p">,</span> <span class="mi">716</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="mi">1226</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">1778</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">660</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1791</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1750</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">867</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">770</span>
<span class="gp">sage: </span><span class="n">Qy</span> <span class="o">=</span> <span class="mi">1764</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">198</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1206</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">406</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1200</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">273</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1712</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">1794*a^6 + 1161*a^5 + 576*a^4 + 488*a^3 + 1950*a^2 + 1905*a + 1315</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Using the same data, we show that the ate pairing is a power of the
Tate pairing (see <a class="reference internal" href="../../../../references/index.html#hsv2006" id="id1"><span>[HSV2006]</span></a> end of section 3.1):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">p</span><span class="o">^</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="n">T</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">T</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">((</span><span class="n">T</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="n">c</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">^</span><span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example where we have to pass the base field size (and we again have
agreement with the Tate pairing). Note that though <span class="math notranslate nohighlight">\(Px\)</span> is not
<span class="math notranslate nohighlight">\(F\)</span>-rational, (it is the homomorphic image of an <span class="math notranslate nohighlight">\(F\)</span>-rational point) it
is nonetheless in <span class="math notranslate nohighlight">\(ker(\pi-1)\)</span>, and so is a legitimate input:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">;</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Fx</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ex</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Fx</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">=</span><span class="n">Hom</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">Fx</span><span class="p">)(</span><span class="n">F</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">Fx</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">=</span><span class="n">Ex</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">(</span><span class="n">b</span><span class="o">^</span><span class="mi">19</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">9</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">13</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">(</span><span class="n">Qx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">^</span><span class="n">q</span><span class="p">,</span> <span class="n">Qx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="n">q</span><span class="p">)</span> <span class="o">-</span> <span class="n">Qx</span>  <span class="c1"># ensure Qx is in ker(pi - q)</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Unexpected field degree: set keyword argument q equal to the size of the base field (big field is GF(q^4)).</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="go">b^19 + b^18 + b^17 + b^16 + b^15 + b^14 + b^13 + b^12 + b^11 + b^9 + b^8 + b^5 + b^4 + b^2 + b + 1</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Px</span><span class="p">)</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="n">T</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">T</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">((</span><span class="n">T</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="n">c</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">Qx</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Px</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span><span class="o">^</span><span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It is an error if <span class="math notranslate nohighlight">\(Q\)</span> is not in the kernel of <span class="math notranslate nohighlight">\(\pi - p\)</span>, where <span class="math notranslate nohighlight">\(\pi\)</span> is
the Frobenius automorphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">29</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]);</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">modulus</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span> <span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Point (13 : 21 : 1) not in Ker(pi - q)</span>
</pre></div>
</div>
<p>It is also an error if <span class="math notranslate nohighlight">\(P\)</span> is not in the kernel os <span class="math notranslate nohighlight">\(\pi - 1\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">29</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]);</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">modulus</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span> <span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">a</span><span class="p">);</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: This point (14 : 10*a : 1) is not in Ker(pi - 1)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>First defined in the paper of <a class="reference internal" href="../../../../references/index.html#hsv2006" id="id2"><span>[HSV2006]</span></a>, the ate pairing
can be computationally effective in those cases when the
trace of the curve over the base field is significantly
smaller than the expected value. This implementation is
simply Miller’s algorithm followed by a naive
exponentiation, and makes no claims towards efficiency.</p>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Mariah Lenox (2011-03-08)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.curve">
<span class="sig-name descname"><span class="pre">curve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.curve" title="Permalink to this definition">#</a></dt>
<dd><p>Return the curve that this point is on.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.division_points">
<span class="sig-name descname"><span class="pre">division_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.division_points" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of all points <span class="math notranslate nohighlight">\(Q\)</span> such that <span class="math notranslate nohighlight">\(mQ=P\)</span> where <span class="math notranslate nohighlight">\(P\)</span> = self.</p>
<p>Only points on the elliptic curve containing self and defined
over the base field are included.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – a positive integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">poly_only</span></code> – bool (default: False); if True return
polynomial whose roots give all possible <span class="math notranslate nohighlight">\(x\)</span>-coordinates of
<span class="math notranslate nohighlight">\(m\)</span>-th roots of self.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(list) – a (possibly empty) list of solutions <span class="math notranslate nohighlight">\(Q\)</span> to <span class="math notranslate nohighlight">\(mQ=P\)</span>,
where <span class="math notranslate nohighlight">\(P\)</span> = self.</p>
<p>EXAMPLES:</p>
<p>We find the five 5-torsion points on an elliptic curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : -6 : 1), (5 : 5 : 1), (16 : -61 : 1), (16 : 60 : 1)]</span>
</pre></div>
</div>
<p>Note above that 0 is included since [5]*0 = 0.</p>
<p>We create a curve of rank 1 with no torsion and do a consistency check:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">44</span><span class="p">,</span><span class="o">-</span><span class="mi">270</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Q</span><span class="p">)</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[(44 : -270 : 1)]</span>
</pre></div>
</div>
<p>We create a curve over a non-prime finite field with group of
order <span class="math notranslate nohighlight">\(18\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">order</span><span class="p">())</span>
<span class="go">2 * 3^2</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
<p>We find the <span class="math notranslate nohighlight">\(1\)</span>-division points as a consistency check – there
is just one, of course:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[(3 : 3*a + 4 : 1)]</span>
</pre></div>
</div>
<p>The point <span class="math notranslate nohighlight">\(P\)</span> has order coprime to 2 but divisible by 3, so:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(2*a + 1 : 3*a + 4 : 1), (3*a + 1 : a : 1)]</span>
</pre></div>
</div>
<p>We check that each of the 2-division points works as claimed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span> <span class="k">for</span> <span class="n">Q</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[(3 : 3*a + 4 : 1), (3 : 3*a + 4 : 1)]</span>
</pre></div>
</div>
<p>Some other checks:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[(0 : 3*a + 2 : 1), (1 : 0 : 1)]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[(1 : 1 : 1)]</span>
</pre></div>
</div>
<p>An example over a number field (see <a class="reference external" href="https://trac.sagemath.org/3383">trac ticket #3383</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;19a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span><span class="o">+</span><span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : -10 : 1), (5 : 9 : 1)]</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : 9 : 1), (5 : -10 : 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : -10 : 1), (5 : 9 : 1)]</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : 9 : 1), (5 : -10 : 1), (-150/121*t^8 + 414/121*t^7 + 1481/242*t^6 - 2382/121*t^5 - 103/242*t^4 + 629/22*t^3 - 367/242*t^2 - 1307/121*t + 625/121 : 35/484*t^8 - 133/242*t^7 + 445/242*t^6 - 799/242*t^5 + 373/484*t^4 + 113/22*t^3 - 2355/484*t^2 - 753/242*t + 1165/484 : 1), (-150/121*t^8 + 414/121*t^7 + 1481/242*t^6 - 2382/121*t^5 - 103/242*t^4 + 629/22*t^3 - 367/242*t^2 - 1307/121*t + 625/121 : -35/484*t^8 + 133/242*t^7 - 445/242*t^6 + 799/242*t^5 - 373/484*t^4 - 113/22*t^3 + 2355/484*t^2 + 753/242*t - 1649/484 : 1), (-1383/484*t^8 + 970/121*t^7 + 3159/242*t^6 - 5211/121*t^5 + 37/484*t^4 + 654/11*t^3 - 909/484*t^2 - 4831/242*t + 6791/484 : 927/121*t^8 - 5209/242*t^7 - 8187/242*t^6 + 27975/242*t^5 - 1147/242*t^4 - 1729/11*t^3 + 1566/121*t^2 + 12873/242*t - 10871/242 : 1), (-1383/484*t^8 + 970/121*t^7 + 3159/242*t^6 - 5211/121*t^5 + 37/484*t^4 + 654/11*t^3 - 909/484*t^2 - 4831/242*t + 6791/484 : -927/121*t^8 + 5209/242*t^7 + 8187/242*t^6 - 27975/242*t^5 + 1147/242*t^4 + 1729/11*t^3 - 1566/121*t^2 - 12873/242*t + 10629/242 : 1), (-4793/484*t^8 + 6791/242*t^7 + 10727/242*t^6 - 18301/121*t^5 + 2347/484*t^4 + 2293/11*t^3 - 7311/484*t^2 - 17239/242*t + 26767/484 : 30847/484*t^8 - 21789/121*t^7 - 34605/121*t^6 + 117164/121*t^5 - 10633/484*t^4 - 29437/22*t^3 + 39725/484*t^2 + 55428/121*t - 176909/484 : 1), (-4793/484*t^8 + 6791/242*t^7 + 10727/242*t^6 - 18301/121*t^5 + 2347/484*t^4 + 2293/11*t^3 - 7311/484*t^2 - 17239/242*t + 26767/484 : -30847/484*t^8 + 21789/121*t^7 + 34605/121*t^6 - 117164/121*t^5 + 10633/484*t^4 + 29437/22*t^3 - 39725/484*t^2 - 55428/121*t + 176425/484 : 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.has_finite_order">
<span class="sig-name descname"><span class="pre">has_finite_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.has_finite_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if this point has finite additive order as an
element of the group of points on this curve.</p>
<p>For fields other than number fields and finite fields, this is
NotImplemented unless self.is_zero().</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: Computation of order of a point not implemented over general fields.</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.has_infinite_order">
<span class="sig-name descname"><span class="pre">has_infinite_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.has_infinite_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this point has infinite additive order as an element
of the group of points on this curve.</p>
<p>For fields other than number fields and finite fields, this is
NotImplemented unless self.is_zero().</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_infinite_order</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_infinite_order</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: Computation of order of a point not implemented over general fields.</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.is_divisible_by">
<span class="sig-name descname"><span class="pre">is_divisible_by</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.is_divisible_by" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if there exists a point <span class="math notranslate nohighlight">\(Q\)</span> defined over the same
field as self such that <span class="math notranslate nohighlight">\(mQ\)</span> == self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – a positive integer.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(bool) – True if there is a solution, else False.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function usually triggers the computation of the
<span class="math notranslate nohighlight">\(m\)</span>-th division polynomial of the associated elliptic
curve, which will be expensive if <span class="math notranslate nohighlight">\(m\)</span> is large, though it
will be cached for subsequent calls with the same <span class="math notranslate nohighlight">\(m\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(-2739/1444 : -77033/54872 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_divisible_by</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_divisible_by</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A finite field example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">101</span><span class="p">),[</span><span class="mi">23</span><span class="p">,</span><span class="mi">34</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2 * 53</span>
<span class="gp">sage: </span><span class="n">Set</span><span class="p">([</span><span class="n">T</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">()])</span>
<span class="go">{1, 106, 2, 53}</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">([</span><span class="n">T</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">()</span> <span class="k">if</span> <span class="n">T</span><span class="o">.</span><span class="n">is_divisible_by</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="go">53</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">([</span><span class="n">T</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">()</span> <span class="k">if</span> <span class="n">T</span><span class="o">.</span><span class="n">is_divisible_by</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">106</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.is_finite_order">
<span class="sig-name descname"><span class="pre">is_finite_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.is_finite_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if this point has finite additive order as an
element of the group of points on this curve.</p>
<p>For fields other than number fields and finite fields, this is
NotImplemented unless self.is_zero().</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: Computation of order of a point not implemented over general fields.</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order">
<span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>If the point is zero, returns 1, otherwise raise a
NotImplementedError.</p>
<p>For curves over number fields and finite fields, see below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">order()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: Computation of order of a point not implemented over general fields.</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Plot this point on an elliptic curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">**args</span></code> – all arguments get passed directly onto the point
plotting function.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pointsize</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.scheme">
<span class="sig-name descname"><span class="pre">scheme</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.scheme" title="Permalink to this definition">#</a></dt>
<dd><p>Return the scheme of this point, i.e., the curve it is on.
This is synonymous with <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.curve" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.curve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">curve()</span></code></a> which is perhaps more
intuitive.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">scheme</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x + 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">scheme</span><span class="p">()</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">scheme</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x + 1 over Number Field in a with defining polynomial x^2 - 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.set_order">
<span class="sig-name descname"><span class="pre">set_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.set_order" title="Permalink to this definition">#</a></dt>
<dd><p>Set the value of self._order to value.</p>
<p>Use this when you know a priori the order of this point to avoid a
potentially expensive order calculation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">value</span></code> – positive integer</p></li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
<p>EXAMPLES:</p>
<p>This example illustrates basic usage.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># This curve has order 12</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">G</span>
<span class="go">(0 : 1 : 0)</span>
</pre></div>
</div>
<p>We now give a more interesting case, the NIST-P521 curve. Its
order is too big to calculate with Sage, and takes a long time
using other packages, so it is very useful here.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">521</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">prev_proof_state</span> <span class="o">=</span> <span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># turn off primality checking</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="mi">1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="mi">6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">F</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="n">B</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">*</span> <span class="n">G</span>  <span class="c1"># This takes practically no time.</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="n">prev_proof_state</span><span class="p">)</span> <span class="c1"># restore state</span>
</pre></div>
</div>
<p>It is an error to pass a <span class="math notranslate nohighlight">\(value\)</span> equal to <span class="math notranslate nohighlight">\(0\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># This curve has order 12</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Value 0 illegal for point order</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Value 1000 illegal: outside max Hasse bound</span>
</pre></div>
</div>
<p>It is also very likely an error to pass a value which is not the actual
order of this point. How unlikely is determined by the factorization of
the actual order, and the actual group structure:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># This curve has order 12</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># G has order 2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Value 11 illegal: 11 * (5 : 0 : 1) is not the identity</span>
</pre></div>
</div>
<p>However, set_order can be fooled, though it’s not likely in “real cases
of interest”. For instance, the order can be set to a multiple the
actual order:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># This curve has order 12</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># G has order 2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<blockquote>
<div><ul class="simple">
<li><p>Mariah Lenox (2011-02-16)</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.tate_pairing">
<span class="sig-name descname"><span class="pre">tate_pairing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.tate_pairing" title="Permalink to this definition">#</a></dt>
<dd><p>Return Tate pairing of <span class="math notranslate nohighlight">\(n\)</span>-torsion point <span class="math notranslate nohighlight">\(P = self\)</span> and point <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>The value returned is <span class="math notranslate nohighlight">\(f_{n,P}(Q)^e\)</span> where <span class="math notranslate nohighlight">\(f_{n,P}\)</span> is a function with
divisor <span class="math notranslate nohighlight">\(n[P]-n[O].\)</span>. This is also known as the “modified Tate
pairing”. It is a well-defined bilinear map.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P=self</span></code> – Elliptic curve point having order n</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – Elliptic curve point on same curve as P (can be any order)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – positive integer: order of P</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – positive integer: embedding degree</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">q</span></code> – positive integer: size of base field (the “big”
field is <span class="math notranslate nohighlight">\(GF(q^k)\)</span>. <span class="math notranslate nohighlight">\(q\)</span> needs to be set only if its value
cannot be deduced.)</p></li>
</ul>
<p>OUTPUT:</p>
<p>An <span class="math notranslate nohighlight">\(n\)</span>’th root of unity in the base field self.curve().base_field()</p>
<p>EXAMPLES:</p>
<p>A simple example, pairing a point with itself, and pairing a point with
another rational point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">103</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mi">91</span><span class="p">);</span> <span class="n">n</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">();</span> <span class="n">n</span>
<span class="go">19</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">n</span><span class="p">)(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">();</span> <span class="n">k</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">87</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>We now let Q be a point on the same curve as above, but defined over
the pairing extension field, and we also demonstrate the bilinearity of
the pairing:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="mi">69</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">96</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">22</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">86</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">35</span>
<span class="gp">sage: </span><span class="n">Qy</span> <span class="o">=</span> <span class="mi">34</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">24</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">41</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">40</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">);</span>
</pre></div>
</div>
<p>Multiply by cofactor so Q has order n:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="mi">551269674</span><span class="p">;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">Q</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">24*a^5 + 34*a^4 + 3*a^3 + 69*a^2 + 86*a + 45</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">ans1</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ans2</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ans3</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="gp">sage: </span><span class="n">ans1</span> <span class="o">==</span> <span class="n">ans2</span> <span class="o">==</span> <span class="n">ans3</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">ans1</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ans1</span><span class="o">^</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Here is an example of using the Tate pairing to compute the Weil
pairing (using the same data as above):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">((</span><span class="n">p</span><span class="o">^</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">);</span> <span class="n">e</span>
<span class="go">62844857712</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="n">e</span>
<span class="go">94*a^5 + 99*a^4 + 29*a^3 + 45*a^2 + 57*a + 34</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">_miller_</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="n">e</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">_miller_</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="n">e</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">Q</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">94*a^5 + 99*a^4 + 29*a^3 + 45*a^2 + 57*a + 34</span>
</pre></div>
</div>
<p>An example where we have to pass the base field size (and we again have
agreement with the Weil pairing):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Fx</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Ex</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Fx</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">=</span><span class="n">Hom</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">Fx</span><span class="p">)(</span><span class="n">F</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">Fx</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">=</span><span class="n">Ex</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">(</span><span class="n">b</span><span class="o">^</span><span class="mi">19</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">9</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">13</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">41</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Unexpected field degree: set keyword argument q equal to the size of the base field (big field is GF(q^4)).</span>
<span class="gp">sage: </span><span class="n">num</span> <span class="o">=</span> <span class="n">Px</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">41</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">32</span><span class="p">);</span> <span class="n">num</span>
<span class="go">b^19 + b^14 + b^13 + b^12 + b^6 + b^4 + b^3</span>
<span class="gp">sage: </span><span class="n">den</span> <span class="o">=</span> <span class="n">Qx</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Px</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">41</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">32</span><span class="p">);</span> <span class="n">den</span>
<span class="go">b^19 + b^17 + b^16 + b^15 + b^14 + b^10 + b^6 + b^2 + 1</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">((</span><span class="mi">32</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">41</span><span class="p">);</span> <span class="n">e</span>
<span class="go">25575</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="mi">41</span><span class="p">)</span><span class="o">^</span><span class="n">e</span> <span class="o">==</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function uses Miller’s algorithm, followed by a naive
exponentiation. It does not do anything fancy. In the case
that there is an issue with <span class="math notranslate nohighlight">\(Q\)</span> being on one of the lines
generated in the <span class="math notranslate nohighlight">\(r*P\)</span> calculation, <span class="math notranslate nohighlight">\(Q\)</span> is offset by a random
point <span class="math notranslate nohighlight">\(R\)</span> and P.tate_pairing(Q+R,n,k)/P.tate_pairing(R,n,k)
is returned.</p>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Mariah Lenox (2011-03-07)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.weil_pairing">
<span class="sig-name descname"><span class="pre">weil_pairing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.weil_pairing" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the Weil pairing of this point with another point <span class="math notranslate nohighlight">\(Q\)</span>
on the same curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – another point on the same curve as <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer <span class="math notranslate nohighlight">\(n\)</span> such that <span class="math notranslate nohighlight">\(nP = nQ = (0:1:0)\)</span>, where
<span class="math notranslate nohighlight">\(P\)</span> is <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – choices are <code class="docutils literal notranslate"><span class="pre">pari</span></code>
and <code class="docutils literal notranslate"><span class="pre">sage</span></code>. PARI is usually significantly faster, but it
only works over finite fields. When <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, a
suitable algorithm is chosen automatically.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An <span class="math notranslate nohighlight">\(n\)</span>’th root of unity in the base field of the curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Fx</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Ex</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Fx</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">=</span><span class="n">Hom</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">Fx</span><span class="p">)(</span><span class="n">F</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">Fx</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">=</span><span class="n">Ex</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">(</span><span class="n">b</span><span class="o">^</span><span class="mi">19</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">18</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">16</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">18</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span><span class="mi">41</span><span class="p">)</span> <span class="o">==</span> <span class="n">b</span><span class="o">^</span><span class="mi">19</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">15</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="mi">17</span><span class="o">*</span><span class="n">Px</span><span class="p">,</span><span class="mi">41</span><span class="p">)</span> <span class="o">==</span> <span class="n">Fx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">O</span><span class="p">,</span><span class="mi">41</span><span class="p">)</span> <span class="o">==</span> <span class="n">Fx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An error is raised if either point is not <span class="math notranslate nohighlight">\(n\)</span>-torsion:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">O</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: points must both be n-torsion</span>
</pre></div>
</div>
<p>A larger example (see <a class="reference external" href="https://trac.sagemath.org/4964">trac ticket #4964</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">((</span><span class="mi">19</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;a&#39;</span><span class="p">),[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">(),</span> <span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">(360, 360)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="mi">360</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">360</span>
</pre></div>
</div>
<p>An example over a number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">element</span><span class="p">(),</span> <span class="n">Q</span><span class="o">.</span><span class="n">element</span><span class="p">())</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">(),</span><span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">())</span>
<span class="go">(5, 5)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">zeta5^2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">zeta5^3</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<ul class="simple">
<li><p>For <code class="docutils literal notranslate"><span class="pre">algorithm='pari'</span></code>: <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/ellweilpairing">pari:ellweilpairing</a>.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">algorithm='sage'</span></code>:
Implemented using Proposition 8 in <a class="reference internal" href="../../../../references/index.html#mil2004" id="id3"><span>[Mil2004]</span></a>.  The value 1 is
returned for linearly dependent input points.  This condition
is caught via a DivisionByZeroError, since the use of a
discrete logarithm test for linear dependence is much too slow
for large <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>David Hansen (2009-01-25)</p></li>
<li><p>Lorenz Panny (2022): <code class="docutils literal notranslate"><span class="pre">algorithm='pari'</span></code></p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.xy">
<span class="sig-name descname"><span class="pre">xy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.xy" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> coordinates of this point, as a 2-tuple.
If this is the point at infinity a ZeroDivisionError is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
<span class="go">(-1, 1)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ZeroDivisionError: rational division by zero</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.ell_point.</span></span><span class="sig-name descname"><span class="pre">EllipticCurvePoint_finite_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">EllipticCurvePoint_field</span></code></a></p>
<p>Class for elliptic curve points over finite fields.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order">
<span class="sig-name descname"><span class="pre">additive_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>ALGORITHM: Use PARI function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/ellorder">pari:ellorder</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">order()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + 4 over Finite Field in a of size 5^5</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">3227</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">831623307675610677632782670796608848711856078</span><span class="p">,</span> <span class="mi">42295786042873366706573292533588638217232964</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">1427247692705959881058262545272474300628281448</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The next example has <span class="math notranslate nohighlight">\(j(E)=0\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">33554501</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">16777251</span>
</pre></div>
</div>
<p>Similarly when <span class="math notranslate nohighlight">\(j(E)=1728\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">33554473</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">1728</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">46912611635760</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.discrete_log">
<span class="sig-name descname"><span class="pre">discrete_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.discrete_log" title="Permalink to this definition">#</a></dt>
<dd><p>Return the discrete logarithm of <span class="math notranslate nohighlight">\(Q\)</span> to base <span class="math notranslate nohighlight">\(P\)</span> = <code class="docutils literal notranslate"><span class="pre">self</span></code>,
that is, an integer <span class="math notranslate nohighlight">\(x\)</span> such that <span class="math notranslate nohighlight">\(xP = Q\)</span>.</p>
<p>A <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></a> is raised if there is no solution.</p>
<p>ALGORITHM:</p>
<p>To compute the actual logarithm, <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/elllog">pari:elllog</a> is called.</p>
<p>However, <code class="docutils literal notranslate"><span class="pre">elllog()</span></code> does not guarantee termination if <span class="math notranslate nohighlight">\(Q\)</span>
is not a multiple of <span class="math notranslate nohighlight">\(P\)</span>, so we first need to check subgroup
membership. This is done as follows:</p>
<ul class="simple">
<li><p>Let <span class="math notranslate nohighlight">\(n\)</span> denote the order of <span class="math notranslate nohighlight">\(P\)</span>. First check that <span class="math notranslate nohighlight">\(nQ\)</span> equals
the point at infinity (and hence the order of <span class="math notranslate nohighlight">\(Q\)</span> divides <span class="math notranslate nohighlight">\(n\)</span>).</p></li>
<li><p>If the curve order <span class="math notranslate nohighlight">\(\#E\)</span> has been cached, check whether
<span class="math notranslate nohighlight">\(\gcd(n^2, \#E) = n\)</span>. If this holds, the curve has cyclic
<span class="math notranslate nohighlight">\(n\)</span>-torsion, hence all points whose order divides <span class="math notranslate nohighlight">\(n\)</span> must be
multiples of <span class="math notranslate nohighlight">\(P\)</span> and we are done.</p></li>
<li><p>Otherwise (if this test is inconclusive), check that the Weil
pairing of <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> is trivial.</p></li>
</ul>
<p>For anomalous curves with <span class="math notranslate nohighlight">\(\#E = p\)</span>, the
<a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.padic_elliptic_logarithm" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.padic_elliptic_logarithm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">padic_elliptic_logarithm()</span></code></a> function is called.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> (point) – another point on the same curve as <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(integer) – The discrete logarithm of <span class="math notranslate nohighlight">\(Q\)</span> with respect to <span class="math notranslate nohighlight">\(P\)</span>,
which is an integer <span class="math notranslate nohighlight">\(x\)</span> with <span class="math notranslate nohighlight">\(0\le x&lt;\mathrm{ord}(P)\)</span> such that
<span class="math notranslate nohighlight">\(xP=Q\)</span>, if one exists.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>John Cremona. Adapted to use generic functions 2008-04-05.</p></li>
<li><p>Lorenz Panny (2022): switch to PARI.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">762</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="mi">400</span><span class="o">*</span><span class="n">P</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">discrete_log</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="go">400</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.has_finite_order">
<span class="sig-name descname"><span class="pre">has_finite_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.has_finite_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if this point has finite additive order as an element
of the group of points on this curve.</p>
<p>Since the base field is finite, the answer will always be <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order">
<span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>ALGORITHM: Use PARI function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/ellorder">pari:ellorder</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">order()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + 4 over Finite Field in a of size 5^5</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">3227</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">831623307675610677632782670796608848711856078</span><span class="p">,</span> <span class="mi">42295786042873366706573292533588638217232964</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">1427247692705959881058262545272474300628281448</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The next example has <span class="math notranslate nohighlight">\(j(E)=0\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">33554501</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">16777251</span>
</pre></div>
</div>
<p>Similarly when <span class="math notranslate nohighlight">\(j(E)=1728\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">33554473</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">1728</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">46912611635760</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.padic_elliptic_logarithm">
<span class="sig-name descname"><span class="pre">padic_elliptic_logarithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.padic_elliptic_logarithm" title="Permalink to this definition">#</a></dt>
<dd><p>Return the discrete logarithm of <span class="math notranslate nohighlight">\(Q\)</span> to base <span class="math notranslate nohighlight">\(P\)</span> = <code class="docutils literal notranslate"><span class="pre">self</span></code>,
that is, an integer <span class="math notranslate nohighlight">\(x\)</span> such that <span class="math notranslate nohighlight">\(xP = Q\)</span> only for anomalous curves.</p>
<p>ALGORITHM:</p>
<p>Discrete logarithm computed as in <a class="reference internal" href="../../../../references/index.html#sma1999" id="id4"><span>[Sma1999]</span></a> with a loop to avoid
the canonical lift.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> (point) – another point on the same curve as <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> (integer) –  a prime equals the order of the curve.</p></li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<p>(integer) – The discrete logarithm of <span class="math notranslate nohighlight">\(Q\)</span> with respect to <span class="math notranslate nohighlight">\(P\)</span>,
which is an integer <span class="math notranslate nohighlight">\(x\)</span> with <span class="math notranslate nohighlight">\(0\le x&lt;\mathrm{ord}(P)\)</span> such that
<span class="math notranslate nohighlight">\(xP=Q\)</span>.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Sylvain Pelissier (2022) based on Samuel Neves <a class="reference external" href="https://crypto.stackexchange.com/questions/70454/why-smarts-attack-doesnt-work-on-this-ecdlp/70508#70508">code</a>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">235322474717419</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">=</span><span class="mi">8856682</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">200673830421813</span><span class="p">,</span> <span class="mi">57025307876612</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">40345734829479</span><span class="p">,</span> <span class="mi">211738132651297</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">*</span> <span class="n">P</span> <span class="o">==</span> <span class="n">Q</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.ell_point.</span></span><span class="sig-name descname"><span class="pre">EllipticCurvePoint_number_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">EllipticCurvePoint_field</span></code></a></p>
<p>A point on an elliptic curve over a number field.</p>
<p>Most of the functionality is derived from the parent class
<code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint_field</span></code>.  In addition we have support for
orders, heights, reduction modulo primes, and elliptic logarithms.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>               <span class="c1"># brackets are optional</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>     <span class="c1"># entries are coerced</span>
<span class="go">(0 : 0 : 1)</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mf">0.000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(0 : 0 : 1)</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: Coordinates [1, 0, 0] do not define a point on</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">QQ</span><span class="p">);</span> <span class="n">S</span>
<span class="go">Abelian group of points on Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order">
<span class="sig-name descname"><span class="pre">additive_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>If the point has infinite order, returns +Infinity.  For
curves defined over <span class="math notranslate nohighlight">\(\QQ\)</span>, we call PARI; over other
number fields we implement the function here.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">order()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">P</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.archimedean_local_height">
<span class="sig-name descname"><span class="pre">archimedean_local_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.archimedean_local_height" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the local height of self at the archimedean place <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a point on an elliptic curve over a number field
<span class="math notranslate nohighlight">\(K\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – a real or complex embedding of K, or None (default).
If <span class="math notranslate nohighlight">\(v\)</span> is a real or complex embedding, return the local
height of self at <span class="math notranslate nohighlight">\(v\)</span>. If <span class="math notranslate nohighlight">\(v\)</span> is None, return the total
archimedean contribution to the global height.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – integer, or None (default). The precision of the
computation. If None, the precision is deduced from v.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weighted</span></code> – boolean. If False (default), the height is
normalised to be invariant under extension of <span class="math notranslate nohighlight">\(K\)</span>. If True,
return this normalised height multiplied by the local degree
if <span class="math notranslate nohighlight">\(v\)</span> is a single place, or by the degree of <span class="math notranslate nohighlight">\(K\)</span> if <span class="math notranslate nohighlight">\(v\)</span> is
None.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A real number. The normalisation is twice that in Silverman’s
paper <a class="reference internal" href="../../../../references/index.html#sil1988" id="id5"><span>[Sil1988]</span></a>. Note that this local height depends on the
model of the curve.</p>
<p>ALGORITHM:</p>
<p>See <a class="reference internal" href="../../../../references/index.html#sil1988" id="id6"><span>[Sil1988]</span></a>, Section 4.</p>
<p>EXAMPLES:</p>
<p>Examples 1, 2, and 3 from <a class="reference internal" href="../../../../references/index.html#sil1988" id="id7"><span>[Sil1988]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 over Number Field in a with defining polynomial x^2 + 2 with a = 1.414213562373095?*I</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(a + 2 : 2*a + 1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">170</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="go">0.45754773287523276736211210741423654346576029814695</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + 4*y = x^3 + 6*i*x over Number Field in i with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="go">0.510184995162373</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="o">/</span><span class="mi">4</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(-9/4 : -27/8*i : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="go">0.654445619529600</span>
</pre></div>
</div>
<p>An example over the rational numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">36</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">()</span>
<span class="go">1.98723816350773</span>
</pre></div>
</div>
<p>Local heights of torsion points can be non-zero (unlike the
global height):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">()</span>
<span class="go">0.346573590279973</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.elliptic_logarithm">
<span class="sig-name descname"><span class="pre">elliptic_logarithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pari'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.elliptic_logarithm" title="Permalink to this definition">#</a></dt>
<dd><p>Return the elliptic logarithm of this elliptic curve point.</p>
<p>An embedding of the base field into <span class="math notranslate nohighlight">\(\RR\)</span> or <span class="math notranslate nohighlight">\(\CC\)</span> (with
arbitrary precision) may be given; otherwise the first real
embedding is used (with the specified precision) if any, else
the first complex embedding.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">embedding</span></code>: an embedding of the base field into <span class="math notranslate nohighlight">\(\RR\)</span> or <span class="math notranslate nohighlight">\(\CC\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code>: a positive integer (default 100) setting the
number of bits of precision for the computation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code>: either ‘pari’ (default for real embeddings)
to use PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/ellpointtoz">pari:ellpointtoz</a>, or ‘sage’ for a native
implementation.  Ignored for complex embeddings.</p></li>
</ul>
<p>ALGORITHM:</p>
<p>See <a class="reference internal" href="../../../../references/index.html#coh1993" id="id8"><span>[Coh1993]</span></a> for the case of real embeddings,
and Cremona, J.E. and Thongjunthug, T. 2010 for the complex
case.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Michael Mardaus (2008-07),</p></li>
<li><p>Tobias Nagel (2008-07) – original version from <a class="reference internal" href="../../../../references/index.html#coh1993" id="id9"><span>[Coh1993]</span></a>.</p></li>
<li><p>John Cremona (2008-07) – revision following eclib code.</p></li>
<li><p>John Cremona (2010-03) – implementation for complex embeddings.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">is_on_identity_component</span> <span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span> <span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
<span class="go">0.4793482501902193161295330101 + 0.985868850775824102211203849...*I</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">E</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_on_identity_component</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">elliptic_logarithm</span> <span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
<span class="go">1.931128271542559442488585220</span>
</pre></div>
</div>
<p>An example with negative discriminant, and a torsion point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mi">61</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
<span class="go">0.25384186085591068434</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">real_period</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span> <span class="o">/</span> <span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
<span class="go">5.0000000000000000000</span>
</pre></div>
</div>
<p>A larger example.  The default algorithm uses PARI and makes
sure the result has the requested precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">85357462</span><span class="p">,</span> <span class="mi">303528987048</span><span class="p">])</span> <span class="c1">#18074g1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">4458713781401</span><span class="o">/</span><span class="mi">835903744</span><span class="p">,</span> <span class="o">-</span><span class="mi">64466909836503771</span><span class="o">/</span><span class="mi">24167649046528</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">()</span>  <span class="c1"># 100 bits</span>
<span class="go">0.27656204014107061464076203097</span>
</pre></div>
</div>
<p>The native algorithm ‘sage’ used to have trouble with
precision in this example, but no longer:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>  <span class="c1"># 100 bits</span>
<span class="go">0.27656204014107061464076203097</span>
</pre></div>
</div>
<p>This shows that the bug reported at <a class="reference external" href="https://trac.sagemath.org/4901">trac ticket #4901</a> has been fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;4390c2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">683762969925</span><span class="o">/</span><span class="mi">44944</span><span class="p">,</span><span class="o">-</span><span class="mi">565388972095220019</span><span class="o">/</span><span class="mi">9528128</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">()</span>
<span class="go">0.00025638725886520225353198932529</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="go">0.000256387258865202254</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">65</span><span class="p">)</span>
<span class="go">0.0002563872588652022535</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="go">0.00025638725886520225353198932528666427412</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">129</span><span class="p">)</span>
<span class="go">0.00025638725886520225353198932528666427412</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="go">0.0002563872588652022535319893252866642741168388008346370015005142128009610936373</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">257</span><span class="p">)</span>
<span class="go">0.00025638725886520225353198932528666427411683880083463700150051421280096109363730</span>
</pre></div>
</div>
<p>Examples over number fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">embs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">L</span><span class="o">.</span><span class="n">real_flag</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Ls</span><span class="p">]</span>
<span class="go">[0, 0, -1]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># order 2</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Ls</span><span class="p">]</span>
<span class="go">[-1.73964256006716 - 1.07861534489191*I, -0.363756518406398 - 1.50699412135253*I, 1.90726488608927]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">pts</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6</span> <span class="p">),</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span> <span class="p">),</span> <span class="n">E</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">9</span><span class="o">/</span><span class="mi">4</span> <span class="p">),</span> <span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span> <span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">12</span> <span class="p">)]</span>
<span class="gp">sage: </span><span class="p">[[</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">]</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Ls</span><span class="p">]</span>
<span class="go">[[0.250819591818930 - 0.411963479992219*I, -0.290994550611374 - 1.37239400324105*I, -0.693473752205595 - 2.45028458830342*I, -0.151659609775291 - 1.48985406505459*I], [1.33444787667954 - 1.50889756650544*I, 0.792633734249234 - 0.548467043256610*I, 0.390154532655013 + 0.529423541805758*I, 0.931968675085317 - 0.431006981443071*I], [1.14758249500109 + 0.853389664016075*I, 2.59823462472518 + 0.853389664016075*I, 1.75372176444709, 0.303069634723001]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">21</span><span class="o">-</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.70448375537782208460499649302 - 0.79246725643650979858266018068*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_finite_order">
<span class="sig-name descname"><span class="pre">has_finite_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_finite_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> iff this point has finite order on the elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">P</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_good_reduction">
<span class="sig-name descname"><span class="pre">has_good_reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_good_reduction" title="Permalink to this definition">#</a></dt>
<dd><p>Returns True iff this point has good reduction modulo a prime.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a prime of the base_field of the point’s curve, or
<code class="docutils literal notranslate"><span class="pre">None</span></code> (default)</p></li>
</ul>
<p>OUTPUT:</p>
<p>(bool) If a prime <span class="math notranslate nohighlight">\(P\)</span> of the base field is specified, returns
True iff the point has good reduction at <span class="math notranslate nohighlight">\(P\)</span>; otherwise,
return true if the point has god reduction at all primes in
the support of the discriminant of this model.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;990e1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(15 : 51 : 1)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="go">[False, False, False, True]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="go">[True, False, True, True]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_exponent</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="go">[2, 2, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="go">[True, True, True, True]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">160</span><span class="p">,</span><span class="mi">308</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="o">-</span><span class="mi">120</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">support</span><span class="p">()</span>
<span class="go">[Fractional ideal (i + 1),</span>
<span class="go">Fractional ideal (-i - 2),</span>
<span class="go">Fractional ideal (2*i + 1),</span>
<span class="go">Fractional ideal (3)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_exponent</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[1, 4, 4, 4]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_infinite_order">
<span class="sig-name descname"><span class="pre">has_infinite_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_infinite_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return True iff this point has infinite order on the elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">P</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_infinite_order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_infinite_order</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.height">
<span class="sig-name descname"><span class="pre">height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalised</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pari'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.height" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Néron-Tate canonical height of the point.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a point on an elliptic curve over a number field
<span class="math notranslate nohighlight">\(K\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code> – positive integer, or None (default). The
precision in bits of the result. If None, the default real
precision is used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalised</span></code> – boolean. If True (default), the height is
normalised to be invariant under extension of <span class="math notranslate nohighlight">\(K\)</span>. If False,
return this normalised height multiplied by the degree of
<span class="math notranslate nohighlight">\(K\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string: either ‘pari’ (default) or ‘sage’.
If ‘pari’ and the base field is <span class="math notranslate nohighlight">\(\QQ\)</span>, use the PARI library
function; otherwise use the Sage implementation.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The rational number 0, or a non-negative real number.</p>
<p>There are two normalisations used in the literature, one of
which is double the other. We use the larger of the two, which
is the one appropriate for the BSD conjecture. This is
consistent with <a class="reference internal" href="../../../../references/index.html#cre1997" id="id10"><span>[Cre1997]</span></a> and double that of <a class="reference internal" href="../../../../references/index.html#sil2009" id="id11"><span>[Sil2009]</span></a>.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Néron-Tate height">Wikipedia article Néron-Tate height</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The correct height to use for the regulator in the BSD
formula is the non-normalised height.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">P</span>
<span class="go">(5 : 5 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">P</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator</span><span class="p">()</span>
<span class="go">0.0511114082399688...</span>

<span class="gp">sage: </span><span class="k">def</span> <span class="nf">naive_height</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numerator</span><span class="p">()),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">denominator</span><span class="p">()))))</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1..10</span><span class="p">]:</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">naive_height</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">n</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="o">^</span><span class="n">n</span><span class="p">)</span>
<span class="go">0.000000000000000</span>
<span class="go">0.0433216987849966</span>
<span class="go">0.0502949347635656</span>
<span class="go">0.0511006335618645</span>
<span class="go">0.0511007834799612</span>
<span class="go">0.0511013666152466</span>
<span class="go">0.0511034199907743</span>
<span class="go">0.0511106492906471</span>
<span class="go">0.0511114081541082</span>
<span class="go">0.0511114081541180</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;4602a1&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + x*y  = x^3 + x^2 - 37746035*x - 89296920339 over Rational Field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">77985922458974949246858229195945103471590</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="mi">19575260230015313702261379022151675961965157108920263594545223</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="mi">2254020761884782243</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span> <span class="n">x</span> <span class="o">/</span> <span class="n">d</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span>  <span class="n">y</span> <span class="o">/</span> <span class="n">d</span><span class="o">^</span><span class="mi">3</span> <span class="p">])</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">86.7406561381275</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">17</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + 17*x*y - 120*y = x^3 - 60*x^2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">])</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.68666708330558658572355210295</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">Q</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">9.0000000000000000000000000000</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Real Field with 100 bits of precision</span>
</pre></div>
</div>
<p>Canonical heights over number fields are implemented as well:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="mi">4</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + a*x + 4 over Number Field in a with defining polynomial x^3 - 2</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.810463096585925</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.81046309658592536863991810577</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="go">0.81046309658592536863991810576865158896130286417155832378086</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">4.00000000000000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">10000.0000000000</span>
</pre></div>
</div>
<p>Setting normalised=False multiplies the height by the degree of <span class="math notranslate nohighlight">\(K\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">normalised</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">PK</span> <span class="o">=</span> <span class="n">EK</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">PK</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">PK</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">normalised</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0.204445632959875</span>
</pre></div>
</div>
<p>Some consistency checks:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.36857250535393</span>

<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">PK</span> <span class="o">=</span> <span class="n">EK</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">PK</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.36857250535393</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="o">/</span><span class="mi">4</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(-9/4 : -27/8*i : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">2.69518560017909</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">15</span><span class="o">*</span><span class="n">Q</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">225.000000000000</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ED</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">ED</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">))(</span><span class="n">P</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(0 : -7/2*a - 1/2 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.051111408239968840235886099757</span>
</pre></div>
</div>
<p>An example to show that the bug at <a class="reference external" href="https://trac.sagemath.org/5252">trac ticket #5252</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2063758701246626370773726978</span><span class="p">,</span> <span class="mi">32838647793306133075103747085833809114881</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">30987785091199</span><span class="p">,</span> <span class="mi">258909576181697016447</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">25.8603170675462</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">25.860317067546190743868840741</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="go">25.860317067546190743868840740735110323098872903844416215577171041783572513</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="go">25.8603170675461907438688407407351103230988729038444162155771710417835725129551130570889813281792157278507639909972112856019190236125362914195452321720</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">+</span><span class="n">P</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example to show that the bug at <a class="reference external" href="https://trac.sagemath.org/8319">trac ticket #8319</a> is fixed (correct height when the curve is not minimal):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">5580472329446114952805505804593498080000</span><span class="p">,</span><span class="o">-</span><span class="mi">157339733785368110382973689903536054787700497223306368000000</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">xP</span> <span class="o">=</span> <span class="mi">204885147732879546487576840131729064308289385547094673627174585676211859152978311600</span><span class="o">/</span><span class="mi">23625501907057948132262217188983681204856907657753178415430361</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">xP</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">157.432598516754</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">P</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="c1"># long time (4s)</span>
<span class="go">629.730394067016</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">0.000000000000000</span>
</pre></div>
</div>
<p>An example to show that the bug at <a class="reference external" href="https://trac.sagemath.org/12509">trac ticket #12509</a> is fixed (precision issues):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28665</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">46382</span><span class="p">,</span> <span class="mi">2797026</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">4525688</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">72</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">509</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span>  <span class="o">-</span><span class="mi">682</span><span class="o">/</span><span class="mi">25</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">434</span><span class="o">/</span><span class="mi">25</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.38877711688727</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">4.00000000000000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">4.0000000000000000000000000000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">4.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>
</pre></div>
</div>
<p>This shows that the bug reported at <a class="reference external" href="https://trac.sagemath.org/13951">trac ticket #13951</a> has been fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">17</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.06248137652528</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">F</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.06248137652528</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.is_on_identity_component">
<span class="sig-name descname"><span class="pre">is_on_identity_component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.is_on_identity_component" title="Permalink to this definition">#</a></dt>
<dd><p>Returns True iff this point is on the identity component of
its curve with respect to a given (real or complex) embedding.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a point on a curve over any ordered field (e.g. <span class="math notranslate nohighlight">\(\QQ\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">embedding</span></code> – an embedding from the base_field of the
point’s curve into <span class="math notranslate nohighlight">\(\RR\)</span> or <span class="math notranslate nohighlight">\(\CC\)</span>; if <code class="docutils literal notranslate"><span class="pre">None</span></code> (the
default) it uses the first embedding of the base_field into
<span class="math notranslate nohighlight">\(\RR\)</span> if any, else the first embedding into <span class="math notranslate nohighlight">\(\CC\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(bool) – <code class="docutils literal notranslate"><span class="pre">True</span></code> iff the point is on the identity component of
the curve.  (If the point is zero then the result is True.)</p>
<p>EXAMPLES:</p>
<p>For <span class="math notranslate nohighlight">\(K=\QQ\)</span> there is no need to specify an embedding:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_on_identity_component</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">srange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)]</span>
<span class="go">[False, False, False, False, False, True, True, True]</span>
</pre></div>
</div>
<p>An example over a field with two real embeddings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">L</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">is_on_identity_component</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RR</span><span class="p">)]</span>
<span class="go">[False, True]</span>
</pre></div>
</div>
<p>We can check this as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">e</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RR</span><span class="p">)]</span>
<span class="go">[True, False]</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RR</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">RR</span><span class="p">,[</span><span class="n">e</span><span class="p">(</span><span class="n">ai</span><span class="p">)</span> <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">,</span><span class="n">e3</span> <span class="o">=</span> <span class="n">E1</span><span class="o">.</span><span class="n">two_division_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e1</span> <span class="o">&lt;</span> <span class="n">e2</span> <span class="o">&lt;</span> <span class="n">e3</span> <span class="ow">and</span> <span class="n">e</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">e3</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.non_archimedean_local_height">
<span class="sig-name descname"><span class="pre">non_archimedean_local_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_minimal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.non_archimedean_local_height" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the local height of self at the non-archimedean place <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a point on an elliptic curve over a number field
<span class="math notranslate nohighlight">\(K\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – a non-archimedean place of <span class="math notranslate nohighlight">\(K\)</span>, or None (default).
If <span class="math notranslate nohighlight">\(v\)</span> is a non-archimedean place, return the local height
of self at <span class="math notranslate nohighlight">\(v\)</span>. If <span class="math notranslate nohighlight">\(v\)</span> is None, return the total
non-archimedean contribution to the global height.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – integer, or None (default). The precision of the
computation. If None, the height is returned symbolically.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weighted</span></code> – boolean. If False (default), the height is
normalised to be invariant under extension of <span class="math notranslate nohighlight">\(K\)</span>. If True,
return this normalised height multiplied by the local degree
if <span class="math notranslate nohighlight">\(v\)</span> is a single place, or by the degree of <span class="math notranslate nohighlight">\(K\)</span> if <span class="math notranslate nohighlight">\(v\)</span> is
None.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A real number. The normalisation is twice that in Silverman’s
paper <a class="reference internal" href="../../../../references/index.html#sil1988" id="id12"><span>[Sil1988]</span></a>. Note that this local height depends on the
model of the curve.</p>
<p>ALGORITHM:</p>
<p>See <a class="reference internal" href="../../../../references/index.html#sil1988" id="id13"><span>[Sil1988]</span></a>, Section 5.</p>
<p>EXAMPLES:</p>
<p>Examples 2 and 3 from <a class="reference internal" href="../../../../references/index.html#sil1988" id="id14"><span>[Sil1988]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + 4*y = x^3 + 6*i*x over Number Field in i with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">-1/2*log(2)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="o">/</span><span class="mi">4</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(-9/4 : -27/8*i : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">))</span>
<span class="go">2*log(2)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">()</span>
<span class="go">2*log(2)</span>
</pre></div>
</div>
<p>An example over the rational numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">36</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">()</span>
<span class="go">-log(3)</span>
</pre></div>
</div>
<p>Local heights of torsion points can be non-zero (unlike the
global height):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">()</span>
<span class="go">-1/2*log(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order">
<span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>If the point has infinite order, returns +Infinity.  For
curves defined over <span class="math notranslate nohighlight">\(\QQ\)</span>, we call PARI; over other
number fields we implement the function here.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">order()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">P</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.padic_elliptic_logarithm">
<span class="sig-name descname"><span class="pre">padic_elliptic_logarithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.padic_elliptic_logarithm" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the <span class="math notranslate nohighlight">\(p\)</span>-adic elliptic logarithm of this point.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">p</span></code> - integer: a prime <code class="docutils literal notranslate"><span class="pre">absprec</span></code> - integer (default: 20):
the initial <span class="math notranslate nohighlight">\(p\)</span>-adic absolute precision of the computation</p>
<p>OUTPUT:</p>
<p>The <span class="math notranslate nohighlight">\(p\)</span>-adic elliptic logarithm of self, with precision <code class="docutils literal notranslate"><span class="pre">absprec</span></code>.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Tobias Nagel</p></li>
<li><p>Michael Mardaus</p></li>
<li><p>John Cremona</p></li>
</ul>
<p>ALGORITHM:</p>
<p>For points in the formal group (i.e. not integral at <span class="math notranslate nohighlight">\(p\)</span>) we
take the <code class="docutils literal notranslate"><span class="pre">log()</span></code> function from the formal groups module and
evaluate it at <span class="math notranslate nohighlight">\(-x/y\)</span>.  Otherwise we first multiply the point
to get into the formal group, and divide the result
afterwards.</p>
<div class="admonition-todo admonition" id="id15">
<p class="admonition-title">Todo</p>
<p>See comments at <a class="reference external" href="https://trac.sagemath.org/4805">trac ticket #4805</a>.  Currently the absolute
precision of the result may be less than the given value
of absprec, and error-handling is imperfect.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2 + 2*3 + 3^3 + 2*3^7 + 3^8 + 3^9 + 3^11 + 3^15 + 2*3^17 + 3^18 + O(3^19)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
<span class="go">660257522</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span><span class="mi">28</span><span class="o">/</span><span class="mi">27</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>  <span class="c1"># long time (3s)</span>
<span class="go">[2 + O(2^19), 2 + O(3^20), 2 + O(5^19), 2 + O(7^19), 2 + O(11^19), 2 + O(13^19), 2 + O(17^19), 2 + O(19^19)]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">12</span><span class="p">)]</span>  <span class="c1"># long time (2s)</span>
<span class="go">[1 + 2 + O(2^19), 3 + 3^20 + O(3^21), 3 + O(5^19), 3 + O(7^19), 3 + O(11^19)]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="mi">5</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">12</span><span class="p">)]</span>  <span class="c1"># long time (2s)</span>
<span class="go">[1 + 2^2 + O(2^19), 2 + 3 + O(3^20), 5 + O(5^19), 5 + O(7^19), 5 + O(11^19)]</span>
</pre></div>
</div>
<p>An example which arose during reviewing <a class="reference external" href="https://trac.sagemath.org/4741">trac ticket #4741</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;794a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># default precision=20</span>
<span class="go">2^4 + 2^5 + 2^6 + 2^8 + 2^9 + 2^13 + 2^14 + 2^15 + O(2^16)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">absprec</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="go">2^4 + 2^5 + 2^6 + 2^8 + 2^9 + 2^13 + 2^14 + 2^15 + 2^22 + 2^23 + 2^24 + O(2^26)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">absprec</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="go">2^4 + 2^5 + 2^6 + 2^8 + 2^9 + 2^13 + 2^14 + 2^15 + 2^22 + 2^23 + 2^24 + 2^28 + 2^29 + 2^31 + 2^34 + O(2^35)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.reduction">
<span class="sig-name descname"><span class="pre">reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.reduction" title="Permalink to this definition">#</a></dt>
<dd><p>This finds the reduction of a point <span class="math notranslate nohighlight">\(P\)</span> on the elliptic curve
modulo the prime <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – A point on an elliptic curve.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
</ul>
<p>OUTPUT:</p>
<p>The point reduced to be a point on the elliptic curve modulo <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span><span class="mi">931</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(3 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span><span class="mi">931</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(3 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">(10 : 7 : 1)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">(abar : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(abar : 1 : 1)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="ell_generic.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Elliptic curves over a general ring</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="jacobian.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Construct elliptic curves as Jacobians</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Points on elliptic curves</a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint"><code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field"><code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint_field</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order"><code class="docutils literal notranslate"><span class="pre">additive_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.ate_pairing"><code class="docutils literal notranslate"><span class="pre">ate_pairing()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.curve"><code class="docutils literal notranslate"><span class="pre">curve()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.division_points"><code class="docutils literal notranslate"><span class="pre">division_points()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.has_finite_order"><code class="docutils literal notranslate"><span class="pre">has_finite_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.has_infinite_order"><code class="docutils literal notranslate"><span class="pre">has_infinite_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.is_divisible_by"><code class="docutils literal notranslate"><span class="pre">is_divisible_by()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.is_finite_order"><code class="docutils literal notranslate"><span class="pre">is_finite_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order"><code class="docutils literal notranslate"><span class="pre">order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.scheme"><code class="docutils literal notranslate"><span class="pre">scheme()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.set_order"><code class="docutils literal notranslate"><span class="pre">set_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.tate_pairing"><code class="docutils literal notranslate"><span class="pre">tate_pairing()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.weil_pairing"><code class="docutils literal notranslate"><span class="pre">weil_pairing()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.xy"><code class="docutils literal notranslate"><span class="pre">xy()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field"><code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint_finite_field</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order"><code class="docutils literal notranslate"><span class="pre">additive_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.discrete_log"><code class="docutils literal notranslate"><span class="pre">discrete_log()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.has_finite_order"><code class="docutils literal notranslate"><span class="pre">has_finite_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order"><code class="docutils literal notranslate"><span class="pre">order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.padic_elliptic_logarithm"><code class="docutils literal notranslate"><span class="pre">padic_elliptic_logarithm()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field"><code class="docutils literal notranslate"><span class="pre">EllipticCurvePoint_number_field</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order"><code class="docutils literal notranslate"><span class="pre">additive_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.archimedean_local_height"><code class="docutils literal notranslate"><span class="pre">archimedean_local_height()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.elliptic_logarithm"><code class="docutils literal notranslate"><span class="pre">elliptic_logarithm()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_finite_order"><code class="docutils literal notranslate"><span class="pre">has_finite_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_good_reduction"><code class="docutils literal notranslate"><span class="pre">has_good_reduction()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_infinite_order"><code class="docutils literal notranslate"><span class="pre">has_infinite_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.height"><code class="docutils literal notranslate"><span class="pre">height()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.is_on_identity_component"><code class="docutils literal notranslate"><span class="pre">is_on_identity_component()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.non_archimedean_local_height"><code class="docutils literal notranslate"><span class="pre">non_archimedean_local_height()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order"><code class="docutils literal notranslate"><span class="pre">order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.padic_elliptic_logarithm"><code class="docutils literal notranslate"><span class="pre">padic_elliptic_logarithm()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.reduction"><code class="docutils literal notranslate"><span class="pre">reduction()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>