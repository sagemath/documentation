<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Canonical heights for elliptic curves over number fields" href="height.html" /><link rel="prev" title="Tables of elliptic curves of given rank" href="ec_database.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Elliptic curves over number fields - Elliptic curves</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Elliptic curves</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.0 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Elliptic curves</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="constructor.html">Elliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian.html">Construct elliptic curves as Jacobians</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_point.html">Points on elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_generic.html">Elliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_field.html">Elliptic curves over a general field</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_finite_field.html">Elliptic curves over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="formal_group.html">Formal groups of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hom.html">Elliptic-curve morphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_morphism.html">Isomorphisms between Weierstrass models of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_curve_isogeny.html">Isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_velusqrt.html">√élu algorithm for elliptic-curve isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_composite.html">Composite morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_scalar.html">Scalar-multiplication morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_frobenius.html">Frobenius isogenies of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_small_degree.html">Isogenies of small prime degree</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ell_rational_field.html">Elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ec_database.html">Tables of elliptic curves of given rank</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="height.html">Canonical heights for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="saturation.html">Saturation of Mordell-Weil groups of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_torsion.html">Torsion subgroups of elliptic curves over number fields (including <span class="math notranslate nohighlight">\(\QQ\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps.html">Galois representations attached to elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps_number_field.html">Galois representations for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_class.html">Isogeny class of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="sha_tate.html">Tate-Shafarevich group</a></li>
<li class="toctree-l1"><a class="reference internal" href="cm.html">Complex multiplication for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="Qcurves.html">Testing whether elliptic curves over number fields are <span class="math notranslate nohighlight">\(\QQ\)</span>-curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_local_data.html">Local data for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="kodaira_symbol.html">Kodaira symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_tate_curve.html">Tate’s parametrisation of <span class="math notranslate nohighlight">\(p\)</span>-adic curves with multiplicative reduction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_wp.html">Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice.html">Period lattices of elliptic curves and related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice_region.html">Regions in fundamental domains of period lattices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modular_parametrization.html">Modular parametrization of elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_modular_symbols.html">Modular symbols attached to elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="mod_sym_num.html">Modular symbols by numerical integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lseries_ell.html"><span class="math notranslate nohighlight">\(L\)</span>-series for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="heegner.html">Heegner points on elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_lseries.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="descent_two_isogeny.html">Descent on elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span> with a 2-isogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_egros.html">Elliptic curves with prescribed good reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_padic_field.html">Elliptic curves over padic fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="gp_simon.html">Denis Simon’s PARI scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="mod5family.html">Elliptic curves with congruent mod-5 representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_transform.html">Morphism to bring a genus-one curve into Weierstrass form</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/constructor.html">Hyperelliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_generic.html">Hyperelliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_finite_field.html">Hyperelliptic curves over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_padic_field.html">Hyperelliptic curves over a <span class="math notranslate nohighlight">\(p\)</span>-adic field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_rational_field.html">Hyperelliptic curves over the rationals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/mestre.html">Mestre’s algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/monsky_washnitzer.html">Computation of Frobenius matrix on Monsky-Washnitzer cohomology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hypellfrob.html">Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over a</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_generic.html">Jacobian of a general hyperelliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_g2.html">Jacobian of a hyperelliptic curve of genus 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_homset.html">Rational point sets on a Jacobian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_morphism.html">Jacobian ‘morphism’ as a class in the Picard group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_g2.html">Hyperelliptic curves of genus 2 over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/invariants.html">Compute invariants of quintics and sextics via ‘Ueberschiebung’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/kummer_surface.html">Kummer surfaces over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/genus2reduction.html">Conductor and reduction types for genus 2 curves</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="elliptic-curves-over-number-fields">
<span id="sage-schemes-elliptic-curves-ell-number-field"></span><h1>Elliptic curves over number fields<a class="headerlink" href="#elliptic-curves-over-number-fields" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.ell_number_field"></span><p>An elliptic curve <span class="math notranslate nohighlight">\(E\)</span> over a number field <span class="math notranslate nohighlight">\(K\)</span> can be given
by a Weierstrass equation whose coefficients lie in <span class="math notranslate nohighlight">\(K\)</span> or by
using <code class="docutils literal notranslate"><span class="pre">base_extend</span></code> on an elliptic curve defined over a subfield.</p>
<p>One major difference to elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span> is that there
might not exist a global minimal equation over <span class="math notranslate nohighlight">\(K\)</span>, when <span class="math notranslate nohighlight">\(K\)</span> does
not have class number one.
Another difference is the lack of understanding of modularity for
general elliptic curves over general number fields.</p>
<p>Currently Sage can obtain local information about <span class="math notranslate nohighlight">\(E/K_v\)</span> for finite places
<span class="math notranslate nohighlight">\(v\)</span>, it has an interface to Denis Simon’s script for 2-descent, it can compute
the torsion subgroup of the Mordell-Weil group <span class="math notranslate nohighlight">\(E(K)\)</span>, and it can work with
isogenies defined over <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-3456*i - 6480</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">+</span><span class="n">P</span>
<span class="go">(-2*i + 9/16 : -9/4*i - 101/64 : 1)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="go">Local data at Fractional ideal (i + 4):</span>
<span class="go">  Reduction type: bad additive</span>
<span class="go">  Local minimal model: Elliptic Curve defined by y^2 = x^3 + (i+4)</span>
<span class="go">                       over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  Minimal discriminant valuation: 2</span>
<span class="go">  Conductor exponent: 2</span>
<span class="go">  Kodaira Symbol: II</span>
<span class="go">  Tamagawa Number: 1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product_bsd</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">()</span>
<span class="go">(1, 1, [(i : 2 : 1)])</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Isogeny of degree 3</span>
<span class="go">  from Elliptic Curve defined by y^2 = x^3 + (i+4)</span>
<span class="go">       over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">    to Elliptic Curve defined by y^2 = x^3 + (-27*i-108)</span>
<span class="go">       over Number Field in i with defining polynomial x^2 + 1]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Robert Bradshaw 2007</p></li>
<li><p>John Cremona</p></li>
<li><p>Chris Wuthrich</p></li>
</ul>
<p>REFERENCE:</p>
<ul class="simple">
<li><p>[Sil] Silverman, Joseph H. The arithmetic of elliptic curves. Second edition. Graduate Texts in
Mathematics, 106. Springer, 2009.</p></li>
<li><p>[Sil2] Silverman, Joseph H. Advanced topics in the arithmetic of elliptic curves. Graduate Texts in
Mathematics, 151. Springer, 1994.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.ell_number_field.</span></span><span class="sig-name descname"><span class="pre">EllipticCurve_number_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ainvs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="ell_field.html#sage.schemes.elliptic_curves.ell_field.EllipticCurve_field" title="sage.schemes.elliptic_curves.ell_field.EllipticCurve_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">EllipticCurve_field</span></code></a></p>
<p>Elliptic curve over a number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">35</span><span class="p">])</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go"> y^2 + i*x*y + (i+1)*y = x^3 + (i-1)*x^2 + (24*i+15)*x + (14*i+35)</span>
<span class="go"> over Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.base_extend">
<span class="sig-name descname"><span class="pre">base_extend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.base_extend" title="Permalink to this definition">#</a></dt>
<dd><p>Return the base extension of <code class="docutils literal notranslate"><span class="pre">self</span></code> to <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a3&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 over Number Field in a</span>
<span class="go"> with defining polynomial x^2 + 5 with a = 2.236067977499790?*I</span>
</pre></div>
</div>
<p>Check that non-torsion points are remembered when extending
the base field (see <a class="reference external" href="https://github.com/sagemath/sage/issues/16034">github issue #16034</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1751</span><span class="p">,</span> <span class="o">-</span><span class="mi">31352</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">d</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(52 : 111 : 1)]</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(52 : 111 : 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant">
<span class="sig-name descname"><span class="pre">cm_discriminant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant" title="Permalink to this definition">#</a></dt>
<dd><p>Return the CM discriminant of the <span class="math notranslate nohighlight">\(j\)</span>-invariant of this curve, or 0.</p>
<p>OUTPUT:</p>
<p>An integer <span class="math notranslate nohighlight">\(D\)</span> which is either <span class="math notranslate nohighlight">\(0\)</span> if this curve <span class="math notranslate nohighlight">\(E\)</span> does not
have Complex Multiplication) (CM), or an imaginary quadratic
discriminant if <span class="math notranslate nohighlight">\(j(E)\)</span> is the <span class="math notranslate nohighlight">\(j\)</span>-invariant of the order with
discriminant <span class="math notranslate nohighlight">\(D\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <span class="math notranslate nohighlight">\(E\)</span> has CM but the discriminant <span class="math notranslate nohighlight">\(D\)</span> is not a square in
the base field <span class="math notranslate nohighlight">\(K\)</span> then the extra endomorphisms will not be
defined over <span class="math notranslate nohighlight">\(K\)</span>.  See also <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">has_rational_cm()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Elliptic Curve defined by y^2 + x*y = x^3 + 36*x + 3455</span>
<span class="go">over Rational Field does not have CM</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1728</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-8</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">282880</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">632000</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-20</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">31710790944000</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">39953093016000</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">50337742902000</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-108</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.conductor">
<span class="sig-name descname"><span class="pre">conductor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.conductor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the conductor of this elliptic curve as a fractional
ideal of the base field.</p>
<p>OUTPUT:</p>
<p>(fractional ideal) The conductor of the curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">35</span><span class="p">])</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (21*i - 3)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="mi">5</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="n">a</span><span class="p">])</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (-6*a)</span>
</pre></div>
</div>
<p>A not so well known curve with everywhere good reduction:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">38</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21796814856932765568243810</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">134364590724198567128296995</span><span class="p">,</span> <span class="mi">121774567239345229314269094644186997594</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">750668847495706904791115375024037711300</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
</pre></div>
</div>
<p>An example which used to fail (see <a class="reference external" href="https://github.com/sagemath/sage/issues/5307">github issue #5307</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">w</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (86304, w + 5898)</span>
</pre></div>
</div>
<p>An example raised in <a class="reference external" href="https://github.com/sagemath/sage/issues/11346">github issue #11346</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">48</span><span class="p">,</span> <span class="o">-</span><span class="mi">161</span><span class="o">/</span><span class="mi">864</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="o">.</span><span class="n">smallest_integer</span><span class="p">(),</span> <span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">E1</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()]</span>
<span class="go">[(2, 4), (3, 1), (5, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.galois_representation">
<span class="sig-name descname"><span class="pre">galois_representation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.galois_representation" title="Permalink to this definition">#</a></dt>
<dd><p>The compatible family of the Galois representation
attached to this elliptic curve.</p>
<p>Given an elliptic curve <span class="math notranslate nohighlight">\(E\)</span> over a number field <span class="math notranslate nohighlight">\(K\)</span>
and a rational prime number <span class="math notranslate nohighlight">\(p\)</span>, the <span class="math notranslate nohighlight">\(p^n\)</span>-torsion
<span class="math notranslate nohighlight">\(E[p^n]\)</span> points of <span class="math notranslate nohighlight">\(E\)</span> is a representation of the
absolute Galois group of <span class="math notranslate nohighlight">\(K\)</span>. As <span class="math notranslate nohighlight">\(n\)</span> varies
we obtain the Tate module <span class="math notranslate nohighlight">\(T_p E\)</span> which is a
a representation of <span class="math notranslate nohighlight">\(G_K\)</span> on a free <span class="math notranslate nohighlight">\(\ZZ_p\)</span>-module
of rank <span class="math notranslate nohighlight">\(2\)</span>. As <span class="math notranslate nohighlight">\(p\)</span> varies the representations
are compatible.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span>
<span class="go">Compatible family of Galois representations associated to the</span>
<span class="go"> Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 + (-10)*x + (-20)</span>
<span class="go">  over Number Field in a with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># long time (4s on sage.math, 2014)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>
<span class="go">[5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens">
<span class="sig-name descname"><span class="pre">gens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens" title="Permalink to this definition">#</a></dt>
<dd><p>Return some points of infinite order on this elliptic curve.</p>
<p>Contrary to what the name of this method suggests, the points
it returns do not always generate a subgroup of full rank in
the Mordell-Weil group, nor are they necessarily linearly
independent.  Moreover, the number of points can be smaller or
larger than what one could expect after calling <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rank()</span></code></a>
or <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rank_bounds()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The optional parameters control the Simon two descent algorithm;
see the documentation of <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simon_two_descent()</span></code></a> for more
details.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – 0, 1, 2, or 3 (default: 0), the verbosity level</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lim1</span></code>    – (default: 2) limit on trivial points on quartics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lim3</span></code>  – (default: 4) limit on points on ELS quartics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limtriv</span></code> – (default: 2) limit on trivial points on elliptic curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxprob</span></code> – (default: 20)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limbigprime</span></code> – (default: 30) to distinguish between
small and large prime numbers. Use probabilistic tests for
large primes. If 0, do not use probabilistic tests.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">known_points</span></code> – (default: None) list of known points on
the curve</p></li>
</ul>
<p>OUTPUT:</p>
<p>A set of points of infinite order given by the Simon two-descent.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For non-quadratic number fields, this code does return, but it takes
a long time.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(23831509/8669448*a - 2867471/8669448 : 76507317707/18049790736*a - 424166479633/18049790736 : 1),</span>
<span class="go"> (-2031032029/969232392*a + 58813561/969232392 : -15575984630401/21336681877488*a + 451041199309/21336681877488 : 1),</span>
<span class="go"> (-186948623/4656964 : 549438861195/10049728312*a : 1)]</span>
</pre></div>
</div>
<p>It can happen that no points are found if the height bounds
used in the search are too small (see <a class="reference external" href="https://github.com/sagemath/sage/issues/10745">github issue #10745</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">(</span><span class="n">lim1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lim3</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">gg</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">(</span><span class="n">lim3</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span> <span class="n">gg</span>  <span class="c1"># long time (about 4s)</span>
<span class="go">[(... : 1)]</span>
</pre></div>
</div>
<p>Check that the the point found has infinite order, and that it is on the curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">gg</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">defining_polynomial</span><span class="p">()(</span><span class="o">*</span><span class="n">P</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Here is a curve of rank 2:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(-1/2*t + 1/2 : -1/2*t + 1/2 : 1), (-t + 3 : -2*t + 10 : 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Test that points of finite order are not included (see <a class="reference external" href="https://github.com/sagemath/sage/issues/13593">github issue #13593</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;17a3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>IMPLEMENTATION:</p>
<p>For curves over quadratic fields which are base-changes from
<span class="math notranslate nohighlight">\(\QQ\)</span>, we delegate the work to <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens_quadratic" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens_quadratic"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gens_quadratic()</span></code></a> where
methods over <span class="math notranslate nohighlight">\(\QQ\)</span> suffice.  Otherwise, we use Denis Simon’s
PARI/GP scripts from <a class="reference external" href="http://www.math.unicaen.fr/~simon/">http://www.math.unicaen.fr/~simon/</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens_quadratic">
<span class="sig-name descname"><span class="pre">gens_quadratic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens_quadratic" title="Permalink to this definition">#</a></dt>
<dd><p>Return generators for the Mordell-Weil group modulo torsion, for a
curve which is a base change from <span class="math notranslate nohighlight">\(\QQ\)</span> to a quadratic field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">2123582</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(5 : 17 : 1)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">gens_quadratic</span><span class="p">()</span>
<span class="go">[(5 : 17 : 1), (-13 : 48*i + 5 : 1)]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">gens_quadratic</span><span class="p">()</span>
<span class="go">[(5 : 17 : 1), (-1 : 2*a - 1 : 1), (11/4 : 33/4*a - 23/8 : 1)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">197</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">2483776</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(47995604297578081/7389879786648100 : -25038161802544048018837479/635266655830129794121000 : 1)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">gens_quadratic</span><span class="p">()</span>
<span class="go">[(-1209642055/59583566*a + 1639995844/29791783 : -377240626321899/1720892553212*a + 138577803462855/245841793316 : 1),</span>
<span class="go"> (1/28 : 393/392*a : 1),</span>
<span class="go"> (-61*a + 162 : 1098*a - 2916 : 1)]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens_quadratic</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: gens_quadratic() requires the elliptic curve to be a base change from Q</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_integral_model">
<span class="sig-name descname"><span class="pre">global_integral_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_integral_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return a model of self which is integral at all primes.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go"> y^2 + (-i)*x*y + (-25*i)*y = x^3 + 5*i*x^2 + 125*i*x + 3125*i</span>
<span class="go"> over Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/sagemath/sage/issues/7935">github issue #7935</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">38</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 1444*a*x + 27436</span>
<span class="go"> over Number Field in a with defining polynomial x^2 - 38</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/sagemath/sage/issues/9266">github issue #9266</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">w</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + (1/2*s+1/2)</span>
<span class="go"> over Number Field in s with defining polynomial x^2 - 5</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/sagemath/sage/issues/12151">github issue #12151</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">161</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">25105</span><span class="o">/</span><span class="mi">216</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">3839</span><span class="o">/</span><span class="mi">36</span><span class="p">,</span> <span class="mi">634768555</span><span class="o">/</span><span class="mi">7776</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">98002625</span><span class="o">/</span><span class="mi">1296</span><span class="p">,</span> <span class="mi">634768555</span><span class="o">/</span><span class="mi">7776</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">98002625</span><span class="o">/</span><span class="mi">1296</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">();</span> <span class="n">M</span> <span class="c1"># choice varies, not tested</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go">y^2 + (2094779518028859*v-1940492905300351)*x*y + (477997268472544193101178234454165304071127500*v-442791377441346852919930773849502871958097500)*y = x^3 + (26519784690047674853185542622500*v-24566525306469707225840460652500)*x^2</span>
<span class="go"> over Number Field in v with defining polynomial x^2 + 161*x - 150</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/sagemath/sage/issues/14476">github issue #14476</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span> <span class="o">-</span><span class="mi">43</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">14</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">706</span><span class="o">/</span><span class="mi">625</span><span class="p">,</span> <span class="o">-</span><span class="mi">4862</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4074</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">711</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">10304</span><span class="o">/</span><span class="mi">78125</span><span class="p">,</span>  <span class="o">-</span><span class="mi">4862</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4074</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">711</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">10304</span><span class="o">/</span><span class="mi">78125</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go"> y^2 + (15*g^3-48*g-42)*x*y + (-111510*g^3-162162*g^2-44145*g+37638)*y = x^3 + (-954*g^3-1134*g^2+81*g+576)*x^2</span>
<span class="go"> over Number Field in g with defining polynomial t^4 - t^3 - 3*t^2 - t + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_minimal_model">
<span class="sig-name descname"><span class="pre">global_minimal_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semi_global</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_minimal_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return a model of self that is integral, and minimal.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Over fields of class number greater than 1, a global
minimal model may not exist.  If it does not, set the
parameter <code class="docutils literal notranslate"><span class="pre">semi_global</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> to obtain a model
minimal at all but one prime.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">semi_global</span></code> (boolean, default False) – if there is no
global minimal mode, return a semi-global minimal model
(minimal at all but one prime) instead, if True; raise an
error if False.  No effect if a global minimal model exists.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A global integral and minimal model, or an integral model
minimal at all but one prime of there is no global minimal
model and the flag <code class="docutils literal notranslate"><span class="pre">semi_global</span></code> is True.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">38</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21796814856932765568243810</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">134364590724198567128296995</span><span class="p">,</span> <span class="mi">121774567239345229314269094644186997594</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">750668847495706904791115375024037711300</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E2</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go"> y^2 + a*x*y + (a+1)*y = x^3 + (a+1)*x^2 + (4*a+15)*x + (4*a+21)</span>
<span class="go"> over Number Field in a with defining polynomial x^2 - 38</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">local_data</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/sagemath/sage/issues/11347">github issue #11347</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">48</span><span class="p">,</span> <span class="mi">161</span><span class="o">/</span><span class="mi">864</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">integral_model</span><span class="p">()</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">();</span> <span class="n">E2</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2</span>
<span class="go"> over Number Field in g with defining polynomial x^2 - x - 1</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="o">.</span><span class="n">norm</span><span class="p">(),</span> <span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">E2</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()]</span>
<span class="go">[(9, 1), (5, 1)]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="o">.</span><span class="n">norm</span><span class="p">(),</span> <span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">E2</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()]</span>
<span class="go">[(-5, 2), (9, 1)]</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/sagemath/sage/issues/14472">github issue #14472</a>, this used not to work over a relative extension:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K1</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K1</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mi">432</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3</span>
<span class="go"> over Number Field in v with defining polynomial x^2 - w + 1 over its base field</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/sagemath/sage/issues/18662">github issue #18662</a>: for fields of class number greater than 1,
even when global minimal models did exist, their computation
was not implemented.  Now it is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">186408</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">589491</span><span class="p">,</span> <span class="mi">78055704</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">246833838</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">16375845905239507992576</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2^31 * 3^27</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_global_minimal_model</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">();</span> <span class="n">Emin</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go"> y^2 + (a+1)*x*y + (a+1)*y = x^3 + (-a)*x^2 + (a-12)*x + (-2*a+2)</span>
<span class="go"> over Number Field in a with defining polynomial x^2 - 10</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">3456</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2^7 * 3^3</span>
</pre></div>
</div>
<p>If there is no global minimal model, this method will raise an
error unless you set the parameter <code class="docutils literal notranslate"><span class="pre">semi_global</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Elliptic Curve defined by</span>
<span class="go">y^2 + a*x*y = x^3 + a*x^2 + (3*a+8)*x + (4*a+3) over Number Field</span>
<span class="go">in a with defining polynomial x^2 - 10 has no global minimal model!</span>
<span class="go">For a semi-global minimal model use semi_global=True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">(</span><span class="n">semi_global</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go"> y^2 + a*x*y = x^3 + a*x^2 + (3*a+8)*x + (4*a+3) over Number Field in a</span>
<span class="go"> with defining polynomial x^2 - 10</span>
</pre></div>
</div>
<p>An example of a curve with everywhere good reduction but which
has no model with unit discriminant:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">16</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">15221331</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">53748576</span><span class="p">,</span> <span class="o">-</span><span class="mi">79617688290</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">281140318368</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">(</span><span class="n">semi_global</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span>
<span class="go">(a, a - 1, a, 605*a - 2728, 15887*a - 71972)</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-17*a - 16</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">-4096</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_minimality_class">
<span class="sig-name descname"><span class="pre">global_minimality_class</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_minimality_class" title="Permalink to this definition">#</a></dt>
<dd><p>Return the obstruction to this curve having a global minimal model.</p>
<p>OUTPUT:</p>
<p>An ideal class of the base number field, which is trivial if
and only if the elliptic curve has a global minimal model, and
which can be used to find global and semi-global minimal
models.</p>
<p>EXAMPLES:</p>
<p>A curve defined over a field of class number 2 with no global
minimal model was a nontrivial minimality class:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">22500</span><span class="p">,</span> <span class="mi">750000</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimality_class</span><span class="p">()</span>
<span class="go">Fractional ideal class (10, 5*a)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimality_class</span><span class="p">()</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Over the same field, a curve defined by a non-minimal model
has trivial class, showing that a global minimal model does
exist:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4536</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">14148</span><span class="p">,</span> <span class="o">-</span><span class="mi">163728</span><span class="o">*</span><span class="n">a</span><span class="o">-</span><span class="mi">474336</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimality_class</span><span class="p">()</span>
<span class="go">Trivial principal fractional ideal class</span>
</pre></div>
</div>
<p>Over a field of class number 1 the result is always the
trivial class:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="mi">64</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimality_class</span><span class="p">()</span>
<span class="go">Trivial principal fractional ideal class</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimality_class</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_additive_reduction">
<span class="sig-name descname"><span class="pre">has_additive_reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_additive_reduction" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this elliptic curve has (bad) additive reduction at the prime <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a prime ideal of the base field of self, or a field
element generating such an ideal.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if the curve has additive reduction at <span class="math notranslate nohighlight">\(P\)</span>, else False.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;27a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_additive_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, False), (3, True), (5, False), (7, False), (11, False), (13, False)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_additive_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), False),</span>
<span class="go"> (Fractional ideal (2*a + 1), True)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_bad_reduction">
<span class="sig-name descname"><span class="pre">has_bad_reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_bad_reduction" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this elliptic curve has bad reduction at the prime <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a prime ideal of the base field of self, or a field
element generating such an ideal.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if the curve has bad reduction at <span class="math notranslate nohighlight">\(P\)</span>, else False.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This requires determining a local integral minimal model;
we do not just check that the discriminant of the current
model has valuation zero.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_bad_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, True), (3, False), (5, False), (7, True), (11, False), (13, False)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_bad_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), False),</span>
<span class="go"> (Fractional ideal (2*a + 1), True)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm">
<span class="sig-name descname"><span class="pre">has_cm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether or not this curve has a CM <span class="math notranslate nohighlight">\(j\)</span>-invariant.</p>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this curve has CM over the algebraic closure
of the base field, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>.  See also
<a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cm_discriminant()</span></code></a> and <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">has_rational_cm()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even if <span class="math notranslate nohighlight">\(E\)</span> has CM in this sense (that its <span class="math notranslate nohighlight">\(j\)</span>-invariant is
a CM <span class="math notranslate nohighlight">\(j\)</span>-invariant), if the associated negative
discriminant <span class="math notranslate nohighlight">\(D\)</span> is not a square in the base field <span class="math notranslate nohighlight">\(K\)</span>, the
extra endomorphisms will not be defined over <span class="math notranslate nohighlight">\(K\)</span>.  See also
the method <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">has_rational_cm()</span></code></a> which tests whether <span class="math notranslate nohighlight">\(E\)</span>
has extra endomorphisms defined over <span class="math notranslate nohighlight">\(K\)</span> or a given
extension of <span class="math notranslate nohighlight">\(K\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1728</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">282880</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">632000</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">31710790944000</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">39953093016000</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">50337742902000</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_global_minimal_model">
<span class="sig-name descname"><span class="pre">has_global_minimal_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_global_minimal_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether this elliptic curve has a global minimal model.</p>
<p>OUTPUT:</p>
<p>Boolean, True iff a global minimal model exists, i.e. an
integral model which is minimal at every prime.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4536</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">14148</span><span class="p">,</span> <span class="o">-</span><span class="mi">163728</span><span class="o">*</span><span class="n">a</span><span class="o">-</span><span class="mi">474336</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_global_minimal_model</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_good_reduction">
<span class="sig-name descname"><span class="pre">has_good_reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_good_reduction" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this elliptic curve has good reduction at the prime <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a prime ideal of the base field of self, or a field
element generating such an ideal.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(bool) – True if the curve has good reduction at <span class="math notranslate nohighlight">\(P\)</span>, else False.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This requires determining a local integral minimal model;
we do not just check that the discriminant of the current
model has valuation zero.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, False), (3, True), (5, True), (7, False), (11, True), (13, True)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), True),</span>
<span class="go"> (Fractional ideal (2*a + 1), False)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_multiplicative_reduction">
<span class="sig-name descname"><span class="pre">has_multiplicative_reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_multiplicative_reduction" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this elliptic curve has (bad) multiplicative reduction at the prime <span class="math notranslate nohighlight">\(P\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See also <code class="docutils literal notranslate"><span class="pre">has_split_multiplicative_reduction()</span></code> and
<code class="docutils literal notranslate"><span class="pre">has_nonsplit_multiplicative_reduction()</span></code>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a prime ideal of the base field of self, or a field
element generating such an ideal.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if the curve has multiplicative reduction at <span class="math notranslate nohighlight">\(P\)</span>,
else False.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, True), (3, False), (5, False), (7, True), (11, False), (13, False)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), False),</span>
<span class="go"> (Fractional ideal (2*a + 1), False)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_nonsplit_multiplicative_reduction">
<span class="sig-name descname"><span class="pre">has_nonsplit_multiplicative_reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_nonsplit_multiplicative_reduction" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this elliptic curve has (bad) non-split multiplicative reduction at the prime <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a prime ideal of the base field of self, or a field
element generating such an ideal.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if the curve has non-split multiplicative
reduction at <span class="math notranslate nohighlight">\(P\)</span>, else False.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_nonsplit_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, True), (3, False), (5, False), (7, False), (11, False), (13, False)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_nonsplit_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), False),</span>
<span class="go"> (Fractional ideal (2*a + 1), False)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm">
<span class="sig-name descname"><span class="pre">has_rational_cm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether or not this curve has CM defined over its
base field or a given extension.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">field</span></code> – a field, which should be an extension of the
base field of the curve.  If <code class="docutils literal notranslate"><span class="pre">field</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code> (the
default), it is taken to be the base field of the curve.</p></li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the ring of endomorphisms of this curve over
the given field is larger than <span class="math notranslate nohighlight">\(\ZZ\)</span>; otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>.
See also <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cm_discriminant()</span></code></a> and <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">has_cm()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <span class="math notranslate nohighlight">\(E\)</span> has CM but the discriminant <span class="math notranslate nohighlight">\(D\)</span> is not a square in
the given field <span class="math notranslate nohighlight">\(K\)</span> then the extra endomorphisms will not
be defined over <span class="math notranslate nohighlight">\(K\)</span>, and this function will return
<code class="docutils literal notranslate"><span class="pre">False</span></code>.  See also <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">has_cm()</span></code></a>.  To obtain the CM
discriminant, use <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cm_discriminant()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">();</span> <span class="n">D</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1728</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">();</span> <span class="n">D</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Higher degree examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">282880</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">632000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-20</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An error is raised if a field is given which is not an extension of the base field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Error in has_rational_cm: Number Field in a</span>
<span class="go">with defining polynomial x^2 + 20 with a = 4.472135954999579?*I</span>
<span class="go">is not an extension field of Number Field in a</span>
<span class="go">with defining polynomial x^2 - 5 with a = 2.236067977499790?</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">31710790944000</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">39953093016000</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">50337742902000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">();</span> <span class="n">D</span>
<span class="go">-108</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">108</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_split_multiplicative_reduction">
<span class="sig-name descname"><span class="pre">has_split_multiplicative_reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_split_multiplicative_reduction" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this elliptic curve has (bad) split multiplicative reduction at the prime <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a prime ideal of the base field of self, or a field
element generating such an ideal.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if the curve has split multiplicative reduction at
<span class="math notranslate nohighlight">\(P\)</span>, else False.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_split_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, False), (3, False), (5, False), (7, True), (11, False), (13, False)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">has_split_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), False),</span>
<span class="go"> (Fractional ideal (2*a + 1), False)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_function">
<span class="sig-name descname"><span class="pre">height_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_function" title="Permalink to this definition">#</a></dt>
<dd><p>Return the canonical height function attached to self.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s1">&#39;11a3&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="go">EllipticCurveCanonicalHeight object associated to</span>
<span class="go"> Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2</span>
<span class="go"> over Number Field in a with defining polynomial x^2 - 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_pairing_matrix">
<span class="sig-name descname"><span class="pre">height_pairing_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalised</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_pairing_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the height pairing matrix of the given points.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">points</span></code> (list or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – a list of points
on this curve, or <code class="docutils literal notranslate"><span class="pre">None</span></code>, in which case self.gens() will
be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – number of bits
of precision of result, or <code class="docutils literal notranslate"><span class="pre">None</span></code>, for default RealField
precision.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalised</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">True</span></code>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, use
normalised heights which are independent of base change.
Otherwise use the non-normalised Néron-Tate height, as
required for the regulator in the BSD conjecture.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">()</span>
<span class="go">[0.0511114082399688]</span>
</pre></div>
</div>
<p>For rank 0 curves, the result is a valid 0x0 matrix:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[  1.3685725053539301120518194471  -1.3095767070865761992624519454 -0.63486715783715592064475542573]</span>
<span class="go">[ -1.3095767070865761992624519454   2.7173593928122930896610589220   1.0998184305667292139777571432]</span>
<span class="go">[-0.63486715783715592064475542573   1.0998184305667292139777571432  0.66820516565192793503314205089]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">E</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">[0.686667083305587 0.268478098806726]</span>
<span class="go">[0.268478098806726 0.327000773651605]</span>
</pre></div>
</div>
<p>Over a number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">47</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">EK</span><span class="p">(</span><span class="n">P</span><span class="p">),</span><span class="n">EK</span><span class="p">(</span><span class="n">Q</span><span class="p">)])</span>
<span class="go">[0.686667083305587 0.268478098806726]</span>
<span class="go">[0.268478098806726 0.327000773651605]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="mi">25</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">[  2.16941934493768 -0.870059380421505]</span>
<span class="go">[-0.870059380421505  0.424585837470709]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">0.164101403936070</span>
</pre></div>
</div>
<p>When the parameter <code class="docutils literal notranslate"><span class="pre">normalised</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, each
height is multiplied by the degree <span class="math notranslate nohighlight">\(d\)</span> of the base field, and
the regulator of <span class="math notranslate nohighlight">\(r\)</span> points is multiplied by <span class="math notranslate nohighlight">\(d^r\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">],</span> <span class="n">normalised</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[ 4.33883868987537 -1.74011876084301]</span>
<span class="go">[-1.74011876084301 0.849171674941418]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">],</span> <span class="n">normalised</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0.656405615744281</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.integral_model">
<span class="sig-name descname"><span class="pre">integral_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.integral_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return a model of self which is integral at all primes.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go"> y^2 + (-i)*x*y + (-25*i)*y = x^3 + 5*i*x^2 + 125*i*x + 3125*i</span>
<span class="go"> over Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/sagemath/sage/issues/7935">github issue #7935</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">38</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 1444*a*x + 27436</span>
<span class="go"> over Number Field in a with defining polynomial x^2 - 38</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/sagemath/sage/issues/9266">github issue #9266</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">w</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + (1/2*s+1/2)</span>
<span class="go"> over Number Field in s with defining polynomial x^2 - 5</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/sagemath/sage/issues/12151">github issue #12151</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">161</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">25105</span><span class="o">/</span><span class="mi">216</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">3839</span><span class="o">/</span><span class="mi">36</span><span class="p">,</span> <span class="mi">634768555</span><span class="o">/</span><span class="mi">7776</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">98002625</span><span class="o">/</span><span class="mi">1296</span><span class="p">,</span> <span class="mi">634768555</span><span class="o">/</span><span class="mi">7776</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">98002625</span><span class="o">/</span><span class="mi">1296</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">();</span> <span class="n">M</span> <span class="c1"># choice varies, not tested</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go">y^2 + (2094779518028859*v-1940492905300351)*x*y + (477997268472544193101178234454165304071127500*v-442791377441346852919930773849502871958097500)*y = x^3 + (26519784690047674853185542622500*v-24566525306469707225840460652500)*x^2</span>
<span class="go"> over Number Field in v with defining polynomial x^2 + 161*x - 150</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/sagemath/sage/issues/14476">github issue #14476</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span> <span class="o">-</span><span class="mi">43</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">14</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">706</span><span class="o">/</span><span class="mi">625</span><span class="p">,</span> <span class="o">-</span><span class="mi">4862</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4074</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">711</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">10304</span><span class="o">/</span><span class="mi">78125</span><span class="p">,</span>  <span class="o">-</span><span class="mi">4862</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4074</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">711</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">10304</span><span class="o">/</span><span class="mi">78125</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go"> y^2 + (15*g^3-48*g-42)*x*y + (-111510*g^3-162162*g^2-44145*g+37638)*y = x^3 + (-954*g^3-1134*g^2+81*g+576)*x^2</span>
<span class="go"> over Number Field in g with defining polynomial t^4 - t^3 - 3*t^2 - t + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_Q_curve">
<span class="sig-name descname"><span class="pre">is_Q_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">certificate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_Q_curve" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if this is a <span class="math notranslate nohighlight">\(\QQ\)</span>-curve, with optional certificate.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">maxp</span></code> (int, default 100): bound on primes used for
checking necessary local conditions.  The result will not
depend on this, but using a larger value may return
<code class="docutils literal notranslate"><span class="pre">False</span></code> faster.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">certificate</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>): if <code class="docutils literal notranslate"><span class="pre">True</span></code> then
a second value is returned giving a certificate for the
<span class="math notranslate nohighlight">\(\QQ\)</span>-curve property.</p></li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">certificate</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>: either <code class="docutils literal notranslate"><span class="pre">True</span></code> (if <span class="math notranslate nohighlight">\(E\)</span> is a
<span class="math notranslate nohighlight">\(\QQ\)</span>-curve), or <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">certificate</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>: a tuple consisting of a boolean
flag as before and a certificate, defined as follows:</p>
<ul class="simple">
<li><p>when the flag is <code class="docutils literal notranslate"><span class="pre">True</span></code>, so <span class="math notranslate nohighlight">\(E\)</span> is a <span class="math notranslate nohighlight">\(\QQ\)</span>-curve:</p>
<ul>
<li><p>either {‘CM’:<span class="math notranslate nohighlight">\(D\)</span>} where <span class="math notranslate nohighlight">\(D\)</span> is a negative discriminant, when
<span class="math notranslate nohighlight">\(E\)</span> has potential CM with discriminant <span class="math notranslate nohighlight">\(D\)</span>;</p></li>
<li><p>otherwise {‘CM’: <span class="math notranslate nohighlight">\(0\)</span>, ‘core_poly’: <span class="math notranslate nohighlight">\(f\)</span>, ‘rho’: <span class="math notranslate nohighlight">\(\rho\)</span>,
‘r’: <span class="math notranslate nohighlight">\(r\)</span>, ‘N’: <span class="math notranslate nohighlight">\(N\)</span>}, when <span class="math notranslate nohighlight">\(E\)</span> is a non-CM <span class="math notranslate nohighlight">\(\QQ\)</span>-curve,
where the core polynomial <span class="math notranslate nohighlight">\(f\)</span> is an irreducible monic
polynomial over <span class="math notranslate nohighlight">\(QQ\)</span> of degree <span class="math notranslate nohighlight">\(2^\rho\)</span>, all of whose
roots are <span class="math notranslate nohighlight">\(j\)</span>-invariants of curves isogenous to <span class="math notranslate nohighlight">\(E\)</span>, the
core level <span class="math notranslate nohighlight">\(N\)</span> is a square-free integer with <span class="math notranslate nohighlight">\(r\)</span> prime
factors which is the LCM of the degrees of the isogenies
between these conjugates.  For example, if there exists
a curve <span class="math notranslate nohighlight">\(E'\)</span> isogenous to <span class="math notranslate nohighlight">\(E\)</span> with <span class="math notranslate nohighlight">\(j(E')=j\in\QQ\)</span>, then
the certificate is {‘CM’:0, ‘r’:0, ‘rho’:0, ‘core_poly’:
x-j, ‘N’:1}.</p></li>
</ul>
</li>
<li><p>when the flag is <code class="docutils literal notranslate"><span class="pre">False</span></code>, so <span class="math notranslate nohighlight">\(E\)</span> is not a <span class="math notranslate nohighlight">\(\QQ\)</span>-curve, the
certificate is a prime <span class="math notranslate nohighlight">\(p\)</span> such that the reductions of <span class="math notranslate nohighlight">\(E\)</span>
at the primes dividing <span class="math notranslate nohighlight">\(p\)</span> are inconsistent with the
property of being a <span class="math notranslate nohighlight">\(\QQ\)</span>-curve.  See the documentation for
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.src.schemes.elliptic_curves.Qcurves.is_Q_curve()</span></code>
for details.</p></li>
</ul>
<p>ALGORITHM:</p>
<p>See the documentation for
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.src.schemes.elliptic_curves.Qcurves.is_Q_curve()</span></code>, and
<a class="reference internal" href="../../../../references/index.html#crna2020" id="id1"><span>[CrNa2020]</span></a> for details.</p>
<p>EXAMPLES:</p>
<p>A non-CM curve over <span class="math notranslate nohighlight">\(\QQ\)</span> and a CM curve over <span class="math notranslate nohighlight">\(\QQ\)</span> are both
trivially <span class="math notranslate nohighlight">\(\QQ\)</span>-curves:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">flag</span><span class="p">,</span> <span class="n">cert</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">is_Q_curve</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">flag</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cert</span>
<span class="go">{&#39;CM&#39;: 0, &#39;N&#39;: 1, &#39;core_poly&#39;: x, &#39;r&#39;: 0, &#39;rho&#39;: 0}</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">flag</span><span class="p">,</span> <span class="n">cert</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">is_Q_curve</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">flag</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cert</span>
<span class="go">{&#39;CM&#39;: -8}</span>
</pre></div>
</div>
<p>A non-<span class="math notranslate nohighlight">\(\QQ\)</span>-curve over a quartic field.  The local data at bad
primes above <span class="math notranslate nohighlight">\(3\)</span> is inconsistent:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">R</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">621</span><span class="p">,</span><span class="mi">778</span><span class="p">,</span><span class="mi">138</span><span class="p">,</span><span class="o">-</span><span class="mi">178</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">9509</span><span class="p">,</span><span class="mi">2046</span><span class="p">,</span><span class="o">-</span><span class="mi">24728</span><span class="p">,</span><span class="mi">10380</span><span class="p">])])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_Q_curve</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Checking whether Elliptic Curve defined by y^2 + (a^3+a^2-4*a-3)*x*y + (a^2-2)*y = x^3 + (-a^2-a+4)*x^2 + (-178*a^3+138*a^2+778*a-621)*x + (10380*a^3-24728*a^2+2046*a+9509) over Number Field in a with defining polynomial x^4 - 5*x^2 + 3 is a Q-curve</span>
<span class="go">No: inconsistency at the 2 primes dividing 3</span>
<span class="go">- potentially multiplicative: [True, False]</span>
<span class="go">(False, 3)</span>
</pre></div>
</div>
<p>A non-<span class="math notranslate nohighlight">\(\QQ\)</span>-curve over a quadratic field.  The local data at bad
primes is consistent, but the local test at good primes above <span class="math notranslate nohighlight">\(13\)</span>
is not:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">R</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">K</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">236</span><span class="p">,</span><span class="mi">40</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">1840</span><span class="p">,</span><span class="mi">464</span><span class="p">])])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_Q_curve</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Checking whether Elliptic Curve defined by y^2 + a*x*y = x^3 + (-a-1)*x^2 + (40*a-236)*x + (464*a-1840) over Number Field in a with defining polynomial x^2 - 10 is a Q-curve</span>
<span class="go">Applying local tests at good primes above p&lt;=100</span>
<span class="go">No: inconsistency at the 2 ordinary primes dividing 13</span>
<span class="go">- Frobenius discriminants mod squares: [-1, -3]</span>
<span class="go">No: local test at p=13 failed</span>
<span class="go">(False, 13)</span>
</pre></div>
</div>
<p>A quadratic <span class="math notranslate nohighlight">\(\QQ\)</span>-curve with CM discriminant <span class="math notranslate nohighlight">\(-15\)</span>
(so the <span class="math notranslate nohighlight">\(j\)</span>-invariant is not in <span class="math notranslate nohighlight">\(\QQ\)</span>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">R</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">K</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_Q_curve</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Checking whether Elliptic Curve defined by y^2 + x*y + a*y = x^3 + (-1)*x^2 + (-2*a)*x + a over Number Field in a with defining polynomial x^2 - x - 1 is a Q-curve</span>
<span class="go">Yes: E is CM (discriminant -15)</span>
<span class="go">(True, {&#39;CM&#39;: -15})</span>
</pre></div>
</div>
<p>An example over <span class="math notranslate nohighlight">\(\QQ(\sqrt{2},\sqrt{3})\)</span>.  The <span class="math notranslate nohighlight">\(j\)</span>-invariant
is in <span class="math notranslate nohighlight">\(\QQ(\sqrt{6})\)</span>, so computations will be done over that
field, and in fact there is an isogenous curve with rational
<span class="math notranslate nohighlight">\(j\)</span>, so we have a so-called rational <span class="math notranslate nohighlight">\(\QQ\)</span>-curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">R</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">4780</span><span class="p">,</span><span class="mi">9170</span><span class="p">,</span><span class="mi">1265</span><span class="p">,</span><span class="o">-</span><span class="mi">2463</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">163923</span><span class="p">,</span><span class="o">-</span><span class="mi">316598</span><span class="p">,</span><span class="o">-</span><span class="mi">43876</span><span class="p">,</span><span class="mi">84852</span><span class="p">])])</span>
<span class="gp">sage: </span><span class="n">flag</span><span class="p">,</span> <span class="n">cert</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">is_Q_curve</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">flag</span> <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cert</span> <span class="c1"># long time</span>
<span class="go">{&#39;CM&#39;: 0, &#39;N&#39;: 1, &#39;core_degs&#39;: [1], &#39;core_poly&#39;: x - 85184/3, &#39;r&#39;: 0, &#39;rho&#39;: 0}</span>
</pre></div>
</div>
<p>Over the same field, a so-called strict <span class="math notranslate nohighlight">\(\QQ\)</span>-curve which is
not isogenous to one with rational <span class="math notranslate nohighlight">\(j\)</span>, but whose core field
is quadratic. In fact the isogeny class over <span class="math notranslate nohighlight">\(K\)</span> consists of
<span class="math notranslate nohighlight">\(6\)</span> curves, four with conjugate quartic <span class="math notranslate nohighlight">\(j\)</span>-invariants and <span class="math notranslate nohighlight">\(2\)</span>
with quadratic conjugate <span class="math notranslate nohighlight">\(j\)</span>-invariants in <span class="math notranslate nohighlight">\(\QQ(\sqrt{3})\)</span>
(but which are not base-changes from the quadratic subfield):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">K</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">K</span><span class="p">([</span><span class="o">-</span><span class="mi">19</span><span class="p">,</span><span class="o">-</span><span class="mi">32</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">])])</span>
<span class="gp">sage: </span><span class="n">flag</span><span class="p">,</span> <span class="n">cert</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">is_Q_curve</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">flag</span> <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cert</span> <span class="c1"># long time</span>
<span class="go">{&#39;CM&#39;: 0,</span>
<span class="go"> &#39;N&#39;: 2,</span>
<span class="go"> &#39;core_degs&#39;: [1, 2],</span>
<span class="go"> &#39;core_poly&#39;: x^2 - 840064*x + 1593413632,</span>
<span class="go"> &#39;r&#39;: 1,</span>
<span class="go"> &#39;rho&#39;: 1}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_global_integral_model">
<span class="sig-name descname"><span class="pre">is_global_integral_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_global_integral_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is integral at all primes.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">is_global_integral_model</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_global_minimal_model">
<span class="sig-name descname"><span class="pre">is_global_minimal_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_global_minimal_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether this elliptic curve is a global minimal model.</p>
<p>OUTPUT:</p>
<p>Boolean, False if E is not integral, or if E is non-minimal at
some prime, else True.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">22500</span><span class="p">,</span> <span class="mi">750000</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">[Fractional ideal (2, a), Fractional ideal (5, a)]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3024</span><span class="p">,</span> <span class="mi">46224</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A necessary condition to be a global minimal model is that the
model must be globally integral:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span>
<span class="go">(0, 1, 1, -2, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_isogenous">
<span class="sig-name descname"><span class="pre">is_isogenous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_isogenous" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether or not self is isogenous to other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – another elliptic curve.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> (default True) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the function will
return <code class="docutils literal notranslate"><span class="pre">True</span></code> whenever the two curves have the same
conductor and are isogenous modulo <span class="math notranslate nohighlight">\(p\)</span> for all primes <span class="math notranslate nohighlight">\(p\)</span> of
norm up to <code class="docutils literal notranslate"><span class="pre">maxnorm</span></code>.  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the function returns
False when the previous condition does not hold, and if it
does hold we compute the complete isogeny class to see if
the curves are indeed isogenous.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxnorm</span></code> (integer, default 100) – The maximum norm of
primes <span class="math notranslate nohighlight">\(p\)</span> for which isogeny modulo <span class="math notranslate nohighlight">\(p\)</span> will be checked.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if there is an isogeny from curve <code class="docutils literal notranslate"><span class="pre">self</span></code> to
curve <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in s with defining polynomial x^2 - 2</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E3</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in s with defining polynomial x^2 - 2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EE</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EE</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in s with defining polynomial x^2 - 2</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">EE</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">EE</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Second argument must be defined over the same number field.</span>
</pre></div>
</div>
<p>Some examples from Cremona’s 1981 tables:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">240</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">400</span><span class="p">,</span> <span class="o">-</span><span class="mi">2869</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2627</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (-4*i - 7)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (-4*i - 7)</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># faster  (~170ms)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In this case E1 and E2 are in fact 9-isogenous, as may be
deduced from the following:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E3</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E3</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E3</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_local_integral_model">
<span class="sig-name descname"><span class="pre">is_local_integral_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_local_integral_model" title="Permalink to this definition">#</a></dt>
<dd><p>Tests if self is integral at the prime ideal <span class="math notranslate nohighlight">\(P\)</span>, or at all the
primes if <span class="math notranslate nohighlight">\(P\)</span> is a list or tuple.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*P</span></code> – a prime ideal, or a list or tuple of primes.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_local_integral_model</span><span class="p">(</span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">local_integral_model</span><span class="p">(</span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">is_local_integral_model</span><span class="p">(</span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogenies_prime_degree">
<span class="sig-name descname"><span class="pre">isogenies_prime_degree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Billerey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimal_models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogenies_prime_degree" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of <span class="math notranslate nohighlight">\(\ell\)</span>-isogenies from self, where <span class="math notranslate nohighlight">\(\ell\)</span> is a
prime.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> – either None or a prime or a list of primes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string, default ‘Billerey’) – the algorithm
to use to compute the reducible primes when <code class="docutils literal notranslate"><span class="pre">l</span></code> is None.
Ignored for CM curves or if <code class="docutils literal notranslate"><span class="pre">l</span></code> is provided.  Values are
‘Billerey’ (default), ‘Larson’, and ‘heuristic’.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minimal_models</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">True</span></code>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>,
all curves computed will be minimal or semi-minimal models.
Over fields of larger degree it can be expensive to compute
these so set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(list) <span class="math notranslate nohighlight">\(\ell\)</span>-isogenies for the given <span class="math notranslate nohighlight">\(\ell\)</span> or if <span class="math notranslate nohighlight">\(\ell\)</span> is None, all
isogenies of prime degree (see below for the CM case).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Over <span class="math notranslate nohighlight">\(\QQ\)</span>, the codomains of the isogenies returned are
standard minimal models.  Over other number fields they are
global minimal models if these exist, otherwise models
which are minimal at all but one prime.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For curves with rational CM, isogenies of primes degree
exist for infinitely many primes <span class="math notranslate nohighlight">\(\ell\)</span>, though there are
only finitely many isogenous curves up to isomorphism.  The
list returned only includes one isogeny of prime degree for
each codomain.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">isogs</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">isogs</span><span class="p">]</span>
<span class="go">[2, 3]</span>

<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">js</span> <span class="o">=</span> <span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">js</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">())</span>  <span class="c1"># long time</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Set <code class="docutils literal notranslate"><span class="pre">minimal_models</span></code> to False to avoid computing minimal
models of the isogenous curves, since that can be
time-consuming since it requires computation of the class
group:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">number_field</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">minimal_models</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[Isogeny of degree 2</span>
<span class="go">  from Elliptic Curve defined by y^2 = x^3 + 6*x^2 + 2*x</span>
<span class="go">       over Cyclotomic Field of order 53 and degree 52</span>
<span class="go">    to Elliptic Curve defined by y^2 = x^3 + 6*x^2 + (-8)*x + (-48)</span>
<span class="go">       over Cyclotomic Field of order 53 and degree 52]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">minimal_models</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># not tested (10s)</span>
<span class="go">[Isogeny of degree 2</span>
<span class="go">  from Elliptic Curve defined by y^2 = x^3 + 6*x^2 + 2*x</span>
<span class="go">       over Cyclotomic Field of order 53 and degree 52</span>
<span class="go">    to Elliptic Curve defined by y^2 = x^3 + (-20)*x + (-16)</span>
<span class="go">       over Cyclotomic Field of order 53 and degree 52]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogeny_class">
<span class="sig-name descname"><span class="pre">isogeny_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reducible_primes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Billerey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimal_models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogeny_class" title="Permalink to this definition">#</a></dt>
<dd><p>Return the isogeny class of this elliptic curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reducible_primes</span></code> (list of ints, or None (default)) – if
not None then this should be a list of primes; in computing
the isogeny class, only composites isogenies of these
degrees will be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string, default <code class="docutils literal notranslate"><span class="pre">'Billerey'</span></code>) – the algorithm
to use to compute the reducible primes.  Ignored for CM
curves or if <code class="docutils literal notranslate"><span class="pre">reducible_primes</span></code> is provided.  Values are
<code class="docutils literal notranslate"><span class="pre">'Billerey'</span></code> (default), <code class="docutils literal notranslate"><span class="pre">'Larson'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'heuristic'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minimal_models</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">True</span></code>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>,
all curves in the class will be minimal or semi-minimal
models.  Over fields of larger degree it can be expensive to
compute these so set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An instance of the class
<a class="reference internal" href="isogeny_class.html#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField" title="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField</span></code></a>.
From this object may be obtained a list of curves in the
class, a matrix of the degrees of the isogenies between them,
and the isogenies themselves.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If using the algorithm <code class="docutils literal notranslate"><span class="pre">'heuristic'</span></code> for non-CM curves, the
result is not guaranteed to be the complete isogeny class,
since only reducible primes up to the default bound in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">reducible_primes_naive()</span></code> (currently 1000) are
tested.  However, no examples of non-CM elliptic curves
with reducible primes greater than 100 have yet been
computed so the output is likely to be correct.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, the curves in the isogeny class will all be
minimal models if these exist (for example, when the class
number is <span class="math notranslate nohighlight">\(1\)</span>); otherwise they will be minimal at all but
one prime.  This behaviour can be switched off if desired,
for example over fields where the computation of the class
group would be too expensive.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">();</span> <span class="n">C</span>
<span class="go">Isogeny class of Elliptic Curve defined by y^2 = x^3 + 1</span>
<span class="go"> over Number Field in i with defining polynomial x^2 + 1 with i = 1*I</span>
</pre></div>
</div>
<p>The curves in the class (sorted):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">E1</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span> <span class="k">for</span> <span class="n">E1</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(0, 0, 0, 0, -27),</span>
<span class="go">(0, 0, 0, 0, 1),</span>
<span class="go">(i + 1, i, i + 1, -i + 3, 4*i),</span>
<span class="go">(i + 1, i, i + 1, -i + 33, -58*i)]</span>
</pre></div>
</div>
<p>The matrix of degrees of cyclic isogenies between curves:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[1 3 6 2]</span>
<span class="go">[3 1 2 6]</span>
<span class="go">[6 2 1 3]</span>
<span class="go">[2 6 3 1]</span>
</pre></div>
</div>
<p>The array of isogenies themselves is not filled out but only
contains those used to construct the class, the other entries
containing the integer 0.  This will be changed when the
class <a class="reference internal" href="ell_curve_isogeny.html#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny" title="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny"><code class="xref py py-class docutils literal notranslate"><span class="pre">EllipticCurveIsogeny</span></code></a> allowed composition.  In
this case we used <span class="math notranslate nohighlight">\(2\)</span>-isogenies to go from 0 to 2 and from 1
to 3, and <span class="math notranslate nohighlight">\(3\)</span>-isogenies to go from 0 to 1 and from 2 to 3:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isogs</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">isogenies</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">isogs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">if</span> <span class="n">isogs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">[((0, 1), 3),</span>
<span class="go"> ((0, 3), 2),</span>
<span class="go"> ((1, 0), 3),</span>
<span class="go"> ((1, 2), 2),</span>
<span class="go"> ((2, 1), 2),</span>
<span class="go"> ((2, 3), 3),</span>
<span class="go"> ((3, 0), 2),</span>
<span class="go"> ((3, 2), 3)]</span>
<span class="gp">sage: </span><span class="p">[((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">isogs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">x_rational_map</span><span class="p">())</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">if</span> <span class="n">isogs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">[((0, 1), (1/9*x^3 - 12)/x^2),</span>
<span class="go"> ((0, 3), (-1/2*i*x^2 + i*x - 12*i)/(x - 3)),</span>
<span class="go"> ((1, 0), (x^3 + 4)/x^2),</span>
<span class="go"> ((1, 2), (-1/2*i*x^2 - i*x - 2*i)/(x + 1)),</span>
<span class="go"> ((2, 1), (1/2*i*x^2 - x)/(x + 3/2*i)),</span>
<span class="go"> ((2, 3), (x^3 + 4*i*x^2 - 10*x - 10*i)/(x^2 + 4*i*x - 4)),</span>
<span class="go"> ((3, 0), (1/2*i*x^2 + x + 4*i)/(x - 5/2*i)),</span>
<span class="go"> ((3, 2), (1/9*x^3 - 4/3*i*x^2 - 34/3*x + 226/9*i)/(x^2 - 8*i*x - 16))]</span>
</pre></div>
</div>
<p>The isogeny class may be visualized by obtaining its graph and
plotting it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># long time</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">();</span> <span class="n">C</span> <span class="c1"># long time</span>
<span class="go">Isogeny class of</span>
<span class="go"> Elliptic Curve defined by y^2 + (i+1)*x*y + i*y = x^3 + (-i)*x^2 + x</span>
<span class="go">  over Number Field in i with defining polynomial x^2 + 1 with i = 1*I</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">[ 1  3  9 18  6  2]</span>
<span class="go">[ 3  1  3  6  2  6]</span>
<span class="go">[ 9  3  1  2  6 18]</span>
<span class="go">[18  6  2  1  3  9]</span>
<span class="go">[ 6  2  6  3  1  3]</span>
<span class="go">[ 2  6 18  9  3  1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E1</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span> <span class="k">for</span> <span class="n">E1</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span> <span class="c1"># long time</span>
<span class="go">[(i + 1, i - 1, i, -i - 1, -i + 1),</span>
<span class="go"> (i + 1, i - 1, i, 14*i + 4, 7*i + 14),</span>
<span class="go"> (i + 1, i - 1, i, 59*i + 99, 372*i - 410),</span>
<span class="go"> (i + 1, -i, i, -240*i - 399, 2869*i + 2627),</span>
<span class="go"> (i + 1, -i, i, -5*i - 4, 2*i + 5),</span>
<span class="go"> (i + 1, -i, i, 1, 0)]</span>
</pre></div>
</div>
<p>An example with CM by <span class="math notranslate nohighlight">\(\sqrt{-5}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1480640</span> <span class="o">+</span> <span class="mi">565760</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-20</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[1 2]</span>
<span class="go">[2 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span> <span class="k">for</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(0, 0, 0, 83490*c^2 - 147015, -64739840*c^2 - 84465260),</span>
<span class="go">(0, 0, 0, -161535*c^2 + 70785, -62264180*c^3 + 6229080*c)]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">isogenies</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Isogeny of degree 2</span>
<span class="go"> from Elliptic Curve defined by</span>
<span class="go">      y^2 = x^3 + (83490*c^2-147015)*x + (-64739840*c^2-84465260)</span>
<span class="go">      over Number Field in c with defining polynomial x^4 + 3*x^2 + 1</span>
<span class="go">   to Elliptic Curve defined by</span>
<span class="go">      y^2 = x^3 + (-161535*c^2+70785)*x + (-62264180*c^3+6229080*c)</span>
<span class="go">      over Number Field in c with defining polynomial x^4 + 3*x^2 + 1</span>
</pre></div>
</div>
<p>An example with CM by <span class="math notranslate nohighlight">\(\sqrt{-23}\)</span> (class number <span class="math notranslate nohighlight">\(3\)</span>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">js</span> <span class="o">=</span> <span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">js</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">())</span>  <span class="c1"># long time</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">6</span>
</pre></div>
</div>
<p>The reason for the isogeny class having size six while the
class number is only <span class="math notranslate nohighlight">\(3\)</span> is that the class also contains three
curves with CM by the order of discriminant <span class="math notranslate nohighlight">\(-92=4\cdot(-23)\)</span>,
which also has class number <span class="math notranslate nohighlight">\(3\)</span>.  The curves in the class are
sorted first by CM discriminant (then lexicographically using
a-invariants):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">F</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span> <span class="k">for</span> <span class="n">F</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>  <span class="c1"># long time</span>
<span class="go">[-23, -23, -23, -92, -92, -92]</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(2\)</span> splits in the order with discriminant <span class="math notranslate nohighlight">\(-23\)</span>, into two
primes of order <span class="math notranslate nohighlight">\(3\)</span> in the class group, each of which induces
a <span class="math notranslate nohighlight">\(2\)</span>-isogeny to a curve with the same endomorphism ring; the
third <span class="math notranslate nohighlight">\(2\)</span>-isogeny is to a curve with the smaller endomorphism
ring:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">()]</span>  <span class="c1"># long time</span>
<span class="go">[-92, -23, -23]</span>

<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>  <span class="c1"># long time # random</span>
<span class="go">[1 2 2 4 4 2]</span>
<span class="go">[2 1 2 4 2 4]</span>
<span class="go">[2 2 1 2 4 4]</span>
<span class="go">[4 4 2 1 3 3]</span>
<span class="go">[4 2 4 3 1 3]</span>
<span class="go">[2 4 4 3 3 1]</span>
</pre></div>
</div>
<p>The graph of this isogeny class has a shape which does not
occur over <span class="math notranslate nohighlight">\(\QQ\)</span>: a triangular prism.  Note that for curves
without CM, the graph has an edge between two curves if and
only if they are connected by an isogeny of prime degree, and
this degree is uniquely determined by the two curves, but in
the CM case this property does not hold, since for pairs of
curves in the class with the same endomorphism ring <span class="math notranslate nohighlight">\(O\)</span>, the
set of degrees of isogenies between them is the set of
integers represented by a primitive integral binary quadratic
form of discriminant <span class="math notranslate nohighlight">\(\text{disc}(O)\)</span>, and this form
represents infinitely many primes.  In the matrix we give a
small prime represented by the appropriate form.  In this
example, the matrix is formed by four <span class="math notranslate nohighlight">\(3\times3\)</span> blocks.  The
isogenies of degree <span class="math notranslate nohighlight">\(2\)</span> indicated by the upper left <span class="math notranslate nohighlight">\(3\times3\)</span>
block of the matrix could be replaced by isogenies of any
degree represented by the quadratic form <span class="math notranslate nohighlight">\(2x^2+xy+3y^2\)</span> of
discriminant <span class="math notranslate nohighlight">\(-23\)</span>.  Similarly in the lower right block, the
entries of <span class="math notranslate nohighlight">\(3\)</span> could be represented by any integers
represented by the quadratic form <span class="math notranslate nohighlight">\(3x^2+2xy+8y^2\)</span> of
discriminant <span class="math notranslate nohighlight">\(-92\)</span>.  In the top right block and lower left
blocks, by contrast, the prime entries <span class="math notranslate nohighlight">\(2\)</span> are unique
determined:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>  <span class="c1"># long time # random</span>
<span class="go">[0 1 1 0 0 1]</span>
<span class="go">[1 0 1 0 1 0]</span>
<span class="go">[1 1 0 1 0 0]</span>
<span class="go">[0 0 1 0 1 1]</span>
<span class="go">[0 1 0 1 0 1]</span>
<span class="go">[1 0 0 1 1 0]</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">simplex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">prism</span><span class="p">()</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">())</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>To display the graph without any edge labels:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># not tested</span>
</pre></div>
</div>
<p>To display the graph with edge labels: by default, for curves
with rational CM, the labels are the coefficients of the
associated quadratic forms:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># not tested</span>
</pre></div>
</div>
<p>For an alternative view, first relabel the edges using only 2
labels to distinguish between isogenies between curves with
the same endomorphism ring and isogenies between curves with
different endomorphism rings, then use a 3-dimensional plot
which can be rotated:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">():</span>  <span class="c1"># long time</span>
<span class="gp">....: </span>    <span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">color_by_label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># long time</span>
</pre></div>
</div>
<p>A class number <span class="math notranslate nohighlight">\(6\)</span> example.  First we set up the fields: <code class="docutils literal notranslate"><span class="pre">pol</span></code>
defines the same field as <code class="docutils literal notranslate"><span class="pre">pol26</span></code> but is simpler:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pol26</span> <span class="o">=</span> <span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="mi">26</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">26</span><span class="p">)</span>
</pre></div>
</div>
<p>Only <span class="math notranslate nohighlight">\(2\)</span> of the <span class="math notranslate nohighlight">\(j\)</span>-invariants with discriminant -104 are in
<span class="math notranslate nohighlight">\(K\)</span>, though all are in <span class="math notranslate nohighlight">\(L\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">pol26</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">pol26</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
<span class="go">6</span>
</pre></div>
</div>
<p>We create an elliptic curve defined over <span class="math notranslate nohighlight">\(K\)</span> with one of the
<span class="math notranslate nohighlight">\(j\)</span>-invariants in <span class="math notranslate nohighlight">\(K\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">j1</span> <span class="o">=</span> <span class="n">pol26</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">K</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">j1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Over <span class="math notranslate nohighlight">\(K\)</span> the isogeny class has size <span class="math notranslate nohighlight">\(4\)</span>, with <span class="math notranslate nohighlight">\(2\)</span> curves for
each of the <span class="math notranslate nohighlight">\(2\)</span> <span class="math notranslate nohighlight">\(K\)</span>-rational <span class="math notranslate nohighlight">\(j\)</span>-invariants:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="c1"># long time (~11s)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>                    <span class="c1"># long time</span>
<span class="go">[ 1 13  2 26]</span>
<span class="go">[13  1 26  2]</span>
<span class="go">[ 2 26  1 13]</span>
<span class="go">[26  2 13  1]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">Set</span><span class="p">([</span><span class="n">EE</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span> <span class="k">for</span> <span class="n">EE</span> <span class="ow">in</span> <span class="n">C</span><span class="o">.</span><span class="n">curves</span><span class="p">]))</span>  <span class="c1"># long time</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Over <span class="math notranslate nohighlight">\(L\)</span>, the isogeny class grows to size <span class="math notranslate nohighlight">\(6\)</span> (the class
number):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EL</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CL</span> <span class="o">=</span> <span class="n">EL</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">(</span><span class="n">minimal_models</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">CL</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">Set</span><span class="p">([</span><span class="n">EE</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span> <span class="k">for</span> <span class="n">EE</span> <span class="ow">in</span> <span class="n">CL</span><span class="o">.</span><span class="n">curves</span><span class="p">])</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">pol26</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span> <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In each position in the matrix of degrees, we see primes (or
<span class="math notranslate nohighlight">\(1\)</span>).  In fact the set of degrees of cyclic isogenies from
curve <span class="math notranslate nohighlight">\(i\)</span> to curve <span class="math notranslate nohighlight">\(j\)</span> is infinite, and is the set of all
integers represented by one of the primitive binary quadratic
forms of discriminant <span class="math notranslate nohighlight">\(-104\)</span>, from which we have selected a
small prime:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CL</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span> <span class="c1"># long time # random (see :trac:`19229`)</span>
<span class="go">[1 2 3 3 5 5]</span>
<span class="go">[2 1 5 5 3 3]</span>
<span class="go">[3 5 1 3 2 5]</span>
<span class="go">[3 5 3 1 5 2]</span>
<span class="go">[5 3 2 5 1 3]</span>
<span class="go">[5 3 5 2 3 1]</span>
</pre></div>
</div>
<p>To see the array of binary quadratic forms:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CL</span><span class="o">.</span><span class="n">qf_matrix</span><span class="p">()</span>  <span class="c1"># long time # random (see :trac:`19229`)</span>
<span class="go">[[[1], [2, 0, 13], [3, -2, 9], [3, -2, 9], [5, -4, 6], [5, -4, 6]],</span>
<span class="go"> [[2, 0, 13], [1], [5, -4, 6], [5, -4, 6], [3, -2, 9], [3, -2, 9]],</span>
<span class="go"> [[3, -2, 9], [5, -4, 6], [1], [3, -2, 9], [2, 0, 13], [5, -4, 6]],</span>
<span class="go"> [[3, -2, 9], [5, -4, 6], [3, -2, 9], [1], [5, -4, 6], [2, 0, 13]],</span>
<span class="go"> [[5, -4, 6], [3, -2, 9], [2, 0, 13], [5, -4, 6], [1], [3, -2, 9]],</span>
<span class="go"> [[5, -4, 6], [3, -2, 9], [5, -4, 6], [2, 0, 13], [3, -2, 9], [1]]]</span>
</pre></div>
</div>
<p>As in the non-CM case, the isogeny class may be visualized by
obtaining its graph and plotting it.  Since there are more
edges than in the non-CM case, it may be preferable to omit
the edge_labels:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># long time</span>
</pre></div>
</div>
<p>It is possible to display a 3-dimensional plot, with colours
to represent the different edge labels, in a form which can be
rotated!:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">color_by_label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># long time</span>
</pre></div>
</div>
<p>Over larger number fields several options make computations
tractable.  Here we use algorithm ‘heuristic’ which avoids a
rigorous computation of the reducible primes, only testing
those less than 1000, and setting <code class="docutils literal notranslate"><span class="pre">minimal_models</span></code> to
<code class="docutils literal notranslate"><span class="pre">False</span></code> avoid having to compute the class group of <span class="math notranslate nohighlight">\(K\)</span>.  To
obtain minimal models set proof.number_field(False); the class
group computation takes an additional 10s:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;heuristic&#39;</span><span class="p">,</span> <span class="n">minimal_models</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span> <span class="n">C</span> <span class="c1"># long time (10s)</span>
<span class="go">Isogeny class of Elliptic Curve defined by y^2 = x^3 + 6*x^2 + 2*x</span>
<span class="go"> over Cyclotomic Field of order 53 and degree 52</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">curves</span> <span class="c1"># long time</span>
<span class="go">[Elliptic Curve defined by y^2 = x^3 + 6*x^2 + (-8)*x + (-48)</span>
<span class="go">  over Cyclotomic Field of order 53 and degree 52,</span>
<span class="go"> Elliptic Curve defined by y^2 = x^3 + 6*x^2 + 2*x</span>
<span class="go">  over Cyclotomic Field of order 53 and degree 52]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogeny_degree">
<span class="sig-name descname"><span class="pre">isogeny_degree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogeny_degree" title="Permalink to this definition">#</a></dt>
<dd><p>Return the minimal degree of an isogeny between self and
other, or 0 if no isogeny exists.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – another elliptic curve.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(int) The degree of an isogeny from <code class="docutils literal notranslate"><span class="pre">self</span></code> to <code class="docutils literal notranslate"><span class="pre">other</span></code>, or 0.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="mf">.0</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in s with defining polynomial x^2 - 2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EE</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EE</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E5</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">E5</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">6</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E2</span><span class="o">.</span><span class="n">label</span><span class="p">()</span> <span class="k">for</span> <span class="n">E2</span> <span class="ow">in</span> <span class="n">cremona_curves</span><span class="p">([</span><span class="mf">11..20</span><span class="p">])</span> <span class="k">if</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">E2</span><span class="p">)]</span>
<span class="go">[&#39;11a1&#39;, &#39;11a2&#39;, &#39;11a3&#39;]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="k">for</span> <span class="n">F</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span> <span class="c1"># long time</span>
<span class="go">[2, 6, 18, 9, 3, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.kodaira_symbol">
<span class="sig-name descname"><span class="pre">kodaira_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.kodaira_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Kodaira Symbol of this elliptic curve at the prime <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – either None or a prime ideal of the base field of self.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The Kodaira Symbol of the curve at <code class="docutils literal notranslate"><span class="pre">P</span></code>, represented as a string.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">625</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6875</span><span class="p">,</span> <span class="mi">31250</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">46875</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">bad_primes</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">support</span><span class="p">();</span> <span class="n">bad_primes</span>
<span class="go">[Fractional ideal (-a), Fractional ideal (7/2*a - 81/2),</span>
<span class="go"> Fractional ideal (-a - 52), Fractional ideal (2)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">kodaira_symbol</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">bad_primes</span><span class="p">]</span>
<span class="go">[I0, I1, I1, II]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">kodaira_symbol</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">K</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[I10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.lll_reduce">
<span class="sig-name descname"><span class="pre">lll_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.lll_reduce" title="Permalink to this definition">#</a></dt>
<dd><p>Return an LLL-reduced basis from a given basis, with transform
matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">points</span></code> – a list of points on this elliptic
curve, which should be independent.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">height_matrix</span></code> – the height-pairing matrix of
the points, or <code class="docutils literal notranslate"><span class="pre">None</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it will be computed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code> – number of bits of precision of intermediate
computations (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>, for default RealField
precision; ignored if <code class="docutils literal notranslate"><span class="pre">height_matrix</span></code> is supplied)</p></li>
</ul>
<p>OUTPUT: A tuple (newpoints, U) where U is a unimodular integer
matrix, new_points is the transform of points by U, such that
new_points has LLL-reduced height pairing matrix</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the input points are not independent, the output
depends on the undocumented behaviour of PARI’s
<a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/qflllgram">pari:qflllgram</a> function when applied to a Gram matrix which
is not positive definite.</p>
</div>
<p>EXAMPLES:</p>
<p>Some examples over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">42</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Pi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">();</span> <span class="n">Pi</span>
<span class="go">[(-4 : 1 : 1), (-3 : 5 : 1), (-11/4 : 43/8 : 1), (-2 : 6 : 1)]</span>
<span class="gp">sage: </span><span class="n">Qi</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lll_reduce</span><span class="p">(</span><span class="n">Pi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">Pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">==</span> <span class="n">Qi</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Qi</span><span class="p">)</span>
<span class="go">[(-4 : 1 : 1), (-3 : 5 : 1), (-2 : 6 : 1), (0 : 6 : 1)]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">Pi</span><span class="p">)</span>
<span class="go">4.59088036960573</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">Qi</span><span class="p">)</span>
<span class="go">4.59088036960574</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">120039822036992245303534619191166796374</span><span class="p">,</span><span class="mi">504224992484910670010801799168082726759443756222911415116</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2005024558054813068</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="o">-</span><span class="mi">4690836759490453344</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">4700156326649806635</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">6785546256295273860</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">6823803569166584943</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">7788809602110240789</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">27385442304350994620556</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">54284682060285253719</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="o">-</span><span class="mi">94200235260395075139</span><span class="o">/</span><span class="mi">25</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="o">-</span><span class="mi">3463661055331841724647</span><span class="o">/</span><span class="mi">576</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="o">-</span><span class="mi">6684065934033506970637</span><span class="o">/</span><span class="mi">676</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="o">-</span><span class="mi">956077386192640344198</span><span class="o">/</span><span class="mi">2209</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="o">-</span><span class="mi">27067471797013364392578</span><span class="o">/</span><span class="mi">2809</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="o">-</span><span class="mi">25538866857137199063309</span><span class="o">/</span><span class="mi">3721</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="o">-</span><span class="mi">1026325011760259051894331</span><span class="o">/</span><span class="mi">108241</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">9351361230729481250627334</span><span class="o">/</span><span class="mi">1366561</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">10100878635879432897339615</span><span class="o">/</span><span class="mi">1423249</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">11499655868211022625340735</span><span class="o">/</span><span class="mi">17522596</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">110352253665081002517811734</span><span class="o">/</span><span class="mi">21353641</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">414280096426033094143668538257</span><span class="o">/</span><span class="mi">285204544</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">36101712290699828042930087436</span><span class="o">/</span><span class="mi">4098432361</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">45442463408503524215460183165</span><span class="o">/</span><span class="mi">5424617104</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">983886013344700707678587482584</span><span class="o">/</span><span class="mi">141566320009</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">1124614335716851053281176544216033</span><span class="o">/</span><span class="mi">152487126016</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">newpoints</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lll_reduce</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>  <span class="c1"># long time (35s on sage.math, 2011)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">newpoints</span><span class="p">]</span>            <span class="c1"># long time</span>
<span class="go">[6823803569166584943, 5949539878899294213, 2005024558054813068, 5864879778877955778, 23955263915878682727/4, 5922188321411938518, 5286988283823825378, 11465667352242779838, -11451575907286171572, 3502708072571012181, 1500143935183238709184/225, 27180522378120223419/4, -5811874164190604461581/625, 26807786527159569093, 7041412654828066743, 475656155255883588, 265757454726766017891/49, 7272142121019825303, 50628679173833693415/4, 6951643522366348968, 6842515151518070703, 111593750389650846885/16, 2607467890531740394315/9, -1829928525835506297]</span>
</pre></div>
</div>
<p>An example to show the explicit use of the height pairing matrix:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">42</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Pi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">(</span><span class="n">Pi</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">lll_reduce</span><span class="p">(</span><span class="n">Pi</span><span class="p">,</span><span class="n">height_matrix</span><span class="o">=</span><span class="n">H</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">                                                          [1 0 0 1]</span>
<span class="go">                                                          [0 1 0 1]</span>
<span class="go">                                                          [0 0 0 1]</span>
<span class="go">[(-4 : 1 : 1), (-3 : 5 : 1), (-2 : 6 : 1), (1 : -7 : 1)], [0 0 1 1]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Some examples over number fields (see <a class="reference external" href="https://github.com/sagemath/sage/issues/9411">github issue #9411</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">lll_reduce</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">(</span>
<span class="go">                                         [0 1]</span>
<span class="go">[(0 : -1 : 1), (-2 : -1/2*a - 1/2 : 1)], [1 0]</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="o">-</span><span class="mi">211</span><span class="o">/</span><span class="mi">841</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">6044</span><span class="o">/</span><span class="mi">841</span><span class="p">,</span><span class="o">-</span><span class="mi">209584</span><span class="o">/</span><span class="mi">24389</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">53634</span><span class="o">/</span><span class="mi">24389</span><span class="p">]),</span>
<span class="gp">....: </span>          <span class="n">E</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="o">-</span><span class="mi">17</span><span class="o">/</span><span class="mi">18</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">109</span><span class="o">/</span><span class="mi">108</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">277</span><span class="o">/</span><span class="mi">108</span><span class="p">])]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">lll_reduce</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[(-a + 4 : -3*a + 7 : 1), (-17/18*a - 1/9 : 109/108*a + 277/108 : 1)],</span>
<span class="go">[ 1  0]</span>
<span class="go">[ 1 -1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_data">
<span class="sig-name descname"><span class="pre">local_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pari'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globally</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_data" title="Permalink to this definition">#</a></dt>
<dd><p>Local data for this elliptic curve at the prime <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – either None, a prime ideal of the base field of self, or an element of the base field that generates a prime ideal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string, default: “pari”) – Ignored unless the
base field is <span class="math notranslate nohighlight">\(\QQ\)</span>.  If “pari”, use the PARI C-library
<a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/ellglobalred">pari:ellglobalred</a> implementation of Tate’s algorithm over
<span class="math notranslate nohighlight">\(\QQ\)</span>. If “generic”, use the general number field
implementation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">globally</span></code> – whether the local algorithm uses global generators
for the prime ideals. Default is False, which will not require any
information about the class group. If True, a generator for <span class="math notranslate nohighlight">\(P\)</span>
will be used if <span class="math notranslate nohighlight">\(P\)</span> is principal. Otherwise, or if <code class="docutils literal notranslate"><span class="pre">globally</span></code>
is False, the minimal model returned will preserve integrality
at other primes, but not minimality.</p></li>
</ul>
<p>OUTPUT:</p>
<p>If <span class="math notranslate nohighlight">\(P\)</span> is specified, returns the <code class="docutils literal notranslate"><span class="pre">EllipticCurveLocalData</span></code>
object associated to the prime <span class="math notranslate nohighlight">\(P\)</span> for this curve.  Otherwise,
returns a list of such objects, one for each prime <span class="math notranslate nohighlight">\(P\)</span> in the
support of the discriminant of this model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The model is not required to be integral on input.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">()</span>
<span class="go">[Local data at Fractional ideal (2*i + 1):</span>
<span class="go">   Reduction type: bad non-split multiplicative</span>
<span class="go">   Local minimal model: Elliptic Curve defined by y^2 + (i+1)*x*y + y = x^3</span>
<span class="go">                        over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">   Minimal discriminant valuation: 1</span>
<span class="go">   Conductor exponent: 1</span>
<span class="go">   Kodaira Symbol: I1</span>
<span class="go">   Tamagawa Number: 1,</span>
<span class="go"> Local data at Fractional ideal (-2*i + 3):</span>
<span class="go">   Reduction type: bad split multiplicative</span>
<span class="go">   Local minimal model: Elliptic Curve defined by y^2 + (i+1)*x*y + y = x^3</span>
<span class="go">                        over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">   Minimal discriminant valuation: 2</span>
<span class="go">   Conductor exponent: 1</span>
<span class="go">   Kodaira Symbol: I2</span>
<span class="go">   Tamagawa Number: 2]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Local data at Fractional ideal (3):</span>
<span class="go">  Reduction type: good</span>
<span class="go">  Local minimal model: Elliptic Curve defined by y^2 + (i+1)*x*y + y = x^3</span>
<span class="go">                       over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  Minimal discriminant valuation: 0</span>
<span class="go">  Conductor exponent: 0</span>
<span class="go">  Kodaira Symbol: I0</span>
<span class="go">  Tamagawa Number: 1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">Local data at Fractional ideal (2*i + 1):</span>
<span class="go">  Reduction type: bad non-split multiplicative</span>
<span class="go">  Local minimal model: Elliptic Curve defined by y^2 + (i+1)*x*y + y = x^3</span>
<span class="go">                       over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  Minimal discriminant valuation: 1</span>
<span class="go">  Conductor exponent: 1</span>
<span class="go">  Kodaira Symbol: I1</span>
<span class="go">  Tamagawa Number: 1</span>
</pre></div>
</div>
<p>An example raised in <a class="reference external" href="https://github.com/sagemath/sage/issues/3897">github issue #3897</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Local data at Principal ideal (3) of Integer Ring:</span>
<span class="go">  Reduction type: good</span>
<span class="go">  Local minimal model: Elliptic Curve defined by y^2 = x^3 + x + 1</span>
<span class="go">                       over Rational Field</span>
<span class="go">  Minimal discriminant valuation: 0</span>
<span class="go">  Conductor exponent: 0</span>
<span class="go">  Kodaira Symbol: I0</span>
<span class="go">  Tamagawa Number: 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_integral_model">
<span class="sig-name descname"><span class="pre">local_integral_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_integral_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return a model of self which is integral at the prime ideal <span class="math notranslate nohighlight">\(P\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The integrality at other primes is not affected, even if
<span class="math notranslate nohighlight">\(P\)</span> is non-principal.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*P</span></code> – a prime ideal, or a list or tuple of primes.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_integral_model</span><span class="p">((</span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span><span class="p">))</span>
<span class="go">Elliptic Curve defined by</span>
<span class="go"> y^2 + (-i)*x*y + (-25*i)*y = x^3 + 5*i*x^2 + 125*i*x + 3125*i</span>
<span class="go"> over Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_minimal_model">
<span class="sig-name descname"><span class="pre">local_minimal_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pari'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_minimal_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return a model which is integral at all primes and minimal at <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – either None or a prime ideal of the base field of self.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string, default: “pari”) – Ignored unless the
base field is <span class="math notranslate nohighlight">\(\QQ\)</span>.  If “pari”, use the PARI C-library
<a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/ellglobalred">pari:ellglobalred</a> implementation of Tate’s algorithm over
<span class="math notranslate nohighlight">\(\QQ\)</span>. If “generic”, use the general number field
implementation.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A model of the curve which is minimal (and integral) at <span class="math notranslate nohighlight">\(P\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The model is not required to be integral on input.</p>
<p>For principal <span class="math notranslate nohighlight">\(P\)</span>, a generator is used as a uniformizer,
and integrality or minimality at other primes is not
affected.  For non-principal <span class="math notranslate nohighlight">\(P\)</span>, the minimal model
returned will preserve integrality at other primes, but not
minimality.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1250</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6250</span><span class="p">,</span> <span class="mi">62500</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">15625</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_minimal_model</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span>
<span class="go">(0, 1, 0, 2*a - 34, -4*a + 66)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.minimal_discriminant_ideal">
<span class="sig-name descname"><span class="pre">minimal_discriminant_ideal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.minimal_discriminant_ideal" title="Permalink to this definition">#</a></dt>
<dd><p>Return the minimal discriminant ideal of this elliptic curve.</p>
<p>OUTPUT:</p>
<p>The integral ideal <span class="math notranslate nohighlight">\(D\)</span> whose valuation at every prime <span class="math notranslate nohighlight">\(P\)</span> is
that of the local minimal model for <span class="math notranslate nohighlight">\(E\)</span> at <span class="math notranslate nohighlight">\(P\)</span>.  If <span class="math notranslate nohighlight">\(E\)</span> has a
global minimal model, this will be the principal ideal
generated by the discriminant of any such model, but otherwise
it can be a proper divisor of the discriminant of any model.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">57</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">5692</span><span class="o">-</span><span class="mi">820</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">259213</span><span class="o">-</span><span class="mi">36720</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span>
<span class="go">Fractional ideal (90118662980*a + 636812084644)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(Fractional ideal (2))^2 * (Fractional ideal (3, a + 2))^12</span>
</pre></div>
</div>
<p>Here the minimal discriminant ideal is principal but there is
no global minimal model since the quotient is the 12th power
of a non-principal ideal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span>
<span class="go">Fractional ideal (4)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(Fractional ideal (2))^2</span>
</pre></div>
</div>
<p>If (and only if) the curve has everywhere good reduction the
result is the unit ideal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">26</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-104030*a - 530451</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
</pre></div>
</div>
<p>Over <span class="math notranslate nohighlight">\(\QQ\)</span>, the result returned is an ideal of <span class="math notranslate nohighlight">\(\ZZ\)</span> rather
than a fractional ideal of <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (10351) of Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.non_minimal_primes">
<span class="sig-name descname"><span class="pre">non_minimal_primes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.non_minimal_primes" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of primes at which this elliptic curve is not minimal.</p>
<p>OUTPUT:</p>
<p>A list of prime ideals (or prime numbers when the base field
is <span class="math notranslate nohighlight">\(\QQ\)</span>, empty if this is a global minimal model.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">22500</span><span class="p">,</span> <span class="mi">750000</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">[Fractional ideal (2, a), Fractional ideal (5, a)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(Fractional ideal (2, a))^24 * (Fractional ideal (3, a + 1))^5 * (Fractional ideal (3, a + 2))^5 * (Fractional ideal (5, a))^24 * (Fractional ideal (7))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(Fractional ideal (2, a))^12 * (Fractional ideal (3, a + 1))^5 * (Fractional ideal (3, a + 2))^5 * (Fractional ideal (7))</span>
</pre></div>
</div>
<p>Over <span class="math notranslate nohighlight">\(\QQ\)</span>, the primes returned are integers, not ideals:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3024</span><span class="p">,</span> <span class="mi">46224</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>If the model is not globally integral, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is
raised:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: non_minimal_primes only defined for integral models</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.period_lattice">
<span class="sig-name descname"><span class="pre">period_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.period_lattice" title="Permalink to this definition">#</a></dt>
<dd><p>Return the period lattice of the elliptic curve for the given
embedding of its base field with respect to the differential
<span class="math notranslate nohighlight">\(dx/(2y + a_1x + a_3)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">embedding</span></code> – an embedding of the base number field into <span class="math notranslate nohighlight">\(\RR\)</span> or <span class="math notranslate nohighlight">\(\CC\)</span>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The precision of the embedding is ignored: we only use the
given embedding to determine which embedding into <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>
to use.  Once the lattice has been initialized, periods can
be computed to arbitrary precision.</p>
</div>
<p>EXAMPLES:</p>
<p>First define a field with two real embeddings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">embs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">embs</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>For each embedding we have a different period lattice:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">embs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 = x^3 + a*x + 2</span>
<span class="go"> over Number Field in a with defining polynomial x^3 - 2</span>
<span class="go"> with respect to the embedding Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">  To:   Algebraic Field</span>
<span class="go">  Defn: a |--&gt; -0.6299605249474365? - 1.091123635971722?*I</span>

<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">embs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 = x^3 + a*x + 2</span>
<span class="go"> over Number Field in a with defining polynomial x^3 - 2</span>
<span class="go"> with respect to the embedding Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">  To:   Algebraic Field</span>
<span class="go">  Defn: a |--&gt; -0.6299605249474365? + 1.091123635971722?*I</span>

<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">embs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 = x^3 + a*x + 2</span>
<span class="go"> over Number Field in a with defining polynomial x^3 - 2</span>
<span class="go"> with respect to the embedding Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">  To:   Algebraic Field</span>
<span class="go">  Defn: a |--&gt; 1.259921049894873?</span>
</pre></div>
</div>
<p>Although the original embeddings have only the default
precision, we can obtain the basis with higher precision
later:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">embs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1.86405007647981 - 0.903761485143226*I, -0.149344633143919 - 2.06619546272945*I)</span>

<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">(1.8640500764798108425920506200 - 0.90376148514322594749786960975*I,</span>
<span class="go"> -0.14934463314391922099120107422 - 2.0661954627294548995621225062*I)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank">
<span class="sig-name descname"><span class="pre">rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank" title="Permalink to this definition">#</a></dt>
<dd><p>Return the rank of this elliptic curve, if it can be determined.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The optional parameters control the Simon two descent algorithm;
see the documentation of <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simon_two_descent()</span></code></a> for more
details.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – 0, 1, 2, or 3 (default: 0), the verbosity level</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lim1</span></code>    – (default: 2) limit on trivial points on quartics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lim3</span></code>  – (default: 4) limit on points on ELS quartics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limtriv</span></code> – (default: 2) limit on trivial points on elliptic curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxprob</span></code> – (default: 20)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limbigprime</span></code> – (default: 30) to distinguish between
small and large prime numbers. Use probabilistic tests for
large primes. If 0, do not use probabilistic tests.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">known_points</span></code> – (default: None) list of known points on
the curve</p></li>
</ul>
<p>OUTPUT:</p>
<p>If the upper and lower bounds given by Simon two-descent are
the same, then the rank has been uniquely identified and we
return this. Otherwise, we raise a ValueError with an error
message specifying the upper and lower bounds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For non-quadratic number fields, this code does return, but it takes
a long time.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s1">&#39;37&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Here is a curve with two-torsion in the Tate-Shafarevich group,
so here the bounds given by the algorithm do not uniquely
determine the rank:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;15a5&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">lim1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lim3</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">limtriv</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: There is insufficient data to determine the rank -</span>
<span class="go">2-descent gave lower bound 0 and upper bound 2</span>
</pre></div>
</div>
<p>IMPLEMENTATION:</p>
<p>Uses Denis Simon’s PARI/GP scripts from
<a class="reference external" href="http://www.math.unicaen.fr/~simon/">http://www.math.unicaen.fr/~simon/</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds">
<span class="sig-name descname"><span class="pre">rank_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds" title="Permalink to this definition">#</a></dt>
<dd><p>Return the lower and upper bounds using <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simon_two_descent()</span></code></a>.
The results of <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simon_two_descent()</span></code></a> are cached.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The optional parameters control the Simon two descent algorithm;
see the documentation of <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simon_two_descent()</span></code></a> for more
details.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – 0, 1, 2, or 3 (default: 0), the verbosity level</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lim1</span></code>    – (default: 2) limit on trivial points on quartics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lim3</span></code>  – (default: 4) limit on points on ELS quartics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limtriv</span></code> – (default: 2) limit on trivial points on elliptic curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxprob</span></code> – (default: 20)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limbigprime</span></code> – (default: 30) to distinguish between
small and large prime numbers. Use probabilistic tests for
large primes. If 0, do not use probabilistic tests.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">known_points</span></code> – (default: None) list of known points on
the curve</p></li>
</ul>
<p>OUTPUT:</p>
<p>lower and upper bounds for the rank of the Mordell-Weil group</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For non-quadratic number fields, this code does
return, but it takes a long time.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s1">&#39;37&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank_bounds</span><span class="p">()</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<p>Here is a curve with two-torsion, again the bounds coincide:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qrt5</span><span class="o">.&lt;</span><span class="n">rt5</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">-</span><span class="n">rt5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rt5</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank_bounds</span><span class="p">()</span>
<span class="go">(1, 1)</span>
</pre></div>
</div>
<p>Finally an example with non-trivial 2-torsion in Sha. So the
2-descent will not be able to determine the rank, but can only
give bounds:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;15a5&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">rank_bounds</span><span class="p">(</span><span class="n">lim1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lim3</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">limtriv</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(0, 2)</span>
</pre></div>
</div>
<p>IMPLEMENTATION:</p>
<p>Uses Denis Simon’s PARI/GP scripts from
<a class="reference external" href="http://www.math.unicaen.fr/~simon/">http://www.math.unicaen.fr/~simon/</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rational_points">
<span class="sig-name descname"><span class="pre">rational_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rational_points" title="Permalink to this definition">#</a></dt>
<dd><p>Find rational points on the elliptic curve, all arguments are passed
on to <code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.schemes.generic.algebraic_scheme.rational_points()</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rational_points</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">[(-1 : -1 : 1),</span>
<span class="go"> (-1 : 0 : 1),</span>
<span class="go"> (0 : -1 : 1),</span>
<span class="go"> (0 : 0 : 1),</span>
<span class="go"> (0 : 1 : 0),</span>
<span class="go"> (1/4 : -5/8 : 1),</span>
<span class="go"> (1/4 : -3/8 : 1),</span>
<span class="go"> (1 : -1 : 1),</span>
<span class="go"> (1 : 0 : 1),</span>
<span class="go"> (2 : -3 : 1),</span>
<span class="go"> (2 : 2 : 1)]</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://github.com/sagemath/sage/issues/26677">github issue #26677</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;11a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rational_points</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : 5 : 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rational_points</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">[(0 : 1 : 0), (5 : -6 : 1), (5 : 5 : 1)]</span>
</pre></div>
</div>
<p>An example over a number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">pts</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">rational_points</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">F</span><span class="o">=</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">pts</span>
<span class="go">[(-a : 0 : 1), (0 : 0 : 1), (0 : 1 : 0), (a : 0 : 1)]</span>
<span class="gp">sage: </span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">(a : 0 : 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.real_components">
<span class="sig-name descname"><span class="pre">real_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.real_components" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of real components with respect to a real embedding of the base field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">embs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">real_embeddings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">e</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span>
<span class="go">[True, False]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">real_components</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span>
<span class="go">[2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.reducible_primes">
<span class="sig-name descname"><span class="pre">reducible_primes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Billerey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.reducible_primes" title="Permalink to this definition">#</a></dt>
<dd><p>Return a finite set of primes <span class="math notranslate nohighlight">\(\ell\)</span> for which <span class="math notranslate nohighlight">\(E\)</span> has a
K-rational <span class="math notranslate nohighlight">\(\ell\)</span>-isogeny.</p>
<p>For curves without CM the list returned is exactly the finite
set of primes <span class="math notranslate nohighlight">\(\ell\)</span> for which the mod-<span class="math notranslate nohighlight">\(\ell\)</span> Galois
representation is reducible.  For curves with CM this set is
infinite; we return a finite list of primes <span class="math notranslate nohighlight">\(\ell\)</span> such that
every curve isogenous to this curve can be obtained by a
finite sequence of isogenies of degree one of the primes in
the list.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string) – only relevant for non-CM curves.
Either ‘Billerey”, to use the methods of <a class="reference internal" href="../../../../references/index.html#bil2011" id="id2"><span>[Bil2011]</span></a>,
‘Larson’ to use Larson’s implementation using Galois
representations, or ‘heuristic’ (see below).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_l</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code>) – only relevant for non-CM
curves and algorithms ‘Billerey’ and ‘heuristic.  Controls
the maximum prime used in either algorithm.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
use the default for that algorithm.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_l</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code>) – only relevant for non-CM
curves and algorithm ‘Billerey’.  Controls the maximum
number of primes used in the algorithm.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, use
the default for that algorithm.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ‘heuristic’ algorithm only checks primes up to the
bound <code class="docutils literal notranslate"><span class="pre">max_l</span></code>.  This is faster but not guaranteed to be
complete.  Both the Billerey and Larson algorithms are
rigorous.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">1728</span><span class="p">))</span> <span class="c1"># CM over K</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span> <span class="c1"># CM curves always return [0]</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="c1"># CM but NOT over K</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2268945</span><span class="o">/</span><span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span> <span class="c1"># c.f. [Sut2012]</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span> <span class="c1"># ..but there is no 7-isogeny, long time</span>
<span class="go">[7]</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.reduction">
<span class="sig-name descname"><span class="pre">reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">place</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.reduction" title="Permalink to this definition">#</a></dt>
<dd><p>Return the reduction of the elliptic curve at a place of good reduction.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">place</span></code> – a prime ideal in the base field of the curve</p></li>
</ul>
<p>OUTPUT:</p>
<p>An elliptic curve over a finite field, the residue field of the place.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2  = x^3 + 5*x + 8</span>
<span class="go"> over Residue field of Fractional ideal (2*i + 3)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: The curve must have good reduction at the place.</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: The ideal must be prime.</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1024</span><span class="o">*</span><span class="n">K</span><span class="mf">.0</span><span class="p">,</span> <span class="mi">1024</span><span class="o">*</span><span class="n">K</span><span class="mf">.0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + (abar+1)*y = x^3</span>
<span class="go"> over Residue field in abar of Fractional ideal (2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.regulator_of_points">
<span class="sig-name descname"><span class="pre">regulator_of_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalised</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.regulator_of_points" title="Permalink to this definition">#</a></dt>
<dd><p>Return the regulator of the given points on this curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">points</span></code> – (default: empty list)  a list of points on this curve</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code> – int or None (default: None): the precision
in bits of the result (default real precision if None)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalised</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">True</span></code>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, use
normalised heights which are independent of base change.
Otherwise use the non-normalised Néron-Tate height, as
required for the regulator in the BSD conjecture</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">0.000000000000000</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">P</span> <span class="o">==</span> <span class="n">Q</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">0.417143558758384</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.41714355875838396981711954462</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">0.152460177943144</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.15246017794314375162432475705</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="go">0.15246017794314375162432475704945582324372707748663081784028</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="go">0.152460177943143751624324757049455823243727077486630817840280980046053225683562463604114816</span>
</pre></div>
</div>
<p>Examples over number fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.476223106404866</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">])</span>
<span class="go">0.476223106404866</span>
</pre></div>
</div>
<p>When the parameter <code class="docutils literal notranslate"><span class="pre">normalised</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, each
height is multiplied by the degree <span class="math notranslate nohighlight">\(d\)</span> of the base field, and
the regulator of <span class="math notranslate nohighlight">\(r\)</span> points is multiplied by <span class="math notranslate nohighlight">\(d^r\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">normalised</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0.952446212809731</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">],</span> <span class="n">normalised</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0.952446212809731</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">47</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">T</span><span class="p">])</span> <span class="c1"># random very small output</span>
<span class="go">-1.23259516440783e-32</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">T</span><span class="p">])</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1e-30</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">0.152460177943144</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">47</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">EK</span><span class="p">(</span><span class="n">P</span><span class="p">),</span><span class="n">EK</span><span class="p">(</span><span class="n">Q</span><span class="p">)])</span>
<span class="go">0.152460177943144</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="mi">25</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">[  2.16941934493768 -0.870059380421505]</span>
<span class="go">[-0.870059380421505  0.424585837470709]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">0.164101403936070</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.saturation">
<span class="sig-name descname"><span class="pre">saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_prime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_prime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odd_primes_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_ht_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.saturation" title="Permalink to this definition">#</a></dt>
<dd><p>Given a list of rational points on <span class="math notranslate nohighlight">\(E\)</span> over <span class="math notranslate nohighlight">\(K\)</span>, compute the
saturation in <span class="math notranslate nohighlight">\(E(K)\)</span> of the subgroup they generate.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">points</span> <span class="pre">(list)</span></code> – list of points on E.  Points of finite
order are ignored; the remaining points should be independent,
or an error is raised.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> (bool) – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>), if <code class="docutils literal notranslate"><span class="pre">True</span></code>, give
verbose output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_prime</span></code> (int, default 0) – saturation is performed
for all primes up to <code class="docutils literal notranslate"><span class="pre">max_prime</span></code>. If <code class="docutils literal notranslate"><span class="pre">max_prime</span></code> is 0,
perform saturation at <em>all</em> primes, i.e., compute the true
saturation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">odd_primes_only</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) – only do
saturation at odd primes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">one_prime</span></code> (int, default 0) – if nonzero, only do
saturation at this prime.</p></li>
</ul>
<p>The following two inputs are optional, and may be provided to speed
up the computation.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lower_ht_bound</span></code> (real, default <code class="docutils literal notranslate"><span class="pre">None</span></code>) – lower bound of
the regulator <span class="math notranslate nohighlight">\(E(K)\)</span>, if known.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reg</span></code> (real, default <code class="docutils literal notranslate"><span class="pre">None</span></code>) – regulator of the span of
points, if known.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">debug</span></code> (int, default 0) – used for debugging and
testing.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">saturation</span></code> (list) – points that form a basis for the
saturation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> (int) – the index of the group generated by the
input points in their saturation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regulator</span></code> (real with default precision, or <code class="docutils literal notranslate"><span class="pre">None</span></code>) –
regulator of saturated points.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">],</span> <span class="n">max_prime</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">([(-1 : 1 : 1)], 2, 0.686667083305587)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="mi">12</span><span class="o">*</span><span class="n">P</span><span class="p">],</span> <span class="n">max_prime</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">([(26/361 : -5720/6859 : 1)], 4, 6.18000374975028)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="mi">12</span><span class="o">*</span><span class="n">P</span><span class="p">],</span> <span class="n">lower_ht_bound</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">([(-1 : 1 : 1)], 12, 0.686667083305587)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">],</span> <span class="n">max_prime</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">([(-1 : 1 : 1), (0 : -1 : 1)], 2, 0.152460177943144)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="n">P</span> <span class="o">+</span> <span class="n">Q</span><span class="p">,</span> <span class="n">P</span> <span class="o">-</span> <span class="n">Q</span><span class="p">],</span> <span class="n">lower_ht_bound</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">([(-1 : 1 : 1), (1 : 0 : 1)], 2, 0.152460177943144)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="n">P</span> <span class="o">+</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">17</span><span class="o">*</span><span class="n">Q</span><span class="p">],</span> <span class="n">lower_ht_bound</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">([(4 : 8 : 1), (0 : -1 : 1)], 17, 0.152460177943143)</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="n">P</span> <span class="o">+</span> <span class="n">R</span><span class="p">,</span> <span class="n">P</span> <span class="o">+</span> <span class="n">Q</span><span class="p">,</span> <span class="n">Q</span> <span class="o">+</span> <span class="n">R</span><span class="p">],</span> <span class="n">lower_ht_bound</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">([(841/1369*i - 171/1369 : 41334/50653*i - 74525/50653 : 1),</span>
<span class="go">  (4 : 8 : 1),</span>
<span class="go">  (-1/25*i + 18/25 : -69/125*i - 58/125 : 1)],</span>
<span class="go"> 2,</span>
<span class="go"> 0.103174443217351)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="mi">26</span><span class="o">*</span><span class="n">Q</span><span class="p">],</span> <span class="n">lower_ht_bound</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">([(0 : -1 : 1)], 26, 0.327000773651605)</span>
</pre></div>
</div>
<p>Another number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="n">P</span> <span class="o">+</span> <span class="n">Q</span><span class="p">,</span> <span class="n">P</span> <span class="o">-</span> <span class="n">Q</span><span class="p">],</span> <span class="n">lower_ht_bound</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">([(-1 : 1 : 1), (1 : 0 : 1)], 2, 0.152460177943144)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="p">,</span> <span class="n">P</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">Q</span><span class="p">],</span> <span class="n">lower_ht_bound</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">([(-185/2209 : -119510/103823 : 1), (80041/34225 : -26714961/6331625 : 1)],</span>
<span class="go"> 15,</span>
<span class="go"> 0.152460177943144)</span>
</pre></div>
</div>
<p>A different curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span> <span class="o">-</span> <span class="n">Q</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span> <span class="n">Q</span><span class="p">],</span> <span class="n">lower_ht_bound</span><span class="o">=</span><span class="mf">.01</span><span class="p">)</span>
<span class="go">([(0 : 0 : 1), (1/2*a : -1/4*a - 1/4 : 1)], 6, 0.0317814530725985)</span>
</pre></div>
</div>
<p>The points must be linearly independent:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">P</span><span class="o">-</span><span class="n">Q</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: points not linearly independent in saturation()</span>
</pre></div>
</div>
<p>Degenerate case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">saturation</span><span class="p">([])</span>
<span class="go">([], 1, 1.00000000000000)</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>For rank 1 subgroups, simply do trial division up to the maximal
prime divisor. For higher rank subgroups, perform trial division
on all linear combinations for small primes, and look for
projections <span class="math notranslate nohighlight">\(E(K) \rightarrow \oplus E(k) \otimes \mathbf{F}_p\)</span> which
are either full rank or provide <span class="math notranslate nohighlight">\(p\)</span>-divisible linear combinations,
where the <span class="math notranslate nohighlight">\(k\)</span> here are residue fields of <span class="math notranslate nohighlight">\(K\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent">
<span class="sig-name descname"><span class="pre">simon_two_descent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limtriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxprob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limbigprime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="Permalink to this definition">#</a></dt>
<dd><p>Return lower and upper bounds on the rank of the Mordell-Weil
group <span class="math notranslate nohighlight">\(E(K)\)</span> and a list of points.</p>
<p>This method is used internally by the <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rank()</span></code></a>,
<a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rank_bounds()</span></code></a> and <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gens()</span></code></a> methods.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – an elliptic curve <span class="math notranslate nohighlight">\(E\)</span> over a number field <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – 0, 1, 2, or 3 (default: 0), the verbosity level</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lim1</span></code> – (default: 2) limit on trivial points on quartics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lim3</span></code> – (default: 4) limit on points on ELS quartics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limtriv</span></code> – (default: 2) limit on trivial points on <span class="math notranslate nohighlight">\(E\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxprob</span></code> – (default: 20)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limbigprime</span></code> – (default: 30) to distinguish between
small and large prime numbers. Use probabilistic tests for
large primes. If 0, do not use probabilistic tests.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">known_points</span></code> – (default: None) list of known points on
the curve</p></li>
</ul>
<p>OUTPUT: a triple <code class="docutils literal notranslate"><span class="pre">(lower,</span> <span class="pre">upper,</span> <span class="pre">list)</span></code> consisting of</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lower</span></code> (integer) – lower bound on the rank</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">upper</span></code> (integer) – upper bound on the rank</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code> – list of points in <span class="math notranslate nohighlight">\(E(K)\)</span></p></li>
</ul>
<p>The integer <code class="docutils literal notranslate"><span class="pre">upper</span></code> is in fact an upper bound on the
dimension of the 2-Selmer group, hence on the dimension of
<span class="math notranslate nohighlight">\(E(K)/2E(K)\)</span>.  It is equal to the dimension of the 2-Selmer
group except possibly if <span class="math notranslate nohighlight">\(E(K)[2]\)</span> has dimension 1.  In that
case, <code class="docutils literal notranslate"><span class="pre">upper</span></code> may exceed the dimension of the 2-Selmer group
by an even number, due to the fact that the algorithm does not
perform a second descent.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For non-quadratic number fields, this code does return, but
it takes a long time.</p>
</div>
<p>ALGORITHM:</p>
<p>Uses Denis Simon’s PARI/GP scripts from
<a class="reference external" href="https://simond.users.lmno.cnrs.fr/">https://simond.users.lmno.cnrs.fr/</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s1">&#39;37&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">()</span>
<span class="go">(2, 2, [(0 : 0 : 1), (1/18*a + 7/18 : -5/54*a - 17/54 : 1)])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">(</span><span class="n">lim1</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lim3</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">limtriv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">maxprob</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">limbigprime</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(2, 2, [(-1 : 0 : 1), (-2 : -1/2*a - 1/2 : 1)])</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x + a</span>
<span class="go"> over Number Field in a with defining polynomial x^2 + 7</span>

<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> <span class="n">v</span>
<span class="go"> elliptic curve: Y^2 = x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7)</span>
<span class="go"> Trivial points on the curve = [[1, 1, 0], [Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7), 1]]</span>
<span class="go">#S(E/K)[2]    = 2</span>
<span class="go">#E(K)/2E(K)   = 2</span>
<span class="go">#III(E/K)[2]  = 1</span>
<span class="go">rank(E/K)     = 1</span>
<span class="go"> listpoints = [[Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7), 1]]</span>
<span class="go">(1, 1, [(1/2*a + 3/2 : -a - 2 : 1)])</span>

<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">K = bnfinit(y^2 + 7);</span>
<span class="go">a = Mod(y,K.pol);</span>
<span class="go">bnfellrank(K, [0, 0, 0, 1, a], [[Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7)]]);</span>
<span class="go">...</span>
<span class="go">v = [1, 1, [[Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7)]]]</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">(1, 1, [(1/2*a + 3/2 : -a - 2 : 1)])</span>
</pre></div>
</div>
<p>A curve with 2-torsion:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s1">&#39;15a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">()</span>  <span class="c1"># long time (3s on sage.math, 2013), points can vary</span>
<span class="go">(1, 3, [...])</span>
</pre></div>
</div>
<p>Check that the bug reported in <a class="reference external" href="https://github.com/sagemath/sage/issues/15483">github issue #15483</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">229</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c4</span> <span class="o">=</span> <span class="mi">2173</span> <span class="o">-</span> <span class="mi">235</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">c6</span> <span class="o">=</span> <span class="o">-</span><span class="mi">124369</span> <span class="o">+</span> <span class="mi">15988</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="n">c4</span><span class="o">/</span><span class="mi">48</span><span class="p">,</span> <span class="o">-</span><span class="n">c6</span><span class="o">/</span><span class="mi">864</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">()</span>
<span class="go">(0, 0, [])</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">13</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="p">(</span><span class="n">g</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">g</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">g</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>  <span class="c1"># long time (about 5 s)</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">subfields</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s1">&#39;37&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">()</span>  <span class="c1"># long time (4s on sage.math, 2013)</span>
<span class="go">(3,</span>
<span class="go"> 3,</span>
<span class="go"> [(1/8*zeta43_0^2 - 3/8*zeta43_0 - 1/4 : -5/16*zeta43_0^2 + 7/16*zeta43_0 + 1/8 : 1),</span>
<span class="go">  (0 : 0 : 1)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_exponent">
<span class="sig-name descname"><span class="pre">tamagawa_exponent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_exponent" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Tamagawa index of this elliptic curve at the prime <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – either None or a prime ideal of the base field of self.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(positive integer) The Tamagawa index of the curve at P.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">625</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6875</span><span class="p">,</span> <span class="mi">31250</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">46875</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_exponent</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_exponent</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">K</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_number">
<span class="sig-name descname"><span class="pre">tamagawa_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_number" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Tamagawa number of this elliptic curve at the prime <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – either None or a prime ideal of the base field of self.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(positive integer) The Tamagawa number of the curve at <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">625</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6875</span><span class="p">,</span> <span class="mi">31250</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">46875</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_number</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_number</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">K</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_numbers">
<span class="sig-name descname"><span class="pre">tamagawa_numbers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_numbers" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of all Tamagawa numbers for all prime divisors of the
conductor (in order).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;30a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">tamagawa_numbers</span><span class="p">()</span>
<span class="go">[2, 3, 1]</span>
<span class="gp">sage: </span><span class="n">vector</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">tamagawa_numbers</span><span class="p">())</span>
<span class="go">(2, 3, 1)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eK</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eK</span><span class="o">.</span><span class="n">tamagawa_numbers</span><span class="p">()</span>
<span class="go">[4, 6, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_product">
<span class="sig-name descname"><span class="pre">tamagawa_product</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_product" title="Permalink to this definition">#</a></dt>
<dd><p>Return the product of the Tamagawa numbers <span class="math notranslate nohighlight">\(c_v\)</span> where <span class="math notranslate nohighlight">\(v\)</span> runs
over all prime ideals of <span class="math notranslate nohighlight">\(K\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See also tamagawa_product_bsd(), which includes an
additional factor when the model is not globally minimal,
as required by the BSD formula.</p>
</div>
<p>OUTPUT:</p>
<p>A positive integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>An example over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;30a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
<p>An example with everywhere good reduction, where the product
is empty:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">38</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">21</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_numbers</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_product_bsd">
<span class="sig-name descname"><span class="pre">tamagawa_product_bsd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_product_bsd" title="Permalink to this definition">#</a></dt>
<dd><p>Given an elliptic curve <span class="math notranslate nohighlight">\(E\)</span> over a number field <span class="math notranslate nohighlight">\(K\)</span>, this function
returns the integer <span class="math notranslate nohighlight">\(C(E/K)\)</span> that appears in the Birch and
Swinnerton-Dyer conjecture accounting for the local
information at finite places. If the model is a global minimal
model then <span class="math notranslate nohighlight">\(C(E/K)\)</span> is simply the product of the Tamagawa
numbers <span class="math notranslate nohighlight">\(c_v\)</span> where <span class="math notranslate nohighlight">\(v\)</span> runs over all prime ideals of
<span class="math notranslate nohighlight">\(K\)</span>. Otherwise, if the model has to be changed at a place <span class="math notranslate nohighlight">\(v\)</span>
a correction factor appears.  The definition is such that
<span class="math notranslate nohighlight">\(C(E/K)\)</span> times the periods at the infinite places is invariant
under change of the Weierstrass model. See <a class="reference internal" href="../../../../references/index.html#tate1966" id="id3"><span>[Tate1966]</span></a> and
<a class="reference internal" href="../../../../references/index.html#dd2010" id="id4"><span>[DD2010]</span></a> for details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This definition differs from the definition of
<code class="docutils literal notranslate"><span class="pre">tamagawa_product</span></code> for curves defined over <span class="math notranslate nohighlight">\(\QQ\)</span>. Over
the rational number it is always defined to be the product
of the Tamagawa numbers, so the two definitions only agree
when the model is global minimal.</p>
</div>
<p>OUTPUT:</p>
<p>A rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product_bsd</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product_bsd</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>An example where the Neron model changes over K:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s1">&#39;75a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product_bsd</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">da</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">dav</span><span class="o">.</span><span class="n">tamagawa_number</span><span class="p">()</span> <span class="k">for</span> <span class="n">dav</span> <span class="ow">in</span> <span class="n">da</span><span class="p">]</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
<p>An example over <span class="math notranslate nohighlight">\(\QQ\)</span> (<a class="reference external" href="https://github.com/sagemath/sage/issues/9413">github issue #9413</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;30a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product_bsd</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_order">
<span class="sig-name descname"><span class="pre">torsion_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order of the torsion subgroup of this elliptic curve.</p>
<p>OUTPUT:</p>
<p>(integer) the order of the torsion subgroup of this elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">41</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>  <span class="c1"># long time (2s on sage.math, 2014)</span>
<span class="go">25</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>
<span class="go">16</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;19a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">21</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_points">
<span class="sig-name descname"><span class="pre">torsion_points</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_points" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of the torsion points of this elliptic curve.</p>
<p>OUTPUT:</p>
<p>(list) A sorted list of the torsion points.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>
<span class="go">[(0 : 1 : 0), (5 : -6 : 1), (5 : 5 : 1), (16 : -61 : 1), (16 : 60 : 1)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">41</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>  <span class="c1"># long time (1s on sage.math, 2014)</span>
<span class="go">[(0 : 1 : 0),</span>
<span class="go"> (t : 1/11*t^3 + 6/11*t^2 + 19/11*t + 48/11 : 1),</span>
<span class="go"> (1/11*t^3 - 5/11*t^2 + 19/11*t - 40/11 : -6/11*t^3 - 3/11*t^2 - 26/11*t - 321/11 : 1),</span>
<span class="go"> (1/11*t^3 - 5/11*t^2 + 19/11*t - 40/11 : 6/11*t^3 + 3/11*t^2 + 26/11*t + 310/11 : 1),</span>
<span class="go"> (t : -1/11*t^3 - 6/11*t^2 - 19/11*t - 59/11 : 1),</span>
<span class="go"> (16 : 60 : 1),</span>
<span class="go"> (-3/55*t^3 - 7/55*t^2 - 2/55*t - 133/55 : 6/55*t^3 + 3/55*t^2 + 25/11*t + 156/55 : 1),</span>
<span class="go"> (14/121*t^3 - 15/121*t^2 + 90/121*t + 232/121 : 16/121*t^3 - 69/121*t^2 + 293/121*t - 46/121 : 1),</span>
<span class="go"> (-26/121*t^3 + 20/121*t^2 - 219/121*t - 995/121 : -15/121*t^3 - 156/121*t^2 + 232/121*t - 2887/121 : 1),</span>
<span class="go"> (10/121*t^3 + 49/121*t^2 + 168/121*t + 73/121 : -32/121*t^3 - 60/121*t^2 + 261/121*t + 686/121 : 1),</span>
<span class="go"> (5 : 5 : 1),</span>
<span class="go"> (-9/121*t^3 - 21/121*t^2 - 127/121*t - 377/121 : -7/121*t^3 + 24/121*t^2 + 197/121*t + 16/121 : 1),</span>
<span class="go"> (3/55*t^3 + 7/55*t^2 + 2/55*t + 78/55 : 7/55*t^3 - 24/55*t^2 + 9/11*t + 17/55 : 1),</span>
<span class="go"> (-5/121*t^3 + 36/121*t^2 - 84/121*t + 24/121 : -34/121*t^3 + 27/121*t^2 - 305/121*t - 829/121 : 1),</span>
<span class="go"> (5/121*t^3 - 14/121*t^2 - 158/121*t - 453/121 : 49/121*t^3 + 129/121*t^2 + 315/121*t + 86/121 : 1),</span>
<span class="go"> (5 : -6 : 1),</span>
<span class="go"> (5/121*t^3 - 14/121*t^2 - 158/121*t - 453/121 : -49/121*t^3 - 129/121*t^2 - 315/121*t - 207/121 : 1),</span>
<span class="go"> (-5/121*t^3 + 36/121*t^2 - 84/121*t + 24/121 : 34/121*t^3 - 27/121*t^2 + 305/121*t + 708/121 : 1),</span>
<span class="go"> (3/55*t^3 + 7/55*t^2 + 2/55*t + 78/55 : -7/55*t^3 + 24/55*t^2 - 9/11*t - 72/55 : 1),</span>
<span class="go"> (-9/121*t^3 - 21/121*t^2 - 127/121*t - 377/121 : 7/121*t^3 - 24/121*t^2 - 197/121*t - 137/121 : 1),</span>
<span class="go"> (16 : -61 : 1),</span>
<span class="go"> (10/121*t^3 + 49/121*t^2 + 168/121*t + 73/121 : 32/121*t^3 + 60/121*t^2 - 261/121*t - 807/121 : 1),</span>
<span class="go"> (-26/121*t^3 + 20/121*t^2 - 219/121*t - 995/121 : 15/121*t^3 + 156/121*t^2 - 232/121*t + 2766/121 : 1),</span>
<span class="go"> (14/121*t^3 - 15/121*t^2 + 90/121*t + 232/121 : -16/121*t^3 + 69/121*t^2 - 293/121*t - 75/121 : 1),</span>
<span class="go"> (-3/55*t^3 - 7/55*t^2 - 2/55*t - 133/55 : -6/55*t^3 - 3/55*t^2 - 25/11*t - 211/55 : 1)]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>
<span class="go">[(-7 : -5*t - 2 : 1),</span>
<span class="go"> (-7 : 5*t + 8 : 1),</span>
<span class="go"> (-13/4 : 9/8 : 1),</span>
<span class="go"> (-2 : -2 : 1),</span>
<span class="go"> (-2 : 3 : 1),</span>
<span class="go"> (-t - 2 : -t - 7 : 1),</span>
<span class="go"> (-t - 2 : 2*t + 8 : 1),</span>
<span class="go"> (-1 : 0 : 1),</span>
<span class="go"> (t : t - 5 : 1),</span>
<span class="go"> (t : -2*t + 4 : 1),</span>
<span class="go"> (0 : 1 : 0),</span>
<span class="go"> (1/2 : -5/4*t - 2 : 1),</span>
<span class="go"> (1/2 : 5/4*t + 1/2 : 1),</span>
<span class="go"> (3 : -2 : 1),</span>
<span class="go"> (8 : -27 : 1),</span>
<span class="go"> (8 : 18 : 1)]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>
<span class="go"> [(-2 : -3*i : 1), (-2 : 3*i : 1), (0 : -i : 1), (0 : i : 1), (0 : 1 : 0), (1 : 0 : 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_subgroup">
<span class="sig-name descname"><span class="pre">torsion_subgroup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_subgroup" title="Permalink to this definition">#</a></dt>
<dd><p>Return the torsion subgroup of this elliptic curve.</p>
<p>OUTPUT: The <code class="xref py py-class docutils literal notranslate"><span class="pre">EllipticCurveTorsionSubgroup</span></code> associated to this elliptic
curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">41</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tor</span> <span class="o">=</span> <span class="n">EK</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">()</span>  <span class="c1"># long time (2s on sage.math, 2014)</span>
<span class="gp">sage: </span><span class="n">tor</span>  <span class="c1"># long time</span>
<span class="go">Torsion Subgroup isomorphic to Z/5 + Z/5 associated to the Elliptic Curve</span>
<span class="go"> defined by y^2 + y = x^3 + (-1)*x^2 + (-10)*x + (-20) over Number Field</span>
<span class="go"> in t with defining polynomial x^4 + x^3 + 11*x^2 + 41*x + 101</span>
<span class="gp">sage: </span><span class="n">tor</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">((16 : 60 : 1), (t : 1/11*t^3 + 6/11*t^2 + 19/11*t + 48/11 : 1))</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">()</span>
<span class="go">Torsion Subgroup isomorphic to Z/4 + Z/4 associated to the</span>
<span class="go"> Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 + (-10)*x + (-10)</span>
<span class="go"> over Number Field in t with defining polynomial x^2 + 2*x + 10</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;19a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span><span class="o">+</span><span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">()</span>
<span class="go">Torsion Subgroup isomorphic to Z/9 associated to the Elliptic Curve defined</span>
<span class="go"> by y^2 + y = x^3 + x^2 + (-9)*x + (-15) over Number Field in t with defining</span>
<span class="go"> polynomial x^9 - 3*x^8 - 4*x^7 + 16*x^6 - 3*x^5 - 21*x^4 + 5*x^3 + 7*x^2 - 7*x + 1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_subgroup</span> <span class="p">()</span>
<span class="go">Torsion Subgroup isomorphic to Trivial group associated to the</span>
<span class="go"> Elliptic Curve defined by y^2 = x^3 + i*x + (i+3)</span>
<span class="go"> over Number Field in i with defining polynomial x^2 + 1 with i = 1*I</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Use <a class="reference internal" href="ell_field.html#sage.schemes.elliptic_curves.ell_field.EllipticCurve_field.division_field" title="sage.schemes.elliptic_curves.ell_field.EllipticCurve_field.division_field"><code class="xref py py-meth docutils literal notranslate"><span class="pre">division_field()</span></code></a>
to determine the field of definition of the <span class="math notranslate nohighlight">\(\ell\)</span>-torsion subgroup.</p>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="height.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Canonical heights for elliptic curves over number fields</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="ec_database.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tables of elliptic curves of given rank</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Elliptic curves over number fields</a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field"><code class="docutils literal notranslate"><span class="pre">EllipticCurve_number_field</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.base_extend"><code class="docutils literal notranslate"><span class="pre">base_extend()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant"><code class="docutils literal notranslate"><span class="pre">cm_discriminant()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.conductor"><code class="docutils literal notranslate"><span class="pre">conductor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.galois_representation"><code class="docutils literal notranslate"><span class="pre">galois_representation()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens"><code class="docutils literal notranslate"><span class="pre">gens()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens_quadratic"><code class="docutils literal notranslate"><span class="pre">gens_quadratic()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_integral_model"><code class="docutils literal notranslate"><span class="pre">global_integral_model()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_minimal_model"><code class="docutils literal notranslate"><span class="pre">global_minimal_model()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_minimality_class"><code class="docutils literal notranslate"><span class="pre">global_minimality_class()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_additive_reduction"><code class="docutils literal notranslate"><span class="pre">has_additive_reduction()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_bad_reduction"><code class="docutils literal notranslate"><span class="pre">has_bad_reduction()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm"><code class="docutils literal notranslate"><span class="pre">has_cm()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_global_minimal_model"><code class="docutils literal notranslate"><span class="pre">has_global_minimal_model()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_good_reduction"><code class="docutils literal notranslate"><span class="pre">has_good_reduction()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_multiplicative_reduction"><code class="docutils literal notranslate"><span class="pre">has_multiplicative_reduction()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_nonsplit_multiplicative_reduction"><code class="docutils literal notranslate"><span class="pre">has_nonsplit_multiplicative_reduction()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm"><code class="docutils literal notranslate"><span class="pre">has_rational_cm()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_split_multiplicative_reduction"><code class="docutils literal notranslate"><span class="pre">has_split_multiplicative_reduction()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_function"><code class="docutils literal notranslate"><span class="pre">height_function()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_pairing_matrix"><code class="docutils literal notranslate"><span class="pre">height_pairing_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.integral_model"><code class="docutils literal notranslate"><span class="pre">integral_model()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_Q_curve"><code class="docutils literal notranslate"><span class="pre">is_Q_curve()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_global_integral_model"><code class="docutils literal notranslate"><span class="pre">is_global_integral_model()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_global_minimal_model"><code class="docutils literal notranslate"><span class="pre">is_global_minimal_model()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_isogenous"><code class="docutils literal notranslate"><span class="pre">is_isogenous()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_local_integral_model"><code class="docutils literal notranslate"><span class="pre">is_local_integral_model()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogenies_prime_degree"><code class="docutils literal notranslate"><span class="pre">isogenies_prime_degree()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogeny_class"><code class="docutils literal notranslate"><span class="pre">isogeny_class()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogeny_degree"><code class="docutils literal notranslate"><span class="pre">isogeny_degree()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.kodaira_symbol"><code class="docutils literal notranslate"><span class="pre">kodaira_symbol()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.lll_reduce"><code class="docutils literal notranslate"><span class="pre">lll_reduce()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_data"><code class="docutils literal notranslate"><span class="pre">local_data()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_integral_model"><code class="docutils literal notranslate"><span class="pre">local_integral_model()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_minimal_model"><code class="docutils literal notranslate"><span class="pre">local_minimal_model()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.minimal_discriminant_ideal"><code class="docutils literal notranslate"><span class="pre">minimal_discriminant_ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.non_minimal_primes"><code class="docutils literal notranslate"><span class="pre">non_minimal_primes()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.period_lattice"><code class="docutils literal notranslate"><span class="pre">period_lattice()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank"><code class="docutils literal notranslate"><span class="pre">rank()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds"><code class="docutils literal notranslate"><span class="pre">rank_bounds()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rational_points"><code class="docutils literal notranslate"><span class="pre">rational_points()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.real_components"><code class="docutils literal notranslate"><span class="pre">real_components()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.reducible_primes"><code class="docutils literal notranslate"><span class="pre">reducible_primes()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.reduction"><code class="docutils literal notranslate"><span class="pre">reduction()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.regulator_of_points"><code class="docutils literal notranslate"><span class="pre">regulator_of_points()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.saturation"><code class="docutils literal notranslate"><span class="pre">saturation()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><code class="docutils literal notranslate"><span class="pre">simon_two_descent()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_exponent"><code class="docutils literal notranslate"><span class="pre">tamagawa_exponent()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_number"><code class="docutils literal notranslate"><span class="pre">tamagawa_number()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_numbers"><code class="docutils literal notranslate"><span class="pre">tamagawa_numbers()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_product"><code class="docutils literal notranslate"><span class="pre">tamagawa_product()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_product_bsd"><code class="docutils literal notranslate"><span class="pre">tamagawa_product_bsd()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_order"><code class="docutils literal notranslate"><span class="pre">torsion_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_points"><code class="docutils literal notranslate"><span class="pre">torsion_points()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_subgroup"><code class="docutils literal notranslate"><span class="pre">torsion_subgroup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>