<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="\(L\)-series for elliptic curves" href="lseries_ell.html" /><link rel="prev" title="Modular symbols attached to elliptic curves over \(\QQ\)" href="ell_modular_symbols.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Modular symbols by numerical integration - Elliptic curves</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZGD13B5572"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ZGD13B5572');
</script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Elliptic curves</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 9.8 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Elliptic curves</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="constructor.html">Elliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian.html">Construct elliptic curves as Jacobians</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_point.html">Points on elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_generic.html">Elliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_field.html">Elliptic curves over a general field</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_finite_field.html">Elliptic curves over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="formal_group.html">Formal groups of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hom.html">Elliptic-curve morphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_morphism.html">Isomorphisms between Weierstrass models of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_curve_isogeny.html">Isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_velusqrt.html">√élu algorithm for elliptic-curve isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_composite.html">Composite morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_scalar.html">Scalar-multiplication morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_frobenius.html">Frobenius isogenies of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_small_degree.html">Isogenies of small prime degree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_rational_field.html">Elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ec_database.html">Tables of elliptic curves of given rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_number_field.html">Elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="height.html">Canonical heights for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="saturation.html">Saturation of Mordell-Weil groups of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_torsion.html">Torsion subgroups of elliptic curves over number fields (including <span class="math notranslate nohighlight">\(\QQ\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps.html">Galois representations attached to elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps_number_field.html">Galois representations for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_class.html">Isogeny class of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="sha_tate.html">Tate-Shafarevich group</a></li>
<li class="toctree-l1"><a class="reference internal" href="cm.html">Complex multiplication for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="Qcurves.html">Testing whether elliptic curves over number fields are <span class="math notranslate nohighlight">\(\QQ\)</span>-curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_local_data.html">Local data for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="kodaira_symbol.html">Kodaira symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_tate_curve.html">Tate’s parametrisation of <span class="math notranslate nohighlight">\(p\)</span>-adic curves with multiplicative reduction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_wp.html">Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice.html">Period lattices of elliptic curves and related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice_region.html">Regions in fundamental domains of period lattices</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="modular_parametrization.html">Modular parametrization of elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_modular_symbols.html">Modular symbols attached to elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Modular symbols by numerical integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lseries_ell.html"><span class="math notranslate nohighlight">\(L\)</span>-series for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="heegner.html">Heegner points on elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_lseries.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="descent_two_isogeny.html">Descent on elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span> with a 2-isogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_egros.html">Elliptic curves with prescribed good reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_padic_field.html">Elliptic curves over padic fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="gp_simon.html">Denis Simon’s PARI scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="mod5family.html">Elliptic curves with congruent mod-5 representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_transform.html">Morphism to bring a genus-one curve into Weierstrass form</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/constructor.html">Hyperelliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_generic.html">Hyperelliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_finite_field.html">Hyperelliptic curves over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_padic_field.html">Hyperelliptic curves over a <span class="math notranslate nohighlight">\(p\)</span>-adic field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_rational_field.html">Hyperelliptic curves over the rationals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/mestre.html">Mestre’s algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/monsky_washnitzer.html">Computation of Frobenius matrix on Monsky-Washnitzer cohomology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hypellfrob.html">Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over a</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_generic.html">Jacobian of a general hyperelliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_g2.html">Jacobian of a hyperelliptic curve of genus 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_homset.html">Rational point sets on a Jacobian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_morphism.html">Jacobian ‘morphism’ as a class in the Picard group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_g2.html">Hyperelliptic curves of genus 2 over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/invariants.html">Compute invariants of quintics and sextics via ‘Ueberschiebung’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/kummer_surface.html">Kummer surfaces over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/genus2reduction.html">Conductor and reduction types for genus 2 curves</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="modular-symbols-by-numerical-integration">
<span id="sage-schemes-elliptic-curves-mod-sym-num"></span><h1>Modular symbols by numerical integration<a class="headerlink" href="#modular-symbols-by-numerical-integration" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.mod_sym_num"></span><p>We describe here the method for computing modular symbols
by numerical approximations of the integral of the modular form on a
path between cusps.</p>
<p>More precisely, let <span class="math notranslate nohighlight">\(E\)</span> be an elliptic curve and <span class="math notranslate nohighlight">\(f\)</span> the newform
associated to the isogeny class of <span class="math notranslate nohighlight">\(E\)</span>. If</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\lambda(r\to r') = 2\pi i \int_{r}^{r'} f(\tau)  d\tau\]</div>
</div>
<p>then the modular symbol <span class="math notranslate nohighlight">\([r]^{+}\)</span> is defined as the quotient of
the real part of <span class="math notranslate nohighlight">\(\lambda(\infty\to r)\)</span> by the least positive real
period of <span class="math notranslate nohighlight">\(E\)</span>. Similarly for the negative modular symbol, it is the
quotient of the imaginary part of the above by the smallest positive
imaginary part of a period on the imaginary axis.</p>
<p>The theorem of Manin-Drinfeld shows that the modular symbols are
rational numbers with small denominator. They are used for the
computation of special values of the L-function of <span class="math notranslate nohighlight">\(E\)</span> twisted by
Dirichlet characters and for the computation of <span class="math notranslate nohighlight">\(p\)</span>-adic L-functions.</p>
<p>ALGORITHM:</p>
<p>The implementation of modular symbols in eclib and directly in sage
uses the algorithm described in Cremona’s book <a class="reference internal" href="../../../../references/index.html#cre1997" id="id1"><span>[Cre1997]</span></a> and Stein’s
book <a class="reference internal" href="../../../../references/index.html#st2007" id="id2"><span>[St2007]</span></a>. First the space of all
modular symbols of the given level is computed, then the space
corresponding to the given newform is determined. Even if these initial
steps may take a while, the evaluation afterwards is instantaneous. All
computations are done with rational numbers and hence are exact.</p>
<p>Instead the method used here (see <a class="reference internal" href="../../../../references/index.html#wu2018" id="id3"><span>[Wu2018]</span></a> for details)
is by evaluating the above integrals
<span class="math notranslate nohighlight">\(\lambda(r\to r')\)</span> by numerical approximation. Since we know precise
bounds on the denominator, we can make rigorous estimates on the
error to guarantee that the result is proven to be the correct rational
number.</p>
<p>The paths over which we integrate are split up and Atkin-Lehner
operators are used to compute the badly converging part of the integrals
by using the Fourier expansion at other cusps than <span class="math notranslate nohighlight">\(\infty\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is one assumption for the correctness of these computations: The
Manin constant for the <span class="math notranslate nohighlight">\(X_0\)</span>-optimal curve should be <span class="math notranslate nohighlight">\(1\)</span> if the curve
lies outside the Cremona tables. This is known for all curves in the
Cremona table, but only conjectured for general curves.</p>
</div>
<p>EXAMPLES:</p>
<p>The most likely usage for the code is through the functions
<code class="docutils literal notranslate"><span class="pre">modular_symbol</span></code> with implementation set to “num” and through
<code class="docutils literal notranslate"><span class="pre">modular_symbol_numerical</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;5077a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span> <span class="o">=</span> <span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">123</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Mn</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol_numerical</span><span class="p">(</span><span class="n">sign</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Mn</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">123</span><span class="p">)</span>       <span class="c1"># abs tol 1e-11</span>
<span class="go">3.00000000000018</span>
</pre></div>
</div>
<p>In more details. A numerical modular symbols <code class="docutils literal notranslate"><span class="pre">M</span></code> is created from an
elliptic curve with a chosen <code class="docutils literal notranslate"><span class="pre">sign</span></code> (though the other sign will also be
accessible, too):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">101</span><span class="p">,</span><span class="mi">103</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">35261176</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="n">sign</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">Numerical modular symbol attached to Elliptic Curve defined by y^2 = x^3 + 101*x + 103 over Rational Field</span>
</pre></div>
</div>
<p>We can then compute the value <span class="math notranslate nohighlight">\([13/17]^{-}\)</span> and <span class="math notranslate nohighlight">\([1/17]^{+}\)</span> by calling
the function <code class="docutils literal notranslate"><span class="pre">M</span></code>. The value of <span class="math notranslate nohighlight">\([0]^{+}=0\)</span> tells us that the rank of
this curve is positive:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">13</span><span class="o">/</span><span class="mi">17</span><span class="p">)</span>
<span class="go">-1/2</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span><span class="n">sign</span><span class="o">=+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sign</span><span class="o">=+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>One can compute the numerical approximation to these rational numbers
to any proven binary precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">approximative_value</span><span class="p">(</span><span class="mi">13</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#abs tol 1e-4</span>
<span class="go">-0.500003172770455</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">approximative_value</span><span class="p">(</span><span class="mi">13</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="c1">#abs tol 1e-6</span>
<span class="go">-0.500000296037388</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">approximative_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sign</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> <span class="c1">#abs tol 1e-8</span>
<span class="go">0.000000000000000</span>
</pre></div>
</div>
<p>There are a few other things that one can do with <code class="docutils literal notranslate"><span class="pre">M</span></code>. The Manin
symbol <span class="math notranslate nohighlight">\(M(c:d)\)</span> for a point <span class="math notranslate nohighlight">\((c:d)\)</span> in the projective line can be
computed.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">manin_symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>In some cases useful, there is a function that returns all <span class="math notranslate nohighlight">\([a/m]^{+}\)</span>
for a fixed denominator <span class="math notranslate nohighlight">\(m\)</span>. This is rather quicker for small <span class="math notranslate nohighlight">\(m\)</span> than
computing them individually:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">all_values_for_one_denominator</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">{1/7: 0, 2/7: 3/2, 3/7: 3/2, 4/7: -3/2, 5/7: -3/2, 6/7: 0}</span>
</pre></div>
</div>
<p>Finally a word of warning. The algorithm is fast when the cusps involved
are unitary. If the curve is semistable, all cusps are unitary. But
rational numbers with a prime <span class="math notranslate nohighlight">\(p\)</span> dividing the denominator once, but the
conductor more than once, are very difficult. For instance for the above
example, a seemingly harmless command like <code class="docutils literal notranslate"><span class="pre">M(1/2)</span></code> would take a very
very long time to return a value. However it is possible to compute them
for smaller conductors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;664a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The problem with non-unitary cusps is dealt with rather easily when one
can twist to a semistable curve, like in this example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;11a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">101</span><span class="p">)</span>
<span class="go">41</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Chris Wuthrich (2013-16)</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.mod_sym_num.</span></span><span class="sig-name descname"><span class="pre">ModularSymbolNumerical</span></span><a class="headerlink" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class assigning to an elliptic curve over <span class="math notranslate nohighlight">\(\QQ\)</span> a modular symbol.
Unlike the other implementations this class does not precompute a
basis for this space. Instead at each call, it evaluates the integral
using numerical approximation. All bounds are very strictly
implemented and the output is a correct proven rational number.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over the rational numbers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sign</span></code> – either -1 or +1 (default). This sets the default
value of <code class="docutils literal notranslate"><span class="pre">sign</span></code> throughout the class. Both are still accessible.</p></li>
</ul>
<p>OUTPUT: a modular symbol</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;5077a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">77</span><span class="o">/</span><span class="mi">57</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">33</span><span class="o">/</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">sign</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">2</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.mod_sym_num</span> \
<span class="gp">....: </span><span class="kn">import</span> <span class="nn">ModularSymbolNumerical</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbolNumerical</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;11a1&quot;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1/2</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-4/5</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.all_values_for_one_denominator">
<span class="sig-name descname"><span class="pre">all_values_for_one_denominator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.all_values_for_one_denominator" title="Permalink to this definition">#</a></dt>
<dd><p>Given an integer <code class="docutils literal notranslate"><span class="pre">m</span></code> and a <code class="docutils literal notranslate"><span class="pre">sign</span></code>, this returns the
modular symbols <span class="math notranslate nohighlight">\([a/m]\)</span> for all <span class="math notranslate nohighlight">\(a\)</span> coprime to <span class="math notranslate nohighlight">\(m\)</span>
using partial sums.
This is much quicker than computing them one by one.</p>
<p>This will only work if <span class="math notranslate nohighlight">\(m\)</span> is relatively small and
if the cusps <span class="math notranslate nohighlight">\(a/m\)</span> are unitary.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – a natural number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sign</span></code> – optional either +1 or -1, or 0 (default),
in which case the sign passed to the class is taken.</p></li>
</ul>
<p>OUTPUT: a dictionary of fractions with denominator <span class="math notranslate nohighlight">\(m\)</span>
giving rational numbers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">all_values_for_one_denominator</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">{1/7: 3, 2/7: 0, 3/7: -3, 4/7: -3, 5/7: 0, 6/7: 3}</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">M</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1..6</span><span class="p">]]</span>
<span class="go">[3, 0, -3, -3, 0, 3]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">all_values_for_one_denominator</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{1/3: 4, 2/3: -4}</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">all_values_for_one_denominator</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="go">{1/12: 1/5, 5/12: -23/10, 7/12: -23/10, 11/12: 1/5}</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">all_values_for_one_denominator</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{1/12: 0, 5/12: 1/2, 7/12: -1/2, 11/12: 0}</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;20a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">all_values_for_one_denominator</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">{1/4: 0, 3/4: 0}</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">all_values_for_one_denominator</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">{1/8: 1/2, 3/8: -1/2, 5/8: -1/2, 7/8: 1/2}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value">
<span class="sig-name descname"><span class="pre">approximative_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_twist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value" title="Permalink to this definition">#</a></dt>
<dd><p>The numerical modular symbol evaluated at rational.</p>
<p>It returns a real number, which should be equal
to a rational number to the given binary
precision <code class="docutils literal notranslate"><span class="pre">prec</span></code>. In practice the precision is
often much higher. See the examples below.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> – a rational (or integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sign</span></code> – optional either +1 or -1, or 0 (default),
in which case the sign passed to the class is taken.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – an integer (default 20)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_twist</span></code> – True (default) allows to use a
quadratic twist of the curve to lower the conductor.</p></li>
</ul>
<p>OUTPUT: a real number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;5077a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">approximative_value</span><span class="p">(</span><span class="mi">123</span><span class="o">/</span><span class="mi">567</span><span class="p">)</span>  <span class="c1"># abs tol 1e-11</span>
<span class="go">-4.00000000000845</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">approximative_value</span><span class="p">(</span><span class="mi">123</span><span class="o">/</span><span class="mi">567</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># abs tol 1e-9</span>
<span class="go">-4.00002815242902</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span><span class="mi">88</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">1715296</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">approximative_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>   <span class="c1"># abs tol 1e-11</span>
<span class="go">-0.0000176374317982166</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">approximative_value</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># abs tol 1e-11</span>
<span class="go">0.999981178147778</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">approximative_value</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># abs tol 1e-11</span>
<span class="go">0.999999972802649</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.clear_cache">
<span class="sig-name descname"><span class="pre">clear_cache</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.clear_cache" title="Permalink to this definition">#</a></dt>
<dd><p>Clear the cached values in all methods of this class</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;11a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1/5</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1/5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.elliptic_curve">
<span class="sig-name descname"><span class="pre">elliptic_curve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.elliptic_curve" title="Permalink to this definition">#</a></dt>
<dd><p>Return the elliptic curve of this modular symbol.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;15a4&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">elliptic_curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 + 35*x - 28 over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.manin_symbol">
<span class="sig-name descname"><span class="pre">manin_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.manin_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>Given a pair <span class="math notranslate nohighlight">\((u,v)\)</span> presenting a point in
<span class="math notranslate nohighlight">\(\mathbb{P}^1(\mathbb{Z}/N\mathbb{Z})\)</span> and hence a coset of
<span class="math notranslate nohighlight">\(\Gamma_0(N)\)</span>, this computes the value of the Manin
symbol <span class="math notranslate nohighlight">\(M(u:v)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">u</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – an integer such that <span class="math notranslate nohighlight">\((u:v)\)</span> is a projective point
modulo <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sign</span></code> – optional either +1 or -1, or 0 (default),
in which case the sign passed to the class is taken.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">manin_symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-1/2</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">manin_symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">sign</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1/2</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">manin_symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">manin_symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">manin_symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1/2</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">manin_symbol</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="go">-1/2</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">manin_symbol</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="go">-1/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.transportable_symbol">
<span class="sig-name descname"><span class="pre">transportable_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.transportable_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>Return the symbol <span class="math notranslate nohighlight">\([r']^+ - [r]^+\)</span> where <span class="math notranslate nohighlight">\(r'=\gamma(r)\)</span> for some
<span class="math notranslate nohighlight">\(\gamma\in\Gamma_0(N)\)</span>. These symbols can be computed by transporting
the path into the upper half plane close to one of the unitary cusps.
Here we have implemented it only to move close to <span class="math notranslate nohighlight">\(i\infty\)</span> and <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> and <code class="docutils literal notranslate"><span class="pre">rr</span></code> – two rational numbers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sign</span></code> – optional either +1 or -1, or 0 (default),
in which case the sign passed to the class is taken.</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;11a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">transportable_symbol</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">-1/2</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;37a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">transportable_symbol</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">19</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">transportable_symbol</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">19</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;5077a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">transportable_symbol</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">35</span><span class="o">/</span><span class="mi">144</span><span class="p">)</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">transportable_symbol</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">35</span><span class="o">/</span><span class="mi">144</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">transportable_symbol</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">31798</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">transportable_symbol</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">31798</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-5</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="lseries_ell.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="math notranslate nohighlight">\(L\)</span>-series for elliptic curves</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="ell_modular_symbols.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Modular symbols attached to elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Modular symbols by numerical integration</a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical"><code class="docutils literal notranslate"><span class="pre">ModularSymbolNumerical</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.all_values_for_one_denominator"><code class="docutils literal notranslate"><span class="pre">all_values_for_one_denominator()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value"><code class="docutils literal notranslate"><span class="pre">approximative_value()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.clear_cache"><code class="docutils literal notranslate"><span class="pre">clear_cache()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.elliptic_curve"><code class="docutils literal notranslate"><span class="pre">elliptic_curve()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.manin_symbol"><code class="docutils literal notranslate"><span class="pre">manin_symbol()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.transportable_symbol"><code class="docutils literal notranslate"><span class="pre">transportable_symbol()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>