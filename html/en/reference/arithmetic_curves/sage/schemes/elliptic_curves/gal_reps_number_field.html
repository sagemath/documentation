<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Isogeny class of elliptic curves over number fields" href="isogeny_class.html" /><link rel="prev" title="Galois representations attached to elliptic curves" href="gal_reps.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Galois representations for elliptic curves over number fields - Elliptic curves</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Elliptic curves</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.1 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Elliptic curves</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="constructor.html">Elliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian.html">Construct elliptic curves as Jacobians</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_point.html">Points on elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_generic.html">Elliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_field.html">Elliptic curves over a general field</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_finite_field.html">Elliptic curves over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="formal_group.html">Formal groups of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hom.html">Elliptic-curve morphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_morphism.html">Isomorphisms between Weierstrass models of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_curve_isogeny.html">Isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_velusqrt.html">Square‑root Vélu algorithm for elliptic-curve isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_composite.html">Composite morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_scalar.html">Scalar-multiplication morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="hom_frobenius.html">Frobenius isogenies of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_small_degree.html">Isogenies of small prime degree</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ell_rational_field.html">Elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ec_database.html">Tables of elliptic curves of given rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_number_field.html">Elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="height.html">Canonical heights for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="saturation.html">Saturation of Mordell-Weil groups of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_torsion.html">Torsion subgroups of elliptic curves over number fields (including <span class="math notranslate nohighlight">\(\QQ\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gal_reps.html">Galois representations attached to elliptic curves</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Galois representations for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="isogeny_class.html">Isogeny class of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="sha_tate.html">Tate-Shafarevich group</a></li>
<li class="toctree-l1"><a class="reference internal" href="cm.html">Complex multiplication for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="Qcurves.html">Testing whether elliptic curves over number fields are <span class="math notranslate nohighlight">\(\QQ\)</span>-curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_local_data.html">Local data for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="kodaira_symbol.html">Kodaira symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_tate_curve.html">Tate’s parametrisation of <span class="math notranslate nohighlight">\(p\)</span>-adic curves with multiplicative reduction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ell_wp.html">Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice.html">Period lattices of elliptic curves and related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="period_lattice_region.html">Regions in fundamental domains of period lattices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modular_parametrization.html">Modular parametrization of elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_modular_symbols.html">Modular symbols attached to elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="mod_sym_num.html">Modular symbols by numerical integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lseries_ell.html"><span class="math notranslate nohighlight">\(L\)</span>-series for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="heegner.html">Heegner points on elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_lseries.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="descent_two_isogeny.html">Descent on elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span> with a 2-isogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_egros.html">Elliptic curves with prescribed good reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ell_padic_field.html">Elliptic curves over padic fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="gp_simon.html">Denis Simon’s PARI scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="mod5family.html">Elliptic curves with congruent mod-5 representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_transform.html">Morphism to bring a genus-one curve into Weierstrass form</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/constructor.html">Hyperelliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_generic.html">Hyperelliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_finite_field.html">Hyperelliptic curves over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_padic_field.html">Hyperelliptic curves over a <span class="math notranslate nohighlight">\(p\)</span>-adic field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_rational_field.html">Hyperelliptic curves over the rationals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/mestre.html">Mestre’s algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/monsky_washnitzer.html">Computation of Frobenius matrix on Monsky-Washnitzer cohomology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hypellfrob.html">Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over a</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_generic.html">Jacobian of a general hyperelliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_g2.html">Jacobian of a hyperelliptic curve of genus 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_homset.html">Rational point sets on a Jacobian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/jacobian_morphism.html">Jacobian ‘morphism’ as a class in the Picard group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/hyperelliptic_g2.html">Hyperelliptic curves of genus 2 over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/invariants.html">Compute invariants of quintics and sextics via ‘Ueberschiebung’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperelliptic_curves/kummer_surface.html">Kummer surfaces over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/genus2reduction.html">Conductor and reduction types for genus 2 curves</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="galois-representations-for-elliptic-curves-over-number-fields">
<span id="sage-schemes-elliptic-curves-gal-reps-number-field"></span><h1>Galois representations for elliptic curves over number fields<a class="headerlink" href="#galois-representations-for-elliptic-curves-over-number-fields" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.gal_reps_number_field"></span><p>This file contains the code to compute for which primes the Galois
representation attached to an elliptic curve (over an arbitrary number field)
is surjective. The functions in this file are called by the <code class="docutils literal notranslate"><span class="pre">is_surjective</span></code>
and <code class="docutils literal notranslate"><span class="pre">non_surjective</span></code> methods of an elliptic curve over a number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="c1"># Cyclotomic character not surjective.</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="c1"># See Section 5.10 of [Ser1972].</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>  <span class="c1"># long time (4s on sage.math, 2014)</span>
<span class="go">[3, 5, 29]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">1728</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="c1"># CM</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>  <span class="c1"># long time (2s on sage.math, 2014)</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Eric Larson (2012-05-28): initial version.</p></li>
<li><p>Eric Larson (2014-08-13): added isogeny_bound function.</p></li>
<li><p>John Cremona (2016, 2017): various efficiency improvements to _semistable_reducible_primes</p></li>
<li><p>John Cremona (2017): implementation of Billerey’s algorithm to find all reducible primes</p></li>
</ul>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../../references/index.html#ser1972" id="id1"><span>[Ser1972]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#sut2012" id="id2"><span>[Sut2012]</span></a></p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_B_bound">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.gal_reps_number_field.</span></span><span class="sig-name descname"><span class="pre">Billerey_B_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_prime_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_B_bound" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Billerey’s bound <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>We compute <span class="math notranslate nohighlight">\(B_l\)</span> for <span class="math notranslate nohighlight">\(l\)</span> up to <code class="docutils literal notranslate"><span class="pre">max_l</span></code> (at most) until <code class="docutils literal notranslate"><span class="pre">num_l</span></code>
nonzero values are found (at most).  Return the list of primes
dividing all <span class="math notranslate nohighlight">\(B_l\)</span> computed, excluding those dividing 6 or
ramified or of bad reduction or less than small_prime_bound.  If
no non-zero values are found return [0].</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over a number field <span class="math notranslate nohighlight">\(K\)</span>, given by a
global integral model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_l</span></code> (int, default 200) – maximum size of primes l to check.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_l</span></code> (int, default 8)  – maximum number of primes l to check.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">small_prime_bound</span></code> (int, default 0) – remove primes less
than this from the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">debug</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>)  – if <code class="docutils literal notranslate"><span class="pre">True</span></code> prints details.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The purpose of the small_prime_bound is that it is faster to
deal with these using the local test; by ignoring them here,
we enable the algorithm to terminate sooner when there are no
large reducible primes, which is always the case in practice.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">Billerey_B_bound</span>
<span class="gp">sage: </span><span class="n">Billerey_B_bound</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[5]</span>
</pre></div>
</div>
<p>If we do not use enough primes <span class="math notranslate nohighlight">\(l\)</span>, extraneous primes will be
included which are not reducible primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Billerey_B_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">num_l</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[5, 7]</span>
</pre></div>
</div>
<p>Similarly if we do not use large enough primes <span class="math notranslate nohighlight">\(l\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Billerey_B_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">max_l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">num_l</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">[5, 7]</span>
<span class="gp">sage: </span><span class="n">Billerey_B_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">max_l</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_l</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">[5]</span>
</pre></div>
</div>
<p>This curve does have a rational 5-isogeny:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_B_l">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.gal_reps_number_field.</span></span><span class="sig-name descname"><span class="pre">Billerey_B_l</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_B_l" title="Permalink to this definition">#</a></dt>
<dd><p>Return Billerey’s <span class="math notranslate nohighlight">\(B_l\)</span>, adapted from the definition in <a class="reference internal" href="../../../../references/index.html#bil2011" id="id3"><span>[Bil2011]</span></a>, after (9).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over a number field <span class="math notranslate nohighlight">\(K\)</span>, given by a
global integral model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> (int) – a rational prime</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> (int) – 0 or LCM of previous <span class="math notranslate nohighlight">\(B_l\)</span>: the prime-to-B part of this <span class="math notranslate nohighlight">\(B_l\)</span> is ignored.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">Billerey_B_l</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Billerey_B_l</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[1123077552537600,</span>
<span class="go"> 227279663773903886745600,</span>
<span class="go"> 0,</span>
<span class="go"> 0,</span>
<span class="go"> 269247154818492941287713746693964214802283882086400,</span>
<span class="go"> 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_P_l">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.gal_reps_number_field.</span></span><span class="sig-name descname"><span class="pre">Billerey_P_l</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_P_l" title="Permalink to this definition">#</a></dt>
<dd><p>Return Billerey’s <span class="math notranslate nohighlight">\(P_l^*\)</span> as defined in <a class="reference internal" href="../../../../references/index.html#bil2011" id="id4"><span>[Bil2011]</span></a>, equation (9).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over a number field <span class="math notranslate nohighlight">\(K\)</span>, given by a
global integral model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> – a rational prime</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">Billerey_P_l</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Billerey_P_l</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[x^2 + 8143*x + 16777216,</span>
<span class="go"> x^2 + 451358*x + 282429536481,</span>
<span class="go"> x^4 - 664299076*x^3 + 205155493652343750*x^2 - 39595310449600219726562500*x + 3552713678800500929355621337890625,</span>
<span class="go"> x^4 - 207302404*x^3 - 377423798538689366394*x^2 - 39715249826471656586987520004*x + 36703368217294125441230211032033660188801]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_R_bound">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.gal_reps_number_field.</span></span><span class="sig-name descname"><span class="pre">Billerey_R_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_prime_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_R_bound" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Billerey’s bound <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>We compute <span class="math notranslate nohighlight">\(R_q\)</span> for <span class="math notranslate nohighlight">\(q\)</span> dividing primes <span class="math notranslate nohighlight">\(\ell\)</span> up to <code class="docutils literal notranslate"><span class="pre">max_l</span></code>
(at most) until <code class="docutils literal notranslate"><span class="pre">num_l</span></code> nonzero values are found (at most).
Return the list of primes dividing all <code class="docutils literal notranslate"><span class="pre">R_q</span></code> computed, excluding
those dividing 6 or ramified or of bad reduction or less than
small_prime_bound.  If no non-zero values are found return [0].</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over a number field <span class="math notranslate nohighlight">\(K\)</span>, given by a
global integral model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_l</span></code> (int, default 200) – maximum size of rational primes
l for which the primes q above l are checked.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_l</span></code> (int, default 8) – maximum number of rational primes
l for which the primes q above l are checked.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">small_prime_bound</span></code> (int, default 0) – remove primes less
than this from the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">debug</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>)  – if <code class="docutils literal notranslate"><span class="pre">True</span></code> prints details.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The purpose of the small_prime_bound is that it is faster to
deal with these using the local test; by ignoring them here,
we enable the algorithm to terminate sooner when there are no
large reducible primes, which is always the case in practice.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">Billerey_R_bound</span>
<span class="gp">sage: </span><span class="n">Billerey_R_bound</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[5]</span>
</pre></div>
</div>
<p>We may get no bound at all if we do not use enough primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Billerey_R_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">max_l</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>Or we may get a bound but not a good one if we do not use enough primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Billerey_R_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">num_l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[5, 17, 67, 157]</span>
</pre></div>
</div>
<p>In this case two primes is enough to restrict the set of possible
reducible primes to just <span class="math notranslate nohighlight">\(\{5\}\)</span>.  This curve does have a rational 5-isogeny:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Billerey_R_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">num_l</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[5]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_R_q">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.gal_reps_number_field.</span></span><span class="sig-name descname"><span class="pre">Billerey_R_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_R_q" title="Permalink to this definition">#</a></dt>
<dd><p>Return Billerey’s <span class="math notranslate nohighlight">\(R_q\)</span>, adapted from the definition in <a class="reference internal" href="../../../../references/index.html#bil2011" id="id5"><span>[Bil2011]</span></a>, Theorem 2.8.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over a number field <span class="math notranslate nohighlight">\(K\)</span>, given by a
global integral model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">q</span></code> – a prime ideal of <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> (int) – 0 or LCM of previous <span class="math notranslate nohighlight">\(R_q\)</span>: the prime-to-B part of this <span class="math notranslate nohighlight">\(R_q\)</span> is ignored.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">Billerey_R_q</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Billerey_R_q</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="n">l</span><span class="p">))</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1123077552537600,</span>
<span class="go">227279663773903886745600,</span>
<span class="go">51956919562116960000000000000000,</span>
<span class="go">252485933820556361829926400000000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.Frobenius_filter">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.gal_reps_number_field.</span></span><span class="sig-name descname"><span class="pre">Frobenius_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Frobenius_filter" title="Permalink to this definition">#</a></dt>
<dd><p>Determine which primes in L might have an image contained in a
Borel subgroup, by checking of traces of Frobenius.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will sometimes return primes for which the image
is not contained in a Borel subgroup.  This issue cannot always
be fixed by increasing patience as it may be a result of a
failure of a local-global principle for isogenies.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – EllipticCurve over a number field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">L</span></code> – a list of prime numbers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">patience</span></code> (int), default 100 – a positive integer bounding
the number of traces of Frobenius to use while trying to prove
irreducibility.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>list – The list of all primes <span class="math notranslate nohighlight">\(\ell\)</span> in L for which the mod
<span class="math notranslate nohighlight">\(\ell\)</span> image might be contained in a Borel subgroup of
<span class="math notranslate nohighlight">\(GL_2(\mathbf{F}_{\ell})\)</span>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span> <span class="c1"># has a 5-isogeny</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">gal_reps_number_field</span><span class="o">.</span><span class="n">Frobenius_filter</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">primes</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>  <span class="c1"># long time</span>
<span class="go">[5]</span>
</pre></div>
</div>
<p>Example to show that the output may contain primes where the
representation is in fact reducible.  Over <span class="math notranslate nohighlight">\(\QQ\)</span> the following is
essentially the unique such example by <a class="reference internal" href="../../../../references/index.html#sut2012" id="id6"><span>[Sut2012]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">2268945</span><span class="o">/</span><span class="mi">128</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">gal_reps_number_field</span><span class="o">.</span><span class="n">Frobenius_filter</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>  <span class="c1"># long time</span>
<span class="go">[7]</span>
</pre></div>
</div>
<p>This curve does possess a 7-isogeny modulo every prime of good
reduction, but has no rational 7-isogeny:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>A number field example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">399</span><span class="o">-</span><span class="mi">240</span><span class="o">*</span><span class="n">i</span><span class="p">,</span>  <span class="mi">2627</span><span class="o">+</span><span class="mi">2869</span><span class="o">*</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">gal_reps_number_field</span><span class="o">.</span><span class="n">Frobenius_filter</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">primes</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>  <span class="c1"># long time</span>
<span class="go">[2, 3]</span>
</pre></div>
</div>
<p>Here the curve really does possess isogenies of degrees 2 and 3:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="n">l</span><span class="p">))</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.gal_reps_number_field.</span></span><span class="sig-name descname"><span class="pre">GaloisRepresentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>The compatible family of Galois representation
attached to an elliptic curve over a number field.</p>
<p>Given an elliptic curve <span class="math notranslate nohighlight">\(E\)</span> over a number field <span class="math notranslate nohighlight">\(K\)</span>
and a rational prime number <span class="math notranslate nohighlight">\(p\)</span>, the <span class="math notranslate nohighlight">\(p^n\)</span>-torsion
<span class="math notranslate nohighlight">\(E[p^n]\)</span> points of <span class="math notranslate nohighlight">\(E\)</span> is a representation of the
absolute Galois group <span class="math notranslate nohighlight">\(G_K\)</span> of <span class="math notranslate nohighlight">\(K\)</span>. As <span class="math notranslate nohighlight">\(n\)</span> varies
we obtain the Tate module <span class="math notranslate nohighlight">\(T_p E\)</span> which is
a representation of <span class="math notranslate nohighlight">\(G_K\)</span> on a free <span class="math notranslate nohighlight">\(\ZZ_p\)</span>-module
of rank <span class="math notranslate nohighlight">\(2\)</span>. As <span class="math notranslate nohighlight">\(p\)</span> varies the representations
are compatible.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span>
<span class="go">Compatible family of Galois representations associated to the Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 + (-10)*x + (-20) over Number Field in a with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.elliptic_curve">
<span class="sig-name descname"><span class="pre">elliptic_curve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.elliptic_curve" title="Permalink to this definition">#</a></dt>
<dd><p>Return the elliptic curve associated to this representation.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">elliptic_curve</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.is_surjective">
<span class="sig-name descname"><span class="pre">is_surjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.is_surjective" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the mod-p representation is (provably)
surjective onto <span class="math notranslate nohighlight">\(Aut(E[p]) = GL_2(\GF{p})\)</span>.  Return
<code class="docutils literal notranslate"><span class="pre">False</span></code> if it is (probably) not.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> - int - a prime number.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">A</span></code> - int - a bound on the number of traces of Frobenius to use</dt><dd><p>while trying to prove surjectivity.</p>
</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="c1"># Cyclotomic character not surjective.</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="c1"># See Section 5.10 of [Ser1972].</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\(E\)</span> is defined over <span class="math notranslate nohighlight">\(\QQ\)</span>, then the exceptional primes for <span class="math notranslate nohighlight">\(E_{/K}\)</span>
are the same as the exceptional primes for <span class="math notranslate nohighlight">\(E\)</span>, except for those primes
that are ramified in <span class="math notranslate nohighlight">\(K/\QQ\)</span> or are less than <span class="math notranslate nohighlight">\([K:\QQ]\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rhoQQ</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rhoK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rhoQQ</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">rhoK</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">rhoQQ</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">rhoK</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rhoQQ</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="n">rhoK</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For CM curves, the mod-p representation is never surjective:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">any</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.isogeny_bound">
<span class="sig-name descname"><span class="pre">isogeny_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.isogeny_bound" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of primes <span class="math notranslate nohighlight">\(p\)</span> including all primes for which
the image of the mod-<span class="math notranslate nohighlight">\(p\)</span> representation is contained in a
Borel.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the actual list of primes <span class="math notranslate nohighlight">\(p\)</span> at which the
representation is reducible see <a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.reducible_primes" title="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.reducible_primes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reducible_primes()</span></code></a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code> – int (a bound on the number of traces of Frobenius to
use while trying to prove the mod-<span class="math notranslate nohighlight">\(p\)</span>
representation is not contained in a Borel).</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code> – A list of primes which contains (but may not be
equal to) all <span class="math notranslate nohighlight">\(p\)</span> for which the image of the mod-<span class="math notranslate nohighlight">\(p\)</span>
representation is contained in a Borel subgroup.  At any
prime not in this list, the image is definitely not
contained in a Borel. If E has <span class="math notranslate nohighlight">\(CM\)</span> defined over <span class="math notranslate nohighlight">\(K\)</span>, the list
[0] is returned.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span> <span class="c1"># See Section 5.10 of [Ser1972].  # long time</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">1728</span><span class="p">))</span>             <span class="c1"># CM over K</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>                <span class="c1"># CM NOT over K</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span>     <span class="c1"># long time</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2268945</span><span class="o">/</span><span class="mi">128</span><span class="p">))</span>      <span class="c1"># c.f. [Sut2012]</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span>  <span class="c1"># No 7-isogeny, but...   # long time</span>
<span class="go">[7]</span>
</pre></div>
</div>
<p>For curves with rational CM, there are infinitely many primes
<span class="math notranslate nohighlight">\(p\)</span> for which the mod-<span class="math notranslate nohighlight">\(p\)</span> representation is reducible, and [0]
is returned:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>An example (an elliptic curve with everywhere good reduction
over an imaginary quadratic field with quite large
discriminant), which failed until fixed at <a class="reference external" href="https://github.com/sagemath/sage/issues/21776">github issue #21776</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">112941801</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="o">-</span><span class="mi">23163076</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">266044005933275</span><span class="p">,</span><span class="mi">57560769602038</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">836483958630700313803</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">GR</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">GR</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.non_surjective">
<span class="sig-name descname"><span class="pre">non_surjective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.non_surjective" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of primes <span class="math notranslate nohighlight">\(p\)</span> including all primes for which the mod-<span class="math notranslate nohighlight">\(p\)</span>
representation might not be surjective.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code> – int (a bound on the number of traces of Frobenius to use
while trying to prove surjectivity).</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code> – A list of primes where mod-<span class="math notranslate nohighlight">\(p\)</span> representation is
very likely not surjective. At any prime not in this list,
the representation is definitely surjective. If <span class="math notranslate nohighlight">\(E\)</span> has CM,
the list [0] is returned.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span> <span class="c1"># See Section 5.10 of [Ser1972].  # long time</span>
<span class="go">[3, 5, 29]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="c1"># X_0(11)</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>  <span class="c1"># long time (4s on sage.math, 2014)</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">1728</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="c1"># CM</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">146329141248</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">327201914880</span><span class="p">)</span> <span class="c1"># CM</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span> <span class="c1"># long time (3s on sage.math, 2014)</span>
<span class="go">[0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.reducible_primes">
<span class="sig-name descname"><span class="pre">reducible_primes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.reducible_primes" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of primes <span class="math notranslate nohighlight">\(p\)</span> for which the mod-<span class="math notranslate nohighlight">\(p\)</span>
representation is reducible, or [0] for CM curves.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code> – A list of those primes <span class="math notranslate nohighlight">\(p\)</span> for which the mod-<span class="math notranslate nohighlight">\(p\)</span>
representation is contained in a Borel subgroup, i.e. is
reducible.  If E has CM <em>defined over K</em>, the list [0] is
returned (in this case the representation is reducible for
infinitely many primes).</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span> <span class="c1"># See Section 5.10 of [Ser1972].  # long time</span>
<span class="go">[3, 5]</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">1728</span><span class="p">))</span>             <span class="c1"># CM over K</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>                <span class="c1"># CM but NOT over K</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2268945</span><span class="o">/</span><span class="mi">128</span><span class="p">))</span>      <span class="c1"># c.f. [Sut2012]</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span>  <span class="c1"># No 7-isogeny, but...   # long time</span>
<span class="go">[7]</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span>                        <span class="c1"># long time</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>For curves with rational CM, there are infinitely many primes
<span class="math notranslate nohighlight">\(p\)</span> for which the mod-<span class="math notranslate nohighlight">\(p\)</span> representation is reducible, and [0]
is returned:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.deg_one_primes_iter">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.gal_reps_number_field.</span></span><span class="sig-name descname"><span class="pre">deg_one_primes_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">principal_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.deg_one_primes_iter" title="Permalink to this definition">#</a></dt>
<dd><p>Return an iterator over degree 1 primes of <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> – a number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">principal_only</span></code> – bool; if <code class="docutils literal notranslate"><span class="pre">True</span></code>, only yield principal primes</p></li>
</ul>
<p>OUTPUT:</p>
<p>An iterator over degree 1 primes of <span class="math notranslate nohighlight">\(K\)</span> up to the given norm,
optionally yielding only principal primes.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">deg_one_primes_iter</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">deg_one_primes_iter</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="go">[Fractional ideal (2, a + 1),</span>
<span class="go"> Fractional ideal (3, a + 1),</span>
<span class="go"> Fractional ideal (3, a + 2),</span>
<span class="go"> Fractional ideal (a),</span>
<span class="go"> Fractional ideal (7, a + 3),</span>
<span class="go"> Fractional ideal (7, a + 4)]</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">deg_one_primes_iter</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="go">[Fractional ideal (a),</span>
<span class="go"> Fractional ideal (-2*a + 3),</span>
<span class="go"> Fractional ideal (2*a + 3),</span>
<span class="go"> Fractional ideal (a + 6),</span>
<span class="go"> Fractional ideal (a - 6),</span>
<span class="go"> Fractional ideal (-3*a + 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.reducible_primes_Billerey">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.gal_reps_number_field.</span></span><span class="sig-name descname"><span class="pre">reducible_primes_Billerey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.reducible_primes_Billerey" title="Permalink to this definition">#</a></dt>
<dd><p>Return a finite set of primes <span class="math notranslate nohighlight">\(\ell\)</span> containing all those for which
<span class="math notranslate nohighlight">\(E\)</span> has a <span class="math notranslate nohighlight">\(K\)</span>-rational ell-isogeny, where <span class="math notranslate nohighlight">\(K\)</span> is the base field of
<span class="math notranslate nohighlight">\(E\)</span>: i.e., the mod-<span class="math notranslate nohighlight">\(\ell\)</span> representation is irreducible for all
<span class="math notranslate nohighlight">\(\ell\)</span> outside the set returned.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve defined over a number field <span class="math notranslate nohighlight">\(K\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_l</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – the maximum prime
<span class="math notranslate nohighlight">\(\ell\)</span> to use for the B-bound and R-bound.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a
default value will be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_l</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – the number of primes
<span class="math notranslate nohighlight">\(\ell\)</span> to use for the B-bound and R-bound.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a
default value will be used.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">E</span></code> has CM then [0] is returned.  In this case use the
function
sage.schemes.elliptic_curves.isogeny_class.possible_isogeny_degrees</p>
</div>
<p>We first compute Billeray’s B_bound using at most <code class="docutils literal notranslate"><span class="pre">num_l</span></code> primes
of size up to <code class="docutils literal notranslate"><span class="pre">max_l</span></code>.  If that fails we compute Billeray’s
R_bound using at most <code class="docutils literal notranslate"><span class="pre">num_q</span></code> primes of size up to <code class="docutils literal notranslate"><span class="pre">max_q</span></code>.</p>
<p>Provided that one of these methods succeeds in producing a finite
list of primes we check these using a local condition, and finally
test that the primes returned actually are reducible.  Otherwise
we return [0].</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">reducible_primes_Billerey</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">reducible_primes_Billerey</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">1728</span><span class="p">))</span> <span class="c1"># CM over K</span>
<span class="gp">sage: </span><span class="n">reducible_primes_Billerey</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="c1"># CM but NOT over K</span>
<span class="gp">sage: </span><span class="n">reducible_primes_Billerey</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">[2, 3]</span>
</pre></div>
</div>
<p>An example where a prime is not reducible but passes the test:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2268945</span><span class="o">/</span><span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span> <span class="c1"># c.f. [Sut2012]</span>
<span class="gp">sage: </span><span class="n">reducible_primes_Billerey</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">[7]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.gal_reps_number_field.reducible_primes_naive">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.gal_reps_number_field.</span></span><span class="sig-name descname"><span class="pre">reducible_primes_naive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.reducible_primes_naive" title="Permalink to this definition">#</a></dt>
<dd><p>Return locally reducible primes <span class="math notranslate nohighlight">\(\ell\)</span> up to <code class="docutils literal notranslate"><span class="pre">max_l</span></code>.</p>
<p>The list of primes <span class="math notranslate nohighlight">\(\ell\)</span> returned consists of all those up to
<code class="docutils literal notranslate"><span class="pre">max_l</span></code> such that <span class="math notranslate nohighlight">\(E\)</span> mod <span class="math notranslate nohighlight">\(P\)</span> has an <span class="math notranslate nohighlight">\(\ell\)</span>-isogeny, where <span class="math notranslate nohighlight">\(K\)</span>
is the base field of <span class="math notranslate nohighlight">\(E\)</span>, for <code class="docutils literal notranslate"><span class="pre">num_P</span></code> primes <span class="math notranslate nohighlight">\(P\)</span> of <span class="math notranslate nohighlight">\(K\)</span>.  In
most cases <span class="math notranslate nohighlight">\(E\)</span> then has a <span class="math notranslate nohighlight">\(K\)</span>-rational <span class="math notranslate nohighlight">\(\ell\)</span>-isogeny, but there
are rare exceptions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve defined over a number field <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_l</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – the maximum prime
<span class="math notranslate nohighlight">\(\ell\)</span> to test.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_P</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – the number of primes
<span class="math notranslate nohighlight">\(P\)</span> of <span class="math notranslate nohighlight">\(K\)</span> to use in testing each <span class="math notranslate nohighlight">\(\ell\)</span>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">reducible_primes_naive</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">95</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">67</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">reducible_primes_naive</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">num_P</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[2, 5, 53, 173, 197, 241, 293, 317, 409, 557, 601, 653, 677, 769, 773, 797]</span>
<span class="gp">sage: </span><span class="n">reducible_primes_naive</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">num_P</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="go">[2, 5, 197, 557, 653, 769]</span>
<span class="gp">sage: </span><span class="n">reducible_primes_naive</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">num_P</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">reducible_primes_naive</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">()]</span>  <span class="c1"># long time</span>
<span class="go">[2, 2, 2, 5]</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="isogeny_class.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Isogeny class of elliptic curves over number fields</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="gal_reps.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Galois representations attached to elliptic curves</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Galois representations for elliptic curves over number fields</a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_B_bound"><code class="docutils literal notranslate"><span class="pre">Billerey_B_bound()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_B_l"><code class="docutils literal notranslate"><span class="pre">Billerey_B_l()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_P_l"><code class="docutils literal notranslate"><span class="pre">Billerey_P_l()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_R_bound"><code class="docutils literal notranslate"><span class="pre">Billerey_R_bound()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_R_q"><code class="docutils literal notranslate"><span class="pre">Billerey_R_q()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Frobenius_filter"><code class="docutils literal notranslate"><span class="pre">Frobenius_filter()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation"><code class="docutils literal notranslate"><span class="pre">GaloisRepresentation</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.elliptic_curve"><code class="docutils literal notranslate"><span class="pre">elliptic_curve()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.is_surjective"><code class="docutils literal notranslate"><span class="pre">is_surjective()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.isogeny_bound"><code class="docutils literal notranslate"><span class="pre">isogeny_bound()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.non_surjective"><code class="docutils literal notranslate"><span class="pre">non_surjective()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.reducible_primes"><code class="docutils literal notranslate"><span class="pre">reducible_primes()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.deg_one_primes_iter"><code class="docutils literal notranslate"><span class="pre">deg_one_primes_iter()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.reducible_primes_Billerey"><code class="docutils literal notranslate"><span class="pre">reducible_primes_Billerey()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.reducible_primes_naive"><code class="docutils literal notranslate"><span class="pre">reducible_primes_naive()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>