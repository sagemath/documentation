<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over a" href="hypellfrob.html" /><link rel="prev" title="Mestre’s algorithm" href="mestre.html" />

    <meta name="generator" content="sphinx-4.4.0, furo 2022.06.21"/>
        <title>Computation of Frobenius matrix on Monsky-Washnitzer cohomology - Elliptic curves</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZGD13B5572"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ZGD13B5572');
</script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Elliptic curves</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 9.7 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Elliptic curves</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/constructor.html">Elliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/jacobian.html">Construct elliptic curves as Jacobians</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_point.html">Points on elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_generic.html">Elliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_field.html">Elliptic curves over a general field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_finite_field.html">Elliptic curves over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/formal_group.html">Formal groups of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/hom.html">Elliptic-curve morphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/weierstrass_morphism.html">Isomorphisms between Weierstrass models of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_curve_isogeny.html">Isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/hom_velusqrt.html">√élu Algorithm for Elliptic-Curve Isogenies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/hom_composite.html">Composite morphisms of elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/isogeny_small_degree.html">Isogenies of small prime degree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_rational_field.html">Elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ec_database.html">Tables of elliptic curves of given rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_number_field.html">Elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/height.html">Canonical heights for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/saturation.html">Saturation of Mordell-Weil groups of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_torsion.html">Torsion subgroups of elliptic curves over number fields (including <span class="math notranslate nohighlight">\(\QQ\)</span>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/gal_reps.html">Galois representations attached to elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/gal_reps_number_field.html">Galois representations for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/isogeny_class.html">Isogeny class of elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/sha_tate.html">Tate-Shafarevich group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/cm.html">Complex multiplication for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/Qcurves.html">Testing whether elliptic curves over number fields are <span class="math notranslate nohighlight">\(\QQ\)</span>-curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_local_data.html">Local data for elliptic curves over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/kodaira_symbol.html">Kodaira symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_tate_curve.html">Tate’s parametrisation of <span class="math notranslate nohighlight">\(p\)</span>-adic curves with multiplicative reduction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_wp.html">Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/period_lattice.html">Period lattices of elliptic curves and related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/period_lattice_region.html">Regions in fundamental domains of period lattices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/modular_parametrization.html">Modular parametrization of elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_modular_symbols.html">Modular symbols attached to elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/mod_sym_num.html">Modular symbols by numerical integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/lseries_ell.html"><span class="math notranslate nohighlight">\(L\)</span>-series for elliptic curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/heegner.html">Heegner points on elliptic curves over the rational numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/padic_lseries.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions of elliptic curves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/descent_two_isogeny.html">Descent on elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span> with a 2-isogeny</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_egros.html">Elliptic curves with prescribed good reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/ell_padic_field.html">Elliptic curves over padic fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/gp_simon.html">Denis Simon’s PARI scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/mod5family.html">Elliptic curves with congruent mod-5 representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elliptic_curves/weierstrass_transform.html">Morphism to bring a genus-one curve into Weierstrass form</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="constructor.html">Hyperelliptic curve constructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperelliptic_generic.html">Hyperelliptic curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperelliptic_finite_field.html">Hyperelliptic curves over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperelliptic_padic_field.html">Hyperelliptic curves over a <span class="math notranslate nohighlight">\(p\)</span>-adic field</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperelliptic_rational_field.html">Hyperelliptic curves over the rationals</a></li>
<li class="toctree-l1"><a class="reference internal" href="mestre.html">Mestre’s algorithm</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Computation of Frobenius matrix on Monsky-Washnitzer cohomology</a></li>
<li class="toctree-l1"><a class="reference internal" href="hypellfrob.html">Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over a</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian_generic.html">Jacobian of a general hyperelliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian_g2.html">Jacobian of a hyperelliptic curve of genus 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian_homset.html">Rational point sets on a Jacobian</a></li>
<li class="toctree-l1"><a class="reference internal" href="jacobian_morphism.html">Jacobian ‘morphism’ as a class in the Picard group</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperelliptic_g2.html">Hyperelliptic curves of genus 2 over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="invariants.html">Compute invariants of quintics and sextics via ‘Ueberschiebung’</a></li>
<li class="toctree-l1"><a class="reference internal" href="kummer_surface.html">Kummer surfaces over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/genus2reduction.html">Conductor and reduction types for genus 2 curves</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="computation-of-frobenius-matrix-on-monsky-washnitzer-cohomology">
<span id="sage-schemes-hyperelliptic-curves-monsky-washnitzer"></span><h1>Computation of Frobenius matrix on Monsky-Washnitzer cohomology<a class="headerlink" href="#computation-of-frobenius-matrix-on-monsky-washnitzer-cohomology" title="Permalink to this headline">#</a></h1>
<span class="target" id="module-sage.schemes.hyperelliptic_curves.monsky_washnitzer"></span><p>The most interesting functions to be exported here are
<a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius"><code class="xref py py-func docutils literal notranslate"><span class="pre">matrix_of_frobenius()</span></code></a> and <a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.adjusted_prec" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.adjusted_prec"><code class="xref py py-func docutils literal notranslate"><span class="pre">adjusted_prec()</span></code></a>.</p>
<p>Currently this code is limited to the case <span class="math notranslate nohighlight">\(p \geq 5\)</span> (no
<span class="math notranslate nohighlight">\(GF(p^n)\)</span> for <span class="math notranslate nohighlight">\(n &gt; 1\)</span>), and only handles the
elliptic curve case (not more general hyperelliptic curves).</p>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../../references/index.html#ked2001" id="id1"><span>[Ked2001]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#edix" id="id2"><span>[Edix]</span></a></p></li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>David Harvey and Robert Bradshaw: initial code developed at the 2006
MSRI graduate workshop, working with Jennifer Balakrishnan and Liang
Xiao</p></li>
<li><p>David Harvey (2006-08): cleaned up, rewrote some chunks, lots more
documentation, added Newton iteration method, added more complete
‘trace trick’, integrated better into Sage.</p></li>
<li><p>David Harvey (2007-02): added algorithm with sqrt(p) complexity
(removed in May 2007 due to better C++ implementation)</p></li>
<li><p>Robert Bradshaw (2007-03): keep track of exact form in reduction
algorithms</p></li>
<li><p>Robert Bradshaw (2007-04): generalization to hyperelliptic curves</p></li>
<li><p>Julian Rueth (2014-05-09): improved caching</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">MonskyWashnitzerDifferential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/element.html#sage.structure.element.ModuleElement" title="(in Parents and Elements v9.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.element.ModuleElement</span></code></a></p>
<p>An element of the Monsky-Washnitzer ring of differentials, of
the form <span class="math notranslate nohighlight">\(F dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">x dx/2y</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">y*1 dx/2y</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">y^10*x dx/2y</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coeff">
<span class="sig-name descname"><span class="pre">coeff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coeff" title="Permalink to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(A\)</span>, where this element is <span class="math notranslate nohighlight">\(A dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">1 dx/2y</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coeff</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">()</span>
<span class="go">y*x</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coeffs">
<span class="sig-name descname"><span class="pre">coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coeffs" title="Permalink to this definition">#</a></dt>
<dd><p>Used to obtain the raw coefficients of a differential, see
<a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.coeffs" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.coeffs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SpecialHyperellipticQuotientElement.coeffs()</span></code></a></p>
<p>INPUT:</p>
<ul class="simple">
<li><p>R – An (optional) base ring in which to cast the coefficients</p></li>
</ul>
<p>OUTPUT:</p>
<p>The raw coefficients of <span class="math notranslate nohighlight">\(A\)</span> where <code class="docutils literal notranslate"><span class="pre">self</span></code> is <span class="math notranslate nohighlight">\(A dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(1, 0, 0, 0, 0)], 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 1, 0, 0, 0)], 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 0, 0, 0, 0), (1, 0, 0, 0, 0)], 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(1, 0, 0, 0, 0), (0, 0, 0, 0, 0), (0, 0, 0, 0, 0)], -2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coleman_integral">
<span class="sig-name descname"><span class="pre">coleman_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coleman_integral" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the definite integral of <code class="docutils literal notranslate"><span class="pre">self</span></code> from <span class="math notranslate nohighlight">\(P\)</span> to <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P\)</span>, <span class="math notranslate nohighlight">\(Q\)</span> – two points on the underlying curve</p></li>
</ul>
<p>OUTPUT:</p>
<p><span class="math notranslate nohighlight">\(\int_P^Q \text{self}\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">pAdicField</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="o">-</span><span class="mi">31</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2501</span><span class="o">/</span><span class="mi">108</span><span class="p">])</span> <span class="c1">#11a</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">14</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span>
<span class="go">O(5^6)</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">58332</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">2*5 + 4*5^2 + 3*5^3 + 4*5^4 + 3*5^5 + O(5^6)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">2*5 + 4*5^2 + 3*5^3 + 4*5^4 + 3*5^5 + O(5^6)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.extract_pow_y">
<span class="sig-name descname"><span class="pre">extract_pow_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.extract_pow_y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the power of <span class="math notranslate nohighlight">\(y\)</span> in <span class="math notranslate nohighlight">\(A\)</span> where <code class="docutils literal notranslate"><span class="pre">self</span></code> is <span class="math notranslate nohighlight">\(A dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">extract_pow_y</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[1, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">())</span><span class="o">.</span><span class="n">extract_pow_y</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[1, 0, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.integrate">
<span class="sig-name descname"><span class="pre">integrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.integrate" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the definite integral of <code class="docutils literal notranslate"><span class="pre">self</span></code> from <span class="math notranslate nohighlight">\(P\)</span> to <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P\)</span>, <span class="math notranslate nohighlight">\(Q\)</span> – two points on the underlying curve</p></li>
</ul>
<p>OUTPUT:</p>
<p><span class="math notranslate nohighlight">\(\int_P^Q \text{self}\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">pAdicField</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="o">-</span><span class="mi">31</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2501</span><span class="o">/</span><span class="mi">108</span><span class="p">])</span> <span class="c1">#11a</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">14</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span>
<span class="go">O(5^6)</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">58332</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">2*5 + 4*5^2 + 3*5^3 + 4*5^4 + 3*5^5 + O(5^6)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">2*5 + 4*5^2 + 3*5^3 + 4*5^4 + 3*5^5 + O(5^6)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.max_pow_y">
<span class="sig-name descname"><span class="pre">max_pow_y</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.max_pow_y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the maximum power of <span class="math notranslate nohighlight">\(y\)</span> in <span class="math notranslate nohighlight">\(A\)</span> where <code class="docutils literal notranslate"><span class="pre">self</span></code> is <span class="math notranslate nohighlight">\(A dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">max_pow_y</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">max_pow_y</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.min_pow_y">
<span class="sig-name descname"><span class="pre">min_pow_y</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.min_pow_y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the minimum power of <span class="math notranslate nohighlight">\(y\)</span> in <span class="math notranslate nohighlight">\(A\)</span> where <code class="docutils literal notranslate"><span class="pre">self</span></code> is <span class="math notranslate nohighlight">\(A dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">min_pow_y</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">min_pow_y</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce">
<span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce" title="Permalink to this definition">#</a></dt>
<dd><p>Use homology relations to find <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(f\)</span> such that this element is
equal to <span class="math notranslate nohighlight">\(a + df\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is given in terms of the <span class="math notranslate nohighlight">\(x^i dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="go">(y*x, 0 dx/2y)</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="go">(1/5*y*1, 4/5*1 dx/2y)</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">QQ</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="n">i</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0..4</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mf">3..3</span><span class="p">])</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span> <span class="o">+</span> <span class="n">a</span> <span class="o">-</span> <span class="n">w</span>
<span class="go">0 dx/2y</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_fast">
<span class="sig-name descname"><span class="pre">reduce_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">even_degree_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_fast" title="Permalink to this definition">#</a></dt>
<dd><p>Use homology relations to find <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(f\)</span> such that this element is
equal to <span class="math notranslate nohighlight">\(a + df\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is given in terms of the <span class="math notranslate nohighlight">\(x^i dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_fast</span><span class="p">()</span>
<span class="go">(x, (0, 0))</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_fast</span><span class="p">()</span>
<span class="go">(y*1, (0, 0))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_fast</span><span class="p">()</span>
<span class="go">((y^-1)*1, (0, 0))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_fast</span><span class="p">()</span>
<span class="go">((y^-11)*1, (0, 0))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_fast</span><span class="p">()</span>
<span class="go">(y^2*x, (0, 0))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y">
<span class="sig-name descname"><span class="pre">reduce_neg_y</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y" title="Permalink to this definition">#</a></dt>
<dd><p>Use homology relations to eliminate negative powers of <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y</span><span class="p">()</span>
<span class="go">((y^-1)*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y</span><span class="p">()</span>
<span class="go">((y^-1)*x + (y^-5)*x^2, 0 dx/2y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y_fast">
<span class="sig-name descname"><span class="pre">reduce_neg_y_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">even_degree_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y_fast" title="Permalink to this definition">#</a></dt>
<dd><p>Use homology relations to eliminate negative powers of <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y_fast</span><span class="p">()</span>
<span class="go">((y^-1)*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y_fast</span><span class="p">()</span>
<span class="go">((y^-1)*x + (y^-5)*x^2, 0 dx/2y)</span>
</pre></div>
</div>
<p>It leaves non-negative powers of <span class="math notranslate nohighlight">\(y\)</span> alone:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="go">(-3*1 + 5*x^4) dx/2y</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y_fast</span><span class="p">()</span>
<span class="go">(0, (-3*1 + 5*x^4) dx/2y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y_faster">
<span class="sig-name descname"><span class="pre">reduce_neg_y_faster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">even_degree_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y_faster" title="Permalink to this definition">#</a></dt>
<dd><p>Use homology relations to eliminate negative powers of <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y</span><span class="p">()</span>
<span class="go">((y^-1)*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y_faster</span><span class="p">()</span>
<span class="go">((y^-1)*x + (y^-5)*x^2, 0 dx/2y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_pos_y">
<span class="sig-name descname"><span class="pre">reduce_pos_y</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_pos_y" title="Permalink to this definition">#</a></dt>
<dd><p>Use homology relations to eliminate positive powers of <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y</span><span class="p">()</span>
<span class="go">(y^2*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y</span><span class="p">()</span>
<span class="go">(y^2*x, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">92</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y</span><span class="p">()</span>
<span class="go">(y^92*x, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">+=</span> <span class="n">w</span><span class="o">.</span><span class="n">parent</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y^3*1 + x, x dx/2y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_pos_y_fast">
<span class="sig-name descname"><span class="pre">reduce_pos_y_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">even_degree_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_pos_y_fast" title="Permalink to this definition">#</a></dt>
<dd><p>Use homology relations to eliminate positive powers of <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y^2*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y^2*x, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">92</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y^92*x, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">+=</span> <span class="n">w</span><span class="o">.</span><span class="n">parent</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y^3*1 + x, x dx/2y)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">MonskyWashnitzerDifferentialRing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_ring</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Parents and Elements v9.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.unique_representation.UniqueRepresentation</span></code></a>, <a class="reference external" href="../../../../modules/sage/modules/module.html#sage.modules.module.Module" title="(in Modules v9.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.modules.module.Module</span></code></a></p>
<p>A ring of Monsky–Washnitzer differentials over <code class="docutils literal notranslate"><span class="pre">base_ring</span></code>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.Element">
<span class="sig-name descname"><span class="pre">Element</span></span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.Element" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential"><code class="xref py py-class docutils literal notranslate"><span class="pre">MonskyWashnitzerDifferential</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.Q">
<span class="sig-name descname"><span class="pre">Q</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.Q" title="Permalink to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(Q(x)\)</span> where the model of the underlying hyperelliptic curve
of self is given by <span class="math notranslate nohighlight">\(y^2 = Q(x)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="go">x^5 - 4*x + 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.base_extend">
<span class="sig-name descname"><span class="pre">base_extend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.base_extend" title="Permalink to this definition">#</a></dt>
<dd><p>Return a new differential ring which is <code class="docutils literal notranslate"><span class="pre">self</span></code> base-extended to <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – ring</p></li>
</ul>
<p>OUTPUT:</p>
<p>Self, base-extended to <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = x^5 - 4*x + 4) over Rational Field</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = (1 + O(5^5))*x^5 + (1 + 4*5 + 4*5^2 + 4*5^3 + 4*5^4 + O(5^5))*x + 4 + O(5^5))</span>
<span class="go"> over 5-adic Field with capped relative precision 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.change_ring">
<span class="sig-name descname"><span class="pre">change_ring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.change_ring" title="Permalink to this definition">#</a></dt>
<dd><p>Return a new differential ring which is self with the coefficient
ring changed to <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – ring of coefficients</p></li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">self</span></code> with the coefficient ring changed to <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = x^5 - 4*x + 4) over Rational Field</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = (1 + O(5^5))*x^5 + (1 + 4*5 + 4*5^2 + 4*5^3 + 4*5^4 + O(5^5))*x + 4 + O(5^5))</span>
<span class="go"> over 5-adic Field with capped relative precision 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.degree">
<span class="sig-name descname"><span class="pre">degree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.degree" title="Permalink to this definition">#</a></dt>
<dd><p>Return the degree of <span class="math notranslate nohighlight">\(Q(x)\)</span>, where the model of the underlying
hyperelliptic curve of <code class="docutils literal notranslate"><span class="pre">self</span></code> is given by <span class="math notranslate nohighlight">\(y^2 = Q(x)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="go">x^5 - 4*x + 4</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.dimension" title="Permalink to this definition">#</a></dt>
<dd><p>Return the dimension of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CK</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">CK</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_Q">
<span class="sig-name descname"><span class="pre">frob_Q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_Q" title="Permalink to this definition">#</a></dt>
<dd><p>Return and cache <span class="math notranslate nohighlight">\(Q(x^p)\)</span>, which is used in computing the image of
<span class="math notranslate nohighlight">\(y\)</span> under a <span class="math notranslate nohighlight">\(p\)</span>-power lift of Frobenius to <span class="math notranslate nohighlight">\(A^{\dagger}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">frob_Q</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-(60-48*y^2+12*y^4-y^6)*1 + (192-96*y^2+12*y^4)*x - (192-48*y^2)*x^2 + 60*x^3</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">Q</span><span class="p">()(</span><span class="n">MW</span><span class="o">.</span><span class="n">x_to_p</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">-(60-48*y^2+12*y^4-y^6)*1 + (192-96*y^2+12*y^4)*x - (192-48*y^2)*x^2 + 60*x^3</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">frob_Q</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="ow">is</span> <span class="n">MW</span><span class="o">.</span><span class="n">frob_Q</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_basis_elements">
<span class="sig-name descname"><span class="pre">frob_basis_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_basis_elements" title="Permalink to this definition">#</a></dt>
<dd><p>Return the action of a <span class="math notranslate nohighlight">\(p\)</span>-power lift of Frobenius on the basis.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\{ dx/2y, x dx/2y, ..., x^{d-2} dx/2y \},\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(d\)</span> is the degree of the underlying hyperelliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">frob_basis_elements</span><span class="p">(</span><span class="n">prec</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<span class="go">[((92000*y^-14-74200*y^-12+32000*y^-10-8000*y^-8+1000*y^-6-50*y^-4)*1</span>
<span class="go">  - (194400*y^-14-153600*y^-12+57600*y^-10-9600*y^-8+600*y^-6)*x</span>
<span class="go">  + (204800*y^-14-153600*y^-12+38400*y^-10-3200*y^-8)*x^2</span>
<span class="go">  - (153600*y^-14-76800*y^-12+9600*y^-10)*x^3</span>
<span class="go">  + (63950*y^-14-18550*y^-12+1600*y^-10-400*y^-8+50*y^-6+5*y^-4)*x^4) dx/2y,</span>
<span class="go"> (-(1391200*y^-14-941400*y^-12+302000*y^-10-76800*y^-8+14400*y^-6-1320*y^-4+30*y^-2)*1</span>
<span class="go">  + (2168800*y^-14-1402400*y^-12+537600*y^-10-134400*y^-8+16800*y^-6-720*y^-4)*x</span>
<span class="go">  - (1596800*y^-14-1433600*y^-12+537600*y^-10-89600*y^-8+5600*y^-6)*x^2</span>
<span class="go">  + (1433600*y^-14-1075200*y^-12+268800*y^-10-22400*y^-8)*x^3</span>
<span class="go">  - (870200*y^-14-445350*y^-12+63350*y^-10-3200*y^-8+600*y^-6-30*y^-4-5*y^-2)*x^4) dx/2y,</span>
<span class="go"> ((19488000*y^-14-15763200*y^-12+4944400*y^-10-913800*y^-8+156800*y^-6-22560*y^-4+1480*y^-2-10)*1</span>
<span class="go">  - (28163200*y^-14-18669600*y^-12+5774400*y^-10-1433600*y^-8+268800*y^-6-25440*y^-4+760*y^-2)*x</span>
<span class="go">  + (15062400*y^-14-12940800*y^-12+5734400*y^-10-1433600*y^-8+179200*y^-6-8480*y^-4)*x^2</span>
<span class="go">  - (12121600*y^-14-11468800*y^-12+4300800*y^-10-716800*y^-8+44800*y^-6)*x^3</span>
<span class="go">  + (9215200*y^-14-6952400*y^-12+1773950*y^-10-165750*y^-8+5600*y^-6-720*y^-4+10*y^-2+5)*x^4) dx/2y,</span>
<span class="go"> (-(225395200*y^-14-230640000*y^-12+91733600*y^-10-18347400*y^-8+2293600*y^-6-280960*y^-4+31520*y^-2-1480-10*y^2)*1</span>
<span class="go">  + (338048000*y^-14-277132800*y^-12+89928000*y^-10-17816000*y^-8+3225600*y^-6-472320*y^-4+34560*y^-2-720)*x</span>
<span class="go">  - (172902400*y^-14-141504000*y^-12+58976000*y^-10-17203200*y^-8+3225600*y^-6-314880*y^-4+11520*y^-2)*x^2</span>
<span class="go">  + (108736000*y^-14-109760000*y^-12+51609600*y^-10-12902400*y^-8+1612800*y^-6-78720*y^-4)*x^3</span>
<span class="go">  - (85347200*y^-14-82900000*y^-12+31251400*y^-10-5304150*y^-8+367350*y^-6-8480*y^-4+760*y^-2+10-5*y^2)*x^4) dx/2y]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_invariant_differential">
<span class="sig-name descname"><span class="pre">frob_invariant_differential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_invariant_differential" title="Permalink to this definition">#</a></dt>
<dd><p>Kedlaya’s algorithm allows us to calculate the action of Frobenius on
the Monsky-Washnitzer cohomology. First we lift <span class="math notranslate nohighlight">\(\phi\)</span> to <span class="math notranslate nohighlight">\(A^{\dagger}\)</span>
by setting</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\phi(x) = x^p,
\qquad\qquad
\phi(y) = y^p \sqrt{1  + \frac{Q(x^p) - Q(x)^p}{Q(x)^p}}.\]</div>
</div>
<p>Pulling back the differential <span class="math notranslate nohighlight">\(dx/2y\)</span>, we get</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\phi^*(dx/2y) = px^{p-1} y(\phi(y))^{-1} dx/2y
= px^{p-1} y^{1-p} \sqrt{1+ \frac{Q(x^p) - Q(x)^p}{Q(x)^p}} dx/2y.\]</div>
</div>
<p>Use Newton’s method to calculate the square root.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">frob_invariant_differential</span><span class="p">(</span><span class="n">prec</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<span class="go">((67894400*y^-20-81198880*y^-18+40140800*y^-16-10035200*y^-14+1254400*y^-12-62720*y^-10)*1</span>
<span class="go"> - (119503944*y^-20-116064242*y^-18+43753472*y^-16-7426048*y^-14+514304*y^-12-12544*y^-10+1568*y^-8-70*y^-6-7*y^-4)*x</span>
<span class="go"> + (78905288*y^-20-61014016*y^-18+16859136*y^-16-2207744*y^-14+250880*y^-12-37632*y^-10+3136*y^-8-70*y^-6)*x^2</span>
<span class="go"> - (39452448*y^-20-26148752*y^-18+8085490*y^-16-2007040*y^-14+376320*y^-12-37632*y^-10+1568*y^-8)*x^3</span>
<span class="go"> + (21102144*y^-20-18120592*y^-18+8028160*y^-16-2007040*y^-14+250880*y^-12-12544*y^-10)*x^4) dx/2y</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.helper_matrix">
<span class="sig-name descname"><span class="pre">helper_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.helper_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>We use this to solve for the linear combination of
<span class="math notranslate nohighlight">\(x^i y^j\)</span> needed to clear all terms with <span class="math notranslate nohighlight">\(y^{j-1}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">helper_matrix</span><span class="p">()</span>
<span class="go">[ 256/2101  320/2101  400/2101  500/2101  625/2101]</span>
<span class="go">[-625/8404  -64/2101  -80/2101 -100/2101 -125/2101]</span>
<span class="go">[-125/2101 -625/8404  -64/2101  -80/2101 -100/2101]</span>
<span class="go">[-100/2101 -125/2101 -625/8404  -64/2101  -80/2101]</span>
<span class="go">[ -80/2101 -100/2101 -125/2101 -625/8404  -64/2101]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.invariant_differential">
<span class="sig-name descname"><span class="pre">invariant_differential</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.invariant_differential" title="Permalink to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(dx/2y\)</span> as an element of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="go">1 dx/2y</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.x_to_p">
<span class="sig-name descname"><span class="pre">x_to_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.x_to_p" title="Permalink to this definition">#</a></dt>
<dd><p>Return and cache <span class="math notranslate nohighlight">\(x^p\)</span>, reduced via the relations coming from the
defining polynomial of the hyperelliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">x_to_p</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">x^3</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">x_to_p</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-(4-y^2)*1 + 4*x</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">x_to_p</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span> <span class="ow">is</span> <span class="n">MW</span><span class="o">.</span><span class="n">x_to_p</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing_class">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">MonskyWashnitzerDifferentialRing_class</span></span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing_class" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">SpecialCubicQuotientRing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laurent_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../rings/sage/rings/ring.html#sage.rings.ring.CommutativeAlgebra" title="(in General Rings, Ideals, and Morphisms v9.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.rings.ring.CommutativeAlgebra</span></code></a></p>
<p>Specialised class for representing the quotient ring
<span class="math notranslate nohighlight">\(R[x,T]/(T - x^3 - ax - b)\)</span>, where <span class="math notranslate nohighlight">\(R\)</span> is an
arbitrary commutative base ring (in which 2 and 3 are invertible),
<span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are elements of that ring.</p>
<p>Polynomials are represented internally in the form
<span class="math notranslate nohighlight">\(p_0 + p_1 x + p_2 x^2\)</span> where the <span class="math notranslate nohighlight">\(p_i\)</span> are
polynomials in <span class="math notranslate nohighlight">\(T\)</span>. Multiplication of polynomials always
reduces high powers of <span class="math notranslate nohighlight">\(x\)</span> (i.e. beyond <span class="math notranslate nohighlight">\(x^2\)</span>) to
powers of <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p>Hopefully this ring is faster than a general quotient ring because
it uses the special structure of this ring to speed multiplication
(which is the dominant operation in the frobenius matrix
calculation). I haven’t actually tested this theory though…</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>Eventually we will want to run this in characteristic 3, so we
need to: (a) Allow <span class="math notranslate nohighlight">\(Q(x)\)</span> to contain an <span class="math notranslate nohighlight">\(x^2\)</span> term, and (b) Remove
the requirement that 3 be invertible. Currently this is used in
the Toom-Cook algorithm to speed multiplication.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">SpecialCubicQuotientRing over Ring of integers modulo 125</span>
<span class="go">with polynomial T = x^3 + 124*x + 94</span>
</pre></div>
</div>
<p>Get generators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span>
<span class="go">(0) + (1)*x + (0)*x^2</span>
<span class="gp">sage: </span><span class="n">T</span>
<span class="go">(T) + (0)*x + (0)*x^2</span>
</pre></div>
</div>
<p>Coercions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(7) + (0)*x + (0)*x^2</span>
</pre></div>
</div>
<p>Create elements directly from polynomials:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">poly_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">Univariate Polynomial Ring in T over Ring of integers modulo 125</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">(T^2) + (T + 1)*x + (3)*x^2</span>
</pre></div>
</div>
<p>Some arithmetic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="go">(T + 31) + (1)*x + (0)*x^2</span>
<span class="gp">sage: </span><span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">15</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="n">T</span>
<span class="go">(3*T^7 + 90*T^6 + 110*T^5 + 20*T^4 + 58*T^3 + 26*T^2 + 124*T) +</span>
<span class="go">(15*T^6 + 110*T^5 + 35*T^4 + 63*T^2 + 1)*x +</span>
<span class="go">(30*T^5 + 40*T^4 + 8*T^3 + 38*T^2)*x^2</span>
</pre></div>
</div>
<p>Retrieve coefficients (output is zero-padded):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">^</span><span class="mi">10</span>
<span class="go">(3*T^2 + 61*T + 8) + (T^3 + 93*T^2 + 12*T + 40)*x + (3*T^2 + 61*T + 9)*x^2</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">[[8, 61, 3, 0], [40, 12, 93, 1], [9, 61, 3, 0]]</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>write an example checking multiplication of these polynomials
against Sage’s ordinary quotient ring arithmetic. I cannot seem
to get the quotient ring stuff happening right now…</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.Element">
<span class="sig-name descname"><span class="pre">Element</span></span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.Element" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpecialCubicQuotientRingElement</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.create_element">
<span class="sig-name descname"><span class="pre">create_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">check</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.create_element" title="Permalink to this definition">#</a></dt>
<dd><p>Create the element <span class="math notranslate nohighlight">\(p_0 + p_1*x + p_2*x^2\)</span>, where the <span class="math notranslate nohighlight">\(p_i\)</span>
are polynomials in <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p0,</span> <span class="pre">p1,</span> <span class="pre">p2</span></code> – coefficients; must be coercible
into poly_ring()</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – bool (default True): whether to carry
out coercion</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">poly_ring</span><span class="p">()</span><span class="o">.</span><span class="n">objgen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># indirect doctest</span>
<span class="go">(T^2) + (T + 1)*x + (3)*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.gens">
<span class="sig-name descname"><span class="pre">gens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.gens" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list [x, T] where x and T are the generators of the ring
(as element <em>of this ring</em>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>I have no idea if this is compatible with the usual Sage
‘gens’ interface.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span>
<span class="go">(0) + (1)*x + (0)*x^2</span>
<span class="gp">sage: </span><span class="n">T</span>
<span class="go">(T) + (0)*x + (0)*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.one">
<span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.one" title="Permalink to this definition">#</a></dt>
<dd><p>Return the unit of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">(1) + (0)*x + (0)*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.poly_ring">
<span class="sig-name descname"><span class="pre">poly_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.poly_ring" title="Permalink to this definition">#</a></dt>
<dd><p>Return the underlying polynomial ring in <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">poly_ring</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in T over Ring of integers modulo 125</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">SpecialCubicQuotientRingElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/element.html#sage.structure.element.CommutativeAlgebraElement" title="(in Parents and Elements v9.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.element.CommutativeAlgebraElement</span></code></a></p>
<p>An element of a SpecialCubicQuotientRing.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.coeffs">
<span class="sig-name descname"><span class="pre">coeffs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.coeffs" title="Permalink to this definition">#</a></dt>
<dd><p>Return list of three lists of coefficients, corresponding to the
<span class="math notranslate nohighlight">\(x^0\)</span>, <span class="math notranslate nohighlight">\(x^1\)</span>, <span class="math notranslate nohighlight">\(x^2\)</span> coefficients.</p>
<p>The lists are zero padded to the same length. The list entries
belong to the base ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">[[0, 1, 0], [123, 0, 1], [3, 0, 0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.scalar_multiply">
<span class="sig-name descname"><span class="pre">scalar_multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.scalar_multiply" title="Permalink to this definition">#</a></dt>
<dd><p>Multiply this element by a scalar, i.e. just multiply each
coefficient of <span class="math notranslate nohighlight">\(x^j\)</span> by the scalar.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scalar</span></code> – either an element of base_ring, or an
element of poly_ring.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">(2) + (T)*x + (T^2 + 122)*x^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">scalar_multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(4) + (2*T)*x + (2*T^2 + 119)*x^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">scalar_multiply</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">(2*T) + (T^2)*x + (T^3 + 122*T)*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.shift">
<span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.shift" title="Permalink to this definition">#</a></dt>
<dd><p>Return this element multiplied by <span class="math notranslate nohighlight">\(T^n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">(2) + (T)*x + (T^2 + 122)*x^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(2*T) + (T^2)*x + (T^3 + 122*T)*x^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2*T^2) + (T^3)*x + (T^4 + 122*T^2)*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.square">
<span class="sig-name descname"><span class="pre">square</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.square" title="Permalink to this definition">#</a></dt>
<dd><p>Return the square of the element.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">square</span><span class="p">()</span>
<span class="go">(73*T^5 + 16*T^4 + 38*T^3 + 39*T^2 + 70*T + 120) + (121*T^5 + 113*T^4 + 73*T^3 + 8*T^2 + 51*T + 61)*x + (18*T^4 + 60*T^3 + 22*T^2 + 108*T + 31)*x^2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">SpecialHyperellipticQuotientElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/element.html#sage.structure.element.CommutativeAlgebraElement" title="(in Parents and Elements v9.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.element.CommutativeAlgebraElement</span></code></a></p>
<p>Element in the Hyperelliptic quotient ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">36</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">77</span><span class="p">)</span>
<span class="go">-(77-y)*1 + x + x^2</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.change_ring">
<span class="sig-name descname"><span class="pre">change_ring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.change_ring" title="Permalink to this definition">#</a></dt>
<dd><p>Return the same element after changing the base ring to <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">36</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">MW</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">77</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">AA</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = x^5 - 36*x + 1) over Algebraic Real Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.coeffs">
<span class="sig-name descname"><span class="pre">coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.coeffs" title="Permalink to this definition">#</a></dt>
<dd><p>Return the raw coefficients of this element.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – an (optional) base-ring in which to cast the coefficients</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coeffs</span></code> – a list of coefficients of powers of <span class="math notranslate nohighlight">\(x\)</span> for each power
of <span class="math notranslate nohighlight">\(y\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an offset indicating the power of <span class="math notranslate nohighlight">\(y\)</span> of the first list
element</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 1, 0, 0, 0)], 0)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 0, 0, 0, 0), (1, 0, 0, 0, 0)], 0)</span>

<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="n">a</span>
<span class="go">x + 2*x^2 + 3*x^3 + 4*x^4</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 1, 2, 3, 4)], 0)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">coeffs</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">([(0, 1 + O(7^20), 2 + O(7^20), 3 + O(7^20), 4 + O(7^20))], 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 0, 0, 0, 0), (0, 1, 2, 3, 4)], 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">^-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 1, 2, 3, 4), (0, 0, 0, 0, 0), (0, 0, 0, 0, 0)], -2)</span>
</pre></div>
</div>
<p>Note that the coefficient list is transposed compared to how they
are stored and printed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">^-</span><span class="mi">2</span>
<span class="go">(y^-2)*x + (2*y^-2)*x^2 + (3*y^-2)*x^3 + (4*y^-2)*x^4</span>
</pre></div>
</div>
<p>A more complicated example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">20</span><span class="o">*</span><span class="n">y</span><span class="o">^-</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">11</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span> <span class="n">a</span>
<span class="go">(y^-3-4*y^-1+6*y-4*y^3+y^5)*1 - (12*y^-3-36*y^-1+36*y+y^2-12*y^3-2*y^4+y^6)*x</span>
<span class="go"> + (54*y^-3-108*y^-1+54*y+6*y^2-6*y^4)*x^2 - (108*y^-3-108*y^-1+9*y^2)*x^3 + (81*y^-3)*x^4</span>
<span class="gp">sage: </span><span class="n">raw</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">min_pow_y</span><span class="p">()</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">offset</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">raw</span>
<span class="go">[(1, -12, 54, -108, 81),</span>
<span class="go"> (0, 0, 0, 0, 0),</span>
<span class="go"> (-4, 36, -108, 108, 0),</span>
<span class="go"> (0, 0, 0, 0, 0),</span>
<span class="go"> (6, -36, 54, 0, 0),</span>
<span class="go"> (0, -1, 6, -9, 0),</span>
<span class="go"> (-4, 12, 0, 0, 0),</span>
<span class="go"> (0, 2, -6, 0, 0),</span>
<span class="go"> (1, 0, 0, 0, 0),</span>
<span class="go"> (0, -1, 0, 0, 0)]</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="n">i</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">offset</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">L</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">L</span><span class="p">))</span> <span class="o">==</span> <span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Can also be used to construct elements:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">parent</span><span class="p">()(</span><span class="n">raw</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.diff">
<span class="sig-name descname"><span class="pre">diff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.diff" title="Permalink to this definition">#</a></dt>
<dd><p>Return the differential of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="go">(-(9-2*y)*1 + 15*x^4) dx/2y</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.extract_pow_y">
<span class="sig-name descname"><span class="pre">extract_pow_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.extract_pow_y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the coefficients of <span class="math notranslate nohighlight">\(y^k\)</span> in <code class="docutils literal notranslate"><span class="pre">self</span></code> as a list.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">9</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">extract_pow_y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[3, 9, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.max_pow_y">
<span class="sig-name descname"><span class="pre">max_pow_y</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.max_pow_y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the maximal degree of <code class="docutils literal notranslate"><span class="pre">self</span></code> with respect to <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">max_pow_y</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.min_pow_y">
<span class="sig-name descname"><span class="pre">min_pow_y</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.min_pow_y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the minimal degree of <code class="docutils literal notranslate"><span class="pre">self</span></code> with respect to <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">min_pow_y</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.truncate_neg">
<span class="sig-name descname"><span class="pre">truncate_neg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.truncate_neg" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">self</span></code> minus its terms of degree less than <span class="math notranslate nohighlight">\(n\)</span> wrt <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">truncate_neg</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">3*y*1 + 14*y^4*x</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">SpecialHyperellipticQuotientRing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Parents and Elements v9.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.unique_representation.UniqueRepresentation</span></code></a>, <a class="reference external" href="../../../../rings/sage/rings/ring.html#sage.rings.ring.CommutativeAlgebra" title="(in General Rings, Ideals, and Morphisms v9.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.rings.ring.CommutativeAlgebra</span></code></a></p>
<p>The special hyperelliptic quotient ring.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.Element">
<span class="sig-name descname"><span class="pre">Element</span></span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.Element" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpecialHyperellipticQuotientElement</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.Q">
<span class="sig-name descname"><span class="pre">Q</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.Q" title="Permalink to this definition">#</a></dt>
<dd><p>Return the defining polynomial of the underlying hyperelliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="go">x^5 - 2*x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.base_extend">
<span class="sig-name descname"><span class="pre">base_extend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.base_extend" title="Permalink to this definition">#</a></dt>
<dd><p>Return the base extension of <code class="docutils literal notranslate"><span class="pre">self</span></code> to the ring <code class="docutils literal notranslate"><span class="pre">R</span></code> if possible.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">UniversalCyclotomicField</span><span class="p">())</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = x^5 - 3*x + 1) over Universal Cyclotomic Field</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: no such base extension</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.change_ring">
<span class="sig-name descname"><span class="pre">change_ring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.change_ring" title="Permalink to this definition">#</a></dt>
<dd><p>Return the analog of <code class="docutils literal notranslate"><span class="pre">self</span></code> over the ring <code class="docutils literal notranslate"><span class="pre">R</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = x^5 - 3*x + 1) over Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.curve">
<span class="sig-name descname"><span class="pre">curve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.curve" title="Permalink to this definition">#</a></dt>
<dd><p>Return the underlying hyperelliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Hyperelliptic Curve over Rational Field defined by y^2 = x^5 - 3*x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.degree">
<span class="sig-name descname"><span class="pre">degree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.degree" title="Permalink to this definition">#</a></dt>
<dd><p>Return the degree of the underlying hyperelliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.gens">
<span class="sig-name descname"><span class="pre">gens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.gens" title="Permalink to this definition">#</a></dt>
<dd><p>Return the generators of <code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(x, y*1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.is_field">
<span class="sig-name descname"><span class="pre">is_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.is_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">False</span></code> as <code class="docutils literal notranslate"><span class="pre">self</span></code> is not a field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">is_field</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial">
<span class="sig-name descname"><span class="pre">monomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial" title="Permalink to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(b y^j x^i\)</span>, computed quickly.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">y^5*x^4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial_diff_coeffs">
<span class="sig-name descname"><span class="pre">monomial_diff_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial_diff_coeffs" title="Permalink to this definition">#</a></dt>
<dd><p>Compute coefficients of the basis representation of <span class="math notranslate nohighlight">\(d(x^iy^j)\)</span>.</p>
<p>The key here is that the formula for <span class="math notranslate nohighlight">\(d(x^iy^j)\)</span> is messy
in terms of <span class="math notranslate nohighlight">\(i\)</span>, but varies nicely with <span class="math notranslate nohighlight">\(j\)</span>.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[d(x^iy^j) = y^{j-1} (2ix^{i-1}y^2 + j (A_i(x) + B_i(x)y^2)) \frac{dx}{2y},\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(A,B\)</span> have degree at most <span class="math notranslate nohighlight">\(n-1\)</span> for each
<span class="math notranslate nohighlight">\(i\)</span>. Pre-compute <span class="math notranslate nohighlight">\(A_i, B_i\)</span> for each <span class="math notranslate nohighlight">\(i\)</span>
the “hard” way, and the rest are easy.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">monomial_diff_coeffs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">((0, -15, 36, 0, 0), (0, 19, 0, 0, 0))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial_diff_coeffs_matrices">
<span class="sig-name descname"><span class="pre">monomial_diff_coeffs_matrices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial_diff_coeffs_matrices" title="Permalink to this definition">#</a></dt>
<dd><p>Compute tables of coefficients of the basis representation
of <span class="math notranslate nohighlight">\(d(x^iy^j)\)</span> for small <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">monomial_diff_coeffs_matrices</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">[0 5 0 0 0]  [0 2 0 0 0]</span>
<span class="go">[0 0 5 0 0]  [0 0 4 0 0]</span>
<span class="go">[0 0 0 5 0]  [0 0 0 6 0]</span>
<span class="go">[0 0 0 0 5]  [0 0 0 0 8]</span>
<span class="go">[0 0 0 0 0], [0 0 0 0 0]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monsky_washnitzer">
<span class="sig-name descname"><span class="pre">monsky_washnitzer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monsky_washnitzer" title="Permalink to this definition">#</a></dt>
<dd><p>Return the stored Monsky-Washnitzer differential ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">monsky_washnitzer</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing_with_category&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.one">
<span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.one" title="Permalink to this definition">#</a></dt>
<dd><p>Return the unit of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.prime">
<span class="sig-name descname"><span class="pre">prime</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.prime" title="Permalink to this definition">#</a></dt>
<dd><p>Return the stored prime number <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">prime</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.x">
<span class="sig-name descname"><span class="pre">x</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.x" title="Permalink to this definition">#</a></dt>
<dd><p>Return the generator <span class="math notranslate nohighlight">\(x\)</span> of <code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
<span class="go">x</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.y">
<span class="sig-name descname"><span class="pre">y</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the generator <span class="math notranslate nohighlight">\(y\)</span> of <code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
<span class="go">y*1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.zero">
<span class="sig-name descname"><span class="pre">zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.zero" title="Permalink to this definition">#</a></dt>
<dd><p>Return the zero of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing_class">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">SpecialHyperellipticQuotientRing_class</span></span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing_class" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.adjusted_prec">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">adjusted_prec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.adjusted_prec" title="Permalink to this definition">#</a></dt>
<dd><p>Compute how much precision is required in <code class="docutils literal notranslate"><span class="pre">matrix_of_frobenius</span></code> to
get an answer correct to <code class="docutils literal notranslate"><span class="pre">prec</span></code> <span class="math notranslate nohighlight">\(p\)</span>-adic digits.</p>
<p>The issue is that the algorithm used in
<a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius"><code class="xref py py-func docutils literal notranslate"><span class="pre">matrix_of_frobenius()</span></code></a> sometimes performs divisions by <span class="math notranslate nohighlight">\(p\)</span>,
so precision is lost during the algorithm.</p>
<p>The estimate returned by this function is based on Kedlaya’s result
(Lemmas 2 and 3 of <a class="reference internal" href="../../../../references/index.html#ked2001" id="id5"><span>[Ked2001]</span></a>),
which implies that if we start with <span class="math notranslate nohighlight">\(M\)</span> <span class="math notranslate nohighlight">\(p\)</span>-adic
digits, the total precision loss is at most
<span class="math notranslate nohighlight">\(1 + \lfloor \log_p(2M-3) \rfloor\)</span> <span class="math notranslate nohighlight">\(p\)</span>-adic
digits. (This estimate is somewhat less than the amount you would
expect by naively counting the number of divisions by
<span class="math notranslate nohighlight">\(p\)</span>.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">&gt;=</span> <span class="pre">5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – integer, desired output precision, <code class="docutils literal notranslate"><span class="pre">prec</span> <span class="pre">&gt;=</span> <span class="pre">1</span></code></p></li>
</ul>
<p>OUTPUT: adjusted precision (usually slightly more than <code class="docutils literal notranslate"><span class="pre">prec</span></code>)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">adjusted_prec</span>
<span class="gp">sage: </span><span class="n">adjusted_prec</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.frobenius_expansion_by_newton">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">frobenius_expansion_by_newton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.frobenius_expansion_by_newton" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the action of Frobenius on <span class="math notranslate nohighlight">\(dx/y\)</span> and on
<span class="math notranslate nohighlight">\(x dx/y\)</span>, using Newton’s method (as suggested in Kedlaya’s
paper <a class="reference internal" href="../../../../references/index.html#ked2001" id="id6"><span>[Ked2001]</span></a>).</p>
<p>(This function does <em>not</em> yet use the cohomology relations - that
happens afterwards in the “reduction” step.)</p>
<p>More specifically, it finds <span class="math notranslate nohighlight">\(F_0\)</span> and <span class="math notranslate nohighlight">\(F_1\)</span> in
the quotient ring <span class="math notranslate nohighlight">\(R[x, T]/(T - Q(x))\)</span>, such that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[F(  dx/y) = T^{-r} F0 dx/y, \text{\ and\ } F(x dx/y) = T^{-r} F1 dx/y\]</div>
</div>
<p>where</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[r = ( (2M-3)p - 1 )/2.\]</div>
</div>
<p>(Here <span class="math notranslate nohighlight">\(T\)</span> is <span class="math notranslate nohighlight">\(y^2 = z^{-2}\)</span>, and <span class="math notranslate nohighlight">\(R\)</span> is the
coefficient ring of <span class="math notranslate nohighlight">\(Q\)</span>.)</p>
<p><span class="math notranslate nohighlight">\(F_0\)</span> and <span class="math notranslate nohighlight">\(F_1\)</span> are computed in the
SpecialCubicQuotientRing associated to <span class="math notranslate nohighlight">\(Q\)</span>, so all powers
of <span class="math notranslate nohighlight">\(x^j\)</span> for <span class="math notranslate nohighlight">\(j \geq 3\)</span> are reduced to powers of
<span class="math notranslate nohighlight">\(T\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – cubic polynomial of the form
<span class="math notranslate nohighlight">\(Q(x) = x^3 + ax + b\)</span>, whose coefficient ring is a
<span class="math notranslate nohighlight">\(Z/(p^M)Z\)</span>-algebra</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – residue characteristic of the p-adic field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> – p-adic precision of the coefficient ring
(this will be used to determine the number of Newton iterations)</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">F0,</span> <span class="pre">F1</span></code> – elements of
SpecialCubicQuotientRing(Q), as described above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> – non-negative integer, as described above</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">frobenius_expansion_by_newton</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">frobenius_expansion_by_newton</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">((25*T^5 + 75*T^3 + 100*T^2 + 100*T + 100) + (5*T^6 + 80*T^5 + 100*T^3</span>
<span class="go">+ 25*T + 50)*x + (55*T^5 + 50*T^4 + 75*T^3 + 25*T^2 + 25*T + 25)*x^2,</span>
<span class="go">(5*T^8 + 15*T^7 + 95*T^6 + 10*T^5 + 25*T^4 + 25*T^3 + 100*T^2 + 50)</span>
<span class="go">+ (65*T^7 + 55*T^6 + 70*T^5 + 100*T^4 + 25*T^2 + 100*T)*x</span>
<span class="go">+ (15*T^6 + 115*T^5 + 75*T^4 + 100*T^3 + 50*T^2 + 75*T + 75)*x^2, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.frobenius_expansion_by_series">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">frobenius_expansion_by_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.frobenius_expansion_by_series" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the action of Frobenius on <span class="math notranslate nohighlight">\(dx/y\)</span> and on <span class="math notranslate nohighlight">\(x dx/y\)</span>, using a
series expansion.</p>
<p>(This function computes the same thing as
frobenius_expansion_by_newton(), using a different method.
Theoretically the Newton method should be asymptotically faster,
when the precision gets large. However, in practice, this functions
seems to be marginally faster for moderate precision, so I’m
keeping it here until I figure out exactly why it is faster.)</p>
<p>(This function does <em>not</em> yet use the cohomology relations - that
happens afterwards in the “reduction” step.)</p>
<p>More specifically, it finds F0 and F1 in the quotient ring
<span class="math notranslate nohighlight">\(R[x, T]/(T - Q(x))\)</span>, such that
<span class="math notranslate nohighlight">\(F(  dx/y) = T^{-r} F0 dx/y\)</span>, and
<span class="math notranslate nohighlight">\(F(x dx/y) = T^{-r} F1 dx/y\)</span> where
<span class="math notranslate nohighlight">\(r = ( (2M-3)p - 1 )/2\)</span>. (Here <span class="math notranslate nohighlight">\(T\)</span> is <span class="math notranslate nohighlight">\(y^2 = z^{-2}\)</span>,
and <span class="math notranslate nohighlight">\(R\)</span> is the coefficient ring of <span class="math notranslate nohighlight">\(Q\)</span>.)</p>
<p><span class="math notranslate nohighlight">\(F_0\)</span> and <span class="math notranslate nohighlight">\(F_1\)</span> are computed in the
SpecialCubicQuotientRing associated to <span class="math notranslate nohighlight">\(Q\)</span>, so all powers
of <span class="math notranslate nohighlight">\(x^j\)</span> for <span class="math notranslate nohighlight">\(j \geq 3\)</span> are reduced to powers of
<span class="math notranslate nohighlight">\(T\)</span>.</p>
<p>It uses the sum</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[F0 = \sum_{k=0}^{M-2} \binom{-1/2}{k} p x^{p-1} E^k T^{(M-2-k)p}\]</div>
</div>
<p>and</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}    F1 = x^p F0,\\where `E = Q(x^p) - Q(x)^p`.\end{aligned}\end{align} \]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – cubic polynomial of the form
<span class="math notranslate nohighlight">\(Q(x) = x^3 + ax + b\)</span>, whose coefficient ring is a
<span class="math notranslate nohighlight">\(\ZZ/(p^M)\ZZ\)</span> -algebra</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – residue characteristic of the <span class="math notranslate nohighlight">\(p\)</span>-adic field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> – <span class="math notranslate nohighlight">\(p\)</span>-adic precision of the coefficient ring
(this will be used to determine the number of terms in the
series)</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">F0,</span> <span class="pre">F1</span></code> – elements of
SpecialCubicQuotientRing(Q), as described above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> – non-negative integer, as described above</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">frobenius_expansion_by_series</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">frobenius_expansion_by_series</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">((25*T^5 + 75*T^3 + 100*T^2 + 100*T + 100) + (5*T^6 + 80*T^5 + 100*T^3</span>
<span class="go">+ 25*T + 50)*x + (55*T^5 + 50*T^4 + 75*T^3 + 25*T^2 + 25*T + 25)*x^2,</span>
<span class="go">(5*T^8 + 15*T^7 + 95*T^6 + 10*T^5 + 25*T^4 + 25*T^3 + 100*T^2 + 50)</span>
<span class="go">+ (65*T^7 + 55*T^6 + 70*T^5 + 100*T^4 + 25*T^2 + 100*T)*x</span>
<span class="go">+ (15*T^6 + 115*T^5 + 75*T^4 + 100*T^3 + 50*T^2 + 75*T + 75)*x^2, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.helper_matrix">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">helper_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.helper_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the (constant) matrix used to calculate the linear
combinations of the <span class="math notranslate nohighlight">\(d(x^i y^j)\)</span> needed to eliminate the
negative powers of <span class="math notranslate nohighlight">\(y\)</span> in the cohomology (i.e. in
reduce_negative()).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – cubic polynomial</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">helper_matrix</span>
<span class="gp">sage: </span><span class="n">helper_matrix</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">-</span><span class="mi">691</span><span class="p">)</span>
<span class="go">[     64/12891731  -16584/12891731 4297329/12891731]</span>
<span class="go">[   6219/12891731     -32/12891731    8292/12891731]</span>
<span class="go">[    -24/12891731    6219/12891731     -32/12891731]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.lift">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">lift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.lift" title="Permalink to this definition">#</a></dt>
<dd><p>Try to call x.lift(), presumably from the <span class="math notranslate nohighlight">\(p\)</span>-adics to ZZ.</p>
<p>If this fails, it assumes the input is a power series, and tries to
lift it to a power series over QQ.</p>
<p>This function is just a very kludgy solution to the problem of
trying to make the reduction code (below) work over both Zp and
Zp[[t]].</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">lift</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">lift</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">13</span><span class="p">)(</span><span class="mi">131</span><span class="p">));</span> <span class="n">l</span>
<span class="go">131</span>
<span class="gp">sage: </span><span class="n">l</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Integer Ring</span>

<span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">lift</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">17</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span><span class="p">);</span> <span class="n">l</span>
<span class="go">4 + 5*t + 17*t^6</span>
<span class="gp">sage: </span><span class="n">l</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Power Series Ring in t over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">matrix_of_frobenius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_exact_forms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the matrix of Frobenius on Monsky-Washnitzer cohomology,
with respect to the basis <span class="math notranslate nohighlight">\((dx/y, x dx/y)\)</span>.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – cubic polynomial <span class="math notranslate nohighlight">\(Q(x) = x^3 + ax + b\)</span>
defining an elliptic curve <span class="math notranslate nohighlight">\(E\)</span> by
<span class="math notranslate nohighlight">\(y^2 = Q(x)\)</span>. The coefficient ring of <span class="math notranslate nohighlight">\(Q\)</span> should be a
<span class="math notranslate nohighlight">\(\ZZ/(p^M)\ZZ\)</span>-algebra in which the matrix of
frobenius will be constructed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime &gt;= 5 for which E has good reduction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> – integer &gt;= 2; <span class="math notranslate nohighlight">\(p\)</span> -adic precision of the coefficient ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trace</span></code> – (optional) the trace of the matrix, if
known in advance. This is easy to compute because it is just the
<span class="math notranslate nohighlight">\(a_p\)</span> of the curve. If the trace is supplied,
matrix_of_frobenius will use it to speed the computation (i.e. we
know the determinant is <span class="math notranslate nohighlight">\(p\)</span>, so we have two conditions, so
really only column of the matrix needs to be computed. it is
actually a little more complicated than that, but that’s the basic
idea.) If trace=None, then both columns will be computed
independently, and you can get a strong indication of correctness
by verifying the trace afterwards.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>THE RESULT WILL NOT NECESSARILY BE CORRECT TO M p-ADIC
DIGITS. If you want prec digits of precision, you need to use
the function adjusted_prec(), and then you need to reduce the
answer mod <span class="math notranslate nohighlight">\(p^{\mathrm{prec}}\)</span> at the end.</p>
</div>
</li>
</ul>
<p>OUTPUT:</p>
<p><span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix of Frobenius acting on Monsky-Washnitzer cohomology,
with entries in the coefficient ring of <code class="docutils literal notranslate"><span class="pre">Q</span></code>.</p>
<p>EXAMPLES:</p>
<p>A simple example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">);</span> <span class="n">M</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[340  62]</span>
<span class="go">[ 70 533]</span>
</pre></div>
</div>
<p>But the result is only accurate to <code class="docutils literal notranslate"><span class="pre">prec</span></code> digits:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span>
<span class="go">[90 62]</span>
<span class="go">[70 33]</span>
</pre></div>
</div>
<p>Check trace (123 = -2 mod 125) and determinant:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">123</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-2</span>
</pre></div>
</div>
<p>Try using the trace to speed up the calculation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span>
<span class="gp">....: </span>                                          <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[ 90  62]</span>
<span class="go">[320 533]</span>
</pre></div>
</div>
<p>Hmmm… it looks different, but that’s because the trace of our
first answer was only -2 modulo <span class="math notranslate nohighlight">\(5^3\)</span>, not -2 modulo
<span class="math notranslate nohighlight">\(5^5\)</span>. So the right answer is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>
<span class="go">[90 62]</span>
<span class="go">[70 33]</span>
</pre></div>
</div>
<p>Check it works with only one digit of precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="go">[0 2]</span>
<span class="go">[0 3]</span>
</pre></div>
</div>
<p>Here is an example that is particularly badly conditioned for
using the trace trick:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>
<span class="go">[1144  176]</span>
<span class="go">[ 847  185]</span>
</pre></div>
</div>
<p>The problem here is that the top-right entry is divisible by 11,
and the bottom-left entry is divisible by <span class="math notranslate nohighlight">\(11^2\)</span>. So when
you apply the trace trick, neither <span class="math notranslate nohighlight">\(F(dx/y)\)</span> nor
<span class="math notranslate nohighlight">\(F(x dx/y)\)</span> is enough to compute the whole matrix to the
desired precision, even if you try increasing the target precision
by one. Nevertheless, <code class="docutils literal notranslate"><span class="pre">matrix_of_frobenius</span></code> knows
how to get the right answer by evaluating <span class="math notranslate nohighlight">\(F((x+1) dx/y)\)</span>
instead:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>
<span class="go">[1144  176]</span>
<span class="go">[ 847  185]</span>
</pre></div>
</div>
<p>The running time is about <code class="docutils literal notranslate"><span class="pre">O(p*prec**2)</span></code> (times some logarithmic
factors), so it is feasible to run on fairly large primes, or
precision (or both?!?!):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">10007</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span>            <span class="c1"># long time</span>
<span class="gp">....: </span>                          <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>     <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">));</span> <span class="n">B</span>               <span class="c1"># long time</span>
<span class="go">[74311982 57996908]</span>
<span class="go">[95877067 25828133]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>                                               <span class="c1"># long time</span>
<span class="go">10007</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>                                             <span class="c1"># long time</span>
<span class="go">66</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">10007</span><span class="p">)</span>                    <span class="c1"># long time</span>
<span class="go">66</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">300</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span>            <span class="c1"># long time</span>
<span class="gp">....: </span>                          <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>     <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>                  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>                                               <span class="c1"># long time</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="o">-</span><span class="n">B</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>                                            <span class="c1"># long time</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                        <span class="c1"># long time</span>
<span class="go">-2</span>
</pre></div>
</div>
<p>Let us check consistency of the results for a range of precisions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">max_prec</span> <span class="o">=</span> <span class="mi">60</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>         <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">max_prec</span><span class="p">))</span>              <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>                                           <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">):</span>                       <span class="c1"># long time</span>
<span class="gp">....: </span>    <span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>      <span class="c1"># long time</span>
<span class="gp">....: </span>    <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="n">M</span><span class="p">),</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>         <span class="c1"># long time</span>
<span class="gp">....: </span>    <span class="n">B</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span>        <span class="c1"># long time</span>
<span class="gp">....: </span>                      <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>         <span class="c1"># long time</span>
<span class="gp">....: </span>    <span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>              <span class="c1"># long time</span>
<span class="gp">....: </span>    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span>                 <span class="c1"># long time</span>
<span class="gp">....: </span>                             <span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">)))</span>      <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">result</span> <span class="o">==</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_prec</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>                     <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The remaining examples discuss what happens when you take the
coefficient ring to be a power series ring; i.e. in effect you’re
looking at a family of curves.</p>
<p>The code does in fact work…</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">),</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>    <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">),</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>        <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">B</span>                                                     <span class="c1"># long time</span>
<span class="go">[1144 + 264*t + 841*t^2 + 1025*t^3 + O(t^4)  176 + 1052*t + 216*t^2 + 523*t^3 + O(t^4)]</span>
<span class="go">[   847 + 668*t + 81*t^2 + 424*t^3 + O(t^4)   185 + 341*t + 171*t^2 + 642*t^3 + O(t^4)]</span>
</pre></div>
</div>
<p>The trace trick should work for power series rings too, even in the
badly-conditioned case. Unfortunately I do not know how to compute
the trace in advance, so I am not sure exactly how this would help.
Also, I suspect the running time will be dominated by the
expansion, so the trace trick will not really speed things up anyway.
Another problem is that the determinant is not always p:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>                                               <span class="c1"># long time</span>
<span class="go">11 + 484*t^2 + 451*t^3 + O(t^4)</span>
</pre></div>
</div>
<p>However, it appears that the determinant always has the property
that if you substitute t - 11t, you do get the constant series p
(mod p**prec). Similarly for the trace. And since the parameter
only really makes sense when it is divisible by p anyway, perhaps
this is not a problem after all.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius_hyperelliptic">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">matrix_of_frobenius_hyperelliptic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius_hyperelliptic" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the matrix of Frobenius on Monsky-Washnitzer cohomology,
with respect to the basis <span class="math notranslate nohighlight">\((dx/2y, x dx/2y, ...x^{d-2} dx/2y)\)</span>, where
<span class="math notranslate nohighlight">\(d\)</span> is the degree of <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – monic polynomial <span class="math notranslate nohighlight">\(Q(x)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime <span class="math notranslate nohighlight">\(\geq 5\)</span> for which <span class="math notranslate nohighlight">\(E\)</span> has good reduction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – (optional) <span class="math notranslate nohighlight">\(p\)</span>-adic precision of the coefficient ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> – (optional) adjusted <span class="math notranslate nohighlight">\(p\)</span>-adic precision of the coefficient ring</p></li>
</ul>
<p>OUTPUT:</p>
<p><span class="math notranslate nohighlight">\((d-1)\)</span> x <span class="math notranslate nohighlight">\((d-1)\)</span> matrix <span class="math notranslate nohighlight">\(M\)</span> of Frobenius on Monsky-Washnitzer cohomology,
and list of differentials {f_i } such that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\phi^* (x^i dx/2y) = df_i + M[i]*vec(dx/2y, ..., x^{d-2} dx/2y)\]</div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">,</span><span class="n">f</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius_hyperelliptic</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[            4*5 + O(5^3)       5 + 2*5^2 + O(5^3) 2 + 3*5 + 2*5^2 + O(5^3)     2 + 5 + 5^2 + O(5^3)]</span>
<span class="go">[      3*5 + 5^2 + O(5^3)             3*5 + O(5^3)             4*5 + O(5^3)         2 + 5^2 + O(5^3)]</span>
<span class="go">[    4*5 + 4*5^2 + O(5^3)     3*5 + 2*5^2 + O(5^3)       5 + 3*5^2 + O(5^3)     2*5 + 2*5^2 + O(5^3)]</span>
<span class="go">[            5^2 + O(5^3)       5 + 4*5^2 + O(5^3)     4*5 + 3*5^2 + O(5^3)             2*5 + O(5^3)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_all">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">reduce_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_exact_form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_all" title="Permalink to this definition">#</a></dt>
<dd><p>Apply cohomology relations to reduce all terms to a linear
combination of <span class="math notranslate nohighlight">\(dx/y\)</span> and <span class="math notranslate nohighlight">\(x dx/y\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – cubic polynomial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coeffs</span></code> – list of length 3 lists. The
<span class="math notranslate nohighlight">\(i^{th}\)</span> list [a, b, c] represents
<span class="math notranslate nohighlight">\(y^{2(i - offset)} (a + bx + cx^2) dx/y\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">offset</span></code> – nonnegative integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">A,</span> <span class="pre">B</span></code> - pair such that the input differential is
cohomologous to (A + Bx) dx/y.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The algorithm operates in-place, so the data in coeffs is
destroyed.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_all</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(21, 106)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_negative">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">reduce_negative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact_form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_negative" title="Permalink to this definition">#</a></dt>
<dd><p>Apply cohomology relations to incorporate negative powers of
<span class="math notranslate nohighlight">\(y\)</span> into the <span class="math notranslate nohighlight">\(y^0\)</span> term.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – cubic polynomial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coeffs</span></code> – list of length 3 lists. The
<span class="math notranslate nohighlight">\(i^{th}\)</span> list [a, b, c] represents
<span class="math notranslate nohighlight">\(y^{2(i - offset)} (a + bx + cx^2) dx/y\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">offset</span></code> – nonnegative integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>The reduction is performed in-place. The output is placed
in coeffs[offset]. Note that coeffs[i] will be meaningless for i
offset after this function is finished.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_negative</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[28, 52, 9]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_negative</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[245, 332, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_positive">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">reduce_positive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact_form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_positive" title="Permalink to this definition">#</a></dt>
<dd><p>Apply cohomology relations to incorporate positive powers of
<span class="math notranslate nohighlight">\(y\)</span> into the <span class="math notranslate nohighlight">\(y^0\)</span> term.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – cubic polynomial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coeffs</span></code> – list of length 3 lists. The
<span class="math notranslate nohighlight">\(i^{th}\)</span> list [a, b, c] represents
<span class="math notranslate nohighlight">\(y^{2(i - offset)} (a + bx + cx^2) dx/y\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">offset</span></code> – nonnegative integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>The reduction is performed in-place. The output is placed
in coeffs[offset]. Note that coeffs[i] will be meaningless for i
offset after this function is finished.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_positive</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[16, 102, 88]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_positive</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[24, 108, 92]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_zero">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">reduce_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact_form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_zero" title="Permalink to this definition">#</a></dt>
<dd><p>Apply cohomology relation to incorporate <span class="math notranslate nohighlight">\(x^2 y^0\)</span> term
into <span class="math notranslate nohighlight">\(x^0 y^0\)</span> and <span class="math notranslate nohighlight">\(x^1 y^0\)</span> terms.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code> – cubic polynomial</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coeffs</span></code> – list of length 3 lists. The
<span class="math notranslate nohighlight">\(i^{th}\)</span> list [a, b, c] represents
<span class="math notranslate nohighlight">\(y^{2(i - offset)} (a + bx + cx^2) dx/y\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">offset</span></code> – nonnegative integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>The reduction is performed in-place. The output is placed
in coeffs[offset]. This method completely ignores coeffs[i] for i
!= offset.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_zero</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[6, 5, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.transpose_list">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</span></span><span class="sig-name descname"><span class="pre">transpose_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.transpose_list" title="Permalink to this definition">#</a></dt>
<dd><p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">input</span></code> – a list of lists, each list of the same length</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">output</span></code> – a list of lists such that output[i][j] = input[j][i]</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">transpose_list</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">transpose_list</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">[[1, 3, 5], [2, 4, 6]]</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="hypellfrob.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over a</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="mestre.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Mestre’s algorithm</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2022, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>