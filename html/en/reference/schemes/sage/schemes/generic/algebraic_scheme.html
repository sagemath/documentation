<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Algebraic schemes &mdash; Sage Reference Manual v7.4: Schemes</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.4: Schemes" href="../../../index.html" />
    <link rel="next" title="Hypersurfaces in affine and projective space" href="hypersurface.html" />
    <link rel="prev" title="Ambient Spaces" href="ambient_space.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hypersurface.html" title="Hypersurfaces in affine and projective space"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ambient_space.html" title="Ambient Spaces"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Schemes</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="algebraic-schemes">
<span id="sage-schemes-generic-algebraic-scheme"></span><h1>Algebraic schemes<a class="headerlink" href="#algebraic-schemes" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.generic.algebraic_scheme"></span><p>An algebraic scheme is defined by a set of polynomials in some
suitable affine or projective coordinates. Possible ambient spaces are</p>
<blockquote>
<div><ul class="simple">
<li>Affine spaces (<a class="reference internal" href="../affine/affine_space.html#sage.schemes.affine.affine_space.AffineSpace_generic" title="sage.schemes.affine.affine_space.AffineSpace_generic"><code class="xref py py-class docutils literal"><span class="pre">AffineSpace</span></code></a>),</li>
<li>Projective spaces (<a class="reference internal" href="../projective/projective_space.html#sage.schemes.projective.projective_space.ProjectiveSpace_ring" title="sage.schemes.projective.projective_space.ProjectiveSpace_ring"><code class="xref py py-class docutils literal"><span class="pre">ProjectiveSpace</span></code></a>), or</li>
<li>Toric varieties (<a class="reference internal" href="../toric/variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal"><span class="pre">ToricVariety</span></code></a>).</li>
</ul>
</div></blockquote>
<p>Note that while projective spaces are of course toric varieties themselves,
they are implemented differently in Sage due to efficiency considerations.
You still can create a projective space as a toric variety if you wish.</p>
<p>In the following, we call the corresponding subschemes affine
algebraic schemes, projective algebraic schemes, or toric algebraic
schemes. In the future other ambient spaces, perhaps by means of
gluing relations, may be intoduced.</p>
<p>Generally, polynomials <span class="math">\(p_0, p_1, \dots, p_n\)</span> define an ideal
<span class="math">\(I=\left&lt;p_0, p_1, \dots, p_n\right&gt;\)</span>. In the projective and toric case, the
polynomials (and, therefore, the ideal) must be homogeneous. The
associated subscheme <span class="math">\(V(I)\)</span> of the ambient space is, roughly speaking,
the subset of the ambient space on which all polynomials vanish simultaneously.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not construct algebraic scheme objects directly. Instead, use
<code class="docutils literal"><span class="pre">.subscheme()</span></code> methods of ambient spaces. See below for examples.</p>
</div>
<p>EXAMPLES:</p>
<p>We first construct the ambient space, here the affine space <span class="math">\(\QQ^2\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A2</span><span class="o">.</span><span class="n">coordinate_ring</span><span class="p">()</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, y</span>
</pre></div>
</div>
<p>Now we can write polynomial equations in the variables <span class="math">\(x\)</span> and <span class="math">\(y\)</span>. For
example, one equation cuts out a curve (a one-dimensional subscheme):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span> <span class="n">V</span>
<span class="go">Closed subscheme of Affine Space of dimension 2</span>
<span class="go">over Rational Field defined by:</span>
<span class="go">  x^2 + y^2 - 1</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Here is a more complicated example in a projective space:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P3</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P3</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x0, x1, x2, x3</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">]])</span><span class="o">.</span><span class="n">minors</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">[-x1^2 + x0*x2, -x1*x2 + x0*x3, -x2^2 + x1*x3]</span>
<span class="gp">sage: </span><span class="n">twisted_cubic</span> <span class="o">=</span> <span class="n">P3</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">twisted_cubic</span>
<span class="go">Closed subscheme of Projective Space of dimension 3</span>
<span class="go">over Rational Field defined by:</span>
<span class="go">  -x1^2 + x0*x2,</span>
<span class="go">  -x1*x2 + x0*x3,</span>
<span class="go">  -x2^2 + x1*x3</span>
<span class="gp">sage: </span><span class="n">twisted_cubic</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Note that there are 3 equations in the 3-dimensional ambient space,
yet the subscheme is 1-dimensional. One can show that it is not
possible to eliminate any of the equations, that is, the twisted cubic
is <strong>not</strong> a complete intersection of two polynomial equations.</p>
<p>Let us look at one affine patch, for example the one where <span class="math">\(x_0=1\)</span></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">patch</span> <span class="o">=</span> <span class="n">twisted_cubic</span><span class="o">.</span><span class="n">affine_patch</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">patch</span>
<span class="go">Closed subscheme of Affine Space of dimension 3</span>
<span class="go">over Rational Field defined by:</span>
<span class="go">  -x0^2 + x1,</span>
<span class="go">  -x0*x1 + x2,</span>
<span class="go">  -x1^2 + x0*x2</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Affine Space of dimension 3</span>
<span class="go">  over Rational Field defined by:</span>
<span class="go">  -x0^2 + x1,</span>
<span class="go">  -x0*x1 + x2,</span>
<span class="go">  -x1^2 + x0*x2</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 3</span>
<span class="go">  over Rational Field defined by:</span>
<span class="go">  x1^2 - x0*x2,</span>
<span class="go">  x1*x2 - x0*x3,</span>
<span class="go">  x2^2 - x1*x3</span>
<span class="go">  Defn: Defined on coordinates by sending (x0, x1, x2) to</span>
<span class="go">        (1 : x0 : x1 : x2)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Kohel (2005): initial version.</li>
<li>William Stein (2005): initial version.</li>
<li>Andrey Novoseltsev (2010-05-17): subschemes of toric varieties.</li>
<li>Volker Braun (2010-12-24): documentation of schemes and
refactoring. Added coordinate neighborhoods and is_smooth()</li>
<li>Ben Hutz (2014): subschemes of Cartesian products of projective space</li>
</ul>
<dl class="class">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme">
<em class="property">class </em><code class="descclassname">sage.schemes.generic.algebraic_scheme.</code><code class="descname">AlgebraicScheme</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="scheme.html#sage.schemes.generic.scheme.Scheme" title="sage.schemes.generic.scheme.Scheme"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.scheme.Scheme</span></code></a></p>
<p>An algebraic scheme presented as a subscheme in an ambient space.</p>
<p>This is the base class for all algebraic schemes, that is, schemes
defined by equations in affine, projective, or toric ambient
spaces.</p>
<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.ambient_space">
<code class="descname">ambient_space</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.ambient_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ambient space of this algebraic scheme.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="go">Affine Space of dimension 2 over Finite Field of size 5</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span> <span class="ow">is</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.coordinate_ring">
<code class="descname">coordinate_ring</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.coordinate_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coordinate ring of this algebraic scheme.  The
result is cached.</p>
<p>OUTPUT:</p>
<p>The coordinate ring. Usually a polynomial ring, or a quotient
thereof.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">coordinate_ring</span><span class="p">()</span>
<span class="go">Quotient of Multivariate Polynomial Ring in x, y, z over Integer Ring by the ideal (x - y, x - z)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_center">
<code class="descname">embedding_center</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distinguished point, if there is any.</p>
<p>If the scheme <span class="math">\(Y\)</span> was constructed as a neighbourhood of a
point <span class="math">\(p \in X\)</span>, then <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism"><code class="xref py py-meth docutils literal"><span class="pre">embedding_morphism()</span></code></a> returns a
local isomorphism <span class="math">\(f:Y\to X\)</span> around the preimage point
<span class="math">\(f^{-1}(p)\)</span>. The latter is returned by
<a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_center" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_center"><code class="xref py py-meth docutils literal"><span class="pre">embedding_center()</span></code></a>.</p>
<p>OUTPUT:</p>
<p>A point of <code class="docutils literal"><span class="pre">self</span></code>. Raises <code class="docutils literal"><span class="pre">AttributeError</span></code> if there is no
distinguished point, depending on how <code class="docutils literal"><span class="pre">self</span></code> was
constructed.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P3</span><span class="o">.&lt;</span><span class="n">w</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P3</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span> <span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">nbhd</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">neighborhood</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">nbhd</span>
<span class="go">Closed subscheme of Affine Space of dimension 3 over Rational Field defined by:</span>
<span class="go">  x0^2*x2^2 - x1^2*x2^2 + 6*x0^2*x2 - 6*x1^2*x2 + 2*x0*x2^2 +</span>
<span class="go">  2*x1*x2^2 - 7*x0^2 + 7*x1^2 + 12*x0*x2 + 12*x1*x2 - 14*x0 - 14*x1</span>
<span class="gp">sage: </span><span class="n">nbhd</span><span class="o">.</span><span class="n">embedding_center</span><span class="p">()</span>
<span class="go">(0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">nbhd</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()(</span><span class="n">nbhd</span><span class="o">.</span><span class="n">embedding_center</span><span class="p">())</span>
<span class="go">(1/4 : -1/4 : 3/4 : 1)</span>
<span class="gp">sage: </span><span class="n">nbhd</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Affine Space of dimension 3 over Rational Field defined by:</span>
<span class="go">  x0^2*x2^2 - x1^2*x2^2 + 6*x0^2*x2 - 6*x1^2*x2 + 2*x0*x2^2 +</span>
<span class="go">  2*x1*x2^2 - 7*x0^2 + 7*x1^2 + 12*x0*x2 + 12*x1*x2 - 14*x0 - 14*x1</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 3 over Rational Field defined by:</span>
<span class="go">  w^2*y^2 - x^2*y^2 - w^2*z^2 + x^2*z^2</span>
<span class="go">  Defn: Defined on coordinates by sending (x0, x1, x2) to</span>
<span class="go">        (x0 + 1 : x1 - 1 : x2 + 3 : 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism">
<code class="descname">embedding_morphism</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the default embedding morphism of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>If the scheme <span class="math">\(Y\)</span> was constructed as a neighbourhood of a
point <span class="math">\(p \in X\)</span>, then <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism"><code class="xref py py-meth docutils literal"><span class="pre">embedding_morphism()</span></code></a> returns a
local isomorphism <span class="math">\(f:Y\to X\)</span> around the preimage point
<span class="math">\(f^{-1}(p)\)</span>. The latter is returned by
<a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_center" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_center"><code class="xref py py-meth docutils literal"><span class="pre">embedding_center()</span></code></a>.</p>
<p>If the algebraic scheme <span class="math">\(Y\)</span> was not constructed as a
neighbourhood of a point, then the embedding in its
<a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.ambient_space" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.ambient_space"><code class="xref py py-meth docutils literal"><span class="pre">ambient_space()</span></code></a> is returned.</p>
<p>OUTPUT:</p>
<p>A scheme morphism whose
<code class="xref py py-meth docutils literal"><span class="pre">domain()</span></code> is <code class="docutils literal"><span class="pre">self</span></code>.</p>
<ul class="simple">
<li>By default, it is the tautological embedding into its own
ambient space <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.ambient_space" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.ambient_space"><code class="xref py py-meth docutils literal"><span class="pre">ambient_space()</span></code></a>.</li>
<li>If the algebraic scheme (which itself is a subscheme of an
auxiliary <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.ambient_space" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.ambient_space"><code class="xref py py-meth docutils literal"><span class="pre">ambient_space()</span></code></a>) was constructed as a patch
or neighborhood of a point then the embedding is the
embedding into the original scheme.</li>
<li>A <code class="docutils literal"><span class="pre">NotImplementedError</span></code> is raised if the construction of
the embedding morphism is not implemented yet.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">  Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2 + y^2 - 1</span>
<span class="go">  To:   Affine Space of dimension 2 over Rational Field</span>
<span class="go">  Defn: Defined on coordinates by sending (x, y) to</span>
<span class="go">        (x, y)</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">From: Closed subscheme of 2-d CPR-Fano toric variety covered</span>
<span class="go">      by 4 affine patches defined by:</span>
<span class="go">x - y</span>
<span class="go">To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">Defn: Defined on coordinates by sending [x : y : u : v] to</span>
<span class="go">      [y : y : u : v]</span>
</pre></div>
</div>
<p>So far, the embedding was just in the own ambient space. Now a
bit more interesting examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">nbhd</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">neighborhood</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">nbhd</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  -x0^2*x1 - 2*x0*x1</span>
</pre></div>
</div>
<p>Note that <span class="math">\(p=(1,1,0)\)</span> is a singular point of <span class="math">\(X\)</span>. So the
neighborhood of <span class="math">\(p\)</span> is not just affine space. The
:meth:neighborhood` method returns a presentation of
the neighborhood as a subscheme of an auxiliary 2-dimensional
affine space:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">nbhd</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="go">Affine Space of dimension 2 over Rational Field</span>
</pre></div>
</div>
<p>But its <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism"><code class="xref py py-meth docutils literal"><span class="pre">embedding_morphism()</span></code></a> is not into this auxiliary
affine space, but the original subscheme <span class="math">\(X\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">nbhd</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  -x0^2*x1 - 2*x0*x1</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2*z - y^2*z</span>
<span class="go">  Defn: Defined on coordinates by sending (x0, x1) to</span>
<span class="go">        (1 : x0 + 1 : x1)</span>
</pre></div>
</div>
<p>A couple more examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">patch1</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">affine_patch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">patch1</span>
<span class="go">2-d affine toric variety</span>
<span class="gp">sage: </span><span class="n">patch1</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">  Scheme morphism:</span>
<span class="go">  From: 2-d affine toric variety</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [y : u] to</span>
<span class="go">        [1 : y : u : 1]</span>
<span class="gp">sage: </span><span class="n">subpatch</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">affine_patch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">subpatch</span>
<span class="go">Closed subscheme of 2-d affine toric variety defined by:</span>
<span class="go">  -y + 1</span>
<span class="gp">sage: </span><span class="n">subpatch</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of 2-d affine toric variety defined by:</span>
<span class="go">  -y + 1</span>
<span class="go">  To:   Closed subscheme of 2-d CPR-Fano toric variety covered</span>
<span class="go">        by 4 affine patches defined by:</span>
<span class="go">  x - y</span>
<span class="go">  Defn: Defined on coordinates by sending [y : u] to</span>
<span class="go">        [1 : y : u : 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.is_projective">
<code class="descname">is_projective</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.is_projective" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is presented as a subscheme of an ambient
projective space.</p>
<p>OUTPUT:</p>
<p>Boolean.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span> <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="n">PP</span><span class="o">.</span><span class="n">gens</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_projective</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">AA</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">AA</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_projective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note that toric varieties are implemented differently than
projective spaces. This is why this method returns <code class="docutils literal"><span class="pre">False</span></code>
for toric varieties:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_projective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.ngens">
<code class="descname">ngens</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.ngens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of generators of the ambient space of this
algebraic scheme.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_quasi">
<em class="property">class </em><code class="descclassname">sage.schemes.generic.algebraic_scheme.</code><code class="descname">AlgebraicScheme_quasi</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_quasi" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.algebraic_scheme.AlgebraicScheme</span></code></a></p>
<p>The quasi-affine or quasi-projective scheme <span class="math">\(X - Y\)</span>, where <span class="math">\(X\)</span> and <span class="math">\(Y\)</span>
are both closed subschemes of a common ambient affine or projective
space.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not create objects of this class directly. The
preferred method to construct such subschemes is to use
<code class="xref py py-meth docutils literal"><span class="pre">complement()</span></code> method of algebraic schemes.</p>
</div>
<p>OUTPUT:</p>
<p>An instance of <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_quasi" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_quasi"><code class="xref py py-class docutils literal"><span class="pre">AlgebraicScheme_quasi</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Quasi-projective subscheme X - Y of Projective Space of dimension 2 over</span>
<span class="go">Integer Ring, where X is defined by:</span>
<span class="go">  (no polynomials)</span>
<span class="go">and Y is defined by:</span>
<span class="go">  x - y</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_quasi.X">
<code class="descname">X</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_quasi.X" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the scheme <span class="math">\(X\)</span> such that self is represented as <span class="math">\(X - Y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">X</span><span class="p">()</span> <span class="ow">is</span> <span class="n">S</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_quasi.Y">
<code class="descname">Y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_quasi.Y" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the scheme <span class="math">\(Y\)</span> such that self is represented as <span class="math">\(X - Y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span> <span class="ow">is</span> <span class="n">T</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_quasi.rational_points">
<code class="descname">rational_points</code><span class="sig-paren">(</span><em>F=None</em>, <em>bound=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_quasi.rational_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the set of rational points on this algebraic scheme
over the field <span class="math">\(F\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">rational_points</span><span class="p">()</span>
<span class="go">[(2, 4), (3, 2), (4, 2), (5, 4), (6, 1)]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">rational_points</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">[(2, 4), (3, 2), (4, 2), (5, 4), (6, 1), (b, b + 4), (b + 1, 3*b + 5), (b + 2, 5*b + 1),</span>
<span class="go">(b + 3, 6), (b + 4, 2*b + 6), (b + 5, 4*b + 1), (b + 6, 6*b + 5), (2*b, 4*b + 2),</span>
<span class="go">(2*b + 1, b + 3), (2*b + 2, 5*b + 6), (2*b + 3, 2*b + 4), (2*b + 4, 6*b + 4),</span>
<span class="go">(2*b + 5, 3*b + 6), (2*b + 6, 3), (3*b, 2*b + 1), (3*b + 1, b + 2), (3*b + 2, 5),</span>
<span class="go">(3*b + 3, 6*b + 3), (3*b + 4, 5*b + 3), (3*b + 5, 4*b + 5), (3*b + 6, 3*b + 2),</span>
<span class="go">(4*b, 2*b + 1), (4*b + 1, 3*b + 2), (4*b + 2, 4*b + 5), (4*b + 3, 5*b + 3),</span>
<span class="go">(4*b + 4, 6*b + 3), (4*b + 5, 5), (4*b + 6, b + 2), (5*b, 4*b + 2), (5*b + 1, 3),</span>
<span class="go">(5*b + 2, 3*b + 6), (5*b + 3, 6*b + 4), (5*b + 4, 2*b + 4), (5*b + 5, 5*b + 6),</span>
<span class="go">(5*b + 6, b + 3), (6*b, b + 4), (6*b + 1, 6*b + 5), (6*b + 2, 4*b + 1), (6*b + 3, 2*b + 6),</span>
<span class="go">(6*b + 4, 6), (6*b + 5, 5*b + 1), (6*b + 6, 3*b + 5)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme">
<em class="property">class </em><code class="descclassname">sage.schemes.generic.algebraic_scheme.</code><code class="descname">AlgebraicScheme_subscheme</code><span class="sig-paren">(</span><em>A</em>, <em>polynomials</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.algebraic_scheme.AlgebraicScheme</span></code></a></p>
<p>An algebraic scheme presented as a closed subscheme is defined by
explicit polynomial equations. This is as opposed to a general
scheme, which could, e.g., be the Neron model of some object, and
for which we do not want to give explicit equations.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">A</span></code> - ambient space (e.g. affine or projective <span class="math">\(n\)</span>-space)</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">polynomials</span></code> - single polynomial, ideal or iterable of defining</dt>
<dd><p class="first last">polynomials; in any case polynomials must belong to the coordinate
ring of the ambient space and define valid polynomial functions (e.g.
they should be homogeneous in the case of a projective space)</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>algebraic scheme</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.generic.algebraic_scheme</span> <span class="kn">import</span> <span class="n">AlgebraicScheme_subscheme</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2 - y*z</span>
<span class="gp">sage: </span><span class="n">AlgebraicScheme_subscheme</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2 - y*z</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.Jacobian">
<code class="descname">Jacobian</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.Jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Jacobian ideal.</p>
<p>This is the ideal generated by</p>
<ul class="simple">
<li>the <span class="math">\(d\times d\)</span> minors of the Jacobian matrix, where <span class="math">\(d\)</span> is
the <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.codimension" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.codimension"><code class="xref py py-meth docutils literal"><span class="pre">codimension()</span></code></a> of the algebraic scheme, and</li>
<li>the defining polynomials of the algebraic scheme. Note that
some authors do not include these in the definition of the
Jacobian ideal. An example of a reference that does include
the defining equations is [LazarsfeldJacobian].</li>
</ul>
<p>OUTPUT:</p>
<p>An ideal in the coordinate ring of the ambient space.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="lazarsfeldjacobian" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[LazarsfeldJacobian]</td><td>Robert Lazarsfeld:
Positivity in algebraic geometry II;
Positivity for Vector Bundles, and Multiplier Ideals,
page 181.</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P3</span><span class="o">.&lt;</span><span class="n">w</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">twisted_cubic</span> <span class="o">=</span> <span class="n">P3</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]])</span><span class="o">.</span><span class="n">minors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">twisted_cubic</span><span class="o">.</span><span class="n">Jacobian</span><span class="p">()</span>
<span class="go">Ideal (-x^2 + w*y, -x*y + w*z, -y^2 + x*z, x*z, -2*w*z, w*y, 3*w*y, -2*w*x,</span>
<span class="go">w^2, y*z, -2*x*z, w*z, 3*w*z, -2*w*y, w*x, z^2, -2*y*z, x*z, 3*x*z, -2*w*z,</span>
<span class="go">w*y) of Multivariate Polynomial Ring in w, x, y, z over Rational Field</span>
<span class="gp">sage: </span><span class="n">twisted_cubic</span><span class="o">.</span><span class="n">defining_ideal</span><span class="p">()</span>
<span class="go">Ideal (-x^2 + w*y, -x*y + w*z, -y^2 + x*z) of Multivariate Polynomial Ring</span>
<span class="go">in w, x, y, z over Rational Field</span>
</pre></div>
</div>
<p>This example addresses ticket <a class="reference external" href="https://trac.sagemath.org/20512">trac ticket #20512</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P3</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Jacobian</span><span class="p">()</span> <span class="o">==</span> <span class="n">P3</span><span class="o">.</span><span class="n">coordinate_ring</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.Jacobian_matrix">
<code class="descname">Jacobian_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.Jacobian_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the matrix <span class="math">\(\frac{\partial f_i}{\partial x_j}\)</span> of
(formal) partial derivatives.</p>
<p>OUTPUT:</p>
<p>A matrix of polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P3</span><span class="o">.&lt;</span><span class="n">w</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">twisted_cubic</span> <span class="o">=</span> <span class="n">P3</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]])</span><span class="o">.</span><span class="n">minors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">twisted_cubic</span><span class="o">.</span><span class="n">Jacobian_matrix</span><span class="p">()</span>
<span class="go">[   y -2*x    w    0]</span>
<span class="go">[   z   -y   -x    w]</span>
<span class="go">[   0    z -2*y    x]</span>
</pre></div>
</div>
<p>This example addresses ticket <a class="reference external" href="https://trac.sagemath.org/20512">trac ticket #20512</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P3</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Jacobian_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span> <span class="o">==</span> <span class="n">P3</span><span class="o">.</span><span class="n">coordinate_ring</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.base_extend">
<code class="descname">base_extend</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.base_extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the base change to the ring <span class="math">\(R\)</span> of this scheme.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Finite Field in b of size 11^2 defined by:</span>
<span class="go">  x^2 - y*z</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no natural map from the base ring (=Finite Field of size 11) to R (=Integer Ring)!</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.change_ring">
<code class="descname">change_ring</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.change_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new algebraic subscheme which is this subscheme coerced to <code class="docutils literal"><span class="pre">R</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">R</span></code> &#8211; ring or morphism.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A new algebraic subscheme which is this subscheme coerced to <code class="docutils literal"><span class="pre">R</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Hom</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Closed subscheme of Projective Space of dimension 1 over Finite Field of size 3 defined by:</span>
<span class="go">-y^2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">w</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">Closed subscheme of Projective Space of dimension 1 over Number Field in v with</span>
<span class="go">defining polynomial z^3 - 5 over its base field defined by:</span>
<span class="go">  x + (-w)*y</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">w</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">v</span><span class="o">*</span><span class="n">x</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">emb</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Closed subscheme of Affine Space of dimension 3 over Algebraic Field</span>
<span class="go">defined by:</span>
<span class="go">  x + (-1.414213562373095? + 0.?e-16*I)*y,</span>
<span class="go">  z^2 + (0.8549879733383485? + 1.480882609682365?*I)*x</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">w</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">v</span><span class="o">*</span><span class="n">x</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">emb</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Closed subscheme of Affine Space of dimension 3 over Algebraic Field</span>
<span class="go">defined by:</span>
<span class="go">  x + (-1.414213562373095? + 0.?e-16*I)*y,</span>
<span class="go">  z^2 + (0.8549879733383485? - 1.480882609682365?*I)*x</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">w</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="go">Closed subscheme of Projective Space of dimension 1 over Complex Field</span>
<span class="go">with 53 bits of precision defined by:</span>
<span class="go">  x + (-1.73205080756888*I)*y</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">w</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="go">Closed subscheme of Projective Space of dimension 1 over Real Field</span>
<span class="go">with 53 bits of precision defined by:</span>
<span class="go">  x - 1.73205080756888*y</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="go">Closed subscheme of Projective Space of dimension 1 over Complex Field</span>
<span class="go">with 53 bits of precision defined by:</span>
<span class="go">  x^2 + (0.623489801858734 + 0.781831482468030*I)*y^2</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Closed subscheme of Projective Space of dimension 1 over Algebraic Field defined by:</span>
<span class="go">  x^2 + (-0.9009688679024191? - 0.4338837391175581?*I)*y^2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Hom</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Complex Field with</span>
<span class="go">53 bits of precision defined by:</span>
<span class="go">  (-0.561231024154687 - 0.972080648619833*I)*x^2,</span>
<span class="go">  y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.codimension">
<code class="descname">codimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.codimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the codimension of the algebraic subscheme.</p>
<p>OUTPUT:</p>
<p>Integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">codimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.complement">
<code class="descname">complement</code><span class="sig-paren">(</span><em>other=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the scheme-theoretic complement other - self, where
self and other are both closed algebraic subschemes of the
same ambient space.</p>
<p>If other is unspecified, it is taken to be the ambient space
of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">+</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="go">Quasi-affine subscheme X - Y of Affine Space of</span>
<span class="go">dimension 3 over Integer Ring, where X is defined by:</span>
<span class="go">  x + y - z</span>
<span class="go">and Y is defined by:</span>
<span class="go">  x - y + z</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span>
<span class="go">Quasi-affine subscheme X - Y of Affine Space of</span>
<span class="go">dimension 3 over Integer Ring, where X is defined by:</span>
<span class="go">  (no polynomials)</span>
<span class="go">and Y is defined by:</span>
<span class="go">  x - y + z</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">z</span><span class="o">*</span><span class="n">x</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="go">Quasi-projective subscheme X - Y of Projective Space of</span>
<span class="go">dimension 2 over Rational Field, where X is defined by:</span>
<span class="go">  x^2 + y^2 + z^2</span>
<span class="go">and Y is defined by:</span>
<span class="go">  x*y + x*z + y*z</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">Quasi-projective subscheme X - Y of Projective Space of</span>
<span class="go">dimension 2 over Rational Field, where X is defined by:</span>
<span class="go">  (no polynomials)</span>
<span class="go">and Y is defined by:</span>
<span class="go">  x*y + x*z + y*z</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.defining_ideal">
<code class="descname">defining_ideal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.defining_ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ideal that defines this scheme as a subscheme
of its ambient space.</p>
<p>OUTPUT:</p>
<p>An ideal in the coordinate ring of the ambient space.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">defining_ideal</span><span class="p">()</span>
<span class="go">Ideal (x^2 - y*z, x^3 + z^3) of Multivariate Polynomial Ring in x, y, z over Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.defining_polynomials">
<code class="descname">defining_polynomials</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.defining_polynomials" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the polynomials that define this scheme as a subscheme
of its ambient space.</p>
<p>OUTPUT:</p>
<p>A tuple of polynomials in the coordinate ring of the ambient
space.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">defining_polynomials</span><span class="p">()</span>
<span class="go">(x^2 - y*z, x^3 + z^3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.intersection">
<code class="descname">intersection</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the scheme-theoretic intersection of self and other in their
common ambient space.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Integer Ring defined by:</span>
<span class="go">  x^2 - y,</span>
<span class="go">  y</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.irreducible_components">
<code class="descname">irreducible_components</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.irreducible_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the irreducible components of this algebraic scheme, as
subschemes of the same ambient space.</p>
<p>OUTPUT:</p>
<p>an immutable sequence of irreducible subschemes of the ambient
space of this scheme</p>
<p>The components are cached.</p>
<p>EXAMPLES:</p>
<p>We define what is clearly a union of four hypersurfaces in
<span class="math">\(\P^4_{\QQ}\)</span> then find the irreducible components:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span>  <span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span> <span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">irreducible_components</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Closed subscheme of Projective Space of dimension 4 over Rational Field defined by:</span>
<span class="go">w,</span>
<span class="go">Closed subscheme of Projective Space of dimension 4 over Rational Field defined by:</span>
<span class="go">x^2 - y^2 - z^2,</span>
<span class="go">Closed subscheme of Projective Space of dimension 4 over Rational Field defined by:</span>
<span class="go">x^2*z - v^3,</span>
<span class="go">Closed subscheme of Projective Space of dimension 4 over Rational Field defined by:</span>
<span class="go">w^5 - 2*z^3*v^2</span>
<span class="go">]</span>
</pre></div>
</div>
<p>We verify that the irrelevant ideal isn&#8217;t accidently returned
(see <a class="reference external" href="https://trac.sagemath.org/6920">trac ticket #6920</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span> <span class="k">for</span> <span class="n">zz</span> <span class="ow">in</span> <span class="n">PP</span><span class="o">.</span><span class="n">gens</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">irreducible_components</span><span class="p">()</span>
<span class="go">[</span>

<span class="go">]</span>
</pre></div>
</div>
<p>The same polynomial as above defines a scheme with a
nontrivial irreducible component in affine space (instead of
the empty scheme as above):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AA</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">AA</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">irreducible_components</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Closed subscheme of Affine Space of dimension 4 over Rational Field defined by:</span>
<span class="go">  w,</span>
<span class="go">  z,</span>
<span class="go">  y,</span>
<span class="go">  x</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.is_irreducible">
<code class="descname">is_irreducible</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.is_irreducible" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether this subscheme is or is not irreducible.</p>
<p>OUTPUT: Boolean.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">u</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([(</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span> <span class="n">z</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">w</span> \
<span class="go">- x^2*w^3 + y^2*w^2 + x*w^3])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.rational_points">
<code class="descname">rational_points</code><span class="sig-paren">(</span><em>bound=0</em>, <em>F=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.rational_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rational points on the algebraic subscheme.</p>
<p>EXAMPLES:</p>
<p>Enumerate over a projective scheme over a number field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">u</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">rational_points</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(-1 : 1), (1 : 1)]</span>
</pre></div>
</div>
<p>One can enumerate points up to a given bound on a projective scheme
over the rationals:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rational_points</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">[(-1 : -1 : 1), (-1 : 0 : 1), (0 : -1 : 1), (0 : 0 : 1), (0 : 1 : 0), (1/4 : -5/8 : 1),</span>
<span class="go">(1/4 : -3/8 : 1), (1 : -1 : 1), (1 : 0 : 1), (2 : -3 : 1), (2 : 2 : 1)]</span>
</pre></div>
</div>
<p>For a small finite field, the complete set of points can be
enumerated.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Etilde</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Etilde</span><span class="o">.</span><span class="n">rational_points</span><span class="p">()</span>
<span class="go">[(0 : 0 : 1), (0 : 1 : 0), (0 : 2 : 1), (1 : 0 : 1),</span>
<span class="go"> (1 : 2 : 1), (2 : 0 : 1), (2 : 2 : 1)]</span>
</pre></div>
</div>
<p>The class of hyperelliptic curves does not (yet) support
desingularization of the places at infinity into two points:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FF</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">FiniteField</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">rational_points</span><span class="p">()</span>
<span class="go">[(0 : 1 : 0), (0 : 1 : 1), (0 : 6 : 1), (2 : 0 : 1),</span>
<span class="go"> (4 : 0 : 1), (6 : 1 : 1), (6 : 6 : 1)]</span>
</pre></div>
</div>
<p>TODO:</p>
<ol class="arabic simple">
<li>The above algorithms enumerate all projective points and
test whether they lie on the scheme; Implement a more naive
sieve at least for covers of the projective line.</li>
<li>Implement Stoll&#8217;s model in weighted projective space to
resolve singularities and find two points (1 : 1 : 0) and
(-1 : 1 : 0) at infinity.</li>
</ol>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.reduce">
<code class="descname">reduce</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the corresponding reduced algebraic space associated to this
scheme.</p>
<p>EXAMPLES: First we construct the union of a doubled and tripled
line in the affine plane over <span class="math">\(\QQ\)</span></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="p">]);</span> <span class="n">X</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^5 - 3*x^4*y + 3*x^3*y^2 - x^2*y^3 - 2*x^4 + 6*x^3*y</span>
<span class="go">  - 6*x^2*y^2 + 2*x*y^3 + x^3 - 3*x^2*y + 3*x*y^2 - y^3</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Then we compute the corresponding reduced scheme:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reduce</span><span class="p">();</span> <span class="n">Y</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2 - x*y - x + y</span>
</pre></div>
</div>
<p>Finally, we verify that the reduced scheme <span class="math">\(Y\)</span> is the union
of those two lines:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span> <span class="n">L1</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x - 1</span>
<span class="gp">sage: </span><span class="n">L2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">]);</span> <span class="n">L2</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x - y</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">L1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">L2</span><span class="p">);</span> <span class="n">W</span>             <span class="c1"># taken in ambient space</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2 - x*y - x + y</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">==</span> <span class="n">W</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.union">
<code class="descname">union</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the scheme-theoretic union of self and other in their common
ambient space.</p>
<p>EXAMPLES: We construct the union of a line and a tripled-point on
the line.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">S</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">y^4 - y^3,</span>
<span class="go">x*y^3 - x*y^2,</span>
<span class="go">x^2*y^2 - x^2*y,</span>
<span class="go">x^3*y - x^3</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">y^2 - y,</span>
<span class="go">x*y - x</span>
</pre></div>
</div>
<p>We can also use the notation &#8220;+&#8221; for the union:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="p">])</span> <span class="o">+</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">x^4 - x*y^2 + x</span>
</pre></div>
</div>
<p>Saving and loading:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">dumps</span><span class="p">())</span> <span class="o">==</span> <span class="n">S</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.weil_restriction">
<code class="descname">weil_restriction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme.weil_restriction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Weil restriction of this variety over some extension
field. If the field is a finite field, then this computes
the Weil restriction to the prime subfield.</p>
<p>A Weil restriction of scalars - denoted <span class="math">\(Res_{L/k}\)</span> - is a
functor which, for any finite extension of fields <span class="math">\(L/k\)</span> and
any algebraic variety <span class="math">\(X\)</span> over <span class="math">\(L\)</span>, produces another
corresponding variety <span class="math">\(Res_{L/k}(X)\)</span>, defined over <span class="math">\(k\)</span>. It is
useful for reducing questions about varieties over large
fields to questions about more complicated varieties over
smaller fields.</p>
<p>This function does not compute this Weil restriction directly
but computes on generating sets of polynomial ideals:</p>
<p>Let <span class="math">\(d\)</span> be the degree of the field extension <span class="math">\(L/k\)</span>, let <span class="math">\(a\)</span> a
generator of <span class="math">\(L/k\)</span> and <span class="math">\(p\)</span> the minimal polynomial of
<span class="math">\(L/k\)</span>. Denote this ideal by <span class="math">\(I\)</span>.</p>
<p>Specifically, this function first maps each variable <span class="math">\(x\)</span> to
its representation over <span class="math">\(k\)</span>: <span class="math">\(\sum_{i=0}^{d-1} a^i x_i\)</span>. Then
each generator of <span class="math">\(I\)</span> is evaluated over these representations
and reduced modulo the minimal polynomial <span class="math">\(p\)</span>. The result is
interpreted as a univariate polynomial in <span class="math">\(a\)</span> and its
coefficients are the new generators of the returned ideal.</p>
<p>If the input and the output ideals are radical, this is
equivalent to the statement about algebraic varieties above.</p>
<p>OUTPUT: Affine subscheme - the Weil restriction of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">L</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">v</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">weil_restriction</span><span class="p">()</span>
<span class="go">Closed subscheme of Affine Space of dimension 4 over Number Field in w</span>
<span class="go">with defining polynomial x^5 - 2 defined by:</span>
<span class="go">  (-w)*z0^3 + (3*w)*z0*z1^2 + z2^2 - z3^2,</span>
<span class="go">  (-3*w)*z0^2*z1 + (w)*z1^3 + 2*z2*z3 - 1</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">weil_restriction</span><span class="p">()</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span> <span class="ow">is</span> <span class="n">A</span><span class="o">.</span><span class="n">weil_restriction</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">weil_restriction</span><span class="p">()</span>
<span class="go">Closed subscheme of Affine Space of dimension 6 over Finite Field of</span>
<span class="go">size 5 defined by:</span>
<span class="go">  z2^2 - 2*z3^2 - z0*z4 + 2*z1*z5,</span>
<span class="go">  2*z2*z3 + z3^2 - z1*z4 - z0*z5 - z1*z5,</span>
<span class="go">  z4^2 - 2*z5^2 + 2*z2,</span>
<span class="go">  2*z4*z5 + z5^2 + 2*z3</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine">
<em class="property">class </em><code class="descclassname">sage.schemes.generic.algebraic_scheme.</code><code class="descname">AlgebraicScheme_subscheme_affine</code><span class="sig-paren">(</span><em>A</em>, <em>polynomials</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme</span></code></a></p>
<p>Construct an algebraic subscheme of affine space.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not create objects of this class directly. The
preferred method to construct such subschemes is to use
<a class="reference internal" href="../affine/affine_space.html#sage.schemes.affine.affine_space.AffineSpace_generic.subscheme" title="sage.schemes.affine.affine_space.AffineSpace_generic.subscheme"><code class="xref py py-meth docutils literal"><span class="pre">subscheme()</span></code></a>
method of <a class="reference internal" href="../affine/affine_space.html#sage.schemes.affine.affine_space.AffineSpace_generic" title="sage.schemes.affine.affine_space.AffineSpace_generic"><code class="xref py py-class docutils literal"><span class="pre">affine</span> <span class="pre">space</span></code></a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">A</span></code> &#8211; ambient <a class="reference internal" href="../affine/affine_space.html#sage.schemes.affine.affine_space.AffineSpace_generic" title="sage.schemes.affine.affine_space.AffineSpace_generic"><code class="xref py py-class docutils literal"><span class="pre">affine</span> <span class="pre">space</span></code></a></li>
<li><code class="docutils literal"><span class="pre">polynomials</span></code> &#8211; single polynomial, ideal or iterable of
defining polynomials.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A3</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A3</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="go">Closed subscheme of Affine Space of dimension 3 over Rational Field defined by:</span>
<span class="go">  x^2 - y*z</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.generic.algebraic_scheme</span> <span class="kn">import</span> <span class="n">AlgebraicScheme_subscheme_affine</span>
<span class="gp">sage: </span><span class="n">AlgebraicScheme_subscheme_affine</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="go">Closed subscheme of Affine Space of dimension 3 over Rational Field defined by:</span>
<span class="go">  x^2 - y*z</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.dimension">
<code class="descname">dimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the affine algebraic subscheme.</p>
<p>OUTPUT:</p>
<p>Integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Something less obvious:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span>
<span class="go">Closed subscheme of Affine Space of dimension 4 over Rational Field defined by:</span>
<span class="go">  x^2,</span>
<span class="go">  x^2*y^2 + z^2,</span>
<span class="go">  z^2 - w^2,</span>
<span class="go">  10*x^2 - z^2 + w^2</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.intersection_multiplicity">
<code class="descname">intersection_multiplicity</code><span class="sig-paren">(</span><em>X</em>, <em>P</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.intersection_multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection multiplicity of this subscheme and the subscheme <code class="docutils literal"><span class="pre">X</span></code> at the point <code class="docutils literal"><span class="pre">P</span></code>.</p>
<p>The intersection of this subscheme with <code class="docutils literal"><span class="pre">X</span></code> must be proper, that is <span class="math">\(\mathrm{codim}(self\cap
X) = \mathrm{codim}(self) + \mathrm{codim}(X)\)</span>, and must also be finite. We use Serre&#8217;s Tor
formula to compute the intersection multiplicity. If <span class="math">\(I\)</span>, <span class="math">\(J\)</span> are the defining ideals of <code class="docutils literal"><span class="pre">self</span></code>, <code class="docutils literal"><span class="pre">X</span></code>,
respectively, then this is <span class="math">\(\sum_{i=0}^{\infty}(-1)^i\mathrm{length}(\mathrm{Tor}_{\mathcal{O}_{A,p}}^{i}
(\mathcal{O}_{A,p}/I,\mathcal{O}_{A,p}/J))\)</span> where <span class="math">\(A\)</span> is the affine ambient space of these subschemes.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">X</span></code> &#8211; subscheme in the same ambient space as this subscheme.</li>
<li><code class="docutils literal"><span class="pre">P</span></code> &#8211; a point in the intersection of this subscheme with <code class="docutils literal"><span class="pre">X</span></code>.</li>
</ul>
<p>OUTPUT: An integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">Curve</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span> <span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">Curve</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">],</span> <span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">A</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="n">w</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">A</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">21</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">28</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">21</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">21</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span> \
<span class="go">+ 2*b^2 - 2*b, 0])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">A</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">the intersection of this subscheme and (=Closed subscheme of Affine Space of dimension 3</span>
<span class="go">over Rational Field defined by: z - 1, -x^2 + y) must be proper and finite</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">w</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">A</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">the intersection of this subscheme and (=Closed subscheme of Affine Space of dimension 5</span>
<span class="go">over Rational Field defined by: y*w + z) must be proper and finite</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.is_smooth">
<code class="descname">is_smooth</code><span class="sig-paren">(</span><em>point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.is_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the algebraic subscheme is smooth.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">point</span></code> &#8211; A point or <code class="docutils literal"><span class="pre">None</span></code> (default). The point to
test smoothness at.</li>
</ul>
<p>OUTPUT:</p>
<p>Boolean. If no point was specified, returns whether the
algebraic subscheme is smooth everywhere. Otherwise,
smoothness at the specified point is tested.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  -x^3 + y^2</span>
<span class="gp">sage: </span><span class="n">smooth_point</span> <span class="o">=</span> <span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">smooth_point</span> <span class="ow">in</span> <span class="n">cuspidal_curve</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">singular_point</span> <span class="o">=</span> <span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">singular_point</span> <span class="ow">in</span> <span class="n">cuspidal_curve</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">(</span><span class="n">smooth_point</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">(</span><span class="n">singular_point</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.multiplicity">
<code class="descname">multiplicity</code><span class="sig-paren">(</span><em>P</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the multiplicity of <code class="docutils literal"><span class="pre">P</span></code> on this subscheme.</p>
<p>This is computed as the multiplicity of the local ring of this subscheme corresponding to <code class="docutils literal"><span class="pre">P</span></code>. This
subscheme must be defined over a field. An error is raised if <code class="docutils literal"><span class="pre">P</span></code> is not a point on this subscheme.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">P</span></code> &#8211; a point on this subscheme.</li>
</ul>
<p>OUTPUT:</p>
<p>An integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">z</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">7</span><span class="p">,</span> <span class="n">w</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">A</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">A</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">23</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">curve</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">7</span> <span class="o">-</span> <span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">v</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">A</span><span class="p">([</span><span class="mi">22</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">7</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">A</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">A</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.projective_closure">
<code class="descname">projective_closure</code><span class="sig-paren">(</span><em>i=None</em>, <em>PP=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.projective_closure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projective closure of this affine subscheme.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">i</span></code> &#8211; (default: None) determines the embedding to use to compute the projective
closure of this affine subscheme. The embedding used is the one which has a 1 in the
i-th coordinate, numbered from 0.</li>
<li><code class="docutils literal"><span class="pre">PP</span></code> &#8211; (default: None) ambient projective space, i.e., ambient space
of codomain of morphism; this is constructed if it is not given.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a projective subscheme.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">projective_closure</span><span class="p">()</span>
<span class="go">Closed subscheme of Projective Space of dimension 4 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">  x0^2 - x1*x4,</span>
<span class="go">  x0*x1 - x2*x4,</span>
<span class="go">  x1^2 - x3*x4,</span>
<span class="go">  x0*x2 - x3*x4,</span>
<span class="go">  x1*x2 - x0*x3,</span>
<span class="go">  x2^2 - x1*x3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">z</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">projective_closure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.projective_embedding">
<code class="descname">projective_embedding</code><span class="sig-paren">(</span><em>i=None</em>, <em>PP=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine.projective_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a morphism from this affine scheme into an ambient
projective space of the same dimension.</p>
<p>The codomain of this morphism is the projective closure of this affine scheme in <code class="docutils literal"><span class="pre">PP</span></code>,
if given, or otherwise in a new projective space that is constructed.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">i</span></code> &#8211; integer (default: dimension of self = last
coordinate) determines which projective embedding to compute. The
embedding is that which has a 1 in the i-th coordinate, numbered
from 0.</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">PP</span></code> &#8211; (default: None) ambient projective space, i.e., ambient space</dt>
<dd><p class="first last">of codomain of morphism; this is constructed if it is not given.</p>
</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">projective_embedding</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Affine Space of dimension 3 over Integer Ring defined by:</span>
<span class="go">  x*y - z</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 3 over Integer Ring defined by:</span>
<span class="go">  x0*x1 - x2*x3</span>
<span class="go">  Defn: Defined on coordinates by sending (x, y, z) to</span>
<span class="go">        (x : y : z : 1)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">ZZ</span><span class="p">,</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">projective_embedding</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Affine Space of dimension 3 over Integer</span>
<span class="go">Ring defined by:</span>
<span class="go">  x^2 - y*z</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 3 over Integer</span>
<span class="go">Ring defined by:</span>
<span class="go">  u0^2 - u2*u3</span>
<span class="go">  Defn: Defined on coordinates by sending (x, y, z) to</span>
<span class="go">        (x : 1 : y : z)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">projective_embedding</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Affine Space of dimension 3 over Rational</span>
<span class="go">Field defined by:</span>
<span class="go">  -x^2 + y,</span>
<span class="go">  -x^3 + z</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 3 over</span>
<span class="go">Rational Field defined by:</span>
<span class="go">  x0^2 - x1*x3,</span>
<span class="go">  x0*x1 - x2*x3,</span>
<span class="go">  x1^2 - x0*x2</span>
<span class="go">  Defn: Defined on coordinates by sending (x, y, z) to</span>
<span class="go">        (x : y : z : 1)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine_toric">
<em class="property">class </em><code class="descclassname">sage.schemes.generic.algebraic_scheme.</code><code class="descname">AlgebraicScheme_subscheme_affine_toric</code><span class="sig-paren">(</span><em>toric_variety</em>, <em>polynomials</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine_toric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric</span></code></a></p>
<p>Construct an algebraic subscheme of an affine toric variety.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not create objects of this class directly. The preferred
method to construct such subschemes is to use
<code class="xref py py-meth docutils literal"><span class="pre">subscheme()</span></code> method of
<code class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">varieties</span></code>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">toric_variety</span></code> &#8211; ambient <code class="xref py py-class docutils literal"><span class="pre">affine</span> <span class="pre">toric</span> <span class="pre">variety</span></code>;</li>
<li><code class="docutils literal"><span class="pre">polynomials</span></code> &#8211; single polynomial, list, or ideal of defining
polynomials in the coordinate ring of <code class="docutils literal"><span class="pre">toric_variety</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine_toric" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine_toric"><code class="xref py py-class docutils literal"><span class="pre">algebraic</span> <span class="pre">subscheme</span> <span class="pre">of</span> <span class="pre">an</span> <span class="pre">affine</span> <span class="pre">toric</span> <span class="pre">variety</span></code></a>.</p>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining s, t, x, y</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.schemes.generic.algebraic_scheme</span> <span class="kn">as</span> <span class="nn">SCM</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">SCM</span><span class="o">.</span><span class="n">AlgebraicScheme_subscheme_toric</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">P1xP1</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span>
<span class="go">Closed subscheme of 2-d CPR-Fano toric variety</span>
<span class="go">covered by 4 affine patches defined by:</span>
<span class="go">  s*x + t*y,</span>
<span class="go">  x^3 + y^3</span>
</pre></div>
</div>
<p>A better way to construct the same scheme as above:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Closed subscheme of 2-d CPR-Fano toric variety</span>
<span class="go">covered by 4 affine patches defined by:</span>
<span class="go">  s*x + t*y,</span>
<span class="go">  x^3 + y^3</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine_toric.dimension">
<code class="descname">dimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine_toric.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>integer.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.&lt;</span><span class="n">s0</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">t1</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">s0</span><span class="o">-</span><span class="n">s1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>A more complicated example where the ambient toric variety is
not smooth:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2_Z2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span>
<span class="go">Closed subscheme of 2-d affine toric variety defined by:</span>
<span class="go">  x*y,</span>
<span class="go">  x^2</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine_toric.is_smooth">
<code class="descname">is_smooth</code><span class="sig-paren">(</span><em>point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine_toric.is_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the algebraic subscheme is smooth.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">point</span></code> &#8211; A point or <code class="docutils literal"><span class="pre">None</span></code> (default). The point to
test smoothness at.</li>
</ul>
<p>OUTPUT:</p>
<p>Boolean. If no point was specified, returns whether the
algebraic subscheme is smooth everywhere. Otherwise,
smoothness at the specified point is tested.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span>
<span class="go">Closed subscheme of 2-d affine toric variety defined by:</span>
<span class="go">  -x^3 + y^2</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">circle</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">circle</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">circle</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A more complicated example where the ambient toric variety is
not smooth:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2_Z2</span><span class="p">()</span>    <span class="c1"># 2-d affine space mod Z/2</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>   <span class="c1"># (twice the x=0 curve) mod Z/2</span>
<span class="gp">sage: </span><span class="n">Y</span>
<span class="go">Closed subscheme of 2-d affine toric variety defined by:</span>
<span class="go">  x*y,</span>
<span class="go">  x^2</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>   <span class="c1"># Y is a Weil divisor but not Cartier</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective">
<em class="property">class </em><code class="descclassname">sage.schemes.generic.algebraic_scheme.</code><code class="descname">AlgebraicScheme_subscheme_product_projective</code><span class="sig-paren">(</span><em>A</em>, <em>polynomials</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective</span></code></a></p>
<p>See <code class="docutils literal"><span class="pre">AlgebraicScheme_subscheme</span></code> for documentation.</p>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.generic.algebraic_scheme</span> <span class="kn">import</span> <span class="n">AlgebraicScheme_subscheme</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2 - y*z</span>
<span class="gp">sage: </span><span class="n">AlgebraicScheme_subscheme</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2 - y*z</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.affine_patch">
<code class="descname">affine_patch</code><span class="sig-paren">(</span><em>I</em>, <em>return_embedding=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.affine_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(I^{th}\)</span> affine patch of this projective scheme
where &#8216;I&#8217; is a multi-index.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">I</span></code> &#8211; a list or tuple of positive integers</li>
<li><code class="docutils literal"><span class="pre">return_embedding</span></code> &#8211; Boolean, if true the projective embedding is also returned</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>An affine algebraic scheme</li>
<li>An embedding into a product of projective space (optional)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">u</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">v</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.</span><span class="n">affine_patch</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(Closed subscheme of Affine Space of dimension 4 over Rational Field defined by:</span>
<span class="go">  x0^2*x1 - 1,</span>
<span class="go">  x1^2 - x2^2,</span>
<span class="go">  x3^3 - 1, Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Affine Space of dimension 4 over Rational Field defined by:</span>
<span class="go">  x0^2*x1 - 1,</span>
<span class="go">  x1^2 - x2^2,</span>
<span class="go">  x3^3 - 1</span>
<span class="go">  To:   Closed subscheme of Product of projective spaces P^3 x P^1 over Rational Field defined by:</span>
<span class="go">  -x^3 + y^2*z,</span>
<span class="go">  z^2 - w^2,</span>
<span class="go">  u^3 - v^3</span>
<span class="go">  Defn: Defined on coordinates by sending (x0, x1, x2, x3) to</span>
<span class="go">        (1 : x0 : x1 : x2 , x3 : 1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.dimension">
<code class="descname">dimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the algebraic subscheme.</p>
<p>OUTPUT:</p>
<p>Integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span> <span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> \
<span class="go">((-w^2 - u*w - u^2)*y^2 + (-u*w - v^2)*z*y + (-w^2 + (-v - u)*w)*z^2)</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">L</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">u</span><span class="o">-</span><span class="n">v</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">CC</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">CC</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">u</span><span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.intersection_multiplicity">
<code class="descname">intersection_multiplicity</code><span class="sig-paren">(</span><em>X</em>, <em>P</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.intersection_multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection multiplicity of this subscheme and the subscheme <code class="docutils literal"><span class="pre">X</span></code> at the point <code class="docutils literal"><span class="pre">P</span></code>.</p>
<p>This uses the intersection_multiplicity function for affine subschemes on affine patches of this subscheme
and <code class="docutils literal"><span class="pre">X</span></code> that contain <code class="docutils literal"><span class="pre">P</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">X</span></code> &#8211; subscheme in the same ambient space as this subscheme.</li>
<li><code class="docutils literal"><span class="pre">P</span></code> &#8211; a point in the intersection of this subscheme with <code class="docutils literal"><span class="pre">X</span></code>.</li>
</ul>
<p>OUTPUT: An integer.</p>
<p>EXAMPLES:</p>
<p>Multiplicity of a fixed point of the map <span class="math">\(z^2 + \frac{1}{4}\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">u</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">rational_points</span><span class="p">()</span>
<span class="go">[(1 : 0 , 1 : 0), (1/2 : 1 , 1/2 : 1)]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">PP</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">z</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">v</span><span class="o">*</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">PP</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<span class="go">16</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">u</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">w</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">PP</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">the intersection of this subscheme and (=Closed subscheme of Affine Space of dimension 4</span>
<span class="go">over Rational Field defined by: x2^3 - x3^3, -x1*x3 + x0, -x1^3*x2 + x3^2) must be proper and finite</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.is_smooth">
<code class="descname">is_smooth</code><span class="sig-paren">(</span><em>point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.is_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the algebraic subscheme is smooth.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span> <span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> \
<span class="go">((-w^2 - u*w - u^2)*y^2 + (-u*w - v^2)*z*y + (-w^2 + (-v - u)*w)*z^2)</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">L</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Not Implemented</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.multiplicity">
<code class="descname">multiplicity</code><span class="sig-paren">(</span><em>P</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the multiplicity of <code class="docutils literal"><span class="pre">P</span></code> on this subscheme.</p>
<p>This is computed as the multiplicity of the corresponding point on an affine patch of this subscheme
that contains <code class="docutils literal"><span class="pre">P</span></code>. This subscheme must be defined over a field. An error is returned if <code class="docutils literal"><span class="pre">P</span></code>
not a point on this subscheme.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">P</span></code> &#8211; a point on this subscheme.</li>
</ul>
<p>OUTPUT: an integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">PP</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">PP</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">u</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">u</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">w</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">w</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">PP</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">PP</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.segre_embedding">
<code class="descname">segre_embedding</code><span class="sig-paren">(</span><em>PP=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_product_projective.segre_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Segre embedding of this subscheme into the appropriate projective
space.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">PP</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) ambient image projective space;
this is constructed if it is not given.</li>
</ul>
<p>OUTPUT:</p>
<p>Hom from this subscheme to the appropriate subscheme of projective space</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span> <span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">((</span><span class="o">-</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> \
<span class="go">((-w^2 - u*w - u^2)*y^2 + (-u*w - v^2)*z*y + (-w^2 + (-v - u)*w)*z^2)</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">L</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">segre_embedding</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">CC</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span><span class="o">.</span><span class="n">segre_embedding</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Product of projective spaces P^1 x P^1 x P^1</span>
<span class="go">over Complex Field with 53 bits of precision defined by:</span>
<span class="go">  (no polynomials)</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 7 over Complex</span>
<span class="go">Field with 53 bits of precision defined by:</span>
<span class="go">  -u5*u6 + u4*u7,</span>
<span class="go">  -u3*u6 + u2*u7,</span>
<span class="go">  -u3*u4 + u2*u5,</span>
<span class="go">  -u3*u5 + u1*u7,</span>
<span class="go">  -u3*u4 + u1*u6,</span>
<span class="go">  -u3*u4 + u0*u7,</span>
<span class="go">  -u2*u4 + u0*u6,</span>
<span class="go">  -u1*u4 + u0*u5,</span>
<span class="go">  -u1*u2 + u0*u3</span>
<span class="go">  Defn: Defined by sending (x : y , u : v , s : t) to</span>
<span class="go">        (x*u*s : x*u*t : x*v*s : x*v*t : y*u*s : y*u*t : y*v*s : y*v*t).</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProductProjectiveSpaces</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">u</span><span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">segre_embedding</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Product of projective spaces P^2 x P^1 x P^1</span>
<span class="go">over Integer Ring defined by:</span>
<span class="go">  x^3,</span>
<span class="go">  u - v,</span>
<span class="go">  s^2 - t^2</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 11 over</span>
<span class="go">Integer Ring defined by:</span>
<span class="go">  u10^2 - u11^2,</span>
<span class="go">  u9 - u11,</span>
<span class="go">  u8 - u10,</span>
<span class="go">  -u7*u10 + u6*u11,</span>
<span class="go">  u6*u10 - u7*u11,</span>
<span class="go">  u6^2 - u7^2,</span>
<span class="go">  u5 - u7,</span>
<span class="go">  u4 - u6,</span>
<span class="go">  u3^3,</span>
<span class="go">  -u3*u10 + u2*u11,</span>
<span class="go">  u2*u10 - u3*u11,</span>
<span class="go">  -u3*u6 + u2*u7,</span>
<span class="go">  u2*u6 - u3*u7,</span>
<span class="go">  u2*u3^2,</span>
<span class="go">  u2^2 - u3^2,</span>
<span class="go">  u1 - u3,</span>
<span class="go">  u0 - u2</span>
<span class="go">  Defn: Defined by sending (x : y : z , u : v , s : t) to</span>
<span class="go">        (x*u*s : x*u*t : x*v*s : x*v*t : y*u*s : y*u*t : y*v*s : y*v*t :</span>
<span class="go">z*u*s : z*u*t : z*v*s : z*v*t).</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective">
<em class="property">class </em><code class="descclassname">sage.schemes.generic.algebraic_scheme.</code><code class="descname">AlgebraicScheme_subscheme_projective</code><span class="sig-paren">(</span><em>A</em>, <em>polynomials</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme</span></code></a></p>
<p>Construct an algebraic subscheme of projective space.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not create objects of this class directly. The
preferred method to construct such subschemes is to use
<code class="xref py py-meth docutils literal"><span class="pre">subscheme()</span></code>
method of <a class="reference internal" href="../projective/projective_space.html#sage.schemes.projective.projective_space.ProjectiveSpace_field" title="sage.schemes.projective.projective_space.ProjectiveSpace_field"><code class="xref py py-class docutils literal"><span class="pre">projective</span> <span class="pre">space</span></code></a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">A</span></code> &#8211; ambient <a class="reference internal" href="../projective/projective_space.html#sage.schemes.projective.projective_space.ProjectiveSpace_field" title="sage.schemes.projective.projective_space.ProjectiveSpace_field"><code class="xref py py-class docutils literal"><span class="pre">projective</span> <span class="pre">space</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">polynomials</span></code> &#8211; single polynomial, ideal or iterable of
defining homogeneous polynomials.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2 - y*z</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.generic.algebraic_scheme</span> <span class="kn">import</span> <span class="n">AlgebraicScheme_subscheme_projective</span>
<span class="gp">sage: </span><span class="n">AlgebraicScheme_subscheme_projective</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2 - y*z</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.Chow_form">
<code class="descname">Chow_form</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.Chow_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Chow form associated to this subscheme.</p>
<p>For a <span class="math">\(k\)</span>-dimensional subvariety of <span class="math">\(\mathbb{P}^N\)</span> of degree <span class="math">\(D\)</span>.
The <span class="math">\((N-k-1)\)</span>-dimensional projective linear subspaces of <span class="math">\(\mathbb{P}^N\)</span>
meeting <span class="math">\(X\)</span> form a hypersurface in the Grassmannian <span class="math">\(G(N-k-1,N)\)</span>.
The homogeneous form of degree <span class="math">\(D\)</span> defining this hypersurface in Plucker
coordinates is called the Chow form of <span class="math">\(X\)</span>.</p>
<p>The base ring needs to be a number field, finite field, or <span class="math">\(\QQbar\)</span>.</p>
<p>ALGORITHM:</p>
<p>For a <span class="math">\(k\)</span>-dimension subscheme <span class="math">\(X\)</span> consider the <span class="math">\(k+1\)</span> linear forms
<span class="math">\(l_i = u_{i0}x_0 + \cdots + u_{in}x_n\)</span>. Let <span class="math">\(J\)</span> be the ideal in the
polynomial ring <span class="math">\(K[x_i,u_{ij}]\)</span> defined by the equations of <span class="math">\(X\)</span> and the <span class="math">\(l_i\)</span>.
Let <span class="math">\(J'\)</span> be the saturation of <span class="math">\(J\)</span> with respect to the irrelevant ideal of
the ambient projective space of <span class="math">\(X\)</span>. The elimination ideal <span class="math">\(I = J' \cap K[u_{ij}]\)</span>
is a principal ideal, let <span class="math">\(R\)</span> be its generator. The Chow form is obtained by
writing <span class="math">\(R\)</span> as a polynomial in Plucker coordinates (i.e. bracket polynomials).
[DalbecSturmfels].</p>
<p>OUTPUT: a homogeneous polynomial.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="dalbecsturmfels" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[DalbecSturmfels]</td><td>J. Dalbec and B. Sturmfels. Invariant methods in discrete and computational geometry,
chapter Introduction to Chow forms, pages 37-58. Springer Netherlands, 1994.</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x3</span><span class="o">+</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="o">-</span><span class="n">x0</span><span class="p">,</span><span class="n">x2</span><span class="o">-</span><span class="n">x3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Chow_form</span><span class="p">()</span>
<span class="go">t0 - t1 + t2 + t3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x3</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span><span class="mi">101</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Chow_form</span><span class="p">()</span>
<span class="go">t0^2 - 101*t2^2 - 3*t1*t3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;=</span><span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x0</span><span class="o">*</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x0</span><span class="o">*</span><span class="n">x3</span><span class="o">-</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">,</span> <span class="n">x1</span><span class="o">*</span><span class="n">x3</span><span class="o">-</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Ch</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">Chow_form</span><span class="p">();</span> <span class="n">Ch</span>
<span class="go">t2^3 + 2*t2^2*t3 + t2*t3^2 - 3*t1*t2*t4 - t1*t3*t4 + t0*t4^2 + t1^2*t5</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme_from_Chow_form</span><span class="p">(</span><span class="n">Ch</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">Y</span>
<span class="go">Closed subscheme of Projective Space of dimension 3 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">  x2^2*x3 - x1*x3^2,</span>
<span class="go">  -x2^3 + x0*x3^2,</span>
<span class="go">  -x2^2*x3 + x1*x3^2,</span>
<span class="go">  x1*x2*x3 - x0*x3^2,</span>
<span class="go">  3*x1*x2^2 - 3*x0*x2*x3,</span>
<span class="go">  -2*x1^2*x3 + 2*x0*x2*x3,</span>
<span class="go">  -3*x1^2*x2 + 3*x0*x1*x3,</span>
<span class="go">  x1^3 - x0^2*x3,</span>
<span class="go">  x2^3 - x1*x2*x3,</span>
<span class="go">  -3*x1*x2^2 + 2*x1^2*x3 + x0*x2*x3,</span>
<span class="go">  2*x0*x2^2 - 2*x0*x1*x3,</span>
<span class="go">  3*x1^2*x2 - 2*x0*x2^2 - x0*x1*x3,</span>
<span class="go">  -x0*x1*x2 + x0^2*x3,</span>
<span class="go">  -x0*x1^2 + x0^2*x2,</span>
<span class="go">  -x1^3 + x0*x1*x2,</span>
<span class="go">  x0*x1^2 - x0^2*x2</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">defining_ideal</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">())))[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Ideal (x2^2 - x1*x3, x1*x2 - x0*x3, x1^2 - x0*x2) of Multivariate</span>
<span class="go">Polynomial Ring in x0, x1, x2, x3 over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.affine_patch">
<code class="descname">affine_patch</code><span class="sig-paren">(</span><em>i</em>, <em>AA=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.affine_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(i^{th}\)</span> affine patch of this projective scheme.
This is the intersection with this <span class="math">\(i^{th}\)</span> affine patch of
its ambient space.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">i</span></code> &#8211; integer between 0 and dimension of self, inclusive.</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">AA</span></code> &#8211; (default: None) ambient affine space, this is constructed</dt>
<dd><p class="first last">if it is not given.</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<p>An affine algebraic scheme with fixed
<code class="xref py py-meth docutils literal"><span class="pre">embedding_morphism()</span></code> equal to the default
<code class="xref py py-meth docutils literal"><span class="pre">projective_embedding()</span></code> map`.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PP</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;X,Y,Z&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">PP</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">X</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">Y</span> <span class="o">+</span> <span class="n">Y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">Z</span> <span class="o">+</span> <span class="n">Z</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">affine_patch</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x0^3*x1 + x1^3 + x0</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x0^3*x1 + x1^3 + x0</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  X^3*Y + Y^3*Z + X*Z^3</span>
<span class="go">  Defn: Defined on coordinates by sending (x0, x1) to</span>
<span class="go">        (1 : x0 : x1)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">projective_embedding</span><span class="p">()</span> <span class="ow">is</span> <span class="n">U</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">projective_embedding</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">affine_patch</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">affine_patch</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Integer Ring</span>
<span class="go">defined by:</span>
<span class="go">  x^2 - y</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.degree">
<code class="descname">degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of this projective subscheme.</p>
<p>If <span class="math">\(P(t) = a_{m}t^m + \ldots + a_{0}\)</span> is the the Hilbert polynomial of this subscheme, then
the degree is <span class="math">\(a_{m}m!\)</span>.</p>
<p>OUTPUT: Integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">u</span><span class="o">^</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">w</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">63</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.dimension">
<code class="descname">dimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the projective algebraic subscheme.</p>
<p>OUTPUT:</p>
<p>Integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">z</span><span class="p">),</span> <span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="p">)])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Something less obvious:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P3</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P3</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span>
<span class="go">Closed subscheme of Projective Space of dimension 4 over Rational Field defined by:</span>
<span class="go">  x^2,</span>
<span class="go">  x^2*y^2 + z^2*t^2,</span>
<span class="go">  z^2 - w^2,</span>
<span class="go">  10*x^2 - z^2 + w^2</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.dual">
<code class="descname">dual</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.dual" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projective dual of the given subscheme of projective space.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">X</span></code> &#8211; A subscheme of projective space. At present, <code class="docutils literal"><span class="pre">X</span></code> is
required to be an irreducible and reduced hypersurface defined
over <span class="math">\(\QQ\)</span> or a finite field.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The dual of <code class="docutils literal"><span class="pre">X</span></code> as a subscheme of the dual projective space.</li>
</ul>
<p>EXAMPLES:</p>
<p>The dual of a smooth conic in the plane is also a smooth conic:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  y0^2 + y1^2 + y2^2</span>
</pre></div>
</div>
<p>The dual of the twisted cubic curve in projective 3-space is a singular
quartic surface. In the following example, we compute the dual of this
surface, which by double duality is equal to the twisted cubic itself.
The output is the twisted cubic as an intersection of three quadrics:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="mi">18</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span> <span class="mi">27</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="go">Closed subscheme of Projective Space of dimension 3 over</span>
<span class="go">Rational Field defined by:</span>
<span class="go">  y2^2 - y1*y3,</span>
<span class="go">  y1*y2 - y0*y3,</span>
<span class="go">  y1^2 - y0*y2</span>
</pre></div>
</div>
<p>The singular locus of the quartic surface in the last example
is itself supported on a twisted cubic:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Jacobian</span><span class="p">()</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">Ideal (z^2 - 3*y*w, y*z - 9*x*w, y^2 - 3*x*z) of Multivariate</span>
<span class="go">Polynomial Ring in x, y, z, w over Rational Field</span>
</pre></div>
</div>
<p>An example over a finite field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">61</span><span class="p">),</span> <span class="s1">&#39;a,b,c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over</span>
<span class="go">Finite Field of size 61 defined by:</span>
<span class="go">y0^2 - 30*y1^2 - 20*y2^2</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;a,b,c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">base ring must be QQ or a finite field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.intersection_multiplicity">
<code class="descname">intersection_multiplicity</code><span class="sig-paren">(</span><em>X</em>, <em>P</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.intersection_multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection multiplicity of this subscheme and the subscheme <code class="docutils literal"><span class="pre">X</span></code> at the point <code class="docutils literal"><span class="pre">P</span></code>.</p>
<p>This uses the intersection_multiplicity function for affine subschemes on affine patches of this subscheme
and <code class="docutils literal"><span class="pre">X</span></code> that contain <code class="docutils literal"><span class="pre">P</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">X</span></code> &#8211; subscheme in the same ambient space as this subscheme.</li>
<li><code class="docutils literal"><span class="pre">P</span></code> &#8211; a point in the intersection of this subscheme with <code class="docutils literal"><span class="pre">X</span></code>.</li>
</ul>
<p>OUTPUT: An integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">Curve</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">Curve</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">P</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">Q1</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">P</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">Q2</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">*</span><span class="n">w</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">z</span> <span class="o">-</span> <span class="n">w</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">P</span><span class="p">([</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Q1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">P</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Q2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">w</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">P</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection_multiplicity</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">the intersection of this subscheme and (=Closed subscheme of Affine Space of dimension 3</span>
<span class="go">over Rational Field defined by:</span>
<span class="go">  x1^2 + x2^2 - 2*x0,</span>
<span class="go">  x0^2 - x2^2) must be proper and finite</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.is_smooth">
<code class="descname">is_smooth</code><span class="sig-paren">(</span><em>point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.is_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the algebraic subscheme is smooth.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">point</span></code> &#8211; A point or <code class="docutils literal"><span class="pre">None</span></code> (default). The point to
test smoothness at.</li>
</ul>
<p>OUTPUT:</p>
<p>Boolean. If no point was specified, returns whether the
algebraic subscheme is smooth everywhere. Otherwise,
smoothness at the specified point is tested.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  -x^3 + y^2*z</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>  <span class="c1"># one of the few cases where the cone over the subvariety is smooth</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.multiplicity">
<code class="descname">multiplicity</code><span class="sig-paren">(</span><em>P</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the multiplicity of <code class="docutils literal"><span class="pre">P</span></code> on this subscheme.</p>
<p>This is computed as the multiplicity of the corresponding point on an affine patch of this subscheme
that contains <code class="docutils literal"><span class="pre">P</span></code>. This subscheme must be defined over a field. An error is returned if <code class="docutils literal"><span class="pre">P</span></code>
not a point on this subscheme.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">P</span></code> &#8211; a point on this subscheme.</li>
</ul>
<p>OUTPUT:</p>
<p>An integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">w</span><span class="o">^</span><span class="mi">7</span> <span class="o">-</span> <span class="n">t</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">P</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">P</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Q3</span> <span class="o">=</span> <span class="n">P</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q3</span><span class="p">)</span>
<span class="go">7</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">z</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">P</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">29</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">Curve</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">17</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">8</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">P</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.neighborhood">
<code class="descname">neighborhood</code><span class="sig-paren">(</span><em>point</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.neighborhood" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an affine algebraic subscheme isomorphic to a
neighborhood of the <code class="docutils literal"><span class="pre">point</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">point</span></code> &#8211; a point of the projective subscheme.</li>
</ul>
<p>OUTPUT:</p>
<p>An affine algebraic scheme (polynomial equations in affine
space) <code class="docutils literal"><span class="pre">result</span></code> such that</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism"><code class="xref py py-meth docutils literal"><span class="pre">embedding_morphism</span></code></a> is an isomorphism to a
neighborhood of <code class="docutils literal"><span class="pre">point</span></code></li>
<li><a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_center" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_center"><code class="xref py py-meth docutils literal"><span class="pre">embedding_center</span></code></a>
is mapped to <code class="docutils literal"><span class="pre">point</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">s</span>
<span class="go">(0 : -3/2 : 1)</span>
<span class="gp">sage: </span><span class="n">patch</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">neighborhood</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">patch</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x0 + 3*x1</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x0 + 3*x1</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x + 2*y + 3*z</span>
<span class="go">  Defn: Defined on coordinates by sending (x0, x1) to</span>
<span class="go">        (x0 : -3/2 : x1 + 1)</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_center</span><span class="p">()</span>
<span class="go">(0, 0)</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(0 : -3/2 : 1)</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()(</span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_center</span><span class="p">())</span>
<span class="go">(0 : -3/2 : 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.nth_iterate">
<code class="descname">nth_iterate</code><span class="sig-paren">(</span><em>f</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.nth_iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>The nth forward image of this scheme by the map <code class="docutils literal"><span class="pre">f</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">f</span></code> &#8211; a SchmemMorphism_polynomial with <code class="docutils literal"><span class="pre">self</span></code> in <code class="docutils literal"><span class="pre">f.domain()</span></code></li>
<li><code class="docutils literal"><span class="pre">n</span></code> &#8211; a positive integer.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A subscheme in <code class="docutils literal"><span class="pre">f.codomain()</span></code></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nth_iterate</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">w</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="n">z</span><span class="p">]),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">Closed subscheme of Projective Space of dimension 3 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">  y - z,</span>
<span class="go">  x - w</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PS</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">PS</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PS</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">nth_iterate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">must be a forward orbit</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PS</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;=</span><span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Hom</span><span class="p">(</span><span class="n">PS</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PS</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">nth_iterate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">map must be an endomorphism for iteration</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PS</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">PS</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PS</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">nth_iterate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Attempt to coerce non-integral RealNumber to Integer</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.orbit">
<code class="descname">orbit</code><span class="sig-paren">(</span><em>f</em>, <em>N</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.orbit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the orbit of this scheme by <code class="docutils literal"><span class="pre">f</span></code>.</p>
<p>If <span class="math">\(N\)</span> is an integer it returns <span class="math">\([self,f(self),\ldots,f^N(self)]\)</span>.
If <span class="math">\(N\)</span> is a list or tuple <span class="math">\(N=[m,k]\)</span> it returns <span class="math">\([f^m(self),\ldots,f^k(self)\)</span>].</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">f</span></code> &#8211; a <code class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_polynomial</span></code> with <code class="docutils literal"><span class="pre">self</span></code> in <code class="docutils literal"><span class="pre">f.domain()</span></code></li>
<li><code class="docutils literal"><span class="pre">N</span></code> &#8211; a non-negative integer or list or tuple of two non-negative integers</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of projective subschemes</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">,(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">,(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">orbit</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="p">]),</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[Closed subscheme of Projective Space of dimension 3 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">   x,</span>
<span class="go"> Closed subscheme of Projective Space of dimension 3 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">   w,</span>
<span class="go"> Closed subscheme of Projective Space of dimension 3 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">   z - w,</span>
<span class="go"> Closed subscheme of Projective Space of dimension 3 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">   y - z,</span>
<span class="go"> Closed subscheme of Projective Space of dimension 3 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">   x - y,</span>
<span class="go"> Closed subscheme of Projective Space of dimension 3 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">   x - w]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PS</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Hom</span><span class="p">(</span><span class="n">PS</span><span class="p">,</span> <span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PS</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">orbit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">map must be an endomorphism for iteration</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PS</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">PS</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PS</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">orbit</span><span class="p">(</span><span class="n">f</span><span class="p">,[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">orbit bounds must be non-negative</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.preimage">
<code class="descname">preimage</code><span class="sig-paren">(</span><em>f</em>, <em>k=1</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective.preimage" title="Permalink to this definition">¶</a></dt>
<dd><p>The subscheme that maps to this scheme by the map <span class="math">\(f^k\)</span>.</p>
<p>In particular, <span class="math">\(f^{-k}(V(h_1,\ldots,h_t)) = V(h_1 \circ f^k, \ldots, h_t \circ f^k)\)</span>.
Map must be a morphism and also must be an endomorphism for <span class="math">\(k &gt; 1\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">f</span></code> - a map whose codomain contains this scheme</li>
<li><code class="docutils literal"><span class="pre">k</span></code> - a positive integer</li>
<li><code class="docutils literal"><span class="pre">check</span></code> &#8211; Boolean, if <code class="docutils literal"><span class="pre">False</span></code> no input checking is done</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a subscheme in the domain of <code class="docutils literal"><span class="pre">f</span></code>.</li>
</ul>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PS</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">PS</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PS</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Integer Ring</span>
<span class="go">defined by:</span>
<span class="go">  -x^2 + y^2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">rational_preimages</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">w</span><span class="o">-</span><span class="n">t</span><span class="p">]))</span>
<span class="go">Closed subscheme of Projective Space of dimension 4 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">  x^2 - y^2 - z^2,</span>
<span class="go">  w^4 + 2*w^2*t^2 + t^4,</span>
<span class="go">  -t^2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P3</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Hom</span><span class="p">(</span><span class="n">P1</span><span class="p">,</span> <span class="n">P3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P3</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">u</span><span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">-</span><span class="n">w</span><span class="p">,</span> <span class="n">u</span><span class="o">+</span><span class="n">t</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Closed subscheme of Projective Space of dimension 1 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">  x^2 - y^2,</span>
<span class="go">  x^2 - y^2,</span>
<span class="go">  x^2 + x*y</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P3</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Hom</span><span class="p">(</span><span class="n">P3</span><span class="p">,</span> <span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">map must be a morphism</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PS</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">PS</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">PS</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">map must be a morphism</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PS</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">PS</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">subscheme must be in ambient space of codomain</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ProjectiveSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Closed subscheme of Projective Space of dimension 2 over Rational Field</span>
<span class="go">defined by:</span>
<span class="go">  x^4 - y^4</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric">
<em class="property">class </em><code class="descclassname">sage.schemes.generic.algebraic_scheme.</code><code class="descname">AlgebraicScheme_subscheme_toric</code><span class="sig-paren">(</span><em>toric_variety</em>, <em>polynomials</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme</span></code></a></p>
<p>Construct an algebraic subscheme of a toric variety.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not create objects of this class directly. The
preferred method to construct such subschemes is to use
<code class="xref py py-meth docutils literal"><span class="pre">subscheme()</span></code> method of <a class="reference internal" href="../toric/variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal"><span class="pre">toric</span>
<span class="pre">varieties</span></code></a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">toric_variety</span></code> &#8211; ambient <code class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">variety</span></code>;</li>
<li><code class="docutils literal"><span class="pre">polynomials</span></code> &#8211; single polynomial, list, or ideal of defining
polynomials in the coordinate ring of <code class="docutils literal"><span class="pre">toric_variety</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric"><code class="xref py py-class docutils literal"><span class="pre">algebraic</span> <span class="pre">subscheme</span> <span class="pre">of</span> <span class="pre">a</span> <span class="pre">toric</span> <span class="pre">variety</span></code></a>.</li>
</ul>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining s, t, x, y</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.schemes.generic.algebraic_scheme</span> <span class="kn">as</span> <span class="nn">SCM</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">SCM</span><span class="o">.</span><span class="n">AlgebraicScheme_subscheme_toric</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">P1xP1</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span>
<span class="go">Closed subscheme of 2-d CPR-Fano toric variety</span>
<span class="go">covered by 4 affine patches defined by:</span>
<span class="go">  s*x + t*y,</span>
<span class="go">  x^3 + y^3</span>
</pre></div>
</div>
<p>A better way to construct the same scheme as above:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Closed subscheme of 2-d CPR-Fano toric variety</span>
<span class="go">covered by 4 affine patches defined by:</span>
<span class="go">  s*x + t*y,</span>
<span class="go">  x^3 + y^3</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.affine_algebraic_patch">
<code class="descname">affine_algebraic_patch</code><span class="sig-paren">(</span><em>cone=None</em>, <em>names=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.affine_algebraic_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the affine patch corresponding to <code class="docutils literal"><span class="pre">cone</span></code> as an affine
algebraic scheme.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cone</span></code> &#8211; a <a class="reference external" href="../../../../geometry/sage/geometry/cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="(in Sage Reference Manual: Geometry v7.4)"><code class="xref py py-class docutils literal"><span class="pre">Cone</span></code></a> <span class="math">\(\sigma\)</span>
of the fan. It can be omitted for an affine toric variety,
in which case the single generating cone is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_affine"><code class="xref py py-class docutils literal"><span class="pre">affine</span> <span class="pre">algebraic</span> <span class="pre">subscheme</span></code></a>
corresponding to the patch <span class="math">\(\mathop{Spec}(\sigma^\vee \cap M)\)</span>
associated to the cone <span class="math">\(\sigma\)</span>.</p>
<p>See also <a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.affine_patch" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.affine_patch"><code class="xref py py-meth docutils literal"><span class="pre">affine_patch()</span></code></a>, which expresses the patches as
subvarieties of affine toric varieties instead.</p>
<p>REFERENCES:</p>
<blockquote>
<div>David A. Cox, &#8220;The Homogeneous Coordinate Ring of a Toric
Variety&#8221;, Lemma 2.2.
<a class="reference external" href="http://www.arxiv.org/abs/alg-geom/9210008v2">http://www.arxiv.org/abs/alg-geom/9210008v2</a></div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">affine_algebraic_patch</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  z0^3 + z1^3 + 1</span>

<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">A2Z2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AffineToricVariety</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A2Z2</span><span class="o">.</span><span class="n">affine_algebraic_patch</span><span class="p">()</span>
<span class="go">Closed subscheme of Affine Space of dimension 3 over Rational Field defined by:</span>
<span class="go">  -z0*z1 + z2^2</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">A2Z2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">patch</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">affine_algebraic_patch</span><span class="p">();</span>  <span class="n">patch</span>
<span class="go">Closed subscheme of Affine Space of dimension 3 over Rational Field defined by:</span>
<span class="go">  -z0*z1 + z2^2,</span>
<span class="go">  z0 + z1 - 1</span>
<span class="gp">sage: </span><span class="n">nbhd_patch</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">neighborhood</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">affine_algebraic_patch</span><span class="p">();</span>  <span class="n">nbhd_patch</span>
<span class="go">Closed subscheme of Affine Space of dimension 3 over Rational Field defined by:</span>
<span class="go">  -z0*z1 + z2^2,</span>
<span class="go">  z0 + z1 - 1</span>
<span class="gp">sage: </span><span class="n">nbhd_patch</span><span class="o">.</span><span class="n">embedding_center</span><span class="p">()</span>
<span class="go">(0, 1, 0)</span>
</pre></div>
</div>
<p>Here we got two defining equations. The first one describes
the singularity of the ambient space and the second is the
pull-back of <span class="math">\(x^2+y^2-1\)</span></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">lp</span> <span class="o">=</span> <span class="n">LatticePolytope</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span>                       <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CPRFanoToricVariety</span><span class="p">(</span><span class="n">Delta_polar</span><span class="o">=</span><span class="n">lp</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">v</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">u</span><span class="o">+</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">affine_algebraic_patch</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span>
<span class="go">Closed subscheme of Affine Space of dimension 4 over Rational Field defined by:</span>
<span class="go">  z0*z2 - z1*z3,</span>
<span class="go">  z1 + z3 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.affine_patch">
<code class="descname">affine_patch</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.affine_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <code class="docutils literal"><span class="pre">i</span></code>-th affine patch of <code class="docutils literal"><span class="pre">self</span></code> as an affine
toric algebraic scheme.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">i</span></code> &#8211; integer, index of a generating cone of the fan of the
ambient space of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>subscheme of an affine <a class="reference internal" href="../toric/variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">variety</span></code></a>
corresponding to the pull-back of <code class="docutils literal"><span class="pre">self</span></code> by the embedding
morphism of the <code class="docutils literal"><span class="pre">i</span></code>-th <a class="reference internal" href="../toric/variety.html#sage.schemes.toric.variety.ToricVariety_field.affine_patch" title="sage.schemes.toric.variety.ToricVariety_field.affine_patch"><code class="xref py py-meth docutils literal"><span class="pre">affine</span> <span class="pre">patch</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">ambient</span>
<span class="pre">space</span></code></a>
of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>The result is cached, so the <code class="docutils literal"><span class="pre">i</span></code>-th patch is always the same object
in memory.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">patch1</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">affine_patch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">patch1</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d affine toric variety</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [t : x] to</span>
<span class="go">        [1 : t : x : 1]</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining s, t, x, y</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">subpatch</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">affine_patch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">subpatch</span>
<span class="go">Closed subscheme of 2-d affine toric variety defined by:</span>
<span class="go">  x - 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.dimension">
<code class="descname">dimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>Integer. If <code class="docutils literal"><span class="pre">self</span></code> is empty, <span class="math">\(-1\)</span> is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining s, t, x, y</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">s</span><span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">])</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.fan">
<code class="descname">fan</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.fan" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fan of the ambient space.</p>
<p>OUTPUT:</p>
<p>A fan.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.is_smooth">
<code class="descname">is_smooth</code><span class="sig-paren">(</span><em>point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.is_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the algebraic subscheme is smooth.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">point</span></code> &#8211; A point or <code class="docutils literal"><span class="pre">None</span></code> (default). The point to
test smoothness at.</li>
</ul>
<p>OUTPUT:</p>
<p>Boolean. If no point was specified, returns whether the
algebraic subscheme is smooth everywhere. Otherwise,
smoothness at the specified point is tested.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span>
<span class="go">Closed subscheme of 2-d CPR-Fano toric variety covered by 3 affine patches defined by:</span>
<span class="go">  -x^3 + y^2*z</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">cuspidal_curve</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Any sufficiently generic cubic hypersurface is smooth:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A more complicated example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span><span class="o">.&lt;</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">x4</span><span class="p">,</span><span class="n">x5</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">disjointP1s</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x0</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">disjointP1s</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">intersectingP1s</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x0</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">intersectingP1s</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A smooth hypersurface in a compact singular toric variety:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">lp</span> <span class="o">=</span> <span class="n">LatticePolytope</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span>                       <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CPRFanoToricVariety</span><span class="p">(</span><span class="n">Delta_polar</span><span class="o">=</span><span class="n">lp</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">v</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">u</span><span class="o">+</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">is_smooth</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.neighborhood">
<code class="descname">neighborhood</code><span class="sig-paren">(</span><em>point</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_toric.neighborhood" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an toric algebraic scheme isomorphic to neighborhood of
the <code class="docutils literal"><span class="pre">point</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">point</span></code> &#8211; a point of the toric algebraic scheme.</li>
</ul>
<p>OUTPUT:</p>
<p>An affine toric algebraic scheme (polynomial equations in an
affine toric variety) with fixed
<a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_morphism"><code class="xref py py-meth docutils literal"><span class="pre">embedding_morphism()</span></code></a> and
<a class="reference internal" href="#sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_center" title="sage.schemes.generic.algebraic_scheme.AlgebraicScheme.embedding_center"><code class="xref py py-meth docutils literal"><span class="pre">embedding_center()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">s</span>
<span class="go">[0 : -3 : 2]</span>
<span class="gp">sage: </span><span class="n">patch</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">neighborhood</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">patch</span>
<span class="go">Closed subscheme of 2-d affine toric variety defined by:</span>
<span class="go">  x + 2*y + 6</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of 2-d affine toric variety defined by:</span>
<span class="go">  x + 2*y + 6</span>
<span class="go">  To:   Closed subscheme of 2-d CPR-Fano toric variety covered by 3 affine patches defined by:</span>
<span class="go">  x + 2*y + 3*z</span>
<span class="go">  Defn: Defined on coordinates by sending [x : y] to</span>
<span class="go">        [-2*y - 6 : y : 2]</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_center</span><span class="p">()</span>
<span class="go">[0 : -3]</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()(</span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_center</span><span class="p">())</span>
<span class="go">[0 : -3 : 2]</span>
</pre></div>
</div>
<p>A more complicated example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span><span class="o">.&lt;</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">x4</span><span class="p">,</span><span class="n">x5</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">twoP1</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">x0</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">patch</span> <span class="o">=</span> <span class="n">twoP1</span><span class="o">.</span><span class="n">neighborhood</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">patch</span>
<span class="go">Closed subscheme of 2-d affine toric variety defined by:</span>
<span class="go">  3*x0</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Closed subscheme of 2-d affine toric variety defined by:</span>
<span class="go">  3*x0</span>
<span class="go">  To:   Closed subscheme of 2-d CPR-Fano toric variety covered by 6 affine patches defined by:</span>
<span class="go">  x0*x3</span>
<span class="go">  Defn: Defined on coordinates by sending [x0 : x1] to</span>
<span class="go">        [0 : x1 : 2 : 3 : 4 : 5]</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_center</span><span class="p">()</span>
<span class="go">[0 : 1]</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()(</span><span class="n">patch</span><span class="o">.</span><span class="n">embedding_center</span><span class="p">())</span>
<span class="go">[0 : 1 : 2 : 3 : 4 : 5]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.schemes.generic.algebraic_scheme.is_AlgebraicScheme">
<code class="descclassname">sage.schemes.generic.algebraic_scheme.</code><code class="descname">is_AlgebraicScheme</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.generic.algebraic_scheme.is_AlgebraicScheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether <code class="docutils literal"><span class="pre">x</span></code> is an algebraic scheme.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">x</span></code> &#8211; anything.</li>
</ul>
<p>OUTPUT:</p>
<p>Boolean. Whether <code class="docutils literal"><span class="pre">x</span></code> is an an algebraic scheme, that is, a
subscheme of an ambient space over a ring defined by polynomial
equations.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A2</span><span class="o">.</span><span class="n">coordinate_ring</span><span class="p">()</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, y</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">]);</span> <span class="n">V</span>
<span class="go">Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  x^2 + y^2</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.generic.algebraic_scheme</span> <span class="kn">import</span> <span class="n">is_AlgebraicScheme</span>
<span class="gp">sage: </span><span class="n">is_AlgebraicScheme</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Affine space is itself not an algebraic scheme, though the closed
subscheme defined by no equations is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.generic.algebraic_scheme</span> <span class="kn">import</span> <span class="n">is_AlgebraicScheme</span>
<span class="gp">sage: </span><span class="n">is_AlgebraicScheme</span><span class="p">(</span><span class="n">AffineSpace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">QQ</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([]);</span> <span class="n">V</span>
<span class="go">Closed subscheme of Affine Space of dimension 10 over Rational Field defined by:</span>
<span class="go">  (no polynomials)</span>
<span class="gp">sage: </span><span class="n">is_AlgebraicScheme</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We create a more complicated closed subscheme:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">AffineSpace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">objgens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">subscheme</span><span class="p">([</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)]);</span> <span class="n">X</span>
<span class="go">Closed subscheme of Affine Space of dimension 10 over Rational Field defined by:</span>
<span class="go">x0 + x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9</span>
<span class="gp">sage: </span><span class="n">is_AlgebraicScheme</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_AlgebraicScheme</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Spec</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_AlgebraicScheme</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="ambient_space.html"
                                  title="previous chapter">Ambient Spaces</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="hypersurface.html"
                                  title="next chapter">Hypersurfaces in affine and projective space</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/generic/algebraic_scheme.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hypersurface.html" title="Hypersurfaces in affine and projective space"
             >next</a> |</li>
        <li class="right" >
          <a href="ambient_space.html" title="Ambient Spaces"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Schemes</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>