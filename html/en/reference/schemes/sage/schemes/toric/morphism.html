<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Morphisms of Toric Varieties &mdash; Sage Reference Manual v7.1: Schemes</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.1: Schemes" href="../../../index.html" />
    <link rel="next" title="Weierstrass form of a toric elliptic curve." href="weierstrass.html" />
    <link rel="prev" title="Toric ideals" href="ideal.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="weierstrass.html" title="Weierstrass form of a toric elliptic curve."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ideal.html" title="Toric ideals"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Schemes</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="morphisms-of-toric-varieties">
<span id="sage-schemes-toric-morphism"></span><h1>Morphisms of Toric Varieties<a class="headerlink" href="#morphisms-of-toric-varieties" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.toric.morphism"></span><p>There are three &#8220;obvious&#8221; ways to map toric varieties to toric
varieties:</p>
<ol class="arabic simple">
<li>Polynomial maps in local coordinates, the usual morphisms in
algebraic geometry.</li>
<li>Polynomial maps in the (global) homogeneous coordinates.</li>
<li>Toric morphisms, that is, algebraic morphisms equivariant with
respect to the torus action on the toric variety.</li>
</ol>
<p>Both 2 and 3 are special cases of 1, which is just to say that we
always remain within the realm of algebraic geometry. But apart from
that, none is included in one of the other cases. In the examples
below, we will explore some algebraic maps that can or can not be
written as a toric morphism. Often a toric morphism can be written
with polynomial maps in homogeneous coordinates, but sometimes it
cannot.</p>
<p>The toric morphisms are perhaps the most mysterious at the
beginning. Let us quickly review their definition (See Definition
3.3.3 of <a class="reference internal" href="variety.html#cls" id="id1">[CLS]</a>). Let <span class="math">\(\Sigma_1\)</span> be a fan in <span class="math">\(N_{1,\RR}\)</span> and <span class="math">\(\Sigma_2\)</span> be a
fan in <span class="math">\(N_{2,\RR}\)</span>. A morphism <span class="math">\(\phi: X_{\Sigma_1} \to X_{\Sigma_2}\)</span>
of the associated toric varieties is toric if <span class="math">\(\phi\)</span> maps the maximal
torus <span class="math">\(T_{N_1} \subseteq X_{\Sigma_1}\)</span> into <span class="math">\(T_{N_2} \subseteq
X_{\Sigma_2}\)</span> and <span class="math">\(\phi|_{T_N}\)</span> is a group homomorphism.</p>
<p>The data defining a toric morphism is precisely what defines a fan
morphism (see <a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#module-sage.geometry.fan_morphism" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-mod docutils literal"><span class="pre">fan_morphism</span></tt></a>), extending the more
familiar dictionary between toric varieties and fans. Toric geometry
is a functor from the category of fans and fan morphisms to the
category of toric varieties and toric morphisms.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not create the toric morphisms (or any morphism of schemes)
directly from the the <tt class="docutils literal"><span class="pre">SchemeMorphism...</span></tt> classes. Instead, use the
<tt class="xref py py-meth docutils literal"><span class="pre">hom()</span></tt> method common to all
algebraic schemes to create new homomorphisms.</p>
</div>
<p>EXAMPLES:</p>
<p>First, consider the following embedding of <span class="math">\(\mathbb{P}^1\)</span> into
<span class="math">\(\mathbb{P}^2\)</span></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">hom</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">],</span> <span class="n">P2</span><span class="p">)</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [u : v] to</span>
<span class="go">        [0 : u^2 + v^2 : u*v]</span>
</pre></div>
</div>
<p>This is a well-defined morphism of algebraic varieties because
homogeneously rescaled coordinates of a point of <span class="math">\(\mathbb{P}^1\)</span> map to the same
point in <span class="math">\(\mathbb{P}^2\)</span> up to its homogeneous rescalings. It is not
equivariant with respect to the torus actions</p>
<div class="math">
\[\CC^\times \times \mathbb{P}^1,
(\mu,[u:v]) \mapsto [u:\mu v]
\quad\text{and}\quad
\left(\CC^\times\right)^2 \times \mathbb{P}^2,
((\alpha,\beta),[x:y:z]) \mapsto [x:\alpha y:\beta z]
,\]</div>
<p>hence it is not a toric morphism. Clearly, the problem is that
the map in homogeneous coordinates contains summands that transform
differently under the torus action. However, this is not the only
difficulty. For example, consider</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">hom</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">],</span> <span class="n">P2</span><span class="p">);</span>  <span class="n">phi</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [u : v] to</span>
<span class="go">        [0 : u : v]</span>
</pre></div>
</div>
<p>This map is actually the embedding of the
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field.orbit_closure" title="sage.schemes.toric.variety.ToricVariety_field.orbit_closure"><tt class="xref py py-meth docutils literal"><span class="pre">orbit_closure()</span></tt></a>
associated to one of the rays of the fan of <span class="math">\(\mathbb{P}^2\)</span>. Now the
morphism is equivariant with respect to <strong>some</strong> map <span class="math">\(\CC^\times \to
(\CC^\times)^2\)</span> of the maximal tori of <span class="math">\(\mathbb{P}^1\)</span> and
<span class="math">\(\mathbb{P}^2\)</span>. But this map of the maximal tori cannot be the same as
<tt class="docutils literal"><span class="pre">phi</span></tt> defined above. Indeed, the image of <tt class="docutils literal"><span class="pre">phi</span></tt> completely misses
the maximal torus <span class="math">\(T_{\mathbb{P}^2} = \{ [x:y:z] | x\not=0, y\not=0,
z\not=0 \}\)</span> of <span class="math">\(\mathbb{P}^2\)</span>.</p>
<p>Consider instead the following morphism of fans:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span> <span class="p">);</span>  <span class="n">fm</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1 0]</span>
<span class="go">Domain fan: Rational polyhedral fan in 1-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
<p>which also defines a morphism of toric varieties:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 1-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 2-d lattice N.</span>
</pre></div>
</div>
<p>The fan morphism map is equivalent to the following polynomial map:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [u : v] to</span>
<span class="go">        [u : v : v]</span>
</pre></div>
</div>
<p>Finally, here is an example of a fan morphism that cannot be written
using homogeneous polynomials. Consider the blowup <span class="math">\(O_{\mathbb{P}^1}(2)
\to \CC^2/\ZZ_2\)</span>. In terms of toric data, this blowup is:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2_Z2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2_Z2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(1, 2)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">O2_P1</span> <span class="o">=</span> <span class="n">A2_Z2</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">blowup</span> <span class="o">=</span> <span class="n">O2_P1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">A2_Z2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The fan morphism cannot be written in homogeneous polynomials.</span>
</pre></div>
</div>
<p>If we denote the homogeneous coordinates of <span class="math">\(O_{\mathbb{P}^1}(2)\)</span> by
<span class="math">\(x\)</span>, <span class="math">\(t\)</span>, <span class="math">\(y\)</span> corresponding to the rays <span class="math">\((1,2)\)</span>, <span class="math">\((1,1)\)</span>, and <span class="math">\((1,0)\)</span>
then the blow-up map is <a class="reference internal" href="#bb" id="id2">[BB]</a>:</p>
<div class="math">
\[f: O_{\mathbb{P}^1}(2) \to \CC^2/\ZZ_2, \quad
(x,t,y) \mapsto \left( x\sqrt{t}, y\sqrt{t} \right)\]</div>
<p>which requires square roots.</p>
<div class="section" id="fibrations">
<h2>Fibrations<a class="headerlink" href="#fibrations" title="Permalink to this headline">¶</a></h2>
<p>If a toric morphism is <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_dominant" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_dominant"><tt class="xref py py-meth docutils literal"><span class="pre">dominant</span></tt></a>, then all fibers over
a fixed torus orbit in the base are isomorphic. Hence, studying the
fibers is again a combinatorial question and Sage implements
additional methods to study such fibrations that are not available
otherwise (however, note that you can always
<a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor"><tt class="xref py py-meth docutils literal"><span class="pre">factor()</span></tt></a> to pick out the part
that is dominant over the image or its closure).</p>
<p>For example, consider the blow-up restricted to one of the two
coordinate charts of <span class="math">\(O_{\mathbb{P}^1}(2)\)</span></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">O2_P1_chart</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">([</span><span class="n">O2_P1</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]))</span>
<span class="gp">sage: </span><span class="n">single_chart</span> <span class="o">=</span> <span class="n">O2_P1_chart</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">A2_Z2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">single_chart</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">single_chart</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">fiber</span> <span class="o">=</span> <span class="n">single_chart</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">();</span>  <span class="n">fiber</span>
<span class="go">(0-d affine toric variety, 1)</span>
<span class="gp">sage: </span><span class="n">fiber</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 0-d affine toric variety</span>
<span class="go">  To:   2-d affine toric variety</span>
<span class="go">  Defn: Defined on coordinates by sending [] to</span>
<span class="go">        [1 : 1]</span>
</pre></div>
</div>
<p>The fibers are labeled by torus orbits in the base, that is, cones of
the codomain fan. In this case, the fibers over lower-dimensional
torus orbits are:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2_Z2_cones</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cones</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">table</span><span class="p">([(</span><span class="s1">&#39;cone&#39;</span><span class="p">,</span> <span class="s1">&#39;dim&#39;</span><span class="p">)]</span> <span class="o">+</span>
<span class="go">....:       [(cone.ambient_ray_indices(), single_chart.fiber_dimension(cone))</span>
<span class="go">....:        for cone in A2_Z2_cones], header_row=True)</span>
<span class="go">  cone     dim</span>
<span class="go">+--------+-----+</span>
<span class="go">  ()       0</span>
<span class="go">  (0,)     0</span>
<span class="go">  (1,)     -1</span>
<span class="go">  (0, 1)   1</span>
</pre></div>
</div>
<p>Lets look closer at the one-dimensional fiber. Although not the case
in this example, connected components of fibers over higher-dimensional cones
(corresponding
to lower-dimensional torus orbits) of the base are often not
irreducible. The irreducible components are labeled by the
<a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">primitive_preimage_cones()</span></tt></a>,
which are certain cones of the domain fan that map to the cone in the
base that defines the torus orbit:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">table</span><span class="p">([(</span><span class="s1">&#39;base cone&#39;</span><span class="p">,</span> <span class="s1">&#39;primitive preimage cones&#39;</span><span class="p">)]</span> <span class="o">+</span> 
<span class="go">....:       [(cone.ambient_ray_indices(),</span>
<span class="go">....:         single_chart.fan_morphism().primitive_preimage_cones(cone))</span>
<span class="go">....:        for cone in A2_Z2_cones], header_row=True)</span>
<span class="go">  base cone   primitive preimage cones</span>
<span class="go">+-----------+---------------------------------------------------------+</span>
<span class="go">  ()          (0-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="go">  (0,)        (1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="go">  (1,)        ()</span>
<span class="go">  (0, 1)      (1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
</pre></div>
</div>
<p>The fiber over the trivial cone is the generic fiber that we have
already encountered. The interesting fiber is the one over the
2-dimensional cone, which represents the exceptional set of the
blow-up in this single coordinate chart. Lets investigate further:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">exceptional_cones</span> <span class="o">=</span> <span class="n">single_chart</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">exceptional_set</span> <span class="o">=</span> <span class="n">single_chart</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">exceptional_cones</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">exceptional_set</span>
<span class="go">1-d affine toric variety</span>
<span class="gp">sage: </span><span class="n">exceptional_set</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d affine toric variety</span>
<span class="go">  To:   2-d affine toric variety</span>
<span class="go">  Defn: Defined on coordinates by sending [z0] to</span>
<span class="go">        [z0 : 0]</span>
</pre></div>
</div>
<p>So we see that the fiber over this point is an affine line. Together
with another affine line in the other coordinate patch, this covers
the exceptional <span class="math">\(\mathbb{P}^1\)</span> of the blowup <span class="math">\(O_{\mathbb{P}^1}(2) \to
\CC^2/\ZZ_2\)</span>.</p>
<p>Here is an example with higher dimensional varieties involved:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A3</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P3</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">A3</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">P3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 3-d affine toric variety</span>
<span class="go">  To:   3-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1 : z2] to</span>
<span class="go">        [z0^2*z1*z2^3 : z1*z2 : 1 : 1]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;SchemeMorphism_fan_toric_variety&#39; object</span>
<span class="go">has no attribute &#39;fiber_generic&#39;</span>
</pre></div>
</div>
<p>Let&#8217;s use factorization mentioned above:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_i</span><span class="p">,</span> <span class="n">phi_b</span><span class="p">,</span> <span class="n">phi_s</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</pre></div>
</div>
<p>It is possible to study fibers of the last two morphisms or their composition:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_d</span> <span class="o">=</span> <span class="n">phi_b</span> <span class="o">*</span> <span class="n">phi_s</span>
<span class="gp">sage: </span><span class="n">phi_d</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 3-d affine toric variety</span>
<span class="go">  To:   2-d toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 3-d lattice N to</span>
<span class="go">        Rational polyhedral fan in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;.</span>
<span class="gp">sage: </span><span class="n">phi_d</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 3-d affine toric variety</span>
<span class="go">  To:   2-d toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1 : z2] to</span>
<span class="go">        [z0^2*z1*z2^3 : z1*z2 : 1]</span>
<span class="gp">sage: </span><span class="n">phi_d</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1,  0, 0),</span>
<span class="go">N( 0,  1, 0),</span>
<span class="go">N(-1, -1, 0)</span>
<span class="go">in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">phi_d</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">():</span>
<span class="gp">... </span>      <span class="n">c</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(1, 2)</span>
<span class="go">(0, 2)</span>
<span class="go">(0, 1)</span>
</pre></div>
</div>
<p>We see that codomain fan of this morphism is a projective plane, which can be
verified by</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_d</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">())</span> <span class="c1"># known bug</span>
<span class="go">True</span>
</pre></div>
</div>
<p>(Unfortunately it cannot be verified correctly until <a class="reference external" href="http://trac.sagemath.org/16012">trac ticket #16012</a> is fixed.)</p>
<p>We now have access to fiber methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fiber</span> <span class="o">=</span> <span class="n">phi_d</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fiber</span>
<span class="go">(1-d affine toric variety, 2)</span>
<span class="gp">sage: </span><span class="n">fiber</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d affine toric variety</span>
<span class="go">  To:   3-d affine toric variety</span>
<span class="go">  Defn: Defined by sending</span>
<span class="go">        Rational polyhedral fan in Sublattice &lt;N(1, 1, -1)&gt; to</span>
<span class="go">        Rational polyhedral fan in 3-d lattice N.</span>
<span class="gp">sage: </span><span class="n">fiber</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">polynomial representations for</span>
<span class="go">fans with virtual rays are not implemented yet</span>
<span class="gp">sage: </span><span class="n">fiber</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">Empty collection</span>
<span class="go">in Sublattice &lt;N(1, 1, -1)&gt;</span>
</pre></div>
</div>
<p>We see that generic fibers of this morphism consist of 2 one-dimensional tori
each. To see what happens over boundary points we can look at fiber components
corresponding to the cones of the domain fan:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">phi_d</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">flatten</span><span class="p">(</span><span class="n">phi_d</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cones</span><span class="p">()):</span>
<span class="gp">... </span>      <span class="n">fc</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">phi_d</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">multiplicity</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">... </span>      <span class="k">print</span> <span class="s2">&quot;{} |-&gt; {} ({} rays, multiplicity {}) over {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">c</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">(),</span> <span class="n">fc</span><span class="p">,</span> <span class="n">fc</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">nrays</span><span class="p">(),</span>
<span class="gp">... </span>        <span class="n">m</span><span class="p">,</span> <span class="n">fm</span><span class="o">.</span><span class="n">image_cone</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">())</span>
<span class="go">() |-&gt; 1-d affine toric variety (0 rays, multiplicity 2) over ()</span>
<span class="go">(0,) |-&gt; 1-d affine toric variety (0 rays, multiplicity 1) over (0,)</span>
<span class="go">(1,) |-&gt; 2-d affine toric variety (2 rays, multiplicity 1) over (0, 1)</span>
<span class="go">(2,) |-&gt; 2-d affine toric variety (2 rays, multiplicity 1) over (0, 1)</span>
<span class="go">(0, 1) |-&gt; 1-d affine toric variety (1 rays, multiplicity 1) over (0, 1)</span>
<span class="go">(1, 2) |-&gt; 1-d affine toric variety (1 rays, multiplicity 1) over (0, 1)</span>
<span class="go">(0, 2) |-&gt; 1-d affine toric variety (1 rays, multiplicity 1) over (0, 1)</span>
<span class="go">(0, 1, 2) |-&gt; 0-d affine toric variety (0 rays, multiplicity 1) over (0, 1)</span>
</pre></div>
</div>
<p>Now we see that over one of the coordinate lines of the projective plane we also
have one-dimensional tori (but only one in each fiber), while over one of the
points fixed by torus action we have two affine planes intersecting along an
affine line. An alternative perspective is provided by cones of the codomain
fan:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">flatten</span><span class="p">(</span><span class="n">phi_d</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cones</span><span class="p">()):</span>
<span class="gp">... </span>      <span class="k">print</span> <span class="s2">&quot;{} connected components over {}, each with {} irreducible components.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">fm</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">(),</span>
<span class="gp">... </span>        <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
<span class="go">2 connected components over (), each with 1 irreducible components.</span>
<span class="go">1 connected components over (0,), each with 1 irreducible components.</span>
<span class="go">None connected components over (1,), each with 0 irreducible components.</span>
<span class="go">None connected components over (2,), each with 0 irreducible components.</span>
<span class="go">None connected components over (1, 2), each with 0 irreducible components.</span>
<span class="go">None connected components over (0, 2), each with 0 irreducible components.</span>
<span class="go">1 connected components over (0, 1), each with 2 irreducible components.</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="bb" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[BB]</a></td><td>Gavin Brown, Jaroslaw Buczynski:
Maps of toric varieties in Cox coordinates,
<a class="reference external" href="http://arxiv.org/abs/1004.4924">http://arxiv.org/abs/1004.4924</a></td></tr>
</tbody>
</table>
<dl class="class">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety">
<em class="property">class </em><tt class="descclassname">sage.schemes.toric.morphism.</tt><tt class="descname">SchemeMorphism_fan_fiber_component_toric_variety</tt><big>(</big><em>toric_morphism</em>, <em>defining_cone</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/morphism.html#sage.schemes.generic.morphism.SchemeMorphism" title="sage.schemes.generic.morphism.SchemeMorphism"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.morphism.SchemeMorphism</span></tt></a></p>
<p>The embedding of a fiber component of a toric morphism.</p>
<p>Note that the embedding map of a fiber component of a toric morphism is
itself not a toric morphism!</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">toric_morphism</span></tt> &#8211; a toric morphism. The toric morphism whose
fiber component we are describing.</li>
<li><tt class="docutils literal"><span class="pre">defining_cone</span></tt> &#8211; a cone of the fan of the domain of
<tt class="docutils literal"><span class="pre">toric_morphism</span></tt>. See
<a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component"><tt class="xref py py-meth docutils literal"><span class="pre">fiber_component()</span></tt></a> for
details.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span>
<span class="gp">... </span>      <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>       <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">coarse_fan</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">polytope</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proj24</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">proj24</span><span class="p">,</span> <span class="n">coarse_fan</span><span class="p">,</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibration</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">())</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">primitive_cones</span> <span class="o">=</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">primitive_cone</span> <span class="o">=</span> <span class="n">primitive_cones</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">fiber_component</span> <span class="o">=</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fiber_component</span>
<span class="go">2-d toric variety covered by 4 affine patches</span>
<span class="gp">sage: </span><span class="n">fiber_component</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d toric variety covered by 4 affine patches</span>
<span class="go">  To:   4-d toric variety covered by 23 affine patches</span>
<span class="go">  Defn: Defined by embedding a fiber component corresponding to</span>
<span class="go">        1-d cone of Rational polyhedral fan in 4-d lattice N.</span>
<span class="gp">sage: </span><span class="n">fiber_component</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d toric variety covered by 4 affine patches</span>
<span class="go">  To:   4-d toric variety covered by 23 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1 : z2 : z3] to</span>
<span class="go">        [1 : 1 : 1 : 1 : z1 : 0 : 1 : z0 : 1 : 1 : 1 : z2 : z3 : 1 : 1]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">fiber_component</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety&#39;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.as_polynomial_map">
<tt class="descname">as_polynomial_map</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.as_polynomial_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Express the embedding morphism via homogeneous polynomials.</p>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></tt></a>. Raises a
<tt class="docutils literal"><span class="pre">ValueError</span></tt> if the morphism cannot be written in terms of
homogeneous polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span>
<span class="gp">... </span>      <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>       <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">coarse_fan</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">polytope</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proj24</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">proj24</span><span class="p">,</span> <span class="n">coarse_fan</span><span class="p">,</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibration</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">())</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">primitive_cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">)</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d toric variety covered by 4 affine patches</span>
<span class="go">  To:   4-d toric variety covered by 23 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1 : z2 : z3] to</span>
<span class="go">        [1 : 1 : 1 : 1 : z1 : 0 : 1 : z0 : 1 : 1 : 1 : z2 : z3 : 1 : 1]</span>

<span class="gp">sage: </span><span class="n">primitive_cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">)</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The morphism cannot be written using homogeneous polynomials.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.base_cone">
<tt class="descname">base_cone</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.base_cone" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the base cone <span class="math">\(\sigma\)</span>.</p>
<p>The fiber is constant over the base orbit closure <span class="math">\(V(\sigma)\)</span>.</p>
<p>OUTPUT:</p>
<p>A cone of the base of the toric fibration.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fc</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">defining_cone</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">base_cone</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1)</span>
<span class="go">in 1-d lattice N       </span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.defining_cone">
<tt class="descname">defining_cone</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.defining_cone" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cone corresponding to the fiber torus orbit.</p>
<p>OUTPUT:</p>
<p>A cone of the fan of the total space of the toric fibration.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fc</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">defining_cone</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">base_cone</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1)</span>
<span class="go">in 1-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.pullback_divisor">
<tt class="descname">pullback_divisor</tt><big>(</big><em>divisor</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.pullback_divisor" title="Permalink to this definition">¶</a></dt>
<dd><p>Pull back a toric divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">divisor</span></tt> &#8211; a torus-invariant QQ-Cartier divisor on the
codomain of the embedding map.</li>
</ul>
<p>OUTPUT:</p>
<p>A divisor on the domain of the embedding map (irreducible
component of a fiber of a toric morphism) that is isomorphic
to the pull-back divisor <span class="math">\(f^*(D)\)</span> but with possibly different
linearization.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">A1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">D</span>
<span class="go">V(z0) + V(z1) + 3*V(z2) + 4*V(z3)</span>
<span class="gp">sage: </span><span class="n">fc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">fc</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">pullback_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">3*V(z0) + 2*V(z2)</span>
<span class="gp">sage: </span><span class="n">fc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">fc</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">pullback_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">-3*V(z0) - 3*V(z1) - V(z2)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety">
<em class="property">class </em><tt class="descclassname">sage.schemes.toric.morphism.</tt><tt class="descname">SchemeMorphism_fan_toric_variety</tt><big>(</big><em>parent</em>, <em>fan_morphism</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/morphism.html#sage.schemes.generic.morphism.SchemeMorphism" title="sage.schemes.generic.morphism.SchemeMorphism"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.morphism.SchemeMorphism</span></tt></a>, <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Sage Reference Manual: Category Framework v7.1)"><tt class="xref py py-class docutils literal"><span class="pre">sage.categories.morphism.Morphism</span></tt></a></p>
<p>Construct a morphism determined by a fan morphism</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not create objects of this class directly. Use the
<tt class="xref py py-meth docutils literal"><span class="pre">hom()</span></tt> method of
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">varieties</span></tt></a>
instead.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">parent</span></tt> &#8211; Hom-set whose domain and codomain are toric varieties.</li>
<li><tt class="docutils literal"><span class="pre">fan_morphism</span></tt> &#8211; A morphism of fans whose domain and codomain
fans equal the fans of the domain and codomain in the <tt class="docutils literal"><span class="pre">parent</span></tt>
Hom-set.</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> &#8211; boolean (optional, default:<tt class="docutils literal"><span class="pre">True</span></tt>). Whether to
check the input for consistency.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">A fibration is a dominant morphism; if you are interested in
these then you have to make sure that your fan morphism is
dominant. For example, this can be achieved by
<a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor"><tt class="xref py py-meth docutils literal"><span class="pre">factoring</span> <span class="pre">the</span> <span class="pre">morphism</span></tt></a>. See
<a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant"><tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_fan_toric_variety_dominant</span></tt></a> for
additional functionality for fibrations.</p>
</div>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety"><tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_fan_toric_variety</span></tt></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1xP1</span><span class="p">);</span>  <span class="n">f</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 1-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 2-d lattice N.</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety&#39;&gt;</span>
</pre></div>
</div>
<p>Slightly more explicit construction:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">hom_set</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">Hom</span><span class="p">(</span><span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">hom_set</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  To:   1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 2-d lattice N</span>
<span class="go">       to Rational polyhedral fan in 1-d lattice N.</span>

<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P1</span><span class="p">)</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  To:   1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 2-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 1-d lattice N.</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.as_polynomial_map">
<tt class="descname">as_polynomial_map</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.as_polynomial_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Express the morphism via homogeneous polynomials.</p>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></tt></a>. Raises a
<tt class="docutils literal"><span class="pre">TypeError</span></tt> if the morphism cannot be written in terms of
homogeneous polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">square</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">A1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">square</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme endomorphism of 1-d affine toric variety</span>
<span class="go">  Defn: Defined on coordinates by sending [z] to</span>
<span class="go">        [z^2]</span>

<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">patch</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d affine toric variety</span>
<span class="go">  To:   1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z] to</span>
<span class="go">        [z : 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor">
<tt class="descname">factor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Factor <tt class="docutils literal"><span class="pre">self</span></tt> into injective * birational * surjective morphisms.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>a triple of toric morphisms <span class="math">\((\phi_i, \phi_b, \phi_s)\)</span>, such that
<span class="math">\(\phi_s\)</span> is surjective, <span class="math">\(\phi_b\)</span> is birational, <span class="math">\(\phi_i\)</span> is injective,
and <tt class="docutils literal"><span class="pre">self</span></tt> is equal to <span class="math">\(\phi_i \circ \phi_b \circ \phi_s\)</span>.</li>
</ul>
<p>The intermediate varieties are universal in the following sense. Let
<tt class="docutils literal"><span class="pre">self</span></tt> map <span class="math">\(X\)</span> to <span class="math">\(X'\)</span> and let <span class="math">\(X_s\)</span>, <span class="math">\(X_i\)</span> sit in between, that is,</p>
<div class="math">
\[X
\twoheadrightarrow
X_s
\to
X_i
\hookrightarrow
X'.\]</div>
<p>Then any toric morphism from <span class="math">\(X\)</span> coinciding with <tt class="docutils literal"><span class="pre">self</span></tt> on the maximal
torus factors through <span class="math">\(X_s\)</span> and any toric morphism into <span class="math">\(X'\)</span> coinciding
with <tt class="docutils literal"><span class="pre">self</span></tt> on the maximal torus factors through <span class="math">\(X_i\)</span>. In particular,
<span class="math">\(X_i\)</span> is the closure of the image of <tt class="docutils literal"><span class="pre">self</span></tt> in <span class="math">\(X'\)</span>.</p>
<p>See
<a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.factor" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">factor()</span></tt></a>
for a description of the toric algorithm.</p>
<p>EXAMPLES:</p>
<p>We map an affine plane into a projective 3-space in such a way, that it
becomes &#8220;a double cover of a chart of the blow up of one of the
coordinate planes&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P3</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">P3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d affine toric variety</span>
<span class="go">  To:   3-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [x : y] to</span>
<span class="go">        [x^2*y : y : 1 : 1]</span>

<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(),</span> <span class="n">phi</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">phi</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">(False, False, False)</span>
<span class="gp">sage: </span><span class="n">phi_i</span><span class="p">,</span> <span class="n">phi_b</span><span class="p">,</span> <span class="n">phi_s</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_s</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(),</span> <span class="n">phi_b</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">phi_i</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">(True, True, True)</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">factor</span><span class="p">())</span> <span class="o">==</span> <span class="n">phi</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Double cover (surjective):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_s</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d affine toric variety</span>
<span class="go">  To:   2-d affine toric variety</span>
<span class="go">  Defn: Defined on coordinates by sending [x : y] to</span>
<span class="go">        [x^2 : y]</span>
</pre></div>
</div>
<p>Blowup chart (birational):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_b</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d affine toric variety</span>
<span class="go">  To:   2-d toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1] to</span>
<span class="go">        [z0*z1 : z1 : 1]</span>
</pre></div>
</div>
<p>Coordinate plane inclusion (injective):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_i</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d toric variety covered by 3 affine patches</span>
<span class="go">  To:   3-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1 : z2] to</span>
<span class="go">        [z0 : z1 : z2 : z2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.fan_morphism">
<tt class="descname">fan_morphism</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.fan_morphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the defining fan morphism.</p>
<p>OUTPUT:</p>
<p>A <a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-class docutils literal"><span class="pre">FanMorphism</span></tt></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1]</span>
<span class="go">[0]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 1-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_birational">
<tt class="descname">is_birational</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_birational" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> is birational.</p>
<p>See
<a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_birational" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">is_birational()</span></tt></a>
for fan morphisms for a description of the toric algorithm.</p>
<p>OUTPUT:</p>
<p>Boolean. Whether <tt class="docutils literal"><span class="pre">self</span></tt> is birational.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP8</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">dP8</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">P2</span><span class="p">)</span><span class="o">.</span><span class="n">is_birational</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])]))</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_birational</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_bundle">
<tt class="descname">is_bundle</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_bundle" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> is a bundle.</p>
<p>See <a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_bundle" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">is_bundle()</span></tt></a>
for fan morphisms for details.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> is a bundle, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_dominant">
<tt class="descname">is_dominant</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_dominant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether <tt class="docutils literal"><span class="pre">self</span></tt> is dominant.</p>
<p>See
<a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_dominant" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">is_dominant()</span></tt></a>
for fan morphisms for a description of the toric algorithm.</p>
<p>OUTPUT:</p>
<p>Boolean. Whether <tt class="docutils literal"><span class="pre">self</span></tt> is a dominant scheme morphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">P1</span><span class="p">);</span>  <span class="n">phi</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d affine toric variety</span>
<span class="go">  To:   1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 1-d lattice N </span>
<span class="go">        to Rational polyhedral fan in 1-d lattice N.</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_fibration">
<tt class="descname">is_fibration</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_fibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> is a fibration.</p>
<p>See
<a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_fibration" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">is_fibration()</span></tt></a>
for fan morphisms for details.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> is a fibration, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_injective">
<tt class="descname">is_injective</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_injective" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> is injective.</p>
<p>See
<a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_injective" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">is_injective()</span></tt></a>
for fan morphisms for a description of the toric algorithm.</p>
<p>OUTPUT:</p>
<p>Boolean. Whether <tt class="docutils literal"><span class="pre">self</span></tt> is injective.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])]))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_surjective">
<tt class="descname">is_surjective</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_surjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <tt class="docutils literal"><span class="pre">self</span></tt> is surjective.</p>
<p>See
<a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_surjective" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">is_surjective()</span></tt></a>
for fan morphisms for a description of the toric algorithm.</p>
<p>OUTPUT:</p>
<p>Boolean. Whether <tt class="docutils literal"><span class="pre">self</span></tt> is surjective.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])]))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.pullback_divisor">
<tt class="descname">pullback_divisor</tt><big>(</big><em>divisor</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.pullback_divisor" title="Permalink to this definition">¶</a></dt>
<dd><p>Pull back a toric divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">divisor</span></tt> &#8211; a torus-invariant QQ-Cartier divisor on the
codomain of <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
</ul>
<p>OUTPUT:</p>
<p>The pull-back divisor <span class="math">\(f^*(D)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2_Z2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2_Z2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">A2_Z2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">pullback_divisor</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">V(x)</span>

<span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">square</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">A1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>  <span class="n">D</span>
<span class="go">V(z)</span>
<span class="gp">sage: </span><span class="n">square</span><span class="o">.</span><span class="n">pullback_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">2*V(z)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant">
<em class="property">class </em><tt class="descclassname">sage.schemes.toric.morphism.</tt><tt class="descname">SchemeMorphism_fan_toric_variety_dominant</tt><big>(</big><em>parent</em>, <em>fan_morphism</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety</span></tt></a></p>
<p>Construct a morphism determined by a dominant fan morphism.</p>
<p>A dominant morphism is one that is surjective onto a dense
subset. In the context of toric morphisms, this means that it is
onto the big torus orbit.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not create objects of this class directly. Use the
<tt class="xref py py-meth docutils literal"><span class="pre">hom()</span></tt> method of
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">varieties</span></tt></a>
instead.</p>
</div>
<p>INPUT:</p>
<p>See <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety"><tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_fan_toric_variety</span></tt></a>. The given fan
morphism <a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_dominant" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">must</span> <span class="pre">be</span> <span class="pre">dominant</span></tt></a>.</p>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant"><tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_fan_toric_variety_dominant</span></tt></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">dP8</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">dP8</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">P2</span><span class="p">);</span>  <span class="n">f</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 2-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 2-d lattice N.</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant&#39;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component">
<tt class="descname">fiber_component</tt><big>(</big><em>domain_cone</em>, <em>multiplicity=False</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a fiber component corresponding to <tt class="docutils literal"><span class="pre">domain_cone</span></tt>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">domain_cone</span></tt> &#8211; a cone of the domain fan of <tt class="docutils literal"><span class="pre">self</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">multiplicity</span></tt> (default: <tt class="docutils literal"><span class="pre">False</span></tt>) &#8211; whether to return the number
of fiber components corresponding to <tt class="docutils literal"><span class="pre">domain_cone</span></tt> as well.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>either <span class="math">\(X\)</span> or a tuple <span class="math">\((X, n)\)</span>, where <span class="math">\(X\)</span> is a <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">variety</span></tt></a> with the
embedding morphism into domain of <tt class="docutils literal"><span class="pre">self</span></tt> and <span class="math">\(n\)</span> is an integer.</li>
</ul>
<p>Let <span class="math">\(\phi: \Sigma \to \Sigma'\)</span> be the <a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-class docutils literal"><span class="pre">fan</span> <span class="pre">morphism</span></tt></a> corresponding to
<tt class="docutils literal"><span class="pre">self</span></tt>. Let <span class="math">\(\sigma \in \Sigma\)</span> and <span class="math">\(\sigma' \in \Sigma'\)</span> be
the <a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.image_cone" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">image_cone()</span></tt></a>
of <span class="math">\(\sigma\)</span>.  The fiber over any point of the torus orbit corresponding
to <span class="math">\(\sigma'\)</span> consists of <span class="math">\(n\)</span> isomorphic connected components with each
component being a union of toric varieties intersecting along
their torus invariant subvarieties. The latter correspond to 
<a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">preimage_cones()</span></tt></a> of
<span class="math">\(\sigma'\)</span> and <span class="math">\(X\)</span> is one of the <span class="math">\(n\)</span> components corresponding to
<span class="math">\(\sigma\)</span>. The irreducible components correspond to
<a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">primitive_preimage_cones()</span></tt></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">LatticePolytope</span><span class="p">(</span>
<span class="gp">... </span>      <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>       <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">coarse_fan</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">polytope</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proj24</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">proj24</span><span class="p">,</span> <span class="n">coarse_fan</span><span class="p">,</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibration</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">())</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">primitive_cones</span> <span class="o">=</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">primitive_cone</span> <span class="o">=</span> <span class="n">primitive_cones</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">)</span>
<span class="go">2-d toric variety covered by 4 affine patches</span>
<span class="gp">sage: </span><span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(2-d toric variety covered by 4 affine patches, 1)</span>

<span class="gp">sage: </span><span class="k">for</span> <span class="n">primitive_cone</span> <span class="ow">in</span> <span class="n">primitive_cones</span><span class="p">:</span>
<span class="gp">... </span>      <span class="k">print</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">)</span>
<span class="go">2-d toric variety covered by 4 affine patches</span>
<span class="go">2-d toric variety covered by 3 affine patches</span>
<span class="go">2-d toric variety covered by 3 affine patches</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_dimension">
<tt class="descname">fiber_dimension</tt><big>(</big><em>codomain_cone</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dimension of the fiber over a particular torus
orbit in the base.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">codomain_cone</span></tt> &#8211; a cone <span class="math">\(\sigma\)</span> of the codomain,
specifying a torus orbit <span class="math">\(O(\sigma)\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>An integer. The dimension of the fiber over the torus orbit
corresponding to <tt class="docutils literal"><span class="pre">codomain_cone</span></tt>. If the fiber is the empty
set, <tt class="docutils literal"><span class="pre">-1</span></tt> is returned. Note that all fibers over this torus
orbit are isomorphic, and therefore have the same dimension.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Here is a more complicated example that is not a flat fibration:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2_Z2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2_Z2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">O2_P1</span> <span class="o">=</span> <span class="n">A2_Z2</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">blowup</span> <span class="o">=</span> <span class="n">O2_P1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">A2_Z2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>This corresponds to the three different fibers:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">()</span>
<span class="go">(0-d affine toric variety, 1)</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="go">0-d affine toric variety</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">1-d toric variety covered by 2 affine patches</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_generic">
<tt class="descname">fiber_generic</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_generic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the generic fiber.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>a tuple <span class="math">\((X, n)\)</span>, where <span class="math">\(X\)</span> is a <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">variety</span></tt></a> with the
embedding morphism into domain of <tt class="docutils literal"><span class="pre">self</span></tt> and <span class="math">\(n\)</span> is an integer.</li>
</ul>
<p>The fiber over the base point with homogeneous coordinates
<span class="math">\([1:1:\cdots:1]\)</span> consists of <span class="math">\(n\)</span> disjoint toric varieties isomorphic to
<span class="math">\(X\)</span>. Note that fibers of a dominant toric morphism are isomorphic over
all points of a fixed torus orbit of its codomain, in particular over
all points of the maximal torus, so it makes sense to talk about &#8220;the
generic&#8221; fiber.</p>
<p>The embedding of <span class="math">\(X\)</span> is a toric morphism with
the <a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">domain_fan()</span></tt></a>
being the
<a class="reference external" href="../../../../geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.kernel_fan" title="(in Sage Reference Manual: Geometry v7.1)"><tt class="xref py py-meth docutils literal"><span class="pre">kernel_fan()</span></tt></a> of
the defining fan morphism. By contrast, embeddings of fiber components
over lower-dimensional torus orbits of the image are not toric
morphisms. Use <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component"><tt class="xref py py-meth docutils literal"><span class="pre">fiber_component()</span></tt></a> for the latter
(non-generic) fibers.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fiber</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fiber</span>
<span class="go">(1-d toric variety covered by 2 affine patches, 1)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fiber</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">();</span>  <span class="n">f</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in Sublattice &lt;N(0, 1)&gt; to</span>
<span class="go">        Rational polyhedral fan in 2-d lattice N.</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1] to</span>
<span class="go">        [1 : 1 : z0 : z1]</span>

<span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">A1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">()</span>
<span class="go">(2-d affine toric variety, 1)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>
<span class="go">(0-d cone of Rational polyhedral fan in Sublattice &lt;N(0, 1, 0), N(0, 0, 1)&gt;,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_graph">
<tt class="descname">fiber_graph</tt><big>(</big><em>codomain_cone</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fiber over a given torus orbit in the codomain.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">codomain_cone</span></tt> &#8211; a cone <span class="math">\(\sigma\)</span> of the codomain,
specifying a torus orbit <span class="math">\(O(\sigma)\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>A graph whose nodes are the irreducible components of a connected
component of the fiber over a point of <span class="math">\(O(\sigma)\)</span>. If two irreducible
components intersect, the
corresponding nodes of the graph are joined by an edge. Note that
irreducible components do not have to be of the same dimension.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component"><tt class="xref py py-meth docutils literal"><span class="pre">fiber_component()</span></tt></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span>
<span class="gp">... </span>      <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>       <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">coarse_fan</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">polytope</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>

<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proj34</span> <span class="o">=</span> <span class="n">block_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="n">zero_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">proj34</span><span class="p">,</span> <span class="n">coarse_fan</span><span class="p">,</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibration</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">())</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">fibration</span><span class="o">.</span><span class="n">fiber_graph</span><span class="p">(</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
<span class="go">Graph on 1 vertex</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">fibration</span><span class="o">.</span><span class="n">fiber_graph</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
<span class="go">Graph on 1 vertex</span>
<span class="go">Graph on 1 vertex</span>
<span class="go">Graph on 4 vertices</span>

<span class="gp">sage: </span><span class="n">fibration</span><span class="o">.</span><span class="n">fiber_graph</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">get_vertices</span><span class="p">()</span>
<span class="go">{0: 2-d toric variety covered by 4 affine patches,</span>
<span class="go"> 1: 2-d toric variety covered by 3 affine patches,</span>
<span class="go"> 2: 2-d toric variety covered by 3 affine patches,</span>
<span class="go"> 3: 2-d toric variety covered by 4 affine patches}</span>

<span class="gp">sage: </span><span class="n">fibration</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 4-d toric variety covered by 18 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 4-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 2-d lattice N.</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety">
<em class="property">class </em><tt class="descclassname">sage.schemes.toric.morphism.</tt><tt class="descname">SchemeMorphism_orbit_closure_toric_variety</tt><big>(</big><em>parent</em>, <em>defining_cone</em>, <em>ray_map</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/morphism.html#sage.schemes.generic.morphism.SchemeMorphism" title="sage.schemes.generic.morphism.SchemeMorphism"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.morphism.SchemeMorphism</span></tt></a>, <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Sage Reference Manual: Category Framework v7.1)"><tt class="xref py py-class docutils literal"><span class="pre">sage.categories.morphism.Morphism</span></tt></a></p>
<p>The embedding of an orbit closure.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">parent</span></tt> &#8211; the parent homset.</li>
<li><tt class="docutils literal"><span class="pre">defining_cone</span></tt> &#8211; the defining cone.</li>
<li><tt class="docutils literal"><span class="pre">ray_map</span></tt> &#8211; a dictionary <tt class="docutils literal"><span class="pre">{ambient</span> <span class="pre">ray</span> <span class="pre">generator:</span> <span class="pre">orbit</span> <span class="pre">ray</span>
<span class="pre">generator}</span></tt>. Note that the image of the ambient ray generator
is not necessarily primitive.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not create objects of this class directly. Use the
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field.orbit_closure" title="sage.schemes.toric.variety.ToricVariety_field.orbit_closure"><tt class="xref py py-meth docutils literal"><span class="pre">orbit_closure()</span></tt></a>
method of <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">varieties</span></tt></a>
instead.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">orbit_closure</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined by embedding the torus closure associated to the 1-d </span>
<span class="go">        cone of Rational polyhedral fan in 2-d lattice N.</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">_reverse_ray_map</span><span class="p">()</span>
<span class="go">{N(-1): 3, N(1): 2}</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">_defining_cone</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.as_polynomial_map">
<tt class="descname">as_polynomial_map</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.as_polynomial_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Express the morphism via homogeneous polynomials.</p>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></tt></a>. Raises a
<tt class="docutils literal"><span class="pre">TypeError</span></tt> if the morphism cannot be written in terms of
homogeneous polynomials.</p>
<p>The defining polynomials are not necessarily unique. There are
choices if multiple ambient space ray generators project to
the same orbit ray generator, and one such choice is made
implicitly. The orbit embedding can be written as a polynomial
map if and only if each primitive orbit ray generator is the
image of at least one primitive ray generator of the ambient
toric variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">orbit_closure</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]);</span>  <span class="n">V</span>
<span class="go">1-d toric variety covered by 2 affine patches</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1] to</span>
<span class="go">        [0 : z1 : z0]</span>
</pre></div>
</div>
<p>If the toric variety is singular, then some orbit closure
embeddings cannot be written with homogeneous polynomials:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2_112</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2_112</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P2_112</span><span class="o">.</span><span class="n">orbit_closure</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The embedding cannot be written with homogeneous polynomials.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.defining_cone">
<tt class="descname">defining_cone</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.defining_cone" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cone corresponding to the torus orbit.</p>
<p>OUTPUT:</p>
<p>A cone of the fan of the ambient toric variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">orbit_closure</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">defining_cone</span><span class="p">()</span> 
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="ow">is</span> <span class="n">cone</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.pullback_divisor">
<tt class="descname">pullback_divisor</tt><big>(</big><em>divisor</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.pullback_divisor" title="Permalink to this definition">¶</a></dt>
<dd><p>Pull back a toric divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">divisor</span></tt> &#8211; a torus-invariant QQ-Cartier divisor on the
codomain of the embedding map.</li>
</ul>
<p>OUTPUT:</p>
<p>A divisor on the domain of the embedding map (the orbit
closure) that is isomorphic to the pull-back divisor <span class="math">\(f^*(D)\)</span>
but with possibly different linearization.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">orbit_closure</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">D</span>
<span class="go">V(x) + 2*V(y) + 3*V(z)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">pullback_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">4*V(z0) + 2*V(z1)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_point_toric_field">
<em class="property">class </em><tt class="descclassname">sage.schemes.toric.morphism.</tt><tt class="descname">SchemeMorphism_point_toric_field</tt><big>(</big><em>X</em>, <em>coordinates</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_point_toric_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/morphism.html#sage.schemes.generic.morphism.SchemeMorphism_point" title="sage.schemes.generic.morphism.SchemeMorphism_point"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.morphism.SchemeMorphism_point</span></tt></a>, <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Sage Reference Manual: Category Framework v7.1)"><tt class="xref py py-class docutils literal"><span class="pre">sage.categories.morphism.Morphism</span></tt></a></p>
<p>A point of a toric variety determined by homogeneous coordinates
in a field.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not create objects of this class directly. Use the
<tt class="xref py py-meth docutils literal"><span class="pre">hom()</span></tt> method of
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">varieties</span></tt></a>
instead.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">X</span></tt> &#8211; toric variety or subscheme of a toric variety.</li>
<li><tt class="docutils literal"><span class="pre">coordinates</span></tt> &#8211; list of coordinates in the base field of <tt class="docutils literal"><span class="pre">X</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt> (default), the input will be checked for
correctness.</li>
</ul>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_point_toric_field" title="sage.schemes.toric.morphism.SchemeMorphism_point_toric_field"><tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_point_toric_field</span></tt></a>.</p>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[1 : 2 : 3 : 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety">
<em class="property">class </em><tt class="descclassname">sage.schemes.toric.morphism.</tt><tt class="descname">SchemeMorphism_polynomial_toric_variety</tt><big>(</big><em>parent</em>, <em>polynomials</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/morphism.html#sage.schemes.generic.morphism.SchemeMorphism_polynomial" title="sage.schemes.generic.morphism.SchemeMorphism_polynomial"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.generic.morphism.SchemeMorphism_polynomial</span></tt></a>, <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Sage Reference Manual: Category Framework v7.1)"><tt class="xref py py-class docutils literal"><span class="pre">sage.categories.morphism.Morphism</span></tt></a></p>
<p>A morphism determined by homogeneous polynomials.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You should not create objects of this class directly. Use the
<tt class="xref py py-meth docutils literal"><span class="pre">hom()</span></tt> method of
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><tt class="xref py py-class docutils literal"><span class="pre">toric</span> <span class="pre">varieties</span></tt></a>
instead.</p>
</div>
<p>INPUT:</p>
<p>Same as for
<tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_polynomial</span></tt>.</p>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></tt></a>.</p>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining s, t, x, y</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">subscheme</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">Hom</span><span class="p">(</span><span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.schemes.toric.morphism</span> <span class="kn">as</span> <span class="nn">MOR</span>
<span class="gp">sage: </span><span class="n">MOR</span><span class="o">.</span><span class="n">SchemeMorphism_polynomial_toric_variety</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  To:   Closed subscheme of 2-d CPR-Fano toric variety</span>
<span class="go">        covered by 4 affine patches defined by:</span>
<span class="go">  s - t</span>
<span class="go">  Defn: Defined on coordinates by sending [s : t : x : y] to</span>
<span class="go">        [s : s : x : y]</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety.as_fan_morphism">
<tt class="descname">as_fan_morphism</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety.as_fan_morphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Express the morphism as a map defined by a fan morphism.</p>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><tt class="xref py py-class docutils literal"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></tt></a>. Raises a
<tt class="docutils literal"><span class="pre">TypeError</span></tt> if the morphism cannot be written in such a way.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A1</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">patch</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">hom</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">z</span><span class="p">],</span> <span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">as_fan_morphism</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">expressing toric morphisms as fan morphisms is</span>
<span class="go">not implemented yet!</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Morphisms of Toric Varieties</a><ul>
<li><a class="reference internal" href="#fibrations">Fibrations</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="ideal.html"
                                  title="previous chapter">Toric ideals</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="weierstrass.html"
                                  title="next chapter">Weierstrass form of a toric elliptic curve.</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/toric/morphism.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="weierstrass.html" title="Weierstrass form of a toric elliptic curve."
             >next</a> |</li>
        <li class="right" >
          <a href="ideal.html" title="Toric ideals"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Schemes</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>