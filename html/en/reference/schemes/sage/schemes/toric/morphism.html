<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Subschemes of toric space" href="toric_subscheme.html" /><link rel="prev" title="Toric ideals" href="ideal.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Morphisms of toric varieties - Schemes</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Schemes</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.0 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Schemes</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Scheme implementation overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/scheme.html">Schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/spec.html">The Spec functor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/glue.html">Scheme obtained by gluing two other schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/point.html">Points on schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/ambient_space.html">Ambient spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/algebraic_scheme.html">Algebraic schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/hypersurface.html">Hypersurfaces in affine and projective space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/homset.html">Set of homomorphisms between two schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/morphism.html">Scheme morphism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/divisor.html">Divisors on schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/divisor_group.html">Divisor groups</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_space.html">Affine <span class="math notranslate nohighlight">\(n\)</span> space over a ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_morphism.html">Morphisms on affine schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_point.html">Points on affine varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_subscheme.html">Subschemes of affine space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_rational_point.html">Enumeration of rational points on affine schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_homset.html">Set of homomorphisms between two affine schemes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_space.html">Projective <span class="math notranslate nohighlight">\(n\)</span> space over a ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_morphism.html">Morphisms on projective schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_point.html">Points on projective varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_subscheme.html">Subschemes of projective space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_rational_point.html">Enumeration of rational points on projective schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_homset.html">Set of homomorphisms between two projective schemes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/space.html">Products of projective spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/homset.html">Set of homomorphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/morphism.html">Polynomial morphisms for products of projective spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/point.html">Points for products of projective spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/subscheme.html">Subschemes of products of projective spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/rational_point.html">Enumeration of rational points on product projective schemes</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="variety.html">Toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="fano_variety.html">Fano toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="library.html">Library of toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="divisor.html">Toric divisors and divisor classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="divisor_class.html">Toric rational divisor classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="chow_group.html">The Chow group of a toric variety</a></li>
<li class="toctree-l1"><a class="reference internal" href="ideal.html">Toric ideals</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Morphisms of toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="toric_subscheme.html">Subschemes of toric space</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass.html">Weierstrass form of a toric elliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_covering.html">Map to the Weierstrass form of a toric elliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_higher.html">Weierstrass for elliptic curves in higher codimension</a></li>
<li class="toctree-l1"><a class="reference internal" href="homset.html">Set of homomorphisms between two toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="points.html">Enumerate points of a toric variety</a></li>
<li class="toctree-l1"><a class="reference internal" href="sheaf/constructor.html">Construct sheaves on toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="sheaf/klyachko.html">Klyachko bundles and sheaves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cyclic_covers/cycliccover_finite_field.html">Cyclic covers over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cyclic_covers/cycliccover_generic.html">Cyclic covers curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cyclic_covers/charpoly_frobenius.html">Computation of the Frobenius polynomial using Newton’s identities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cyclic_covers/constructor.html">Cyclic cover curve constructor</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../berkovich/berkovich_cp_element.html">Elements of Berkovich space.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../berkovich/berkovich_space.html">Berkovich Space over <span class="math notranslate nohighlight">\(\CC_p\)</span></a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="morphisms-of-toric-varieties">
<span id="sage-schemes-toric-morphism"></span><h1>Morphisms of toric varieties<a class="headerlink" href="#morphisms-of-toric-varieties" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.schemes.toric.morphism"></span><p>There are three “obvious” ways to map toric varieties to toric
varieties:</p>
<ol class="arabic simple">
<li><p>Polynomial maps in local coordinates, the usual morphisms in
algebraic geometry.</p></li>
<li><p>Polynomial maps in the (global) homogeneous coordinates.</p></li>
<li><p>Toric morphisms, that is, algebraic morphisms equivariant with
respect to the torus action on the toric variety.</p></li>
</ol>
<p>Both 2 and 3 are special cases of 1, which is just to say that we
always remain within the realm of algebraic geometry. But apart from
that, none is included in one of the other cases. In the examples
below, we will explore some algebraic maps that can or can not be
written as a toric morphism. Often a toric morphism can be written
with polynomial maps in homogeneous coordinates, but sometimes it
cannot.</p>
<p>The toric morphisms are perhaps the most mysterious at the
beginning. Let us quickly review their definition (See Definition
3.3.3 of <a class="reference internal" href="../../../../references/index.html#cls2011" id="id1"><span>[CLS2011]</span></a>). Let <span class="math notranslate nohighlight">\(\Sigma_1\)</span> be a fan in <span class="math notranslate nohighlight">\(N_{1,\RR}\)</span> and <span class="math notranslate nohighlight">\(\Sigma_2\)</span> be a
fan in <span class="math notranslate nohighlight">\(N_{2,\RR}\)</span>. A morphism <span class="math notranslate nohighlight">\(\phi: X_{\Sigma_1} \to X_{\Sigma_2}\)</span>
of the associated toric varieties is toric if <span class="math notranslate nohighlight">\(\phi\)</span> maps the maximal
torus <span class="math notranslate nohighlight">\(T_{N_1} \subseteq X_{\Sigma_1}\)</span> into <span class="math notranslate nohighlight">\(T_{N_2} \subseteq
X_{\Sigma_2}\)</span> and <span class="math notranslate nohighlight">\(\phi|_{T_N}\)</span> is a group homomorphism.</p>
<p>The data defining a toric morphism is precisely what defines a fan
morphism (see <a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#module-sage.geometry.fan_morphism" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fan_morphism</span></code></a>), extending the more
familiar dictionary between toric varieties and fans. Toric geometry
is a functor from the category of fans and fan morphisms to the
category of toric varieties and toric morphisms.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not create the toric morphisms (or any morphism of schemes)
directly from the <code class="docutils literal notranslate"><span class="pre">SchemeMorphism...</span></code> classes. Instead, use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">hom()</span></code> method common to all
algebraic schemes to create new homomorphisms.</p>
</div>
<p>EXAMPLES:</p>
<p>First, consider the following embedding of <span class="math notranslate nohighlight">\(\mathbb{P}^1\)</span> into
<span class="math notranslate nohighlight">\(\mathbb{P}^2\)</span></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">hom</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">],</span> <span class="n">P2</span><span class="p">)</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [u : v] to [0 : u^2 + v^2 : u*v]</span>
</pre></div>
</div>
<p>This is a well-defined morphism of algebraic varieties because
homogeneously rescaled coordinates of a point of <span class="math notranslate nohighlight">\(\mathbb{P}^1\)</span> map to the same
point in <span class="math notranslate nohighlight">\(\mathbb{P}^2\)</span> up to its homogeneous rescalings. It is not
equivariant with respect to the torus actions</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\CC^\times \times \mathbb{P}^1,
(\mu,[u:v]) \mapsto [u:\mu v]
\quad\text{and}\quad
\left(\CC^\times\right)^2 \times \mathbb{P}^2,
((\alpha,\beta),[x:y:z]) \mapsto [x:\alpha y:\beta z]
,\]</div>
</div>
<p>hence it is not a toric morphism. Clearly, the problem is that
the map in homogeneous coordinates contains summands that transform
differently under the torus action. However, this is not the only
difficulty. For example, consider</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">hom</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">],</span> <span class="n">P2</span><span class="p">);</span>  <span class="n">phi</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [u : v] to [0 : u : v]</span>
</pre></div>
</div>
<p>This map is actually the embedding of the
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field.orbit_closure" title="sage.schemes.toric.variety.ToricVariety_field.orbit_closure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orbit_closure()</span></code></a>
associated to one of the rays of the fan of <span class="math notranslate nohighlight">\(\mathbb{P}^2\)</span>. Now the
morphism is equivariant with respect to <strong>some</strong> map <span class="math notranslate nohighlight">\(\CC^\times \to
(\CC^\times)^2\)</span> of the maximal tori of <span class="math notranslate nohighlight">\(\mathbb{P}^1\)</span> and
<span class="math notranslate nohighlight">\(\mathbb{P}^2\)</span>. But this map of the maximal tori cannot be the same as
<code class="docutils literal notranslate"><span class="pre">phi</span></code> defined above. Indeed, the image of <code class="docutils literal notranslate"><span class="pre">phi</span></code> completely misses
the maximal torus <span class="math notranslate nohighlight">\(T_{\mathbb{P}^2} = \{ [x:y:z] | x\not=0, y\not=0,
z\not=0 \}\)</span> of <span class="math notranslate nohighlight">\(\mathbb{P}^2\)</span>.</p>
<p>Consider instead the following morphism of fans:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">());</span>  <span class="n">fm</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1 0]</span>
<span class="go">Domain fan: Rational polyhedral fan in 1-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
<p>which also defines a morphism of toric varieties:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 1-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 2-d lattice N.</span>
</pre></div>
</div>
<p>The fan morphism map is equivalent to the following polynomial map:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [u : v] to [u : v : v]</span>
</pre></div>
</div>
<p>Finally, here is an example of a fan morphism that cannot be written
using homogeneous polynomials. Consider the blowup <span class="math notranslate nohighlight">\(O_{\mathbb{P}^1}(2)
\to \CC^2/\ZZ_2\)</span>. In terms of toric data, this blowup is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2_Z2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2_Z2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(1, 2)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">O2_P1</span> <span class="o">=</span> <span class="n">A2_Z2</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">blowup</span> <span class="o">=</span> <span class="n">O2_P1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">A2_Z2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: the fan morphism cannot be written in homogeneous polynomials</span>
</pre></div>
</div>
<p>If we denote the homogeneous coordinates of <span class="math notranslate nohighlight">\(O_{\mathbb{P}^1}(2)\)</span> by
<span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(y\)</span> corresponding to the rays <span class="math notranslate nohighlight">\((1,2)\)</span>, <span class="math notranslate nohighlight">\((1,1)\)</span>, and <span class="math notranslate nohighlight">\((1,0)\)</span>
then the blow-up map is <a class="reference internal" href="../../../../references/index.html#bb2013" id="id2"><span>[BB2013]</span></a>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f: O_{\mathbb{P}^1}(2) \to \CC^2/\ZZ_2, \quad
(x,t,y) \mapsto \left( x\sqrt{t}, y\sqrt{t} \right)\]</div>
</div>
<p>which requires square roots.</p>
<section id="fibrations">
<h2>Fibrations<a class="headerlink" href="#fibrations" title="Permalink to this heading">#</a></h2>
<p>If a toric morphism is <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_dominant" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_dominant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dominant</span></code></a>, then all fibers over
a fixed torus orbit in the base are isomorphic. Hence, studying the
fibers is again a combinatorial question and Sage implements
additional methods to study such fibrations that are not available
otherwise (however, note that you can always
<a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">factor()</span></code></a> to pick out the part
that is dominant over the image or its closure).</p>
<p>For example, consider the blow-up restricted to one of the two
coordinate charts of <span class="math notranslate nohighlight">\(O_{\mathbb{P}^1}(2)\)</span></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">O2_P1_chart</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">([</span><span class="n">O2_P1</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]))</span>
<span class="gp">sage: </span><span class="n">single_chart</span> <span class="o">=</span> <span class="n">O2_P1_chart</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">A2_Z2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">single_chart</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">single_chart</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">fiber</span> <span class="o">=</span> <span class="n">single_chart</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">();</span>  <span class="n">fiber</span>
<span class="go">(0-d affine toric variety, 1)</span>
<span class="gp">sage: </span><span class="n">fiber</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 0-d affine toric variety</span>
<span class="go">  To:   2-d affine toric variety</span>
<span class="go">  Defn: Defined on coordinates by sending [] to [1 : 1]</span>
</pre></div>
</div>
<p>The fibers are labeled by torus orbits in the base, that is, cones of
the codomain fan. In this case, the fibers over lower-dimensional
torus orbits are:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2_Z2_cones</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cones</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">table</span><span class="p">([(</span><span class="s1">&#39;cone&#39;</span><span class="p">,</span> <span class="s1">&#39;dim&#39;</span><span class="p">)]</span> <span class="o">+</span>
<span class="gp">....: </span>      <span class="p">[(</span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">(),</span> <span class="n">single_chart</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">cone</span><span class="p">))</span>
<span class="gp">....: </span>       <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">A2_Z2_cones</span><span class="p">],</span> <span class="n">header_row</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">  cone     dim</span>
<span class="go">+--------+-----+</span>
<span class="go">  ()       0</span>
<span class="go">  (0,)     0</span>
<span class="go">  (1,)     -1</span>
<span class="go">  (0, 1)   1</span>
</pre></div>
</div>
<p>Lets look closer at the one-dimensional fiber. Although not the case
in this example, connected components of fibers over higher-dimensional cones
(corresponding
to lower-dimensional torus orbits) of the base are often not
irreducible. The irreducible components are labeled by the
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">primitive_preimage_cones()</span></code></a>,
which are certain cones of the domain fan that map to the cone in the
base that defines the torus orbit:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">table</span><span class="p">([(</span><span class="s1">&#39;base cone&#39;</span><span class="p">,</span> <span class="s1">&#39;primitive preimage cones&#39;</span><span class="p">)]</span> <span class="o">+</span>
<span class="gp">....: </span>      <span class="p">[(</span><span class="n">cone</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">(),</span>
<span class="gp">....: </span>        <span class="n">single_chart</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">cone</span><span class="p">))</span>
<span class="gp">....: </span>       <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">A2_Z2_cones</span><span class="p">],</span> <span class="n">header_row</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">  base cone   primitive preimage cones</span>
<span class="go">+-----------+---------------------------------------------------------+</span>
<span class="go">  ()          (0-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="go">  (0,)        (1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="go">  (1,)        ()</span>
<span class="go">  (0, 1)      (1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
</pre></div>
</div>
<p>The fiber over the trivial cone is the generic fiber that we have
already encountered. The interesting fiber is the one over the
2-dimensional cone, which represents the exceptional set of the
blow-up in this single coordinate chart. Lets investigate further:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">single_chart</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">exceptional_cones</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">exceptional_set</span> <span class="o">=</span> <span class="n">single_chart</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">exceptional_cones</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">exceptional_set</span>
<span class="go">1-d affine toric variety</span>
<span class="gp">sage: </span><span class="n">exceptional_set</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d affine toric variety</span>
<span class="go">  To:   2-d affine toric variety</span>
<span class="go">  Defn: Defined on coordinates by sending [z0] to [z0 : 0]</span>
</pre></div>
</div>
<p>So we see that the fiber over this point is an affine line. Together
with another affine line in the other coordinate patch, this covers
the exceptional <span class="math notranslate nohighlight">\(\mathbb{P}^1\)</span> of the blowup <span class="math notranslate nohighlight">\(O_{\mathbb{P}^1}(2) \to
\CC^2/\ZZ_2\)</span>.</p>
<p>Here is an example with higher dimensional varieties involved:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A3</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P3</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">A3</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">P3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 3-d affine toric variety</span>
<span class="go">  To:   3-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1 : z2] to</span>
<span class="go">        [z0^2*z1*z2^3 : z1*z2 : 1 : 1]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;SchemeMorphism_fan_toric_variety&#39; object</span>
<span class="go">has no attribute &#39;fiber_generic&#39;</span>
</pre></div>
</div>
<p>Let’s use factorization mentioned above:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_i</span><span class="p">,</span> <span class="n">phi_b</span><span class="p">,</span> <span class="n">phi_s</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</pre></div>
</div>
<p>It is possible to study fibers of the last two morphisms or their composition:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_d</span> <span class="o">=</span> <span class="n">phi_b</span> <span class="o">*</span> <span class="n">phi_s</span>
<span class="gp">sage: </span><span class="n">phi_d</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 3-d affine toric variety</span>
<span class="go">  To:   2-d toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 3-d lattice N to</span>
<span class="go">        Rational polyhedral fan in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;.</span>
<span class="gp">sage: </span><span class="n">phi_d</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 3-d affine toric variety</span>
<span class="go">  To:   2-d toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1 : z2] to</span>
<span class="go">        [1 : z1*z2 : z0^2*z1*z2^3]</span>
<span class="gp">sage: </span><span class="n">phi_d</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(-1, -1, 0),</span>
<span class="go">N( 0,  1, 0),</span>
<span class="go">N( 1,  0, 0)</span>
<span class="go">in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">phi_d</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="n">c</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="go">(0, 2)</span>
<span class="go">(1, 2)</span>
</pre></div>
</div>
<p>We see that codomain fan of this morphism is a projective plane, which can be
verified by</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_d</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">())</span> <span class="c1"># known bug</span>
<span class="go">True</span>
</pre></div>
</div>
<p>(Unfortunately it cannot be verified correctly until <a class="reference external" href="https://github.com/sagemath/sage/issues/16012">github issue #16012</a> is fixed.)</p>
<p>We now have access to fiber methods:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fiber</span> <span class="o">=</span> <span class="n">phi_d</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fiber</span>
<span class="go">(1-d affine toric variety, 2)</span>
<span class="gp">sage: </span><span class="n">fiber</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d affine toric variety</span>
<span class="go">  To:   3-d affine toric variety</span>
<span class="go">  Defn: Defined by sending</span>
<span class="go">        Rational polyhedral fan in Sublattice &lt;N(1, 1, -1)&gt; to</span>
<span class="go">        Rational polyhedral fan in 3-d lattice N.</span>
<span class="gp">sage: </span><span class="n">fiber</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: polynomial representations for</span>
<span class="go">fans with virtual rays are not implemented yet</span>
<span class="gp">sage: </span><span class="n">fiber</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">Empty collection</span>
<span class="go">in Sublattice &lt;N(1, 1, -1)&gt;</span>
</pre></div>
</div>
<p>We see that generic fibers of this morphism consist of 2 one-dimensional tori
each. To see what happens over boundary points we can look at fiber components
corresponding to the cones of the domain fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">phi_d</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">flatten</span><span class="p">(</span><span class="n">phi_d</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cones</span><span class="p">()):</span>
<span class="gp">....: </span>    <span class="n">fc</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">phi_d</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">multiplicity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> |-&gt; </span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2"> rays, multiplicity </span><span class="si">{}</span><span class="s2">) over </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">....: </span>      <span class="n">c</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">(),</span> <span class="n">fc</span><span class="p">,</span> <span class="n">fc</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">nrays</span><span class="p">(),</span>
<span class="gp">....: </span>      <span class="n">m</span><span class="p">,</span> <span class="n">fm</span><span class="o">.</span><span class="n">image_cone</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">()))</span>
<span class="go">() |-&gt; 1-d affine toric variety (0 rays, multiplicity 2) over ()</span>
<span class="go">(0,) |-&gt; 1-d affine toric variety (0 rays, multiplicity 1) over (2,)</span>
<span class="go">(1,) |-&gt; 2-d affine toric variety (2 rays, multiplicity 1) over (1, 2)</span>
<span class="go">(2,) |-&gt; 2-d affine toric variety (2 rays, multiplicity 1) over (1, 2)</span>
<span class="go">(0, 1) |-&gt; 1-d affine toric variety (1 rays, multiplicity 1) over (1, 2)</span>
<span class="go">(1, 2) |-&gt; 1-d affine toric variety (1 rays, multiplicity 1) over (1, 2)</span>
<span class="go">(0, 2) |-&gt; 1-d affine toric variety (1 rays, multiplicity 1) over (1, 2)</span>
<span class="go">(0, 1, 2) |-&gt; 0-d affine toric variety (0 rays, multiplicity 1) over (1, 2)</span>
</pre></div>
</div>
<p>Now we see that over one of the coordinate lines of the projective plane we also
have one-dimensional tori (but only one in each fiber), while over one of the
points fixed by torus action we have two affine planes intersecting along an
affine line. An alternative perspective is provided by cones of the codomain
fan:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">flatten</span><span class="p">(</span><span class="n">phi_d</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cones</span><span class="p">()):</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> connected components over </span><span class="si">{}</span><span class="s2">, each with </span><span class="si">{}</span><span class="s2"> irreducible components.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">....: </span>      <span class="n">fm</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">c</span><span class="o">.</span><span class="n">ambient_ray_indices</span><span class="p">(),</span>
<span class="gp">....: </span>      <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">c</span><span class="p">))))</span>
<span class="go">2 connected components over (), each with 1 irreducible components.</span>
<span class="go">None connected components over (0,), each with 0 irreducible components.</span>
<span class="go">None connected components over (1,), each with 0 irreducible components.</span>
<span class="go">1 connected components over (2,), each with 1 irreducible components.</span>
<span class="go">None connected components over (0, 1), each with 0 irreducible components.</span>
<span class="go">None connected components over (0, 2), each with 0 irreducible components.</span>
<span class="go">1 connected components over (1, 2), each with 2 irreducible components.</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.morphism.</span></span><span class="sig-name descname"><span class="pre">SchemeMorphism_fan_fiber_component_toric_variety</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toric_morphism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defining_cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/morphism.html#sage.schemes.generic.morphism.SchemeMorphism" title="sage.schemes.generic.morphism.SchemeMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism</span></code></a></p>
<p>The embedding of a fiber component of a toric morphism.</p>
<p>Note that the embedding map of a fiber component of a toric morphism is
itself not a toric morphism!</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">toric_morphism</span></code> – a toric morphism. The toric morphism whose
fiber component we are describing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">defining_cone</span></code> – a cone of the fan of the domain of
<code class="docutils literal notranslate"><span class="pre">toric_morphism</span></code>. See
<a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fiber_component()</span></code></a> for
details.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span>
<span class="gp">....: </span>    <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">....: </span>     <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">coarse_fan</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">polytope</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proj24</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">proj24</span><span class="p">,</span> <span class="n">coarse_fan</span><span class="p">,</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibration</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">())</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ffm</span> <span class="o">=</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">primitive_cones</span> <span class="o">=</span> <span class="n">ffm</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">primitive_cone</span> <span class="o">=</span> <span class="n">primitive_cones</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">fiber_component</span> <span class="o">=</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fiber_component</span>
<span class="go">2-d toric variety covered by 4 affine patches</span>
<span class="gp">sage: </span><span class="n">fiber_component</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d toric variety covered by 4 affine patches</span>
<span class="go">  To:   4-d toric variety covered by 23 affine patches</span>
<span class="go">  Defn: Defined by embedding a fiber component corresponding to</span>
<span class="go">        1-d cone of Rational polyhedral fan in 4-d lattice N.</span>
<span class="gp">sage: </span><span class="n">fiber_component</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d toric variety covered by 4 affine patches</span>
<span class="go">  To:   4-d toric variety covered by 23 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1 : z2 : z3] to</span>
<span class="go">        [1 : 1 : 1 : 1 : z2 : 0 : 1 : z3 : 1 : 1 : 1 : z1 : z0 : 1 : 1]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">fiber_component</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety&#39;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.as_polynomial_map">
<span class="sig-name descname"><span class="pre">as_polynomial_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.as_polynomial_map" title="Permalink to this definition">#</a></dt>
<dd><p>Express the embedding morphism via homogeneous polynomials.</p>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></code></a>. Raises a
<code class="docutils literal notranslate"><span class="pre">ValueError</span></code> if the morphism cannot be written in terms of
homogeneous polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span>
<span class="gp">....: </span>    <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">....: </span>     <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">coarse_fan</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">polytope</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proj24</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">proj24</span><span class="p">,</span> <span class="n">coarse_fan</span><span class="p">,</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibration</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">())</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">primitive_cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">)</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d toric variety covered by 4 affine patches</span>
<span class="go">  To:   4-d toric variety covered by 23 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1 : z2 : z3] to</span>
<span class="go">        [1 : 1 : 1 : 1 : z2 : 0 : 1 : z3 : 1 : 1 : 1 : z1 : z0 : 1 : 1]</span>

<span class="gp">sage: </span><span class="n">primitive_cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">)</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: the morphism cannot be written using homogeneous polynomials</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.base_cone">
<span class="sig-name descname"><span class="pre">base_cone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.base_cone" title="Permalink to this definition">#</a></dt>
<dd><p>Return the base cone <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<p>The fiber is constant over the base orbit closure <span class="math notranslate nohighlight">\(V(\sigma)\)</span>.</p>
<p>OUTPUT:</p>
<p>A cone of the base of the toric fibration.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fc</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">defining_cone</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">base_cone</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1)</span>
<span class="go">in 1-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.defining_cone">
<span class="sig-name descname"><span class="pre">defining_cone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.defining_cone" title="Permalink to this definition">#</a></dt>
<dd><p>Return the cone corresponding to the fiber torus orbit.</p>
<p>OUTPUT:</p>
<p>A cone of the fan of the total space of the toric fibration.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fc</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">defining_cone</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">base_cone</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1)</span>
<span class="go">in 1-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.pullback_divisor">
<span class="sig-name descname"><span class="pre">pullback_divisor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">divisor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.pullback_divisor" title="Permalink to this definition">#</a></dt>
<dd><p>Pull back a toric divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">divisor</span></code> – a torus-invariant <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor on the
codomain of the embedding map.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A divisor on the domain of the embedding map (irreducible
component of a fiber of a toric morphism) that is isomorphic
to the pull-back divisor <span class="math notranslate nohighlight">\(f^*(D)\)</span> but with possibly different
linearization.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">A1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">D</span>
<span class="go">V(z0) + V(z1) + 3*V(z2) + 4*V(z3)</span>
<span class="gp">sage: </span><span class="n">fc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">fc</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">pullback_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">4*V(z0) + V(z1) + 4*V(z2)</span>
<span class="gp">sage: </span><span class="n">fc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">fc</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">pullback_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">-V(z0) - 3*V(z1) - 3*V(z2)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.morphism.</span></span><span class="sig-name descname"><span class="pre">SchemeMorphism_fan_toric_variety</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fan_morphism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/morphism.html#sage.schemes.generic.morphism.SchemeMorphism" title="sage.schemes.generic.morphism.SchemeMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism</span></code></a>, <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Category Framework v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Morphism</span></code></a></p>
<p>Construct a morphism determined by a fan morphism</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You should not create objects of this class directly. Use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">hom()</span></code> method of
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">varieties</span></code></a>
instead.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parent</span></code> – Hom-set whose domain and codomain are toric varieties.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fan_morphism</span></code> – A morphism of fans whose domain and codomain
fans equal the fans of the domain and codomain in the <code class="docutils literal notranslate"><span class="pre">parent</span></code>
Hom-set.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (optional, default:<code class="docutils literal notranslate"><span class="pre">True</span></code>). Whether to
check the input for consistency.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A fibration is a dominant morphism; if you are interested in
these then you have to make sure that your fan morphism is
dominant. For example, this can be achieved by
<a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">factoring</span> <span class="pre">the</span> <span class="pre">morphism</span></code></a>. See
<a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_fan_toric_variety_dominant</span></code></a> for
additional functionality for fibrations.</p>
</div>
<p>OUTPUT: A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_fan_toric_variety</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1xP1</span><span class="p">);</span>  <span class="n">f</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 1-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 2-d lattice N.</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety&#39;&gt;</span>
</pre></div>
</div>
<p>Slightly more explicit construction:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">hom_set</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">Hom</span><span class="p">(</span><span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">hom_set</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  To:   1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 2-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 1-d lattice N.</span>

<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P1</span><span class="p">)</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  To:   1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 2-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 1-d lattice N.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.as_polynomial_map">
<span class="sig-name descname"><span class="pre">as_polynomial_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.as_polynomial_map" title="Permalink to this definition">#</a></dt>
<dd><p>Express the morphism via homogeneous polynomials.</p>
<p>OUTPUT: A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></code></a>.</p>
<p>Raises a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> if the morphism cannot be written in terms of
homogeneous polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">square</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">A1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">square</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme endomorphism of 1-d affine toric variety</span>
<span class="go">  Defn: Defined on coordinates by sending [z] to [z^2]</span>

<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">patch</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d affine toric variety</span>
<span class="go">  To:   1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z] to [z : 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor">
<span class="sig-name descname"><span class="pre">factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor" title="Permalink to this definition">#</a></dt>
<dd><p>Factor <code class="docutils literal notranslate"><span class="pre">self</span></code> into injective * birational * surjective morphisms.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a triple of toric morphisms <span class="math notranslate nohighlight">\((\phi_i, \phi_b, \phi_s)\)</span>, such that
<span class="math notranslate nohighlight">\(\phi_s\)</span> is surjective, <span class="math notranslate nohighlight">\(\phi_b\)</span> is birational, <span class="math notranslate nohighlight">\(\phi_i\)</span> is injective,
and <code class="docutils literal notranslate"><span class="pre">self</span></code> is equal to <span class="math notranslate nohighlight">\(\phi_i \circ \phi_b \circ \phi_s\)</span>.</p></li>
</ul>
<p>The intermediate varieties are universal in the following sense. Let
<code class="docutils literal notranslate"><span class="pre">self</span></code> map <span class="math notranslate nohighlight">\(X\)</span> to <span class="math notranslate nohighlight">\(X'\)</span> and let <span class="math notranslate nohighlight">\(X_s\)</span>, <span class="math notranslate nohighlight">\(X_i\)</span> sit in between, that is,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[X
\twoheadrightarrow
X_s
\to
X_i
\hookrightarrow
X'.\]</div>
</div>
<p>Then any toric morphism from <span class="math notranslate nohighlight">\(X\)</span> coinciding with <code class="docutils literal notranslate"><span class="pre">self</span></code> on the maximal
torus factors through <span class="math notranslate nohighlight">\(X_s\)</span> and any toric morphism into <span class="math notranslate nohighlight">\(X'\)</span> coinciding
with <code class="docutils literal notranslate"><span class="pre">self</span></code> on the maximal torus factors through <span class="math notranslate nohighlight">\(X_i\)</span>. In particular,
<span class="math notranslate nohighlight">\(X_i\)</span> is the closure of the image of <code class="docutils literal notranslate"><span class="pre">self</span></code> in <span class="math notranslate nohighlight">\(X'\)</span>.</p>
<p>See
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.factor" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">factor()</span></code></a>
for a description of the toric algorithm.</p>
<p>EXAMPLES:</p>
<p>We map an affine plane into a projective 3-space in such a way, that it
becomes “a double cover of a chart of the blow up of one of the
coordinate planes”:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P3</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">P3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d affine toric variety</span>
<span class="go">  To:   3-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [x : y] to</span>
<span class="go">        [x^2*y : y : 1 : 1]</span>

<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(),</span> <span class="n">phi</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">phi</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">(False, False, False)</span>
<span class="gp">sage: </span><span class="n">phi_i</span><span class="p">,</span> <span class="n">phi_b</span><span class="p">,</span> <span class="n">phi_s</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_s</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(),</span> <span class="n">phi_b</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">phi_i</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">(True, True, True)</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">factor</span><span class="p">())</span> <span class="o">==</span> <span class="n">phi</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Double cover (surjective):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_s</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d affine toric variety</span>
<span class="go">  To:   2-d affine toric variety</span>
<span class="go">  Defn: Defined on coordinates by sending [x : y] to [x^2 : y]</span>
</pre></div>
</div>
<p>Blowup chart (birational):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_b</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d affine toric variety</span>
<span class="go">  To:   2-d toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1] to [1 : z1 : z0*z1]</span>
</pre></div>
</div>
<p>Coordinate plane inclusion (injective):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_i</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d toric variety covered by 3 affine patches</span>
<span class="go">  To:   3-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1 : z2] to [z2 : z1 : z0 : z0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.fan_morphism">
<span class="sig-name descname"><span class="pre">fan_morphism</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.fan_morphism" title="Permalink to this definition">#</a></dt>
<dd><p>Return the defining fan morphism.</p>
<p>OUTPUT: A <a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">FanMorphism</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1]</span>
<span class="go">[0]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 1-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_birational">
<span class="sig-name descname"><span class="pre">is_birational</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_birational" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is birational.</p>
<p>See
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_birational" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_birational()</span></code></a>
for fan morphisms for a description of the toric algorithm.</p>
<p>OUTPUT:</p>
<p>Boolean. Whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is birational.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP8</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">dP8</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">P2</span><span class="p">)</span><span class="o">.</span><span class="n">is_birational</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])]))</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_birational</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_bundle">
<span class="sig-name descname"><span class="pre">is_bundle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_bundle" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a bundle.</p>
<p>See <a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_bundle" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_bundle()</span></code></a>
for fan morphisms for details.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a bundle, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_dominant">
<span class="sig-name descname"><span class="pre">is_dominant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_dominant" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is dominant.</p>
<p>See
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_dominant" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_dominant()</span></code></a>
for fan morphisms for a description of the toric algorithm.</p>
<p>OUTPUT:</p>
<p>Boolean. Whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is a dominant scheme morphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">P1</span><span class="p">);</span>  <span class="n">phi</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d affine toric variety</span>
<span class="go">  To:   1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 1-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 1-d lattice N.</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_fibration">
<span class="sig-name descname"><span class="pre">is_fibration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_fibration" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a fibration.</p>
<p>See
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_fibration" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_fibration()</span></code></a>
for fan morphisms for details.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a fibration, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_injective">
<span class="sig-name descname"><span class="pre">is_injective</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_injective" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is injective.</p>
<p>See
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_injective" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_injective()</span></code></a>
for fan morphisms for a description of the toric algorithm.</p>
<p>OUTPUT:</p>
<p>Boolean. Whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is injective.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])]))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_surjective">
<span class="sig-name descname"><span class="pre">is_surjective</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_surjective" title="Permalink to this definition">#</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is surjective.</p>
<p>See
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_surjective" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_surjective()</span></code></a>
for fan morphisms for a description of the toric algorithm.</p>
<p>OUTPUT:</p>
<p>Boolean. Whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is surjective.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])]))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.pullback_divisor">
<span class="sig-name descname"><span class="pre">pullback_divisor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">divisor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.pullback_divisor" title="Permalink to this definition">#</a></dt>
<dd><p>Pull back a toric divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">divisor</span></code> – a torus-invariant <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor on the
codomain of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The pull-back divisor <span class="math notranslate nohighlight">\(f^*(D)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2_Z2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2_Z2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">A2_Z2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">pullback_divisor</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">V(x)</span>

<span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">square</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">A1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>  <span class="n">D</span>
<span class="go">V(z)</span>
<span class="gp">sage: </span><span class="n">square</span><span class="o">.</span><span class="n">pullback_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">2*V(z)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.morphism.</span></span><span class="sig-name descname"><span class="pre">SchemeMorphism_fan_toric_variety_dominant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fan_morphism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_fan_toric_variety</span></code></a></p>
<p>Construct a morphism determined by a dominant fan morphism.</p>
<p>A dominant morphism is one that is surjective onto a dense
subset. In the context of toric morphisms, this means that it is
onto the big torus orbit.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You should not create objects of this class directly. Use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">hom()</span></code> method of
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">varieties</span></code></a>
instead.</p>
</div>
<p>INPUT:</p>
<p>See <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_fan_toric_variety</span></code></a>. The given fan
morphism <a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.is_dominant" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">must</span> <span class="pre">be</span> <span class="pre">dominant</span></code></a>.</p>
<p>OUTPUT: A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_fan_toric_variety_dominant</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">dP8</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">dP8</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">P2</span><span class="p">);</span>  <span class="n">f</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 2-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 2-d lattice N.</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant&#39;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component">
<span class="sig-name descname"><span class="pre">fiber_component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain_cone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component" title="Permalink to this definition">#</a></dt>
<dd><p>Return a fiber component corresponding to <code class="docutils literal notranslate"><span class="pre">domain_cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">domain_cone</span></code> – a cone of the domain fan of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">multiplicity</span></code> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – whether to return the number
of fiber components corresponding to <code class="docutils literal notranslate"><span class="pre">domain_cone</span></code> as well.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>either <span class="math notranslate nohighlight">\(X\)</span> or a tuple <span class="math notranslate nohighlight">\((X, n)\)</span>, where <span class="math notranslate nohighlight">\(X\)</span> is a <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">variety</span></code></a> with the
embedding morphism into domain of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <span class="math notranslate nohighlight">\(n\)</span> is an integer.</p></li>
</ul>
<p>Let <span class="math notranslate nohighlight">\(\phi: \Sigma \to \Sigma'\)</span> be the <a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">fan</span> <span class="pre">morphism</span></code></a> corresponding to
<code class="docutils literal notranslate"><span class="pre">self</span></code>. Let <span class="math notranslate nohighlight">\(\sigma \in \Sigma\)</span> and <span class="math notranslate nohighlight">\(\sigma' \in \Sigma'\)</span> be
the <a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.image_cone" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">image_cone()</span></code></a>
of <span class="math notranslate nohighlight">\(\sigma\)</span>.  The fiber over any point of the torus orbit corresponding
to <span class="math notranslate nohighlight">\(\sigma'\)</span> consists of <span class="math notranslate nohighlight">\(n\)</span> isomorphic connected components with each
component being a union of toric varieties intersecting along
their torus invariant subvarieties. The latter correspond to
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preimage_cones()</span></code></a> of
<span class="math notranslate nohighlight">\(\sigma'\)</span> and <span class="math notranslate nohighlight">\(X\)</span> is one of the <span class="math notranslate nohighlight">\(n\)</span> components corresponding to
<span class="math notranslate nohighlight">\(\sigma\)</span>. The irreducible components correspond to
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">primitive_preimage_cones()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">LatticePolytope</span><span class="p">(</span>
<span class="gp">....: </span>    <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">....: </span>     <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">coarse_fan</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">polytope</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proj24</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">proj24</span><span class="p">,</span> <span class="n">coarse_fan</span><span class="p">,</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibration</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">())</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ffm</span> <span class="o">=</span> <span class="n">fibration</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">primitive_cones</span> <span class="o">=</span> <span class="n">ffm</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">primitive_cone</span> <span class="o">=</span> <span class="n">primitive_cones</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">)</span>
<span class="go">2-d toric variety covered by 4 affine patches</span>
<span class="gp">sage: </span><span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">(2-d toric variety covered by 4 affine patches, 1)</span>

<span class="gp">sage: </span><span class="k">for</span> <span class="n">primitive_cone</span> <span class="ow">in</span> <span class="n">primitive_cones</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">fibration</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">primitive_cone</span><span class="p">))</span>
<span class="go">2-d toric variety covered by 4 affine patches</span>
<span class="go">2-d toric variety covered by 3 affine patches</span>
<span class="go">2-d toric variety covered by 3 affine patches</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_dimension">
<span class="sig-name descname"><span class="pre">fiber_dimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codomain_cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_dimension" title="Permalink to this definition">#</a></dt>
<dd><p>Return the dimension of the fiber over a particular torus
orbit in the base.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">codomain_cone</span></code> – a cone <span class="math notranslate nohighlight">\(\sigma\)</span> of the codomain,
specifying a torus orbit <span class="math notranslate nohighlight">\(O(\sigma)\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An integer. The dimension of the fiber over the torus orbit
corresponding to <code class="docutils literal notranslate"><span class="pre">codomain_cone</span></code>. If the fiber is the empty
set, <code class="docutils literal notranslate"><span class="pre">-1</span></code> is returned. Note that all fibers over this torus
orbit are isomorphic, and therefore have the same dimension.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Here is a more complicated example that is not a flat fibration:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2_Z2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2_Z2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">O2_P1</span> <span class="o">=</span> <span class="n">A2_Z2</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">blowup</span> <span class="o">=</span> <span class="n">O2_P1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">A2_Z2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_dimension</span><span class="p">(</span><span class="n">A2_Z2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>This corresponds to the three different fibers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">()</span>
<span class="go">(0-d affine toric variety, 1)</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="go">0-d affine toric variety</span>
<span class="gp">sage: </span><span class="n">blowup</span><span class="o">.</span><span class="n">fiber_component</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">1-d toric variety covered by 2 affine patches</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_generic">
<span class="sig-name descname"><span class="pre">fiber_generic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_generic" title="Permalink to this definition">#</a></dt>
<dd><p>Return the generic fiber.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a tuple <span class="math notranslate nohighlight">\((X, n)\)</span>, where <span class="math notranslate nohighlight">\(X\)</span> is a <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">variety</span></code></a> with the
embedding morphism into domain of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <span class="math notranslate nohighlight">\(n\)</span> is an integer.</p></li>
</ul>
<p>The fiber over the base point with homogeneous coordinates
<span class="math notranslate nohighlight">\([1:1:\cdots:1]\)</span> consists of <span class="math notranslate nohighlight">\(n\)</span> disjoint toric varieties isomorphic to
<span class="math notranslate nohighlight">\(X\)</span>. Note that fibers of a dominant toric morphism are isomorphic over
all points of a fixed torus orbit of its codomain, in particular over
all points of the maximal torus, so it makes sense to talk about “the
generic” fiber.</p>
<p>The embedding of <span class="math notranslate nohighlight">\(X\)</span> is a toric morphism with
the <a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">domain_fan()</span></code></a>
being the
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan_morphism.html#sage.geometry.fan_morphism.FanMorphism.kernel_fan" title="(in Combinatorial and Discrete Geometry v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kernel_fan()</span></code></a> of
the defining fan morphism. By contrast, embeddings of fiber components
over lower-dimensional torus orbits of the image are not toric
morphisms. Use <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fiber_component()</span></code></a> for the latter
(non-generic) fibers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fiber</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fiber</span>
<span class="go">(1-d toric variety covered by 2 affine patches, 1)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fiber</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">();</span>  <span class="n">f</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in Sublattice &lt;N(0, 1)&gt; to</span>
<span class="go">        Rational polyhedral fan in 2-d lattice N.</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1] to [1 : 1 : z0 : z1]</span>

<span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">fan</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">new_rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">A1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fiber_generic</span><span class="p">()</span>
<span class="go">(2-d affine toric variety, 1)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">generating_cones</span><span class="p">()</span>
<span class="go">(0-d cone of Rational polyhedral fan in Sublattice &lt;N(0, 1, 0), N(0, 0, 1)&gt;,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_graph">
<span class="sig-name descname"><span class="pre">fiber_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codomain_cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_graph" title="Permalink to this definition">#</a></dt>
<dd><p>Return the fiber over a given torus orbit in the codomain.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">codomain_cone</span></code> – a cone <span class="math notranslate nohighlight">\(\sigma\)</span> of the codomain,
specifying a torus orbit <span class="math notranslate nohighlight">\(O(\sigma)\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A graph whose nodes are the irreducible components of a connected
component of the fiber over a point of <span class="math notranslate nohighlight">\(O(\sigma)\)</span>. If two irreducible
components intersect, the
corresponding nodes of the graph are joined by an edge. Note that
irreducible components do not have to be of the same dimension.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component" title="sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fiber_component()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span>
<span class="gp">....: </span>    <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">....: </span>     <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">coarse_fan</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">polytope</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>

<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proj34</span> <span class="o">=</span> <span class="n">block_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">zero_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">proj34</span><span class="p">,</span> <span class="n">coarse_fan</span><span class="p">,</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibration</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">())</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">fibration</span><span class="o">.</span><span class="n">fiber_graph</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Graph on 1 vertex</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">fibration</span><span class="o">.</span><span class="n">fiber_graph</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
<span class="go">Graph on 1 vertex</span>
<span class="go">Graph on 1 vertex</span>
<span class="go">Graph on 4 vertices</span>

<span class="gp">sage: </span><span class="n">fibration</span><span class="o">.</span><span class="n">fiber_graph</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">get_vertices</span><span class="p">()</span>
<span class="go">{0: 2-d toric variety covered by 4 affine patches,</span>
<span class="go"> 1: 2-d toric variety covered by 3 affine patches,</span>
<span class="go"> 2: 2-d toric variety covered by 3 affine patches,</span>
<span class="go"> 3: 2-d toric variety covered by 4 affine patches}</span>

<span class="gp">sage: </span><span class="n">fibration</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 4-d toric variety covered by 18 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined by sending Rational polyhedral fan in 4-d lattice N</span>
<span class="go">        to Rational polyhedral fan in 2-d lattice N.</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.morphism.</span></span><span class="sig-name descname"><span class="pre">SchemeMorphism_orbit_closure_toric_variety</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defining_cone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ray_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/morphism.html#sage.schemes.generic.morphism.SchemeMorphism" title="sage.schemes.generic.morphism.SchemeMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism</span></code></a>, <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Category Framework v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Morphism</span></code></a></p>
<p>The embedding of an orbit closure.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parent</span></code> – the parent homset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">defining_cone</span></code> – the defining cone.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ray_map</span></code> – a dictionary <code class="docutils literal notranslate"><span class="pre">{ambient</span> <span class="pre">ray</span> <span class="pre">generator:</span> <span class="pre">orbit</span> <span class="pre">ray</span>
<span class="pre">generator}</span></code>. Note that the image of the ambient ray generator
is not necessarily primitive.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You should not create objects of this class directly. Use the
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field.orbit_closure" title="sage.schemes.toric.variety.ToricVariety_field.orbit_closure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orbit_closure()</span></code></a>
method of <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">varieties</span></code></a>
instead.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">orbit_closure</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined by embedding the torus closure associated to the 1-d</span>
<span class="go">        cone of Rational polyhedral fan in 2-d lattice N.</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.as_polynomial_map">
<span class="sig-name descname"><span class="pre">as_polynomial_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.as_polynomial_map" title="Permalink to this definition">#</a></dt>
<dd><p>Express the morphism via homogeneous polynomials.</p>
<p>OUTPUT:</p>
<p>A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></code></a>. Raises a
<code class="docutils literal notranslate"><span class="pre">TypeError</span></code> if the morphism cannot be written in terms of
homogeneous polynomials.</p>
<p>The defining polynomials are not necessarily unique. There are
choices if multiple ambient space ray generators project to
the same orbit ray generator, and one such choice is made
implicitly. The orbit embedding can be written as a polynomial
map if and only if each primitive orbit ray generator is the
image of at least one primitive ray generator of the ambient
toric variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">orbit_closure</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]);</span>  <span class="n">V</span>
<span class="go">1-d toric variety covered by 2 affine patches</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d toric variety covered by 2 affine patches</span>
<span class="go">  To:   2-d CPR-Fano toric variety covered by 3 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [z0 : z1] to [0 : z1 : z0]</span>
</pre></div>
</div>
<p>If the toric variety is singular, then some orbit closure
embeddings cannot be written with homogeneous polynomials:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2_112</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2_112</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P2_112</span><span class="o">.</span><span class="n">orbit_closure</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: the embedding cannot be written with homogeneous polynomials</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.defining_cone">
<span class="sig-name descname"><span class="pre">defining_cone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.defining_cone" title="Permalink to this definition">#</a></dt>
<dd><p>Return the cone corresponding to the torus orbit.</p>
<p>OUTPUT: A cone of the fan of the ambient toric variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">orbit_closure</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span><span class="o">.</span><span class="n">defining_cone</span><span class="p">()</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="ow">is</span> <span class="n">cone</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.pullback_divisor">
<span class="sig-name descname"><span class="pre">pullback_divisor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">divisor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.pullback_divisor" title="Permalink to this definition">#</a></dt>
<dd><p>Pull back a toric divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">divisor</span></code> – a torus-invariant <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor on the
codomain of the embedding map.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A divisor on the domain of the embedding map (the orbit
closure) that is isomorphic to the pull-back divisor <span class="math notranslate nohighlight">\(f^*(D)\)</span>
but with possibly different linearization.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">orbit_closure</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">embedding_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">D</span>
<span class="go">V(x) + 2*V(y) + 3*V(z)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">pullback_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">4*V(z0) + 2*V(z1)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_point_toric_field">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.morphism.</span></span><span class="sig-name descname"><span class="pre">SchemeMorphism_point_toric_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_point_toric_field" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/morphism.html#sage.schemes.generic.morphism.SchemeMorphism_point" title="sage.schemes.generic.morphism.SchemeMorphism_point"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_point</span></code></a>, <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Category Framework v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Morphism</span></code></a></p>
<p>A point of a toric variety determined by homogeneous coordinates
in a field.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You should not create objects of this class directly. Use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">hom()</span></code> method of
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">varieties</span></code></a>
instead.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X</span></code> – toric variety or subscheme of a toric variety.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coordinates</span></code> – list of coordinates in the base field of <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), the input will be checked for
correctness.</p></li>
</ul>
<p>OUTPUT: A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_point_toric_field" title="sage.schemes.toric.morphism.SchemeMorphism_point_toric_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_point_toric_field</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.morphism.</span></span><span class="sig-name descname"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polynomials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/morphism.html#sage.schemes.generic.morphism.SchemeMorphism_polynomial" title="sage.schemes.generic.morphism.SchemeMorphism_polynomial"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_polynomial</span></code></a>, <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Category Framework v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Morphism</span></code></a></p>
<p>A morphism determined by homogeneous polynomials.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You should not create objects of this class directly. Use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">hom()</span></code> method of
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">varieties</span></code></a>
instead.</p>
</div>
<p>INPUT:</p>
<p>Same as for
<code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_polynomial</span></code>.</p>
<p>OUTPUT: A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety.as_fan_morphism">
<span class="sig-name descname"><span class="pre">as_fan_morphism</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety.as_fan_morphism" title="Permalink to this definition">#</a></dt>
<dd><p>Express the morphism as a map defined by a fan morphism.</p>
<p>OUTPUT: A <a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety" title="sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></code></a>.</p>
<p>Raises a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> if the morphism cannot be written in such a way.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A1</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">patch</span> <span class="o">=</span> <span class="n">A1</span><span class="o">.</span><span class="n">hom</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">z</span><span class="p">],</span> <span class="n">P1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">patch</span><span class="o">.</span><span class="n">as_fan_morphism</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: expressing toric morphisms as fan morphisms is</span>
<span class="go">not implemented yet</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="toric_subscheme.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Subschemes of toric space</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="ideal.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Toric ideals</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Morphisms of toric varieties</a><ul>
<li><a class="reference internal" href="#fibrations">Fibrations</a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety"><code class="docutils literal notranslate"><span class="pre">SchemeMorphism_fan_fiber_component_toric_variety</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.as_polynomial_map"><code class="docutils literal notranslate"><span class="pre">as_polynomial_map()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.base_cone"><code class="docutils literal notranslate"><span class="pre">base_cone()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.defining_cone"><code class="docutils literal notranslate"><span class="pre">defining_cone()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_fiber_component_toric_variety.pullback_divisor"><code class="docutils literal notranslate"><span class="pre">pullback_divisor()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety"><code class="docutils literal notranslate"><span class="pre">SchemeMorphism_fan_toric_variety</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.as_polynomial_map"><code class="docutils literal notranslate"><span class="pre">as_polynomial_map()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.factor"><code class="docutils literal notranslate"><span class="pre">factor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.fan_morphism"><code class="docutils literal notranslate"><span class="pre">fan_morphism()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_birational"><code class="docutils literal notranslate"><span class="pre">is_birational()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_bundle"><code class="docutils literal notranslate"><span class="pre">is_bundle()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_dominant"><code class="docutils literal notranslate"><span class="pre">is_dominant()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_fibration"><code class="docutils literal notranslate"><span class="pre">is_fibration()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_injective"><code class="docutils literal notranslate"><span class="pre">is_injective()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.is_surjective"><code class="docutils literal notranslate"><span class="pre">is_surjective()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety.pullback_divisor"><code class="docutils literal notranslate"><span class="pre">pullback_divisor()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant"><code class="docutils literal notranslate"><span class="pre">SchemeMorphism_fan_toric_variety_dominant</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_component"><code class="docutils literal notranslate"><span class="pre">fiber_component()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_dimension"><code class="docutils literal notranslate"><span class="pre">fiber_dimension()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_generic"><code class="docutils literal notranslate"><span class="pre">fiber_generic()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_fan_toric_variety_dominant.fiber_graph"><code class="docutils literal notranslate"><span class="pre">fiber_graph()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety"><code class="docutils literal notranslate"><span class="pre">SchemeMorphism_orbit_closure_toric_variety</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.as_polynomial_map"><code class="docutils literal notranslate"><span class="pre">as_polynomial_map()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.defining_cone"><code class="docutils literal notranslate"><span class="pre">defining_cone()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_orbit_closure_toric_variety.pullback_divisor"><code class="docutils literal notranslate"><span class="pre">pullback_divisor()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_point_toric_field"><code class="docutils literal notranslate"><span class="pre">SchemeMorphism_point_toric_field</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety"><code class="docutils literal notranslate"><span class="pre">SchemeMorphism_polynomial_toric_variety</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.toric.morphism.SchemeMorphism_polynomial_toric_variety.as_fan_morphism"><code class="docutils literal notranslate"><span class="pre">as_fan_morphism()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>