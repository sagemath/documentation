<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Toric rational divisor classes" href="divisor_class.html" /><link rel="prev" title="Library of toric varieties" href="library.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Toric divisors and divisor classes - Schemes</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=a078f75a" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Schemes</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.3 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Schemes</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Scheme implementation overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/scheme.html">Schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/spec.html">The Spec functor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/glue.html">Scheme obtained by gluing two other schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/point.html">Points on schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/ambient_space.html">Ambient spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/algebraic_scheme.html">Algebraic schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/hypersurface.html">Hypersurfaces in affine and projective space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/homset.html">Set of homomorphisms between two schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/morphism.html">Scheme morphism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/divisor.html">Divisors on schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic/divisor_group.html">Divisor groups</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_space.html">Affine <span class="math notranslate nohighlight">\(n\)</span> space over a ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_morphism.html">Morphisms on affine schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_point.html">Points on affine varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_subscheme.html">Subschemes of affine space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_rational_point.html">Enumeration of rational points on affine schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../affine/affine_homset.html">Set of homomorphisms between two affine schemes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_space.html">Projective <span class="math notranslate nohighlight">\(n\)</span> space over a ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_morphism.html">Morphisms on projective schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_point.html">Points on projective varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_subscheme.html">Subschemes of projective space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_rational_point.html">Enumeration of rational points on projective schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projective/projective_homset.html">Set of homomorphisms between two projective schemes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/space.html">Products of projective spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/homset.html">Set of homomorphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/morphism.html">Polynomial morphisms for products of projective spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/point.html">Points for products of projective spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/subscheme.html">Subschemes of products of projective spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../product_projective/rational_point.html">Enumeration of rational points on product projective schemes</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="variety.html">Toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="fano_variety.html">Fano toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="library.html">Library of toric varieties</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Toric divisors and divisor classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="divisor_class.html">Toric rational divisor classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="chow_group.html">The Chow group of a toric variety</a></li>
<li class="toctree-l1"><a class="reference internal" href="ideal.html">Toric ideals</a></li>
<li class="toctree-l1"><a class="reference internal" href="morphism.html">Morphisms of toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="toric_subscheme.html">Subschemes of toric space</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass.html">Weierstrass form of a toric elliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_covering.html">Map to the Weierstrass form of a toric elliptic curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="weierstrass_higher.html">Weierstrass for elliptic curves in higher codimension</a></li>
<li class="toctree-l1"><a class="reference internal" href="homset.html">Set of homomorphisms between two toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="points.html">Enumerate points of a toric variety</a></li>
<li class="toctree-l1"><a class="reference internal" href="sheaf/constructor.html">Construct sheaves on toric varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="sheaf/klyachko.html">Klyachko bundles and sheaves</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cyclic_covers/cycliccover_finite_field.html">Cyclic covers over a finite field</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cyclic_covers/cycliccover_generic.html">Cyclic covers curves over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cyclic_covers/charpoly_frobenius.html">Computation of the Frobenius polynomial using Newton’s identities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cyclic_covers/constructor.html">Cyclic cover curve constructor</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../berkovich/berkovich_cp_element.html">Elements of Berkovich space.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../berkovich/berkovich_space.html">Berkovich Space over <span class="math notranslate nohighlight">\(\CC_p\)</span></a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="toric-divisors-and-divisor-classes">
<span id="sage-schemes-toric-divisor"></span><h1>Toric divisors and divisor classes<a class="headerlink" href="#toric-divisors-and-divisor-classes" title="Link to this heading">#</a></h1>
<p id="module-sage.schemes.toric.divisor">Let <span class="math notranslate nohighlight">\(X\)</span> be a <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">variety</span></code></a> corresponding to a
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan.html#sage.geometry.fan.RationalPolyhedralFan" title="(in Combinatorial and Discrete Geometry v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a>
<span class="math notranslate nohighlight">\(\Sigma\)</span>. A <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">divisor</span></code></a> <span class="math notranslate nohighlight">\(D\)</span> is a T-Weil
divisor over a given coefficient ring (usually <span class="math notranslate nohighlight">\(\ZZ\)</span> or <span class="math notranslate nohighlight">\(\QQ\)</span>), i.e. a formal
linear combination of torus-invariant subvarieties of <span class="math notranslate nohighlight">\(X\)</span> of codimension one.
In homogeneous coordinates <span class="math notranslate nohighlight">\([z_0:\cdots:z_k]\)</span>, these are the subvarieties
<span class="math notranslate nohighlight">\(\{z_i=0\}\)</span>. Note that there is a finite number of such subvarieties, one for
each ray of <span class="math notranslate nohighlight">\(\Sigma\)</span>. We generally identify</p>
<blockquote>
<div><ul class="simple">
<li><p>Toric divisor <span class="math notranslate nohighlight">\(D\)</span>,</p></li>
<li><p>Sheaf <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span> (if <span class="math notranslate nohighlight">\(D\)</span> is Cartier, it is a line bundle),</p></li>
<li><p>Support function <span class="math notranslate nohighlight">\(\phi_D\)</span> (if <span class="math notranslate nohighlight">\(D\)</span> is <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier, it is a function
linear on each cone of <span class="math notranslate nohighlight">\(\Sigma\)</span>).</p></li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<p>We start with an illustration of basic divisor arithmetic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Dx</span><span class="p">,</span><span class="n">Du</span><span class="p">,</span><span class="n">Dy</span><span class="p">,</span><span class="n">Dv</span><span class="p">,</span><span class="n">Dz</span><span class="p">,</span><span class="n">Dw</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Dx</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="o">-</span><span class="n">Dx</span>
<span class="go">-V(x)</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">Dx</span>
<span class="go">2*V(x)</span>
<span class="gp">sage: </span><span class="n">Dx</span><span class="o">*</span><span class="mi">2</span>
<span class="go">2*V(x)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Dx</span> <span class="o">+</span> <span class="n">Dy</span><span class="o">/</span><span class="mi">3</span> <span class="o">-</span> <span class="n">Dz</span>
<span class="go">1/2*V(x) + 1/3*V(y) - V(z)</span>
<span class="gp">sage: </span><span class="n">Dx</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Group of toric ZZ-Weil divisors</span>
<span class="go">on 2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">Dx</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Group of toric QQ-Weil divisors</span>
<span class="go">on 2-d CPR-Fano toric variety covered by 6 affine patches</span>
</pre></div>
</div>
<p>Now we create a more complicated variety to demonstrate divisors of different
types:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>        <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Cartier</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">QQ_Cartier</span>
<span class="gp">sage: </span><span class="n">Weil</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">QQ_Weil</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Weil</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">QQ_Weil</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">QQ_Weil</span><span class="o">.</span><span class="n">is_Weil</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">QQ_Weil</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">QQ_Weil</span><span class="o">.</span><span class="n">is_Cartier</span><span class="p">()]</span>
<span class="go">[True, False, False, False]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Weil</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">Weil</span><span class="o">.</span><span class="n">is_Weil</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">Weil</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">Weil</span><span class="o">.</span><span class="n">is_Cartier</span><span class="p">()]</span>
<span class="go">[True, True, False, False]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">is_Weil</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">is_Cartier</span><span class="p">()]</span>
<span class="go">[True, True, True, False]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Cartier</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">Cartier</span><span class="o">.</span><span class="n">is_Weil</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">Cartier</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">(),</span>
<span class="gp">....: </span> <span class="n">Cartier</span><span class="o">.</span><span class="n">is_Cartier</span><span class="p">()]</span>
<span class="go">[True, True, True, True]</span>
</pre></div>
</div>
<p>The toric (<span class="math notranslate nohighlight">\(\QQ\)</span>-Weil) divisors on a toric variety <span class="math notranslate nohighlight">\(X\)</span> modulo linear
equivalence generate the divisor <strong>class group</strong> <span class="math notranslate nohighlight">\(\mathrm{Cl}(X)\)</span>, implemented
by <a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClassGroup</span></code></a>.  If <span class="math notranslate nohighlight">\(X\)</span> is smooth, this equals the
<strong>Picard group</strong> <span class="math notranslate nohighlight">\(\mathop{\mathrm{Pic}}(X)\)</span>. We continue using del Pezzo
surface of degree 6 introduced above:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cl</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">rational_class_group</span><span class="p">();</span> <span class="n">Cl</span>
<span class="go">The toric rational divisor class group</span>
<span class="go">of a 2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="gp">sage: </span><span class="n">Cl</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">c0</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">c3</span> <span class="o">=</span> <span class="n">Cl</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">c0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c1</span> <span class="o">-</span> <span class="n">c3</span><span class="p">;</span> <span class="n">c</span>
<span class="go">Divisor class [1, 2, 0, -1]</span>
</pre></div>
</div>
<p>Divisors are mapped to their classes and lifted via:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Dx</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">()</span>
<span class="go">Divisor class [1, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Dx</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">()</span> <span class="ow">in</span> <span class="n">Cl</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">Dw</span> <span class="o">+</span> <span class="n">Dv</span> <span class="o">+</span> <span class="n">Dy</span><span class="p">)</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">()</span>
<span class="go">Divisor class [1, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">c0</span>
<span class="go">Divisor class [1, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">c0</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
<span class="go">V(x)</span>
</pre></div>
</div>
<p>The (rational) divisor class group is where the Kaehler cone lives:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Kc</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">Kaehler_cone</span><span class="p">();</span> <span class="n">Kc</span>
<span class="go">4-d cone in 4-d lattice</span>
<span class="gp">sage: </span><span class="n">Kc</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">Divisor class [0, 1, 1, 0],</span>
<span class="go">Divisor class [0, 0, 1, 1],</span>
<span class="go">Divisor class [1, 1, 0, 0],</span>
<span class="go">Divisor class [1, 1, 1, 0],</span>
<span class="go">Divisor class [0, 1, 1, 1]</span>
<span class="go">in Basis lattice of The toric rational divisor class group</span>
<span class="go">of a 2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="gp">sage: </span><span class="n">Kc</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
<span class="go">V(x) + V(w)</span>
</pre></div>
</div>
<p>Given a divisor <span class="math notranslate nohighlight">\(D\)</span>, we have an associated line bundle (or a reflexive
sheaf, if <span class="math notranslate nohighlight">\(D\)</span> is not Cartier) <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span>. Its sections are:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">H</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(M(-1, 0), M(-1, 1), M(0, 0))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">sections_monomials</span><span class="p">()</span>
<span class="go">(z, y, x)</span>
</pre></div>
</div>
<p>Note that the space of sections is always spanned by
monomials. Therefore, we can grade the sections (as homogeneous
monomials) by their weight under rescaling individual
coordinates. This weight data amounts to a point of the dual lattice.</p>
<p>In the same way, we can grade cohomology groups by their cohomological
degree and a weight:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">deg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">Vector space of dimension 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Here is a more complicated example with <span class="math notranslate nohighlight">\(h^1(dP_6, \mathcal{O}(D))=4\)</span></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">()</span>
<span class="go">{0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 4 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(0, 4, 0)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Volker Braun, Andrey Novoseltsev (2010-09-07): initial version.</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.divisor.</span></span><span class="sig-name descname"><span class="pre">ToricDivisor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toric_variety</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor" title="Link to this definition">#</a></dt>
<dd><p>Construct a divisor of <code class="docutils literal notranslate"><span class="pre">toric_variety</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">toric_variety</span></code> – a <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">variety</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arg</span></code> – one of the following description of the toric divisor to be
constructed:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> or 0 (the trivial divisor);</p></li>
<li><p>monomial in the homogeneous coordinates;</p></li>
<li><p>one-dimensional cone of the fan of <code class="docutils literal notranslate"><span class="pre">toric_variety</span></code> or a lattice
point generating such a cone;</p></li>
<li><p>sequence of rational numbers, specifying multiplicities for each of
the toric divisors.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ring</span></code> – usually either <span class="math notranslate nohighlight">\(\ZZ\)</span> or <span class="math notranslate nohighlight">\(\QQ\)</span>. The base ring of the
divisor group. If <code class="docutils literal notranslate"><span class="pre">ring</span></code> is not specified, a coefficient ring
suitable for <code class="docutils literal notranslate"><span class="pre">arg</span></code> is derived.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – bool (default: True). Whether to coerce
coefficients into base ring. Setting it to <code class="docutils literal notranslate"><span class="pre">False</span></code> can speed
up construction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reduce</span></code> – reduce (default: True). Whether to combine common
terms. Setting it to <code class="docutils literal notranslate"><span class="pre">False</span></code> can speed up construction.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The coefficients of the divisor must be in the base ring and
the terms must be reduced. If you set <code class="docutils literal notranslate"><span class="pre">check=False</span></code> and/or
<code class="docutils literal notranslate"><span class="pre">reduce=False</span></code> it is your responsibility to pass valid input
data <code class="docutils literal notranslate"><span class="pre">arg</span></code>.</p>
</div>
<p>OUTPUT: A <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.schemes.toric.divisor.ToricDivisor_generic</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.toric.divisor</span> <span class="kn">import</span> <span class="n">ToricDivisor</span>
<span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="n">dP6</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dP6</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">))])</span>
<span class="go">V(u) + V(y)</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">V(u) + V(y)</span>
<span class="gp">sage: </span><span class="n">dP6</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, u, y, v, z, w</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="n">u</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: u + y is not a monomial</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="n">u</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="go">V(u) + V(y)</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
<span class="go">V(y)</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="n">cone</span><span class="p">)</span>
<span class="go">V(y)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="go">V(w)</span>
</pre></div>
</div>
<p>We attempt to guess the correct base ring:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">u</span><span class="p">)])</span>
<span class="go">1/2*V(u)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Group of toric QQ-Weil divisors on</span>
<span class="go">2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">u</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">u</span><span class="p">)])</span>
<span class="go">V(u)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Group of toric ZZ-Weil divisors on</span>
<span class="go">2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="p">[(</span><span class="n">u</span><span class="p">,</span><span class="n">u</span><span class="p">)])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: cannot deduce coefficient ring for [(u, u)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisorGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.divisor.</span></span><span class="sig-name descname"><span class="pre">ToricDivisorGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toric_variety</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_ring</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/divisor_group.html#sage.schemes.generic.divisor_group.DivisorGroup_generic" title="sage.schemes.generic.divisor_group.DivisorGroup_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">DivisorGroup_generic</span></code></a></p>
<p>The group of (<span class="math notranslate nohighlight">\(\QQ\)</span>-T-Weil) divisors on a toric variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span>
<span class="go">Group of toric ZZ-Weil divisors</span>
<span class="go">on 2-d CPR-Fano toric variety covered by 3 affine patches</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisorGroup.Element">
<span class="sig-name descname"><span class="pre">Element</span></span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup.Element" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricDivisor_generic</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisorGroup.base_extend">
<span class="sig-name descname"><span class="pre">base_extend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup.base_extend" title="Link to this definition">#</a></dt>
<dd><p>Extend the scalars of <code class="docutils literal notranslate"><span class="pre">self</span></code> to <code class="docutils literal notranslate"><span class="pre">R</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – ring.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>toric divisor group.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">DivZZ</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">DivQQ</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">(</span><span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">DivZZ</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span> <span class="ow">is</span> <span class="n">DivQQ</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisorGroup.gen">
<span class="sig-name descname"><span class="pre">gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup.gen" title="Link to this definition">#</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th generator of the divisor group.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> – integer.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The divisor <span class="math notranslate nohighlight">\(z_i=0\)</span>, where <span class="math notranslate nohighlight">\(z_i\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>-th homogeneous
coordinate.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">V(z)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisorGroup.gens">
<span class="sig-name descname"><span class="pre">gens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup.gens" title="Link to this definition">#</a></dt>
<dd><p>Return the generators of the divisor group.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(V(x), V(y), V(z))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisorGroup.ngens">
<span class="sig-name descname"><span class="pre">ngens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup.ngens" title="Link to this definition">#</a></dt>
<dd><p>Return the number of generators.</p>
<p>OUTPUT:</p>
<p>The number of generators of <code class="docutils literal notranslate"><span class="pre">self</span></code>, which equals the number of
rays in the fan of the toric variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.divisor.</span></span><span class="sig-name descname"><span class="pre">ToricDivisor_generic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/divisor.html#sage.schemes.generic.divisor.Divisor_generic" title="sage.schemes.generic.divisor.Divisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Divisor_generic</span></code></a></p>
<p>Construct a <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">(toric</span> <span class="pre">Weil)</span> <span class="pre">divisor</span></code></a> on the
given toric variety.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – a list of tuples (multiplicity, coordinate).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parent</span></code> – <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisorGroup" title="sage.schemes.toric.divisor.ToricDivisorGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricDivisorGroup</span></code></a>. The parent divisor group.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean. Type-check the entries of <code class="docutils literal notranslate"><span class="pre">v</span></code>, see
<a class="reference internal" href="../generic/divisor_group.html#sage.schemes.generic.divisor_group.DivisorGroup_generic" title="sage.schemes.generic.divisor_group.DivisorGroup_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">DivisorGroup_generic</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reduce</span></code> – boolean. Combine coefficients in <code class="docutils literal notranslate"><span class="pre">v</span></code>, see
<a class="reference internal" href="../generic/divisor_group.html#sage.schemes.generic.divisor_group.DivisorGroup_generic" title="sage.schemes.generic.divisor_group.DivisorGroup_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">DivisorGroup_generic</span></code></a>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not construct <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricDivisor_generic</span></code></a> objects manually.
Instead, use either the function <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor" title="sage.schemes.toric.divisor.ToricDivisor"><code class="xref py py-func docutils literal notranslate"><span class="pre">ToricDivisor()</span></code></a> or the method
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field.divisor" title="sage.schemes.toric.variety.ToricVariety_field.divisor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">divisor()</span></code></a>
of toric varieties.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ray</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ray</span>
<span class="go">N(0, 1)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">ray</span><span class="p">);</span> <span class="n">D</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Group of toric ZZ-Weil divisors</span>
<span class="go">on 2-d CPR-Fano toric variety covered by 6 affine patches</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.Chern_character">
<span class="sig-name descname"><span class="pre">Chern_character</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.Chern_character" title="Link to this definition">#</a></dt>
<dd><p>Return the Chern character of the sheaf <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span>
defined by the divisor <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>You can also use a shortcut <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.ch" title="sage.schemes.toric.divisor.ToricDivisor_generic.ch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ch()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D3</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>   <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D5</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D6</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">D3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">D5</span> <span class="o">-</span> <span class="n">D6</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Chern_character</span><span class="p">()</span>                                                   <span class="c1"># needs sage.libs.singular</span>
<span class="go">[5*w^2 + y - 2*v + w + 1]</span>
<span class="gp">sage: </span><span class="n">dP6</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">ch</span><span class="p">()</span> <span class="o">*</span> <span class="n">dP6</span><span class="o">.</span><span class="n">Td</span><span class="p">())</span>                                      <span class="c1"># needs sage.libs.singular</span>
<span class="go">-4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.Chow_cycle">
<span class="sig-name descname"><span class="pre">Chow_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ring=Integer</span> <span class="pre">Ring</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.Chow_cycle" title="Link to this definition">#</a></dt>
<dd><p>Returns the Chow homology class of the divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ring</span></code> – Either <code class="docutils literal notranslate"><span class="pre">ZZ</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">QQ</span></code>. The base ring
of the Chow group.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The <a class="reference internal" href="chow_group.html#sage.schemes.toric.chow_group.ChowCycle" title="sage.schemes.toric.chow_group.ChowCycle"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChowCycle</span></code></a>
represented by the divisor.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">cone</span><span class="p">);</span> <span class="n">D</span>
<span class="go">V(w)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Chow_cycle</span><span class="p">()</span>
<span class="go">( 0 | -1, 0, 1, 1 | 0 )</span>
<span class="gp">sage: </span><span class="n">dP6</span><span class="o">.</span><span class="n">Chow_group</span><span class="p">()(</span><span class="n">cone</span><span class="p">)</span>
<span class="go">( 0 | -1, 0, 1, 1 | 0 )</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.Kodaira_map">
<span class="sig-name descname"><span class="pre">Kodaira_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.Kodaira_map" title="Link to this definition">#</a></dt>
<dd><p>Return the Kodaira map.</p>
<p>The Kodaira map is the rational map <span class="math notranslate nohighlight">\(X_\Sigma \to
\mathbb{P}^{n-1}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> equals the number of sections. It
is defined by the monomial sections of the line bundle.</p>
<p>If the divisor is ample and the toric variety smooth or of
dimension 2, then this is an embedding.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> – string (optional; default <code class="docutils literal notranslate"><span class="pre">'z'</span></code>). The
variable names for the destination projective space.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">P1</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Kodaira_map</span><span class="p">()</span>                                                       <span class="c1"># needs fpylll sage.libs.singular</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 2</span>
<span class="go">        over Rational Field defined by: -z1^2 + z0*z2</span>
<span class="go">  Defn: Defined on coordinates by sending [u : v] to (v^2 : u*v : u^2)</span>

<span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">dP6</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Kodaira_map</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>                                              <span class="c1"># needs fpylll sage.libs.singular</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 6</span>
<span class="go">        over Rational Field defined by:</span>
<span class="go">          -x1*x5 + x0*x6,       -x2*x3 + x0*x5,       -x1*x3 + x0*x4,</span>
<span class="go">          x4*x5 - x3*x6,        -x1*x2 + x0*x3,       x3*x5 - x2*x6,</span>
<span class="go">          x3*x4 - x1*x6,        x3^2 - x1*x5,         x2*x4 - x1*x5,</span>
<span class="go">          -x1*x5^2 + x2*x3*x6, -x1*x5^3 + x2^2*x6^2</span>
<span class="go">  Defn: Defined on coordinates by sending [x : u : y : v : z : w] to</span>
<span class="go">        (x*u^2*y^2*v : x^2*u^2*y*w : u*y^2*v^2*z : x*u*y*v*z*w :</span>
<span class="go">         x^2*u*z*w^2 : y*v^2*z^2*w : x*v*z^2*w^2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.ch">
<span class="sig-name descname"><span class="pre">ch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.ch" title="Link to this definition">#</a></dt>
<dd><p>Return the Chern character of the sheaf <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span>
defined by the divisor <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>You can also use a shortcut <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.ch" title="sage.schemes.toric.divisor.ToricDivisor_generic.ch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ch()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D3</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>   <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D5</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D6</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">D3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">D5</span> <span class="o">-</span> <span class="n">D6</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Chern_character</span><span class="p">()</span>                                                   <span class="c1"># needs sage.libs.singular</span>
<span class="go">[5*w^2 + y - 2*v + w + 1]</span>
<span class="gp">sage: </span><span class="n">dP6</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">ch</span><span class="p">()</span> <span class="o">*</span> <span class="n">dP6</span><span class="o">.</span><span class="n">Td</span><span class="p">())</span>                                      <span class="c1"># needs sage.libs.singular</span>
<span class="go">-4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.coefficient">
<span class="sig-name descname"><span class="pre">coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.coefficient" title="Link to this definition">#</a></dt>
<dd><p>Return the coefficient of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> – one of the homogeneous coordinates, either given by
the variable or its index.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The coefficient of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">));</span> <span class="n">D</span>
<span class="go">11*V(x) + 12*V(y) + 13*V(z)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, y, z</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.cohomology">
<span class="sig-name descname"><span class="pre">cohomology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.cohomology" title="Link to this definition">#</a></dt>
<dd><p>Return the cohomology of the line bundle associated to the
Cartier divisor or reflexive sheaf associated to the Weil
divisor.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cohomology of a toric line bundle/reflexive sheaf is
graded by the usual degree as well as by the <span class="math notranslate nohighlight">\(M\)</span>-lattice.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code> – (optional) a point of the <span class="math notranslate nohighlight">\(M\)</span>-lattice.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">deg</span></code> – (optional) the degree of the cohomology group.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dim</span></code> – boolean. If <code class="docutils literal notranslate"><span class="pre">False</span></code> (default), the cohomology
groups are returned as vector spaces. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, only the
dimension of the vector space(s) is returned.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The vector space <span class="math notranslate nohighlight">\(H^\text{deg}(X,\mathcal{O}(D))\)</span> (if <code class="docutils literal notranslate"><span class="pre">deg</span></code>
is specified) or a dictionary <code class="docutils literal notranslate"><span class="pre">{degree:cohomology(degree)}</span></code>
of all degrees between 0 and the dimension of the variety.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weight</span></code> is specified, return only the subspace
<span class="math notranslate nohighlight">\(H^\text{deg}(X,\mathcal{O}(D))_\text{weight}\)</span> of the
cohomology of the given weight.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim==True</span></code>, the dimension of the cohomology vector space
is returned instead of actual vector space. Moreover, if
<code class="docutils literal notranslate"><span class="pre">deg</span></code> was not specified, a vector whose entries are the
dimensions is returned instead of a dictionary.</p>
<p>ALGORITHM:</p>
<p>Roughly, Chech cohomology is used to compute the
cohomology. For toric divisors, the local sections can be
chosen to be monomials (instead of general homogeneous
polynomials), this is the reason for the extra grading by
<span class="math notranslate nohighlight">\(m\in M\)</span>. General references would be <a class="reference internal" href="../../../../references/index.html#ful1993" id="id1"><span>[Ful1993]</span></a>, <a class="reference internal" href="../../../../references/index.html#cls2011" id="id2"><span>[CLS2011]</span></a>. Here
are some salient features of our implementation:</p>
<ul>
<li><p>First, a finite set of <span class="math notranslate nohighlight">\(M\)</span>-lattice points is identified that
supports the cohomology. The toric divisor determines a
(polyhedral) chamber decomposition of <span class="math notranslate nohighlight">\(M_\RR\)</span>, see Section
9.1 and Figure 4 of <a class="reference internal" href="../../../../references/index.html#cls2011" id="id3"><span>[CLS2011]</span></a>. The cohomology vanishes on the
non-compact chambers. Hence, the convex hull of the vertices
of the chamber decomposition contains all non-vanishing
cohomology groups. This is returned by the private method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_sheaf_cohomology_support()</span></code>.</p>
<p>It would be more efficient, but more difficult to implement,
to keep track of all of the individual chambers. We leave
this for future work.</p>
</li>
<li><p>For each point <span class="math notranslate nohighlight">\(m\in M\)</span>, the weight-<span class="math notranslate nohighlight">\(m\)</span> part of the
cohomology can be rewritten as the cohomology of a
simplicial complex, see Exercise 9.1.10 of <a class="reference internal" href="../../../../references/index.html#cls2011" id="id4"><span>[CLS2011]</span></a>,
<a class="reference internal" href="../../../../references/index.html#per2007" id="id5"><span>[Per2007]</span></a>. This is returned by the private method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_sheaf_complex()</span></code>.</p>
<p>The simplicial complex is the same for all points in a
chamber, but we currently do not make use of this and
compute each point <span class="math notranslate nohighlight">\(m\in M\)</span> separately.</p>
</li>
<li><p>Finally, the cohomology (over <span class="math notranslate nohighlight">\(\QQ\)</span>) of this simplicial
complex is computed in the private method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_sheaf_cohomology()</span></code>. Summing over the supporting
points <span class="math notranslate nohighlight">\(m\in M\)</span> yields the cohomology of the sheaf`.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Example 9.1.7 of Cox, Little, Schenck: “Toric Varieties” <a class="reference internal" href="../../../../references/index.html#cls2011" id="id6"><span>[CLS2011]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
<span class="gp">....: </span>        <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D3</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D5</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D6</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">D3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">D5</span> <span class="o">-</span> <span class="n">D6</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">()</span>
<span class="go">{0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 4 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Vector space of dimension 4 over Rational Field</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">dual_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span> <span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">{0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 1 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span> <span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
<span class="go">Vector space of dimension 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">dP6</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">ch</span><span class="p">()</span> <span class="o">*</span> <span class="n">dP6</span><span class="o">.</span><span class="n">Td</span><span class="p">())</span>                                      <span class="c1"># needs sage.libs.singular</span>
<span class="go">-4</span>
</pre></div>
</div>
<p>Note the different output options:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">()</span>
<span class="go">{0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 4 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(0, 4, 0)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">{0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 1 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(0, 1, 0)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Vector space of dimension 4 over Rational Field</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Vector space of dimension 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Here is a Weil (non-Cartier) divisor example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">Cube_nonpolyhedral</span><span class="p">()</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_Weil</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(0, 0, 0, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.cohomology_class">
<span class="sig-name descname"><span class="pre">cohomology_class</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.cohomology_class" title="Link to this definition">#</a></dt>
<dd><p>Return the degree-2 cohomology class associated to the divisor.</p>
<p>OUTPUT:</p>
<p>The corresponding cohomology class as an instance of
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.CohomologyClass" title="sage.schemes.toric.variety.CohomologyClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">CohomologyClass</span></code></a>.
The cohomology class is the first Chern class of the
associated line bundle <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology_class</span><span class="p">()</span>                                                  <span class="c1"># needs sage.libs.singular</span>
<span class="go">[y + v - w]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.cohomology_support">
<span class="sig-name descname"><span class="pre">cohomology_support</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.cohomology_support" title="Link to this definition">#</a></dt>
<dd><p>Return the weights for which the cohomology groups do not vanish.</p>
<p>OUTPUT:</p>
<p>A tuple of dual lattice points. <code class="docutils literal notranslate"><span class="pre">self.cohomology(weight=m)</span></code>
does not vanish if and only if <code class="docutils literal notranslate"><span class="pre">m</span></code> is in the output.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is provided for educational purposes and it is
not an efficient way of computing the cohomology groups.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
<span class="gp">....: </span>        <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D3</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D5</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D6</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">D3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">D5</span> <span class="o">-</span> <span class="n">D6</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology_support</span><span class="p">()</span>
<span class="go">(M(0, 0), M(1, 0), M(2, 0), M(1, 1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.divisor_class">
<span class="sig-name descname"><span class="pre">divisor_class</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.divisor_class" title="Link to this definition">#</a></dt>
<dd><p>Return the linear equivalence class of the divisor.</p>
<p>OUTPUT:</p>
<p>The class of the divisor in <span class="math notranslate nohighlight">\(\mathop{Cl}(X)
\otimes_\ZZ \QQ\)</span> as an instance of
<a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClassGroup</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">()</span>
<span class="go">Divisor class [1, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.function_value">
<span class="sig-name descname"><span class="pre">function_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.function_value" title="Link to this definition">#</a></dt>
<dd><p>Return the value of the support function at <code class="docutils literal notranslate"><span class="pre">point</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> be the ambient toric variety of <code class="docutils literal notranslate"><span class="pre">self</span></code>, <span class="math notranslate nohighlight">\(\Sigma\)</span> the fan
associated to <span class="math notranslate nohighlight">\(X\)</span>, and <span class="math notranslate nohighlight">\(N\)</span> the ambient lattice of <span class="math notranslate nohighlight">\(\Sigma\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">point</span></code> – either an integer, interpreted as the index of a ray of
<span class="math notranslate nohighlight">\(\Sigma\)</span>, or a point of the lattice <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
</ul>
<p>OUTPUT: An integer or a rational number.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">44</span><span class="p">])</span>   <span class="c1"># total degree 77</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">function_value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">function_value</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="go">33</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">function_value</span><span class="p">(</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.is_Cartier">
<span class="sig-name descname"><span class="pre">is_Cartier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_Cartier" title="Link to this definition">#</a></dt>
<dd><p>Return whether the divisor is a Cartier-divisor.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The sheaf <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span> associated to the given divisor
<span class="math notranslate nohighlight">\(D\)</span> is a line bundle if and only if the divisor is
Cartier.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P4_11169</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_Cartier</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.is_QQ_Cartier">
<span class="sig-name descname"><span class="pre">is_QQ_Cartier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_QQ_Cartier" title="Link to this definition">#</a></dt>
<dd><p>Return whether the divisor is a <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor.</p>
<p>A <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor is a divisor such that some multiple
of it is Cartier.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P4_11169</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">Cube_face_fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.is_QQ_Weil">
<span class="sig-name descname"><span class="pre">is_QQ_Weil</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_QQ_Weil" title="Link to this definition">#</a></dt>
<dd><p>Return whether the divisor is a <span class="math notranslate nohighlight">\(\QQ\)</span>-Weil-divisor.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function returns always <code class="docutils literal notranslate"><span class="pre">True</span></code> since
<a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricDivisor</span></code></a> can only
describe <span class="math notranslate nohighlight">\(\QQ\)</span>-Weil divisors.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.is_Weil">
<span class="sig-name descname"><span class="pre">is_Weil</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_Weil" title="Link to this definition">#</a></dt>
<dd><p>Return whether the divisor is a Weil-divisor.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_Weil</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_Weil</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.is_ample">
<span class="sig-name descname"><span class="pre">is_ample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_ample" title="Link to this definition">#</a></dt>
<dd><p>Return whether a <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor is ample.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the divisor is in the ample cone, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>For a <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor, some positive integral
multiple is Cartier. We return whether this associated
divisor is ample, i.e. corresponds to an ample line bundle.</p></li>
<li><p>In the orbifold case, the ample cone is an open
and full-dimensional cone in the rational divisor class
group <a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClassGroup</span></code></a>.</p></li>
<li><p>If the variety has worse than orbifold singularities,
the ample cone is a full-dimensional cone within the
(not full-dimensional) subspace spanned by the Cartier
divisors inside the rational (Weil) divisor class group,
that is, <a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClassGroup</span></code></a>. The
ample cone is then relative open (open in this
subspace).</p></li>
<li><p>See also <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_nef" title="sage.schemes.toric.divisor.ToricDivisor_generic.is_nef"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_nef()</span></code></a>.</p></li>
<li><p>A toric divisor is ample if and only if its support
function is strictly convex.</p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">+</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Example 6.1.3, 6.1.11, 6.1.17 of <a class="reference internal" href="../../../../references/index.html#cls2011" id="id7"><span>[CLS2011]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
<span class="gp">....: </span>          <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fan</span><span class="p">,</span><span class="s1">&#39;u1, u2, u3, u4&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">D</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="n">D</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[(1, 1), (1, 2), (2, 1), (2, 2)]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="n">D</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1), (2, 2)]</span>
</pre></div>
</div>
<p>A (worse than orbifold) singular Fano threefold:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">facets</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="n">facets</span><span class="p">,</span> <span class="n">rays</span><span class="o">=</span><span class="n">points</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">rational_class_group</span><span class="p">()</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Kaehler_cone</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">Divisor class [1, 0, 0, 0]</span>
<span class="go">in Basis lattice of The toric rational divisor class group</span>
<span class="go">of a 3-d toric variety covered by 7 affine patches</span>
<span class="gp">sage: </span><span class="n">antiK</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">antiK</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">()</span>
<span class="go">Divisor class [2, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">antiK</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.is_integral">
<span class="sig-name descname"><span class="pre">is_integral</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_integral" title="Link to this definition">#</a></dt>
<dd><p>Return whether the coefficients of the divisor are all integral.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">DZZ</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">(</span><span class="n">base_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">DZZ</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">DQQ</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">(</span><span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">DQQ</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">DZZ</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">DQQ</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.is_nef">
<span class="sig-name descname"><span class="pre">is_nef</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_nef" title="Link to this definition">#</a></dt>
<dd><p>Return whether a <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor is nef.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the divisor is in the closure of the ample cone,
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>For a <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor, some positive integral multiple is
Cartier. We return whether this associated divisor is nef.</p></li>
<li><p>The nef cone is the closure of the ample cone.</p></li>
<li><p>See also <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_ample" title="sage.schemes.toric.divisor.ToricDivisor_generic.is_ample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_ample()</span></code></a>.</p></li>
<li><p>A toric divisor is nef if and only if its support
function is convex (but not necessarily strictly
convex).</p></li>
<li><p>A toric Cartier divisor is nef if and only if its linear
system is basepoint free.</p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">+</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Example 6.1.3, 6.1.11, 6.1.17 of <a class="reference internal" href="../../../../references/index.html#cls2011" id="id8"><span>[CLS2011]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
<span class="gp">....: </span>          <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fan</span><span class="p">,</span><span class="s1">&#39;u1, u2, u3, u4&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">D</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="n">D</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[(1, 1), (1, 2), (2, 1), (2, 2)]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="n">D</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1), (2, 2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.m">
<span class="sig-name descname"><span class="pre">m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.m" title="Link to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(m_\sigma\)</span> representing <span class="math notranslate nohighlight">\(\phi_D\)</span> on <code class="docutils literal notranslate"><span class="pre">cone</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> be the ambient toric variety of this divisor <span class="math notranslate nohighlight">\(D\)</span> associated to
the fan <span class="math notranslate nohighlight">\(\Sigma\)</span> in lattice <span class="math notranslate nohighlight">\(N\)</span>. Let <span class="math notranslate nohighlight">\(M\)</span> be the lattice dual to <span class="math notranslate nohighlight">\(N\)</span>.
Given the cone <span class="math notranslate nohighlight">\(\sigma =\langle v_1, \dots, v_k \rangle\)</span> in <span class="math notranslate nohighlight">\(\Sigma\)</span>,
this method searches for a vector <span class="math notranslate nohighlight">\(m_\sigma \in M_\QQ\)</span> such that
<span class="math notranslate nohighlight">\(\phi_D(v_i) = \langle m_\sigma, v_i \rangle\)</span> for all <span class="math notranslate nohighlight">\(i=1, \dots, k\)</span>,
where <span class="math notranslate nohighlight">\(\phi_D\)</span> is the support function of <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cone</span></code> – A cone in the fan of the toric variety.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>If possible, a point of lattice <span class="math notranslate nohighlight">\(M\)</span>.</p></li>
<li><p>If the dual vector cannot be chosen integral, a rational vector is
returned.</p></li>
<li><p>If there is no such vector (i.e. <code class="docutils literal notranslate"><span class="pre">self</span></code> is not even a
<span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor), a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>        <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">square_cone</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">triangle_cone</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ray</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">ray</span><span class="p">)</span>
<span class="go">M(0, 2, 0)</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">square_cone</span><span class="p">)</span>
<span class="go">(3/2, 0, 1/2)</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">triangle_cone</span><span class="p">)</span>
<span class="go">M(1, 0, 1)</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">Cone</span><span class="p">(</span><span class="n">triangle_cone</span><span class="p">))</span>
<span class="go">M(1, 0, 1)</span>
<span class="gp">sage: </span><span class="n">Weil</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Weil</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">square_cone</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: V(z0) + V(z1) + V(z2) is not QQ-Cartier,</span>
<span class="go">cannot choose a dual vector on 3-d cone</span>
<span class="go">of Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">Weil</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">triangle_cone</span><span class="p">)</span>
<span class="go">M(1, 0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.monomial">
<span class="sig-name descname"><span class="pre">monomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.monomial" title="Link to this definition">#</a></dt>
<dd><p>Return the monomial in the homogeneous coordinate ring
associated to the <code class="docutils literal notranslate"><span class="pre">point</span></code> in the dual lattice.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">point</span></code> – a point in <code class="docutils literal notranslate"><span class="pre">self.variety().fan().dual_lattice()</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>For a fixed divisor <code class="docutils literal notranslate"><span class="pre">D</span></code>, the sections are generated by
monomials in <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field.coordinate_ring" title="sage.schemes.toric.variety.ToricVariety_field.coordinate_ring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ToricVariety.coordinate_ring</span></code></a>.
Alternatively, the monomials can be described as <span class="math notranslate nohighlight">\(M\)</span>-lattice
points in the polyhedron <code class="docutils literal notranslate"><span class="pre">D.polyhedron()</span></code>. This method
converts the points <span class="math notranslate nohighlight">\(m\in M\)</span> into homogeneous polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">O3_P2</span> <span class="o">=</span> <span class="o">-</span><span class="n">P2</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">dual_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">O3_P2</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span> <span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">x*y*z</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.move_away_from">
<span class="sig-name descname"><span class="pre">move_away_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cone</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.move_away_from" title="Link to this definition">#</a></dt>
<dd><p>Move the divisor away from the orbit closure of <code class="docutils literal notranslate"><span class="pre">cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">cone</span></code> of the fan of the toric variety.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A (rationally equivalent) divisor that is moved off the
orbit closure of the given cone.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A divisor that is Weil but not Cartier might be impossible
to move away. In this case, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>        <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">square_cone</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">triangle_cone</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">line_cone</span> <span class="o">=</span> <span class="n">square_cone</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">triangle_cone</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Cartier</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Cartier</span>
<span class="go">2*V(z0) + 2*V(z1) + V(z2) + V(z3) + V(z4)</span>
<span class="gp">sage: </span><span class="n">Cartier</span><span class="o">.</span><span class="n">move_away_from</span><span class="p">(</span><span class="n">line_cone</span><span class="p">)</span>
<span class="go">3*V(z2) + 3*V(z3) - V(z4)</span>
<span class="gp">sage: </span><span class="n">QQ_Weil</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">QQ_Weil</span><span class="o">.</span><span class="n">move_away_from</span><span class="p">(</span><span class="n">line_cone</span><span class="p">)</span>
<span class="go">2*V(z2) + V(z3) - 1/2*V(z4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.polyhedron">
<span class="sig-name descname"><span class="pre">polyhedron</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.polyhedron" title="Link to this definition">#</a></dt>
<dd><p>Return the polyhedron <span class="math notranslate nohighlight">\(P_D\subset M\)</span> associated to a toric
divisor <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>OUTPUT:</p>
<p><span class="math notranslate nohighlight">\(P_D\)</span> as an instance of <a class="reference external" href="../../../../discrete_geometry/sage/geometry/polyhedron/base.html#sage.geometry.polyhedron.base.Polyhedron_base" title="(in Combinatorial and Discrete Geometry v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyhedron_base</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP7</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP7</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP7</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P_D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">();</span> <span class="n">P_D</span>
<span class="go">A 0-dimensional polyhedron in QQ^2 defined as the convex hull of 1 vertex</span>
<span class="gp">sage: </span><span class="n">P_D</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0),)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">dP7</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">ch</span><span class="p">()</span> <span class="o">*</span> <span class="n">dP7</span><span class="o">.</span><span class="n">Td</span><span class="p">())</span>                                      <span class="c1"># needs sage.libs.singular</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">P_antiK</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">dP7</span><span class="o">.</span><span class="n">K</span><span class="p">())</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">();</span> <span class="n">P_antiK</span>
<span class="go">A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 5 vertices</span>
<span class="gp">sage: </span><span class="n">P_antiK</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
<span class="go">(A vertex at (1, -1), A vertex at (0, 1), A vertex at (1, 0),</span>
<span class="go"> A vertex at (-1, 1), A vertex at (-1, -1))</span>
<span class="gp">sage: </span><span class="n">P_antiK</span><span class="o">.</span><span class="n">integral_points</span><span class="p">()</span>
<span class="go">((-1, -1), (-1, 0), (-1, 1), (0, -1), (0, 0), (0, 1), (1, -1), (1, 0))</span>
</pre></div>
</div>
<p>Example 6.1.3, 6.1.11, 6.1.17 of <a class="reference internal" href="../../../../references/index.html#cls2011" id="id9"><span>[CLS2011]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
<span class="gp">....: </span>          <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fan</span><span class="p">,</span><span class="s1">&#39;u1, u2, u3, u4&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0), A vertex at (2, 1), A vertex at (0, 1))</span>
<span class="gp">sage: </span><span class="n">Dprime</span> <span class="o">=</span> <span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">D</span>
<span class="gp">sage: </span><span class="n">Dprime</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
<span class="go">(A vertex at (2, 1), A vertex at (0, 1), A vertex at (0, 0))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Dprime</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A more complicated example where <span class="math notranslate nohighlight">\(P_D\)</span> is not a lattice polytope:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">BCdlOG_base</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">antiK</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P_D</span> <span class="o">=</span> <span class="n">antiK</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P_D</span>
<span class="go">A 3-dimensional polyhedron in QQ^3 defined as the convex hull of 8 vertices</span>
<span class="gp">sage: </span><span class="n">P_D</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
<span class="go">(A vertex at (1, -1, 0), A vertex at (1, -3, 1),</span>
<span class="go"> A vertex at (1, 1, 1), A vertex at (-5, 1, 1),</span>
<span class="go"> A vertex at (1, 1, -1/2), A vertex at (1, 1/2, -1/2),</span>
<span class="go"> A vertex at (-1, -1, 0), A vertex at (-5, -3, 1))</span>
<span class="gp">sage: </span><span class="n">P_D</span><span class="o">.</span><span class="n">Hrepresentation</span><span class="p">()</span>
<span class="go">(An inequality (-1, 0, 0) x + 1 &gt;= 0, An inequality (0, -1, 0) x + 1 &gt;= 0,</span>
<span class="go"> An inequality (0, 0, -1) x + 1 &gt;= 0, An inequality (1, 0, 4) x + 1 &gt;= 0,</span>
<span class="go"> An inequality (0, 1, 3) x + 1 &gt;= 0, An inequality (0, 1, 2) x + 1 &gt;= 0)</span>
<span class="gp">sage: </span><span class="n">P_D</span><span class="o">.</span><span class="n">integral_points</span><span class="p">()</span>
<span class="go">((-1, -1, 0), (0, -1, 0), (1, -1, 0), (-1, 0, 0), (0, 0, 0),</span>
<span class="go"> (1, 0, 0), (-1, 1, 0), (0, 1, 0), (1, 1, 0), (-5, -3, 1),</span>
<span class="go"> (-4, -3, 1), (-3, -3, 1), (-2, -3, 1), (-1, -3, 1), (0, -3, 1),</span>
<span class="go"> (1, -3, 1), (-5, -2, 1), (-4, -2, 1), (-3, -2, 1), (-2, -2, 1),</span>
<span class="go"> (-1, -2, 1), (0, -2, 1), (1, -2, 1), (-5, -1, 1), (-4, -1, 1),</span>
<span class="go"> (-3, -1, 1), (-2, -1, 1), (-1, -1, 1), (0, -1, 1), (1, -1, 1),</span>
<span class="go"> (-5, 0, 1), (-4, 0, 1), (-3, 0, 1), (-2, 0, 1), (-1, 0, 1),</span>
<span class="go"> (0, 0, 1), (1, 0, 1), (-5, 1, 1), (-4, 1, 1), (-3, 1, 1),</span>
<span class="go"> (-2, 1, 1), (-1, 1, 1), (0, 1, 1), (1, 1, 1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.sections">
<span class="sig-name descname"><span class="pre">sections</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.sections" title="Link to this definition">#</a></dt>
<dd><p>Return the global sections (as points of the <span class="math notranslate nohighlight">\(M\)</span>-lattice) of
the line bundle (or reflexive sheaf) associated to the
divisor.</p>
<p>OUTPUT: A <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of points of lattice <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(M(-1, 0), M(-1, 1), M(0, 0))</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(M(0, -1), M(0, 0), M(1, -1))</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(M(0, 0), M(0, 1), M(1, 0))</span>
</pre></div>
</div>
<p>The divisor can be non-nef yet still have sections:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">cones</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">(</span><span class="n">rays</span><span class="o">=</span><span class="n">rays</span><span class="p">,</span> <span class="n">cones</span><span class="o">=</span><span class="n">cones</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">D</span>
<span class="go">V(z2)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(M(0, 0, 0),)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(1, 0, 0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricDivisor_generic.sections_monomials">
<span class="sig-name descname"><span class="pre">sections_monomials</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.sections_monomials" title="Link to this definition">#</a></dt>
<dd><p>Return the global sections of the line bundle associated to the
Cartier divisor.</p>
<p>The sections are described as monomials in the generalized homogeneous
coordinates.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>tuple of monomials in the coordinate ring of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sections_monomials</span><span class="p">()</span>
<span class="go">(z, y, x)</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sections_monomials</span><span class="p">()</span>
<span class="go">(z, y, x)</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sections_monomials</span><span class="p">()</span>
<span class="go">(z, y, x)</span>
</pre></div>
</div>
<p>From <a class="reference internal" href="../../../../references/index.html#cox" id="id10"><span>[Cox]</span></a> page 38:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">lp</span> <span class="o">=</span> <span class="n">LatticePolytope</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">lp</span>
<span class="go">2-d reflexive polytope #5 in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">dP7</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">FaceFan</span><span class="p">(</span><span class="n">lp</span><span class="p">),</span> <span class="s1">&#39;x1, x2, x3, x4, x5&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">AK</span> <span class="o">=</span> <span class="o">-</span><span class="n">dP7</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">AK</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(N(-1, 0), N(-1, 1), N(0, -1), N(0, 0),</span>
<span class="go"> N(0, 1), N(1, -1), N(1, 0), N(1, 1))</span>
<span class="gp">sage: </span><span class="n">AK</span><span class="o">.</span><span class="n">sections_monomials</span><span class="p">()</span>
<span class="go">(x3*x4^2*x5, x2*x3^2*x4^2, x1*x4*x5^2, x1*x2*x3*x4*x5,</span>
<span class="go"> x1*x2^2*x3^2*x4, x1^2*x2*x5^2, x1^2*x2^2*x3*x5, x1^2*x2^3*x3^2)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.divisor.</span></span><span class="sig-name descname"><span class="pre">ToricRationalDivisorClassGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toric_variety</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../modules/sage/modules/free_module.html#sage.modules.free_module.FreeModule_ambient_field" title="(in Modules v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">FreeModule_ambient_field</span></code></a>, <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueRepresentation</span></code></a></p>
<p>The rational divisor class group of a toric variety.</p>
<p>The <strong>T-Weil divisor class group</strong> <span class="math notranslate nohighlight">\(\mathop{Cl}(X)\)</span> of a toric
variety <span class="math notranslate nohighlight">\(X\)</span> is a finitely generated abelian group and can contain
torsion. Its rank equals the number of rays in the fan of <span class="math notranslate nohighlight">\(X\)</span>
minus the dimension of <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>The <strong>rational divisor class group</strong> is <span class="math notranslate nohighlight">\(\mathop{Cl}(X)
\otimes_\ZZ \QQ\)</span> and never includes torsion. If <span class="math notranslate nohighlight">\(X\)</span> is <em>smooth</em>,
this equals the <strong>Picard group</strong> <span class="math notranslate nohighlight">\(\mathop{\mathrm{Pic}}(X)\)</span>, whose
elements are the isomorphism classes of line bundles on <span class="math notranslate nohighlight">\(X\)</span>. The
group law (which we write as addition) is the tensor product of
the line bundles. The Picard group of a toric variety is always
torsion-free.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not instantiate this class yourself. Use
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field.rational_class_group" title="sage.schemes.toric.variety.ToricVariety_field.rational_class_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rational_class_group()</span></code></a>
method of <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">varieties</span></code></a> if you need
the divisor class group. Or you can obtain it as the parent of any
divisor class constructed, for example, via
<a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.divisor_class" title="sage.schemes.toric.divisor.ToricDivisor_generic.divisor_class"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ToricDivisor_generic.divisor_class()</span></code></a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">toric_variety</span></code> – <code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">variety</span>
<span class="pre">&lt;sage.schemes.toric.variety.ToricVariety_field</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>rational divisor class group of a toric variety.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">rational_class_group</span><span class="p">()</span>
<span class="go">The toric rational divisor class group of a 2-d CPR-Fano</span>
<span class="go">toric variety covered by 3 affine patches</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">D</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">Dclass</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">();</span> <span class="n">Dclass</span>
<span class="go">Divisor class [1]</span>
<span class="gp">sage: </span><span class="n">Dclass</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
<span class="go">V(y)</span>
<span class="gp">sage: </span><span class="n">Dclass</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">The toric rational divisor class group of a 2-d CPR-Fano</span>
<span class="go">toric variety covered by 3 affine patches</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup.Element">
<span class="sig-name descname"><span class="pre">Element</span></span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup.Element" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="divisor_class.html#sage.schemes.toric.divisor_class.ToricRationalDivisorClass" title="sage.schemes.toric.divisor_class.ToricRationalDivisorClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClass</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup_basis_lattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.divisor.</span></span><span class="sig-name descname"><span class="pre">ToricRationalDivisorClassGroup_basis_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup_basis_lattice" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../modules/sage/modules/free_module.html#sage.modules.free_module.FreeModule_ambient_pid" title="(in Modules v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">FreeModule_ambient_pid</span></code></a></p>
<p>Construct the basis lattice of the <code class="docutils literal notranslate"><span class="pre">group</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> – <a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">rational</span> <span class="pre">divisor</span> <span class="pre">class</span> <span class="pre">group</span></code></a>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>the basis lattice of <code class="docutils literal notranslate"><span class="pre">group</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">Kaehler_cone</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Basis lattice of The toric rational divisor class group of a</span>
<span class="go">2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Divisor class [1, 0],</span>
<span class="go">Divisor class [0, 1]</span>
<span class="go">]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup_basis_lattice.Element">
<span class="sig-name descname"><span class="pre">Element</span></span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup_basis_lattice.Element" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="divisor_class.html#sage.schemes.toric.divisor_class.ToricRationalDivisorClass" title="sage.schemes.toric.divisor_class.ToricRationalDivisorClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClass</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.toric.divisor.is_ToricDivisor">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.toric.divisor.</span></span><span class="sig-name descname"><span class="pre">is_ToricDivisor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.is_ToricDivisor" title="Link to this definition">#</a></dt>
<dd><p>Test whether <code class="docutils literal notranslate"><span class="pre">x</span></code> is a toric divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> – anything.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">x</span></code> is an instance of <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricDivisor_generic</span></code></a> and
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.toric.divisor</span> <span class="kn">import</span> <span class="n">is_ToricDivisor</span>
<span class="gp">sage: </span><span class="n">is_ToricDivisor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">D</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">is_ToricDivisor</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="divisor_class.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Toric rational divisor classes</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="library.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Library of toric varieties</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2024, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Toric divisors and divisor classes</a><ul>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor"><code class="docutils literal notranslate"><span class="pre">ToricDivisor()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisorGroup"><code class="docutils literal notranslate"><span class="pre">ToricDivisorGroup</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisorGroup.Element"><code class="docutils literal notranslate"><span class="pre">Element</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisorGroup.base_extend"><code class="docutils literal notranslate"><span class="pre">base_extend()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisorGroup.gen"><code class="docutils literal notranslate"><span class="pre">gen()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisorGroup.gens"><code class="docutils literal notranslate"><span class="pre">gens()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisorGroup.ngens"><code class="docutils literal notranslate"><span class="pre">ngens()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic"><code class="docutils literal notranslate"><span class="pre">ToricDivisor_generic</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.Chern_character"><code class="docutils literal notranslate"><span class="pre">Chern_character()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.Chow_cycle"><code class="docutils literal notranslate"><span class="pre">Chow_cycle()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.Kodaira_map"><code class="docutils literal notranslate"><span class="pre">Kodaira_map()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.ch"><code class="docutils literal notranslate"><span class="pre">ch()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.coefficient"><code class="docutils literal notranslate"><span class="pre">coefficient()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.cohomology"><code class="docutils literal notranslate"><span class="pre">cohomology()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.cohomology_class"><code class="docutils literal notranslate"><span class="pre">cohomology_class()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.cohomology_support"><code class="docutils literal notranslate"><span class="pre">cohomology_support()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.divisor_class"><code class="docutils literal notranslate"><span class="pre">divisor_class()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.function_value"><code class="docutils literal notranslate"><span class="pre">function_value()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_Cartier"><code class="docutils literal notranslate"><span class="pre">is_Cartier()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_QQ_Cartier"><code class="docutils literal notranslate"><span class="pre">is_QQ_Cartier()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_QQ_Weil"><code class="docutils literal notranslate"><span class="pre">is_QQ_Weil()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_Weil"><code class="docutils literal notranslate"><span class="pre">is_Weil()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_ample"><code class="docutils literal notranslate"><span class="pre">is_ample()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_integral"><code class="docutils literal notranslate"><span class="pre">is_integral()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_nef"><code class="docutils literal notranslate"><span class="pre">is_nef()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.m"><code class="docutils literal notranslate"><span class="pre">m()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.monomial"><code class="docutils literal notranslate"><span class="pre">monomial()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.move_away_from"><code class="docutils literal notranslate"><span class="pre">move_away_from()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.polyhedron"><code class="docutils literal notranslate"><span class="pre">polyhedron()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.sections"><code class="docutils literal notranslate"><span class="pre">sections()</span></code></a></li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.sections_monomials"><code class="docutils literal notranslate"><span class="pre">sections_monomials()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="docutils literal notranslate"><span class="pre">ToricRationalDivisorClassGroup</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup.Element"><code class="docutils literal notranslate"><span class="pre">Element</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup_basis_lattice"><code class="docutils literal notranslate"><span class="pre">ToricRationalDivisorClassGroup_basis_lattice</span></code></a><ul>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup_basis_lattice.Element"><code class="docutils literal notranslate"><span class="pre">Element</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.schemes.toric.divisor.is_ToricDivisor"><code class="docutils literal notranslate"><span class="pre">is_ToricDivisor()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/tabs.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>