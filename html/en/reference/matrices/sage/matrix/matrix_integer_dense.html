<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Sparse integer matrices" href="matrix_integer_sparse.html" /><link rel="prev" title="Sparse Matrices over a general ring" href="matrix_generic_sparse.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Dense matrices over the integer ring - Matrices and Spaces of Matrices</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Matrices and Spaces of Matrices</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.2 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Matrices and Spaces of Matrices</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="matrix_space.html">Matrix Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructor.html">General matrix Constructor and display options</a></li>
<li class="toctree-l1"><a class="reference internal" href="special.html">Constructors for special matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="args.html">Helpers for creating matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs.html">Matrices over an arbitrary ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix0.html">Base class for matrices, part 0</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix1.html">Base class for matrices, part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix2.html">Base class for matrices, part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="strassen.html">Generic Asymptotically Fast Strassen Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="berlekamp_massey.html">Minimal Polynomials of Linear Recurrence Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_dense.html">Base class for dense matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_sparse.html">Base class for sparse matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_generic_dense.html">Dense Matrices over a general ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_generic_sparse.html">Sparse Matrices over a general ring</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Dense matrices over the integer ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_integer_sparse.html">Sparse integer matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_integer_dense_hnf.html">Modular algorithm to compute Hermite normal forms of integer matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_integer_dense_saturation.html">Saturation over ZZ</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_rational_dense.html">Dense matrices over the rational field</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_rational_sparse.html">Sparse rational matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_double_dense.html">Dense matrices using a NumPy backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_real_double_dense.html">Dense matrices over the Real Double Field using NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_mod2_dense.html">Dense matrices over GF(2) using the M4RI library</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_gf2e_dense.html">Dense matrices over <span class="math notranslate nohighlight">\(\GF{2^e}\)</span> for <span class="math notranslate nohighlight">\(2 \leq e \leq 16\)</span> using the M4RIE library</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_modn_dense_double.html">Dense matrices over <span class="math notranslate nohighlight">\(\ZZ/n\ZZ\)</span> for <span class="math notranslate nohighlight">\(n &lt; 94906266\)</span> using LinBox’s <code class="docutils literal notranslate"><span class="pre">Modular&lt;double&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_modn_dense_float.html">Dense matrices over <span class="math notranslate nohighlight">\(\ZZ/n\ZZ\)</span> for <span class="math notranslate nohighlight">\(n &lt; 2^{8}\)</span> using LinBox’s <code class="docutils literal notranslate"><span class="pre">Modular&lt;float&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_modn_sparse.html">Sparse matrices over <span class="math notranslate nohighlight">\(\ZZ/n\ZZ\)</span> for <span class="math notranslate nohighlight">\(n\)</span> small</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_symbolic_dense.html">Symbolic dense matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_symbolic_sparse.html">Symbolic sparse matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_complex_double_dense.html">Dense matrices over the Complex Double Field using NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_complex_ball_dense.html">Arbitrary precision complex ball matrices using Arb</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_polynomial_dense.html">Dense matrices over univariate polynomials over fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_mpolynomial_dense.html">Dense matrices over multivariate polynomials over fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_cyclo_dense.html">Matrices over Cyclotomic Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="operation_table.html">Operation Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="action.html">Actions used by the coercion model for matrix and vector multiplications</a></li>
<li class="toctree-l1"><a class="reference internal" href="change_ring.html">Functions for changing the base ring of matrices quickly</a></li>
<li class="toctree-l1"><a class="reference internal" href="echelon_matrix.html">Echelon matrices over finite fields.</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_misc.html">Miscellaneous matrix functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_window.html">Matrix windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Misc matrix algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc_mpfr.html">Misc matrix algorithms using MPFR</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc_flint.html">Misc matrix algorithms using FLINT</a></li>
<li class="toctree-l1"><a class="reference internal" href="symplectic_basis.html">Calculate symplectic bases for matrices over fields and the integers.</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute_J_ideal.html"><span class="math notranslate nohighlight">\(J\)</span>-ideals of matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">Benchmarks for matrices</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="dense-matrices-over-the-integer-ring">
<span id="sage-matrix-matrix-integer-dense"></span><h1>Dense matrices over the integer ring<a class="headerlink" href="#dense-matrices-over-the-integer-ring" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.matrix.matrix_integer_dense"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein</p></li>
<li><p>Robert Bradshaw</p></li>
<li><p>Marc Masdeu (August 2014). Implemented using FLINT, see <a class="reference external" href="https://github.com/sagemath/sage/issues/16803">github issue #16803</a>.</p></li>
<li><p>Jeroen Demeyer (October 2014): lots of fixes, see <a class="reference external" href="https://github.com/sagemath/sage/issues/17090">github issue #17090</a> and
<a class="reference external" href="https://github.com/sagemath/sage/issues/17094">github issue #17094</a>.</p></li>
<li><p>Vincent Delecroix (February 2015): make it faster, see <a class="reference external" href="https://github.com/sagemath/sage/issues/17822">github issue #17822</a>.</p></li>
<li><p>Vincent Delecroix (May 2017): removed duplication of entries and
cleaner linbox interface</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">a</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">-30</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^3 - 22*x^2 + 102*x + 30</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">&lt;</span> <span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.matrix.matrix_integer_dense.</span></span><span class="sig-name descname"><span class="pre">Matrix_integer_dense</span></span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="matrix_dense.html#sage.matrix.matrix_dense.Matrix_dense" title="sage.matrix.matrix_dense.Matrix_dense"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix_dense</span></code></a></p>
<p>Matrix over the integers, implemented using FLINT.</p>
<p>On a 32-bit machine, they can have at most <span class="math notranslate nohighlight">\(2^{32}-1\)</span> rows or
columns.  On a 64-bit machine, matrices can have at most
<span class="math notranslate nohighlight">\(2^{64}-1\)</span> rows or columns.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[2 0 0]</span>
<span class="go">[0 2 0]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[ 1  2 -3]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)(</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: nonzero scalar matrix must be square</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.BKZ">
<span class="sig-name descname"><span class="pre">BKZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fpLLL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_givens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.BKZ" title="Permalink to this definition">#</a></dt>
<dd><p>Block Korkin-Zolotarev reduction.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0.99</span></code>) LLL parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">&quot;fpLLL&quot;</span></code>) <code class="docutils literal notranslate"><span class="pre">&quot;fpLLL&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;NTL&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fp</span></code> – floating point number implementation</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> – NTL’s exact reduction or fpLLL’s wrapper (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fp'</span></code> – double precision: NTL’s FP or fpLLL’s double</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ld'</span></code> – long doubles (fpLLL only)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'qd'</span></code> – NTL’s QP</p></li>
</ul>
<dl class="simple">
<dt>-<code class="docutils literal notranslate"><span class="pre">'qd1'</span></code> – quad doubles: Uses <code class="docutils literal notranslate"><span class="pre">quad_float</span></code> precision</dt><dd><p>to compute Gram-Schmidt, but uses double precision in
the search phase of the block reduction algorithm. This
seems adequate for most purposes, and is faster than
<code class="docutils literal notranslate"><span class="pre">'qd'</span></code>, which uses quad_float precision uniformly
throughout (NTL only).</p>
</dd>
</dl>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'xd'</span></code> – extended exponent: NTL’s XD or fpLLL’s dpe</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rr'</span></code> – arbitrary precision: NTL’RR or fpLLL’s MPFR</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">block_size</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">10</span></code>) Specifies the size
of the blocks in the reduction.  High values yield
shorter vectors, but the running time increases double
exponentially with <code class="docutils literal notranslate"><span class="pre">block_size</span></code>.  <code class="docutils literal notranslate"><span class="pre">block_size</span></code>
should be between 2 and the number of rows of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – (default: same as <code class="docutils literal notranslate"><span class="pre">proof.linear_algebra()</span></code>)
Insist on full BKZ reduction. If disabled and fplll is
called, reduction is much faster but the result is not fully
BKZ reduced.</p></li>
</ul>
<p>NTL SPECIFIC INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prune</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) The optional parameter
<code class="docutils literal notranslate"><span class="pre">prune</span></code> can be set to any positive number to invoke the
Volume Heuristic from <a class="reference internal" href="../../../references/index.html#sh1995" id="id1"><span>[SH1995]</span></a>. This can significantly reduce
the running time, and hence allow much bigger block size,
but the quality of the reduction is of course not as good in
general. Higher values of <code class="docutils literal notranslate"><span class="pre">prune</span></code> mean better quality, and
slower running time. When <code class="docutils literal notranslate"><span class="pre">prune</span></code> is <code class="docutils literal notranslate"><span class="pre">0</span></code>, pruning is
disabled. Recommended usage: for <code class="docutils literal notranslate"><span class="pre">block_size==30</span></code>, set
<code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">&lt;=</span> <span class="pre">prune</span> <span class="pre">&lt;=15</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_givens</span></code> – Use Givens orthogonalization.  Only
applies to approximate reduction using NTL.  This is a bit
slower, but generally much more stable, and is really the
preferred orthogonalization strategy.  For a nice
description of this, see Chapter 5 of <a class="reference internal" href="../../../references/index.html#gl1996" id="id2"><span>[GL1996]</span></a>.</p></li>
</ul>
<p>fpLLL SPECIFIC INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0</span></code> for automatic choice) bit
precision to use if <code class="docutils literal notranslate"><span class="pre">fp='rr'</span></code> is set</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> – keywords to be passed to <code class="xref py py-mod docutils literal notranslate"><span class="pre">fpylll</span></code>.  See
<code class="xref py py-class docutils literal notranslate"><span class="pre">fpylll.BKZ.Param</span></code> for details.</p></li>
</ul>
<p>Also, if the verbose level is at least <span class="math notranslate nohighlight">\(2\)</span>, some output
is printed during the computation.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">()</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">(</span><span class="n">use_givens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">BKZ</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="s2">&quot;fp&quot;</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Calls either NTL or fpLLL.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL">
<span class="sig-name descname"><span class="pre">LLL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fpLLL:wrapper'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_red</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_givens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_siegel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL" title="Permalink to this definition">#</a></dt>
<dd><p>Return LLL reduced or approximated LLL reduced lattice <span class="math notranslate nohighlight">\(R\)</span> for this
matrix interpreted as a lattice.</p>
<p>A lattice <span class="math notranslate nohighlight">\((b_1, b_2, ..., b_d)\)</span> is <span class="math notranslate nohighlight">\((\delta, \eta)\)</span>-LLL-reduced
if the two following conditions hold:</p>
<ul class="simple">
<li><p>For any <span class="math notranslate nohighlight">\(i &gt; j\)</span>, we have <span class="math notranslate nohighlight">\(\lvert \mu_{i,j} \rvert \leq \eta\)</span>.</p></li>
<li><p>For any <span class="math notranslate nohighlight">\(i &lt; d\)</span>, we have <span class="math notranslate nohighlight">\(\delta \lvert b_i^* \rvert^2 \leq
\lvert b_{i + 1}^* + \mu_{i+1, i} b_i^* \rvert^2\)</span>,</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\mu_{i,j} = \langle b_i, b_j^* \rangle / \langle b_j^*, b_j^*
\rangle\)</span> and <span class="math notranslate nohighlight">\(b_i^*\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>-th vector of the Gram-Schmidt
orthogonalisation of <span class="math notranslate nohighlight">\((b_1, b_2, ..., b_d)\)</span>.</p>
<p>The default reduction parameters are <span class="math notranslate nohighlight">\(\delta = 0.99\)</span> and <span class="math notranslate nohighlight">\(\eta = 0.501\)</span>.
The parameters <span class="math notranslate nohighlight">\(\delta\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span> must satisfy <span class="math notranslate nohighlight">\(0.25 &lt; \delta
\leq 1.0\)</span> and <span class="math notranslate nohighlight">\(0.5 \leq \eta &lt; \sqrt{\delta}\)</span>. Polynomial time
complexity is only guaranteed for <span class="math notranslate nohighlight">\(\delta &lt; 1\)</span>. Not every algorithm
admits the case <span class="math notranslate nohighlight">\(\delta = 1\)</span>.</p>
<p>The lattice is returned as a matrix. Also the rank (and the
determinant) of <code class="docutils literal notranslate"><span class="pre">self</span></code> are cached if those are computed during
the reduction. Note that in general this only happens when
<code class="docutils literal notranslate"><span class="pre">self.rank()</span> <span class="pre">==</span> <span class="pre">self.ncols()</span></code> and the exact algorithm is used.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0.99</span></code>) <span class="math notranslate nohighlight">\(\delta\)</span> parameter as described
above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eta</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0.501</span></code>) <span class="math notranslate nohighlight">\(\eta\)</span> parameter as described above,
ignored by NTL</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string; one of the algorithms listed below
(default: <code class="docutils literal notranslate"><span class="pre">&quot;fpLLL:wrapper&quot;</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fp</span></code> – floating point number implementation:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> – NTL’s exact reduction or fpLLL’s wrapper</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fp'</span></code> – double precision: NTL’s FP or fpLLL’s double</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ld'</span></code> – long doubles (fpLLL only)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'qd'</span></code> – NTL’s QP</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'xd'</span></code> – extended exponent: NTL’s XD or fpLLL’s dpe</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'rr'</span></code> – arbitrary precision: NTL’s RR or fpLLL’s MPFR</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – (default: auto choose) precision, ignored by NTL</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">early_red</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) perform early reduction,
ignored by NTL</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_givens</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) use Givens
orthogonalization.  Only applies to approximate reduction
using NTL.  This is slower but generally more stable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_siegel</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) use Siegel’s condition
instead of Lovász’s condition, ignored by NTL</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) also return transformation</dt><dd><p>matrix.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> – keywords to be passed to <code class="xref py py-mod docutils literal notranslate"><span class="pre">fpylll</span></code>.  See
<code class="xref py py-meth docutils literal notranslate"><span class="pre">fpylll.LLL.reduction()</span></code> for details.</p></li>
</ul>
<p>Also, if the verbose level is at least <span class="math notranslate nohighlight">\(2\)</span>, some output
is printed during the computation.</p>
<p>AVAILABLE ALGORITHMS:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'NTL:LLL'</span></code> - NTL’s LLL + choice of <code class="docutils literal notranslate"><span class="pre">fp</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fpLLL:heuristic'</span></code> - fpLLL’s heuristic + choice of <code class="docutils literal notranslate"><span class="pre">fp</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fpLLL:fast'</span></code> - fpLLL’s fast + choice of <code class="docutils literal notranslate"><span class="pre">fp</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fpLLL:proved'</span></code> - fpLLL’s proved + choice of <code class="docutils literal notranslate"><span class="pre">fp</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fpLLL:wrapper'</span></code> - fpLLL’s automatic choice (default).</p></li>
</ul>
<p>OUTPUT:</p>
<p>A matrix over the integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[-1  1  3]</span>
</pre></div>
</div>
<p>We compute the extended GCD of a list of integers using LLL, this
example is from the Magma handbook:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">67015143</span><span class="p">,</span> <span class="mi">248934363018</span><span class="p">,</span> <span class="mi">109210</span><span class="p">,</span> <span class="mi">25590011055</span><span class="p">,</span> <span class="mi">74631449</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="mi">10230248</span><span class="p">,</span> <span class="mi">709487</span><span class="p">,</span> <span class="mi">68965012139</span><span class="p">,</span> <span class="mi">972065</span><span class="p">,</span> <span class="mi">864972271</span> <span class="p">]</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span> <span class="o">*</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[-3, -1, 13, -1, -4, 2, 3, 4, 5, -1]</span>
<span class="gp">sage: </span><span class="n">add</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>The case <span class="math notranslate nohighlight">\(\delta = 1\)</span> is not always supported:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: delta must be &lt;= 1</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>    <span class="c1"># not tested, will eat lots of ram</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">RuntimeError: infinite loop in LLL</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;NTL:LLL&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">(-100, -3, -1, 13, -1, -4, 2, 3, 4, 5, -1)</span>
</pre></div>
</div>
<p>We return the transformation matrix:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">R</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;NTL:LLL&quot;</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">R</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.libs.ntl.ntl_mat_ZZ.ntl_mat_ZZ.LLL</span></code> and
<code class="xref py py-mod docutils literal notranslate"><span class="pre">fpylll.fplll.lll</span></code> for details on the algorithms used.</p>
<p>Although LLL is a deterministic algorithm, the output for
different implementations and CPUs (32-bit vs. 64-bit) may
vary, while still being correct.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.antitranspose">
<span class="sig-name descname"><span class="pre">antitranspose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.antitranspose" title="Permalink to this definition">#</a></dt>
<dd><p>Return the antitranspose of self, without changing self.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.matrix.matrix_integer_dense.Matrix_integer_dense&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">antitranspose</span><span class="p">()</span>
<span class="go">[5 2]</span>
<span class="go">[4 1]</span>
<span class="go">[3 0]</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">A</span>
<span class="go">[0 1|2]</span>
<span class="go">[---+-]</span>
<span class="go">[3 4|5]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">antitranspose</span><span class="p">()</span>
<span class="go">[5|2]</span>
<span class="go">[-+-]</span>
<span class="go">[4|1]</span>
<span class="go">[3|0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdivide</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.augment" title="Permalink to this definition">#</a></dt>
<dd><p>Return a new matrix formed by appending the matrix
(or vector) <code class="docutils literal notranslate"><span class="pre">right</span></code> on the right side of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">right</span></code> - a matrix, vector or free module element, whose
dimensions are compatible with <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subdivide</span></code> - default: <code class="docutils literal notranslate"><span class="pre">False</span></code> - request the resulting
matrix to have a new subdivision, separating <code class="docutils literal notranslate"><span class="pre">self</span></code> from <code class="docutils literal notranslate"><span class="pre">right</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A new matrix formed by appending <code class="docutils literal notranslate"><span class="pre">right</span></code> onto the right side of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
If <code class="docutils literal notranslate"><span class="pre">right</span></code> is a vector (or free module element) then in this context
it is appropriate to consider it as a column vector.  (The code first
converts a vector to a 1-column matrix.)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4  0  1  2]</span>
<span class="go">[ 5  6  7  8  9  3  4  5]</span>
<span class="go">[10 11 12 13 14  6  7  8]</span>
<span class="go">[15 16 17 18 19  9 10 11]</span>
</pre></div>
</div>
<p>A vector may be augmented to a matrix.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4  0]</span>
<span class="go">[ 5  6  7  8  9  1]</span>
<span class="go">[10 11 12 13 14  2]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">subdivide</span></code> option will add a natural subdivision between
<code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code>.  For more details about how subdivisions
are managed when augmenting, see
<a class="reference internal" href="matrix1.html#sage.matrix.matrix1.Matrix.augment" title="sage.matrix.matrix1.Matrix.augment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.matrix.matrix1.Matrix.augment()</span></code></a>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[ 0  1  2  3  4| 0  1  2]</span>
<span class="go">[ 5  6  7  8  9| 3  4  5]</span>
<span class="go">[10 11 12 13 14| 6  7  8]</span>
</pre></div>
</div>
<p>Errors are raised if the sizes are incompatible.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: number of rows must be the same, not 2 != 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly">
<span class="sig-name descname"><span class="pre">charpoly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly" title="Permalink to this definition">#</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The characteristic polynomial is defined as <span class="math notranslate nohighlight">\(\det(xI-A)\)</span>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> - a variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - (optional) either ‘generic’, ‘flint’ or ‘linbox’.
Default is set to ‘linbox’.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">();</span> <span class="n">f</span>
<span class="go">x^6 - 105*x^5 - 630*x^4</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;flint&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">g</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^20 - 3990*x^19 - 266000*x^18</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^3 - 3990*x^2 - 266000*x</span>
</pre></div>
</div>
<p>On non square matrices, this method raises an ArithmeticError:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: only valid for square matrix</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.column">
<span class="sig-name descname"><span class="pre">column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.column" title="Permalink to this definition">#</a></dt>
<dd><p>Return the i-th column of this matrix as a dense vector.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> - integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from_list</span></code> - ignored</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-2, 4, 0)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">from_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(-2, 4, 0)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-2, 4, 0)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, 3, -1)</span>

<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">IndexError: column index out of range</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">IndexError: column index out of range</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.decomposition">
<span class="sig-name descname"><span class="pre">decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.decomposition" title="Permalink to this definition">#</a></dt>
<dd><p>Return the decomposition of the free module on which this matrix A
acts from the right (i.e., the action is x goes to x A), along with
whether this matrix acts irreducibly on each factor. The factors
are guaranteed to be sorted in the same way as the corresponding
factors of the characteristic polynomial, and are saturated as ZZ
modules.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> - a matrix over the integers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> - these are passed onto to the
decomposition over QQ command.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="n">sign</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">[ 3 -2]</span>
<span class="go">[ 0 -2]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 3) * (x + 2)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">(Free module of degree 2 and rank 1 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 5 -2], True),</span>
<span class="go">(Free module of degree 2 and rank 1 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[0 1], True)</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.determinant">
<span class="sig-name descname"><span class="pre">determinant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stabilize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.determinant" title="Permalink to this definition">#</a></dt>
<dd><p>Return the determinant of this matrix.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code> – use <code class="docutils literal notranslate"><span class="pre">flint</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flint'</span></code> – let flint do the determinant</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'padic'</span></code> -  uses a p-adic / multimodular
algorithm that relies on code in IML and linbox</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'linbox'</span></code> - calls linbox det (you <em>must</em> set
proof=False to use this!)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ntl'</span></code> - calls NTL’s det function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> - uses PARI</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - bool or None; if None use
proof.linear_algebra(); only relevant for the padic algorithm.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It would be <em>VERY VERY</em> hard for det to fail even with
proof=False.</p>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">stabilize</span></code> - if proof is False, require det to be
the same for this many CRT primes in a row. Ignored if proof is
True.</p></li>
</ul>
<p>ALGORITHM: The p-adic algorithm works by first finding a random
vector v, then solving <span class="math notranslate nohighlight">\(Ax = v\)</span> and taking the denominator
<span class="math notranslate nohighlight">\(d\)</span>. This gives a divisor of the determinant. Then we
compute <span class="math notranslate nohighlight">\(\det(A)/d\)</span> using a multimodular algorithm and the
Hadamard bound, skipping primes that divide <span class="math notranslate nohighlight">\(d\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,[</span><span class="mf">3..66</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D1</span> <span class="o">==</span> <span class="n">D2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We have a special-case algorithm for 4 x 4 determinants:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">270</span>
</pre></div>
</div>
<p>Next we try the Linbox det. Note that we must have proof=False.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">RuntimeError: you must pass the proof=False option to the determinant command to use LinBox&#39;s det algorithm</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">-21</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">-21</span>
</pre></div>
</div>
<p>Try the other algorithms on the same example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>
<span class="go">-21</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">-21</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">-21</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">();</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>
<span class="go">-21</span>
</pre></div>
</div>
<p>A bigger example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">_clear_cache</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">,</span><span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.echelon_form">
<span class="sig-name descname"><span class="pre">echelon_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_zero_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.echelon_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return the echelon form of this matrix over the integers, also known
as the hermite normal form (HNF).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – String. The algorithm to use. Valid options are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code> – Let Sage pick an algorithm (default).
Up to 75 rows or columns with no transformation matrix,
use pari with flag 0; otherwise, use flint.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flint'</span></code> - use flint</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ntl'</span></code> - use NTL (only works for square matrices of
full rank!)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'padic'</span></code> - an asymptotically fast p-adic modular
algorithm, If your matrix has large coefficients and is
small, you may also want to try this.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> - use PARI with flag 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari0'</span></code> - use PARI with flag 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari1'</span></code> - use PARI with flag 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari4'</span></code> - use PARI with flag 4 (use heuristic LLL)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - (default: True); if proof=False certain
determinants are computed using a randomized hybrid p-adic
multimodular strategy until it stabilizes twice (instead of up to
the Hadamard bound). It is <em>incredibly</em> unlikely that one would
ever get an incorrect result with proof=False.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include_zero_rows</span></code> - (default: True) if False,
don’t include zero rows</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transformation</span></code> - if given, also compute
transformation matrix; only valid for flint and padic algorithm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> - (default: None) if given and the algorithm
is ‘ntl’, then D must be a multiple of the determinant and this
function will use that fact.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The Hermite normal form (=echelon form over <span class="math notranslate nohighlight">\(\ZZ\)</span>) of self as
an immutable matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[  5   0  -5 -10 -15]</span>
<span class="go">[  0   1   2   3   4]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
</pre></div>
</div>
<p>Getting a transformation matrix in the nonsquare case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..15</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[  0   0   0   4  -3]</span>
<span class="go">[  0   0   0  13 -10]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If ‘ntl’ is chosen for a non square matrix this function
raises a ValueError.</p>
</div>
<p>Special cases: 0 or 1 rows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(1,)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>Illustrate using various algorithms.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari0&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari4&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>The ‘ntl’ algorithm doesn’t work on matrices that do not have full rank.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: ntl only computes HNF for square matrices of full rank.</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span><span class="p">[</span><span class="mf">2..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors">
<span class="sig-name descname"><span class="pre">elementary_divisors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pari'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors" title="Permalink to this definition">#</a></dt>
<dd><p>Return the elementary divisors of self, in order.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is MUCH faster than the <a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smith_form()</span></code></a> function.</p>
</div>
<p>The elementary divisors are the invariants of the finite abelian
group that is the cokernel of <em>left</em> multiplication of this matrix.
They are ordered in reverse by divisibility.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> - matrix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - (default: ‘pari’)</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code>: works robustly, but is slower.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'linbox'</span></code> - use linbox (currently off, broken)</p></li>
</ul>
</li>
</ul>
<p>OUTPUT: list of integers</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These are the invariants of the cokernel of <em>left</em> multiplication:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[3 0 1]</span>
<span class="go">[0 1 0]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 0]</span>
</pre></div>
</div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 3, 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">[1, 3, 0]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">)([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 1, 687]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 6]</span>
</pre></div>
</div>
<p>This returns a copy, which is safe to change:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">edivs</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">edivs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, 1, 6]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smith_form()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius">
<span class="sig-name descname"><span class="pre">frobenius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Frobenius form (rational canonical form) of this
matrix.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">flag</span></code> – 0 (default), 1 or 2 as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> – (default) return the Frobenius form of this
matrix.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> – return only the elementary divisor
polynomials, as polynomials in var.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> – return a two-components vector [F,B] where F
is the Frobenius form and B is the basis change so that
<span class="math notranslate nohighlight">\(M=B^{-1}FB\)</span>.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> – a string (default: ‘x’)</p></li>
</ul>
<p>ALGORITHM: uses PARI’s matfrobenius()</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[ 0  0  0]</span>
<span class="go">[ 1  0 18]</span>
<span class="go">[ 0  1 12]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[x^3 - 12*x^2 - 18*x]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="go">[y^3 - 12*y^2 - 18*y]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">B</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="o">*</span><span class="n">B</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">=</span><span class="n">matrix</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">([], [])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">frobenius</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">frobenius</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: frobenius matrix of non-square matrix not defined.</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Martin Albrect (2006-04-02)</p></li>
</ul>
<p>TODO: - move this to work for more general matrices than just over
Z. This will require fixing how PARI polynomials are coerced to
Sage polynomials.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.gcd">
<span class="sig-name descname"><span class="pre">gcd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.gcd" title="Permalink to this definition">#</a></dt>
<dd><p>Return the gcd of all entries of self; very fast.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.height">
<span class="sig-name descname"><span class="pre">height</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.height" title="Permalink to this definition">#</a></dt>
<dd><p>Return the height of this matrix, i.e., the max absolute value of
the entries of the matrix.</p>
<p>OUTPUT: A nonnegative integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)([</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">389</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[ -17    3 -389]</span>
<span class="go">[  15   -1    0]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">389</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.hermite_form">
<span class="sig-name descname"><span class="pre">hermite_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_zero_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.hermite_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return the echelon form of this matrix over the integers, also known
as the hermite normal form (HNF).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – String. The algorithm to use. Valid options are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code> – Let Sage pick an algorithm (default).
Up to 75 rows or columns with no transformation matrix,
use pari with flag 0; otherwise, use flint.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flint'</span></code> - use flint</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ntl'</span></code> - use NTL (only works for square matrices of
full rank!)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'padic'</span></code> - an asymptotically fast p-adic modular
algorithm, If your matrix has large coefficients and is
small, you may also want to try this.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> - use PARI with flag 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari0'</span></code> - use PARI with flag 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari1'</span></code> - use PARI with flag 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari4'</span></code> - use PARI with flag 4 (use heuristic LLL)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - (default: True); if proof=False certain
determinants are computed using a randomized hybrid p-adic
multimodular strategy until it stabilizes twice (instead of up to
the Hadamard bound). It is <em>incredibly</em> unlikely that one would
ever get an incorrect result with proof=False.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include_zero_rows</span></code> - (default: True) if False,
don’t include zero rows</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transformation</span></code> - if given, also compute
transformation matrix; only valid for flint and padic algorithm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> - (default: None) if given and the algorithm
is ‘ntl’, then D must be a multiple of the determinant and this
function will use that fact.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The Hermite normal form (=echelon form over <span class="math notranslate nohighlight">\(\ZZ\)</span>) of self as
an immutable matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[  5   0  -5 -10 -15]</span>
<span class="go">[  0   1   2   3   4]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
<span class="go">[  0   0   0   0   0]</span>
</pre></div>
</div>
<p>Getting a transformation matrix in the nonsquare case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..15</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[  0   0   0   4  -3]</span>
<span class="go">[  0   0   0  13 -10]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If ‘ntl’ is chosen for a non square matrix this function
raises a ValueError.</p>
</div>
<p>Special cases: 0 or 1 rows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(1,)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">include_zero_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>Illustrate using various algorithms.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari0&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari4&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">[1 2 3]</span>
<span class="go">[0 3 6]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>The ‘ntl’ algorithm doesn’t work on matrices that do not have full rank.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: ntl only computes HNF for square matrices of full rank.</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span><span class="p">[</span><span class="mf">2..9</span><span class="p">])</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ntl&#39;</span><span class="p">)</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.index_in_saturation">
<span class="sig-name descname"><span class="pre">index_in_saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.index_in_saturation" title="Permalink to this definition">#</a></dt>
<dd><p>Return the index of self in its saturation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - (default: use proof.linear_algebra());
if False, the determinant calculations are done with proof=False.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">positive</span> <span class="pre">integer</span></code> - the index of the row span of
this matrix in its saturation</p></li>
</ul>
<p>ALGORITHM: Use Hermite normal form twice to find an invertible
matrix whose inverse transforms a matrix with the same row span as
self to its saturation, then compute the determinant of that
matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mf">1..6</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">()</span>
<span class="go">[1 2 3]</span>
<span class="go">[1 1 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.insert_row">
<span class="sig-name descname"><span class="pre">insert_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.insert_row" title="Permalink to this definition">#</a></dt>
<dd><p>Create a new matrix from self with.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> - integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row</span></code> - a vector</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">X</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  1   5 -10]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[  1   5 -10]</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[  0   1   2]</span>
<span class="go">[  3   4   5]</span>
<span class="go">[  6   7   8]</span>
<span class="go">[  1   5 -10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.integer_valued_polynomials_generators">
<span class="sig-name descname"><span class="pre">integer_valued_polynomials_generators</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.integer_valued_polynomials_generators" title="Permalink to this definition">#</a></dt>
<dd><p>Determine the generators of the ring of integer valued polynomials on this
matrix.</p>
<p>OUTPUT:</p>
<p>A pair <code class="docutils literal notranslate"><span class="pre">(mu_B,</span> <span class="pre">P)</span></code> where <code class="docutils literal notranslate"><span class="pre">P</span></code> is a list of polynomials in <span class="math notranslate nohighlight">\(\QQ[X]\)</span>
such that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\{f \in \QQ[X] \mid f(B) \in M_n(\ZZ)\}
    = \mu_B \QQ[X] + \sum_{g\in P} g \ZZ[X]\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(B\)</span> is this matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">integer_valued_polynomials_generators</span><span class="p">()</span>
<span class="go">(x^3 + x^2 - 12*x - 20, [1, 1/4*x^2 + 3/4*x + 1/2])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="compute_J_ideal.html#module-sage.matrix.compute_J_ideal" title="sage.matrix.compute_J_ideal"><code class="xref py py-mod docutils literal notranslate"><span class="pre">compute_J_ideal</span></code></a>,
<a class="reference internal" href="compute_J_ideal.html#sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.integer_valued_polynomials_generators" title="sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.integer_valued_polynomials_generators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integer_valued_polynomials_generators()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.inverse_of_unit">
<span class="sig-name descname"><span class="pre">inverse_of_unit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.inverse_of_unit" title="Permalink to this definition">#</a></dt>
<dd><p>If self is a matrix with determinant <span class="math notranslate nohighlight">\(1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span> return the inverse of
<code class="docutils literal notranslate"><span class="pre">self</span></code> as a matrix over <span class="math notranslate nohighlight">\(ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">m</span>
<span class="go">[ 1 -1]</span>
<span class="go">[-1  2]</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">Full MatrixSpace of 2 by 2 dense matrices over Integer Ring</span>

<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: non-invertible matrix</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_LLL_reduced">
<span class="sig-name descname"><span class="pre">is_LLL_reduced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_LLL_reduced" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if this lattice is <span class="math notranslate nohighlight">\((\delta, \eta)\)</span>-LLL reduced.
See <code class="docutils literal notranslate"><span class="pre">self.LLL</span></code> for a definition of LLL reduction.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> – (default: <span class="math notranslate nohighlight">\(0.99\)</span>) parameter <span class="math notranslate nohighlight">\(\delta\)</span> as described above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eta</span></code> – (default: <span class="math notranslate nohighlight">\(0.501\)</span>) parameter <span class="math notranslate nohighlight">\(\eta\)</span> as described above</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_LLL_reduced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_LLL_reduced</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_one">
<span class="sig-name descname"><span class="pre">is_one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_one" title="Permalink to this definition">#</a></dt>
<dd><p>Tests whether self is the identity matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_primitive">
<span class="sig-name descname"><span class="pre">is_primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_primitive" title="Permalink to this definition">#</a></dt>
<dd><p>Test whether the matrix is primitive.</p>
<p>An integral matrix <span class="math notranslate nohighlight">\(A\)</span> is primitive if all its entries are non-negative
and for some positive integer <span class="math notranslate nohighlight">\(n\)</span> the matrix <span class="math notranslate nohighlight">\(A^n\)</span> has all its
entries positive.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">**</span><span class="mi">4</span>
<span class="go">[3 2 1]</span>
<span class="go">[1 1 1]</span>
<span class="go">[2 1 1]</span>

<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">**</span><span class="mi">6</span>
<span class="go">[4 3 2 1]</span>
<span class="go">[1 1 1 1]</span>
<span class="go">[2 1 1 1]</span>
<span class="go">[3 2 1 1]</span>

<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Testing extremal matrices:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">matrix1</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="n">m</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">matrix1</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="k">def</span> <span class="nf">matrix2</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....: </span>    <span class="n">m</span><span class="p">[</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="n">m</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">matrix2</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Non-primitive families:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">matrix3</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="n">m</span>
<span class="gp">sage: </span><span class="nb">any</span><span class="p">(</span><span class="n">matrix3</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.minpoly">
<span class="sig-name descname"><span class="pre">minpoly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.minpoly" title="Permalink to this definition">#</a></dt>
<dd><p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> - a variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - (optional) either ‘linbox’ (default) or ‘generic’</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^3 - 105*x^2 - 630*x</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">6</span><span class="p">)([</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;linbox&#39;</span><span class="p">)</span>
<span class="go">x^4 - 2695*x^3 - 257964*x^2 + 1693440*x</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">)</span>
<span class="go">x^4 - 2695*x^3 - 257964*x^2 + 1693440*x</span>
</pre></div>
</div>
<p>On non square matrices, this method raises an ArithmeticError:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: only valid for square matrix</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.null_ideal">
<span class="sig-name descname"><span class="pre">null_ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.null_ideal" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\((b)\)</span>-ideal of this matrix.</p>
<p>Let <span class="math notranslate nohighlight">\(B\)</span> be a <span class="math notranslate nohighlight">\(n \times n\)</span> matrix. The <em>null ideal</em> modulo <span class="math notranslate nohighlight">\(b\)</span>,
or <span class="math notranslate nohighlight">\((b)\)</span>-ideal, is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[N_{(b)}(B) = \{f \in \ZZ[X] \mid f(B) \in M_n(b\ZZ)\}.\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> – an element of <span class="math notranslate nohighlight">\(\ZZ\)</span> (default: 0)</p></li>
</ul>
<p>OUTPUT:</p>
<p>An ideal in <span class="math notranslate nohighlight">\(\ZZ[X]\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">null_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (x^3 + x^2 - 12*x - 20) of</span>
<span class="go">    Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">null_ideal</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">Ideal (8, x^3 + x^2 - 12*x - 20, 2*x^2 + 6*x + 4) of</span>
<span class="go">    Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">null_ideal</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">Ideal (6, 2*x^3 + 2*x^2 - 24*x - 40, 3*x^2 + 3*x) of</span>
<span class="go">    Univariate Polynomial Ring in x over Integer Ring</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="compute_J_ideal.html#module-sage.matrix.compute_J_ideal" title="sage.matrix.compute_J_ideal"><code class="xref py py-mod docutils literal notranslate"><span class="pre">compute_J_ideal</span></code></a>,
<a class="reference internal" href="compute_J_ideal.html#sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.null_ideal" title="sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.null_ideal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">null_ideal()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.p_minimal_polynomials">
<span class="sig-name descname"><span class="pre">p_minimal_polynomials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.p_minimal_polynomials" title="Permalink to this definition">#</a></dt>
<dd><p>Compute <span class="math notranslate nohighlight">\((p^s)\)</span>-minimal polynomials <span class="math notranslate nohighlight">\(\nu_s\)</span> of this matrix.</p>
<p>For <span class="math notranslate nohighlight">\(s  \ge 0\)</span>, a <span class="math notranslate nohighlight">\((p^s)\)</span>-minimal polynomial of
a matrix <span class="math notranslate nohighlight">\(B\)</span> is a monic polynomial <span class="math notranslate nohighlight">\(f \in \ZZ[X]\)</span> of
minimal degree such that all entries of <span class="math notranslate nohighlight">\(f(B)\)</span> are divisible
by <span class="math notranslate nohighlight">\(p^s\)</span>.</p>
<p>Compute a finite subset <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> of the positive
integers and <span class="math notranslate nohighlight">\((p^s)\)</span>-minimal polynomials
<span class="math notranslate nohighlight">\(\nu_s\)</span> for <span class="math notranslate nohighlight">\(s \in \mathcal{S}\)</span>.</p>
<p>For <span class="math notranslate nohighlight">\(0 &lt; t \le \max \mathcal{S}\)</span>, a <span class="math notranslate nohighlight">\((p^t)\)</span>-minimal polynomial is
given by <span class="math notranslate nohighlight">\(\nu_s\)</span> where
<span class="math notranslate nohighlight">\(s = \min\{ r \in \mathcal{S} \mid r\ge t \}\)</span>.
For <span class="math notranslate nohighlight">\(t &gt; \max\mathcal{S}\)</span>, the minimal polynomial of <span class="math notranslate nohighlight">\(B\)</span> is
also a <span class="math notranslate nohighlight">\((p^t)\)</span>-minimal polynomial.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime in <span class="math notranslate nohighlight">\(\ZZ\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s_max</span></code> – a positive integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); if set, only
<span class="math notranslate nohighlight">\((p^s)\)</span>-minimal polynomials for <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">&lt;=</span> <span class="pre">s_max</span></code> are computed
(see below for details)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A dictionary. Keys are the finite set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>, the
values are the associated <span class="math notranslate nohighlight">\((p^s)\)</span>-minimal polynomials <span class="math notranslate nohighlight">\(\nu_s\)</span>,
<span class="math notranslate nohighlight">\(s\in\mathcal{S}\)</span>.</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">s_max</span></code> only affects the output if <code class="docutils literal notranslate"><span class="pre">s_max</span></code> is at
most <span class="math notranslate nohighlight">\(\max\mathcal{S}\)</span> where <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> denotes the full
set. In that case, only those <span class="math notranslate nohighlight">\(\nu_s\)</span> with <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">&lt;=</span> <span class="pre">s_max</span></code> are
returned where <code class="docutils literal notranslate"><span class="pre">s_max</span></code> is always included even if it is not
included in the full set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">p_minimal_polynomials</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">{2: x^2 + 3*x + 2}</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="compute_J_ideal.html#module-sage.matrix.compute_J_ideal" title="sage.matrix.compute_J_ideal"><code class="xref py py-mod docutils literal notranslate"><span class="pre">compute_J_ideal</span></code></a>,
<a class="reference internal" href="compute_J_ideal.html#sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.p_minimal_polynomials" title="sage.matrix.compute_J_ideal.ComputeMinimalPolynomials.p_minimal_polynomials"><code class="xref py py-meth docutils literal notranslate"><span class="pre">p_minimal_polynomials()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.pivots">
<span class="sig-name descname"><span class="pre">pivots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.pivots" title="Permalink to this definition">#</a></dt>
<dd><p>Return the pivot column positions of this matrix.</p>
<p>OUTPUT: a tuple of Python integers: the position of the
first nonzero entry in each row of the echelon form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 3  0 -3]</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 0  0  0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.prod_of_row_sums">
<span class="sig-name descname"><span class="pre">prod_of_row_sums</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.prod_of_row_sums" title="Permalink to this definition">#</a></dt>
<dd><p>Return the product of the sums of the entries in the submatrix of
<code class="docutils literal notranslate"><span class="pre">self</span></code> with given columns.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cols</span></code> – a list (or set) of integers representing columns
of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>OUTPUT: an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..6</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">prod_of_row_sums</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">40</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
<span class="go">40</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">prod_of_row_sums</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">40</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.randomize">
<span class="sig-name descname"><span class="pre">randomize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonzero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.randomize" title="Permalink to this definition">#</a></dt>
<dd><p>Randomize <code class="docutils literal notranslate"><span class="pre">density</span></code> proportion of the entries of this matrix,
leaving the rest unchanged.</p>
<p>The parameters are the same as the ones for the integer ring’s
<code class="docutils literal notranslate"><span class="pre">random_element</span></code> function.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are given, randomized entries of this matrix have
to be between <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> and have density 1.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> - a mutable matrix over ZZ</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">density</span></code> - a float between 0 and 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x,</span> <span class="pre">y</span></code> - if not <code class="docutils literal notranslate"><span class="pre">None</span></code>, these are passed to the
<code class="docutils literal notranslate"><span class="pre">ZZ.random_element</span></code> function as the upper and lower endpoints in
the  uniform distribution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distribution</span></code> - would also be passed into <code class="docutils literal notranslate"><span class="pre">ZZ.random_element</span></code>
if given</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nonzero</span></code> - bool (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether the new entries
are guaranteed to be zero</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>None, the matrix is modified in-place</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mf">1..6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ranks</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="nb">any</span><span class="p">(</span><span class="n">ranks</span><span class="p">):</span>
<span class="gp">....: </span>   <span class="n">A</span><span class="o">.</span><span class="n">randomize</span><span class="p">()</span>
<span class="gp">....: </span>   <span class="n">ranks</span><span class="p">[</span><span class="n">A</span><span class="o">.</span><span class="n">rank</span><span class="p">()]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="gp">sage: </span><span class="n">mini</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">maxi</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">mini</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">30</span> <span class="ow">and</span> <span class="n">maxi</span> <span class="o">!=</span> <span class="mi">30</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">A</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">mini</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">list</span><span class="p">()),</span> <span class="n">mini</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">maxi</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">list</span><span class="p">()),</span> <span class="n">maxi</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.rank">
<span class="sig-name descname"><span class="pre">rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'modp'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.rank" title="Permalink to this definition">#</a></dt>
<dd><p>Return the rank of this matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – either <code class="docutils literal notranslate"><span class="pre">'modp'</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">'flint'</span></code>
or <code class="docutils literal notranslate"><span class="pre">'linbox'</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a nonnegative integer – the rank</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The rank is cached.</p>
</div>
<p>ALGORITHM:</p>
<p>If set to <code class="docutils literal notranslate"><span class="pre">'modp'</span></code>, first check if the matrix has maximum
possible rank by working modulo one random prime. If not, call
LinBox’s rank function.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..6</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1..9</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="go">[7 8 9]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Here is a bigger example - the rank is of course still 2:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">100</span><span class="p">,[</span><span class="mf">1..100</span><span class="o">^</span><span class="mi">2</span><span class="p">]);</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.rational_reconstruction">
<span class="sig-name descname"><span class="pre">rational_reconstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.rational_reconstruction" title="Permalink to this definition">#</a></dt>
<dd><p>Use rational reconstruction to lift self to a matrix over the
rational numbers (if possible), where we view self as a matrix
modulo N.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> - an integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">matrix</span></code> - over QQ or raise a ValueError</p></li>
</ul>
<p>EXAMPLES: We create a random 4x4 matrix over ZZ.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>There isn’t a unique rational reconstruction of it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: rational reconstruction does not exist</span>
</pre></div>
</div>
<p>We throw in a denominator and reduce the matrix modulo 389 - it
does rationally reconstruct.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="mi">3</span> <span class="o">%</span> <span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span><span class="o">/</span><span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.row">
<span class="sig-name descname"><span class="pre">row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.row" title="Permalink to this definition">#</a></dt>
<dd><p>Return the i-th row of this matrix as a dense vector.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> - integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from_list</span></code> - ignored</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(1, -2)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(3, 4)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">from_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(3, 4)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, -2)</span>

<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">IndexError: row index out of range</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">IndexError: row index out of range</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.saturation">
<span class="sig-name descname"><span class="pre">saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.saturation" title="Permalink to this definition">#</a></dt>
<dd><p>Return a saturation matrix of self, which is a matrix whose rows
span the saturation of the row span of self. This is not unique.</p>
<p>The saturation of a <span class="math notranslate nohighlight">\(\ZZ\)</span> module <span class="math notranslate nohighlight">\(M\)</span>
embedded in <span class="math notranslate nohighlight">\(\ZZ^n\)</span> is a module <span class="math notranslate nohighlight">\(S\)</span> that
contains <span class="math notranslate nohighlight">\(M\)</span> with finite index such that
<span class="math notranslate nohighlight">\(\ZZ^n/S\)</span> is torsion free. This function takes the
row span <span class="math notranslate nohighlight">\(M\)</span> of self, and finds another matrix of full rank
with row span the saturation of <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> - (default: 0); if nonzero given, saturate
only at the prime <span class="math notranslate nohighlight">\(p\)</span>, i.e., return a matrix whose row span
is a <span class="math notranslate nohighlight">\(\ZZ\)</span>-module <span class="math notranslate nohighlight">\(S\)</span> that contains self and
such that the index of <span class="math notranslate nohighlight">\(S\)</span> in its saturation is coprime to
<span class="math notranslate nohighlight">\(p\)</span>. If <span class="math notranslate nohighlight">\(p\)</span> is None, return full saturation of
self.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - (default: use proof.linear_algebra());
if False, the determinant calculations are done with proof=False.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_dets</span></code> - (default: 5); technical parameter -
max number of determinant to compute when bounding prime divisor of
self in its saturation.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">matrix</span></code> - a matrix over ZZ</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The result is <em>not</em> cached.</p>
</div>
<p>ALGORITHM: 1. Replace input by a matrix of full rank got from a
subset of the rows. 2. Divide out any common factors from rows. 3.
Check max_dets random dets of submatrices to see if their GCD
(with p) is 1 - if so matrix is saturated and we’re done. 4.
Finally, use that if A is a matrix of full rank, then
<span class="math notranslate nohighlight">\(hnf(transpose(A))^{-1}*A\)</span> is a saturation of A.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">51</span><span class="p">,</span> <span class="o">-</span><span class="mi">1509</span><span class="p">,</span> <span class="o">-</span><span class="mi">71</span><span class="p">,</span> <span class="o">-</span><span class="mi">109</span><span class="p">,</span> <span class="o">-</span><span class="mi">593</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="o">-</span><span class="mi">341</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">246</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">217</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[      1       5    2262   20364   56576]</span>
<span class="go">[      0       6   35653  320873  891313]</span>
<span class="go">[      0       0   42993  386937 1074825]</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">();</span> <span class="n">S</span>
<span class="go">[  -51 -1509   -71  -109  -593]</span>
<span class="go">[  -19  -341     4    86    98]</span>
<span class="go">[   35   994    43    51   347]</span>
</pre></div>
</div>
<p>Notice that the saturation spans a different module than A.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 1  2  0  8 32]</span>
<span class="go">[ 0  3  0 -2 -6]</span>
<span class="go">[ 0  0  1  9 25]</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">row_space</span><span class="p">();</span> <span class="n">W</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">85986</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">index_in_saturation</span><span class="p">()</span>
<span class="go">85986</span>
</pre></div>
</div>
<p>We illustrate each option:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">saturation</span><span class="p">(</span><span class="n">max_dets</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form">
<span class="sig-name descname"><span class="pre">smith_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return the smith normal form of this matrix, that is the diagonal
matrix <span class="math notranslate nohighlight">\(S\)</span> with diagonal entries the ordered elementary divisors of
this matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether to
return the transformation matrices <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> such that <span class="math notranslate nohighlight">\(S=U\cdot
self\cdot V\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">integral</span></code> – a subring of the base ring or <code class="docutils literal notranslate"><span class="pre">True</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>); ignored for matrices with integer entries.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">elementary_divisors()</span></code></a> function, which returns the diagonal
entries of <span class="math notranslate nohighlight">\(S\)</span>, is VASTLY faster than this function.</p>
</div>
<p>The elementary divisors are the invariants of the finite abelian
group that is the cokernel of this matrix. They are ordered in
reverse by divisibility.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">IntegerRing</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 3 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[ 0  2 -1]</span>
<span class="go">[ 0 -1  1]</span>
<span class="go">[ 1 -2  1]</span>
<span class="gp">sage: </span><span class="n">V</span>
<span class="go">[ 0  0  1]</span>
<span class="go">[-1  2 -2]</span>
<span class="go">[ 1 -1  1]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">V</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 3 0]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>It also makes sense for nonsquare matrices:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="go">[0 0]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[ 0  2 -1]</span>
<span class="go">[ 0 -1  1]</span>
<span class="go">[ 1 -2  1]</span>
<span class="gp">sage: </span><span class="n">V</span>
<span class="go">[-1  1]</span>
<span class="go">[ 1  0]</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">V</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="go">[0 0]</span>
</pre></div>
</div>
<p>Empty matrices are handled sensibly (see <a class="reference external" href="https://github.com/sagemath/sage/issues/3068">github issue #3068</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">elementary_divisors()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.symplectic_form">
<span class="sig-name descname"><span class="pre">symplectic_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.symplectic_form" title="Permalink to this definition">#</a></dt>
<dd><p>Find a symplectic basis for <code class="docutils literal notranslate"><span class="pre">self</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is an anti-symmetric,
alternating matrix.</p>
<p>Return a pair (F, C) such that the rows of C form a symplectic
basis for <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">F</span> <span class="pre">=</span> <span class="pre">C</span> <span class="pre">*</span> <span class="pre">self</span> <span class="pre">*</span> <span class="pre">C.transpose()</span></code>.</p>
<p>Raise a <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></a> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is not anti-symmetric,
or <code class="docutils literal notranslate"><span class="pre">self</span></code> is not alternating.</p>
<p>Anti-symmetric means that <span class="math notranslate nohighlight">\(M = -M^t\)</span>. Alternating means
that the diagonal of <span class="math notranslate nohighlight">\(M\)</span> is identically zero.</p>
<p>A symplectic basis is a basis of the form
<span class="math notranslate nohighlight">\(e_1, \ldots, e_j, f_1, \ldots f_j, z_1, \dots, z_k\)</span>
such that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z_i M v^t = 0\)</span> for all vectors <span class="math notranslate nohighlight">\(v\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(e_i M {e_j}^t = 0\)</span> for all <span class="math notranslate nohighlight">\(i, j\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_i M {f_j}^t = 0\)</span> for all <span class="math notranslate nohighlight">\(i, j\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(e_i M {f_i}^t = 1\)</span> for all <span class="math notranslate nohighlight">\(i\)</span></p></li>
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(e_i M {f_j}^t = 0\)</span> for all <span class="math notranslate nohighlight">\(i\)</span> not equal</dt><dd><p><span class="math notranslate nohighlight">\(j\)</span>.</p>
</dd>
</dl>
</li>
</ul>
<p>The ordering for the factors <span class="math notranslate nohighlight">\(d_{i} | d_{i+1}\)</span> and for
the placement of zeroes was chosen to agree with the output of
<a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form" title="sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smith_form()</span></code></a>.</p>
<p>See the example for a pictorial description of such a basis.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">[  0  14   0  -8  -2]</span>
<span class="go">[-14   0  -3 -11   4]</span>
<span class="go">[  0   3   0   0   0]</span>
<span class="go">[  8  11   0   0   8]</span>
<span class="go">[  2  -4   0  -8   0]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">symplectic_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">[ 0  0  1  0  0]</span>
<span class="go">[ 0  0  0  2  0]</span>
<span class="go">[-1  0  0  0  0]</span>
<span class="go">[ 0 -2  0  0  0]</span>
<span class="go">[ 0  0  0  0  0]</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">==</span> <span class="n">C</span> <span class="o">*</span> <span class="n">E</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[1 0 0 0 0]</span>
<span class="go">[0 1 0 0 0]</span>
<span class="go">[0 0 2 0 0]</span>
<span class="go">[0 0 0 2 0]</span>
<span class="go">[0 0 0 0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.matrix.matrix_integer_dense.Matrix_integer_dense.transpose">
<span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.transpose" title="Permalink to this definition">#</a></dt>
<dd><p>Return the transpose of self, without changing self.</p>
<p>EXAMPLES:</p>
<p>We create a matrix, compute its transpose, and note that the
original matrix is not changed.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.matrix.matrix_integer_dense.Matrix_integer_dense&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[0 3]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.T</span></code> is a convenient shortcut for the transpose:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">T</span>
<span class="go">[0 3]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">A</span>
<span class="go">[0|1 2]</span>
<span class="go">[3|4 5]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">[0 3]</span>
<span class="go">[---]</span>
<span class="go">[1 4]</span>
<span class="go">[2 5]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="matrix_integer_sparse.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Sparse integer matrices</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="matrix_generic_sparse.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Sparse Matrices over a general ring</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Dense matrices over the integer ring</a><ul>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense"><code class="docutils literal notranslate"><span class="pre">Matrix_integer_dense</span></code></a><ul>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.BKZ"><code class="docutils literal notranslate"><span class="pre">BKZ()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL"><code class="docutils literal notranslate"><span class="pre">LLL()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.antitranspose"><code class="docutils literal notranslate"><span class="pre">antitranspose()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.augment"><code class="docutils literal notranslate"><span class="pre">augment()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly"><code class="docutils literal notranslate"><span class="pre">charpoly()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.column"><code class="docutils literal notranslate"><span class="pre">column()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.decomposition"><code class="docutils literal notranslate"><span class="pre">decomposition()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.determinant"><code class="docutils literal notranslate"><span class="pre">determinant()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.echelon_form"><code class="docutils literal notranslate"><span class="pre">echelon_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.elementary_divisors"><code class="docutils literal notranslate"><span class="pre">elementary_divisors()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.frobenius"><code class="docutils literal notranslate"><span class="pre">frobenius()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.gcd"><code class="docutils literal notranslate"><span class="pre">gcd()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.height"><code class="docutils literal notranslate"><span class="pre">height()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.hermite_form"><code class="docutils literal notranslate"><span class="pre">hermite_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.index_in_saturation"><code class="docutils literal notranslate"><span class="pre">index_in_saturation()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.insert_row"><code class="docutils literal notranslate"><span class="pre">insert_row()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.integer_valued_polynomials_generators"><code class="docutils literal notranslate"><span class="pre">integer_valued_polynomials_generators()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.inverse_of_unit"><code class="docutils literal notranslate"><span class="pre">inverse_of_unit()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_LLL_reduced"><code class="docutils literal notranslate"><span class="pre">is_LLL_reduced()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_one"><code class="docutils literal notranslate"><span class="pre">is_one()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.is_primitive"><code class="docutils literal notranslate"><span class="pre">is_primitive()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.minpoly"><code class="docutils literal notranslate"><span class="pre">minpoly()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.null_ideal"><code class="docutils literal notranslate"><span class="pre">null_ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.p_minimal_polynomials"><code class="docutils literal notranslate"><span class="pre">p_minimal_polynomials()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.pivots"><code class="docutils literal notranslate"><span class="pre">pivots()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.prod_of_row_sums"><code class="docutils literal notranslate"><span class="pre">prod_of_row_sums()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.randomize"><code class="docutils literal notranslate"><span class="pre">randomize()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.rank"><code class="docutils literal notranslate"><span class="pre">rank()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.rational_reconstruction"><code class="docutils literal notranslate"><span class="pre">rational_reconstruction()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.row"><code class="docutils literal notranslate"><span class="pre">row()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.saturation"><code class="docutils literal notranslate"><span class="pre">saturation()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.smith_form"><code class="docutils literal notranslate"><span class="pre">smith_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.symplectic_form"><code class="docutils literal notranslate"><span class="pre">symplectic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.matrix.matrix_integer_dense.Matrix_integer_dense.transpose"><code class="docutils literal notranslate"><span class="pre">transpose()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>