
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Power Series &#8212; Sage Reference Manual v8.7: Power Series Rings</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Power Series Methods" href="power_series_poly.html" />
    <link rel="prev" title="Power Series Rings" href="power_series_ring.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="power_series_poly.html" title="Power Series Methods"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="power_series_ring.html" title="Power Series Rings"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Power Series Rings</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="power-series">
<span id="sage-rings-power-series-ring-element"></span><h1>Power Series<a class="headerlink" href="#power-series" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.rings.power_series_ring_element"></span><p>Sage provides an implementation of dense and sparse power series
over any Sage base ring. This is the base class of the implementations
of univariate and multivariate power series ring elements in Sage
(see also <a class="reference internal" href="power_series_poly.html"><span class="doc">Power Series Methods</span></a>, <a class="reference internal" href="multi_power_series_ring_element.html"><span class="doc">Multivariate Power Series</span></a>).</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein</li>
<li>David Harvey (2006-09-11): added solve_linear_de() method</li>
<li>Robert Bradshaw (2007-04): sqrt, rmul, lmul, shifting</li>
<li>Robert Bradshaw (2007-04): Cython version</li>
<li>Simon King (2012-08): use category and coercion framework, <a class="reference external" href="https://trac.sagemath.org/13412">trac ticket #13412</a></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">1 + 2*x + 3*x^2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">1 + 2*x + 3*x^2 + O(x^10)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="p">);</span> <span class="n">f</span>
<span class="go">1 + 2*x - 3*x^3 + O(x^4)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">^</span><span class="mi">10</span>
<span class="go">1 + 20*x + 180*x^2 + 930*x^3 + O(x^4)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">f</span><span class="p">;</span> <span class="n">g</span>
<span class="go">1 - 2*x + 4*x^2 - 5*x^3 + O(x^4)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">*</span> <span class="n">f</span>
<span class="go">1 + O(x^4)</span>
</pre></div>
</div>
<p>In Python (as opposed to Sage) create the power series ring and
its generator as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Power Series Ring in x over Integer Ring</span>
</pre></div>
</div>
<p>EXAMPLES:</p>
<p>This example illustrates that coercion for power
series rings is consistent with coercion for polynomial rings.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">poly_ring1</span><span class="o">.&lt;</span><span class="n">gen1</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">poly_ring2</span><span class="o">.&lt;</span><span class="n">gen2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">huge_ring</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">poly_ring1</span><span class="p">)</span>
</pre></div>
</div>
<p>The generator of the first ring gets coerced in as itself, since it
is the base ring.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">huge_ring</span><span class="p">(</span><span class="n">gen1</span><span class="p">)</span>
<span class="go">gen1</span>
</pre></div>
</div>
<p>The generator of the second ring gets mapped via the natural map
sending one generator to the other.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">huge_ring</span><span class="p">(</span><span class="n">gen2</span><span class="p">)</span>
<span class="go">x</span>
</pre></div>
</div>
<p>With power series the behavior is the same.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">power_ring1</span><span class="o">.&lt;</span><span class="n">gen1</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">power_ring2</span><span class="o">.&lt;</span><span class="n">gen2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">huge_power_ring</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">power_ring1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">huge_power_ring</span><span class="p">(</span><span class="n">gen1</span><span class="p">)</span>
<span class="go">gen1</span>
<span class="gp">sage: </span><span class="n">huge_power_ring</span><span class="p">(</span><span class="n">gen2</span><span class="p">)</span>
<span class="go">x</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.rings.power_series_ring_element.PowerSeries">
<em class="property">class </em><code class="descclassname">sage.rings.power_series_ring_element.</code><code class="descname">PowerSeries</code><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.AlgebraElement" title="(in Sage Reference Manual: Parents and Elements v8.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.element.AlgebraElement</span></code></a></p>
<p>A power series. Base class of univariate and
multivariate power series. The following methods
are available with both types of objects.</p>
<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.O">
<code class="descname">O</code><span class="sig-paren">(</span><em>prec</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.O" title="Permalink to this definition">¶</a></dt>
<dd><p>Return this series plus <span class="math notranslate nohighlight">\(O(x^\text{prec})\)</span>. Does not change
self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span><span class="p">;</span> <span class="n">p</span>
<span class="go">1 + x^2 + x^10</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">O</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">1 + x^2 + x^10 + O(x^15)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">O</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + x^2 + O(x^5)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">O</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">prec (= -5) must be non-negative</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.V">
<code class="descname">V</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.V" title="Permalink to this definition">¶</a></dt>
<dd><p>If <span class="math notranslate nohighlight">\(f = \sum a_m x^m\)</span>, then this function returns
<span class="math notranslate nohighlight">\(\sum a_m x^{nm}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span><span class="p">;</span> <span class="n">p</span>
<span class="go">1 + x^2 + x^10</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 + x^6 + x^30</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 + x^6 + x^30 + O(x^60)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.add_bigoh">
<code class="descname">add_bigoh</code><span class="sig-paren">(</span><em>prec</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.add_bigoh" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the power series of precision at most <code class="docutils literal notranslate"><span class="pre">prec</span></code> got by adding
<span class="math notranslate nohighlight">\(O(q^\text{prec})\)</span> to <span class="math notranslate nohighlight">\(f\)</span>, where <span class="math notranslate nohighlight">\(q\)</span> is the variable.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">[[]]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">A</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="n">A</span><span class="o">^</span><span class="mi">5</span><span class="p">))</span><span class="o">^</span><span class="mi">5</span><span class="p">;</span> <span class="n">f</span>
<span class="go">1.0 + 5.0*A + 10.0*A^2 + 10.0*A^3 + 5.0*A^4 + O(A^5)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1.0 + 5.0*A + 10.0*A^2 + O(A^3)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1.0 + 5.0*A + 10.0*A^2 + 10.0*A^3 + 5.0*A^4 + O(A^5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.base_extend">
<code class="descname">base_extend</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.base_extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of this power series but with coefficients in R.</p>
<p>The following coercion uses <code class="docutils literal notranslate"><span class="pre">base_extend</span></code> implicitly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[[</span><span class="s1">&#39;t&#39;</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Mod</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">t + 2*t^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.base_ring">
<code class="descname">base_ring</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.base_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the base ring that this power series is defined over.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">49</span><span class="p">,</span><span class="s1">&#39;alpha&#39;</span><span class="p">)[[]]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Finite Field in alpha of size 7^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.change_ring">
<code class="descname">change_ring</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.change_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Change if possible the coefficients of self to lie in R.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[[]];</span> <span class="n">R</span>
<span class="go">Power Series Ring in T over Rational Field</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">T</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">T</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">no base extension defined</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1 + 2*T + 2*T^2 + O(T^3)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">inverse of Mod(0, 3) does not exist</span>
</pre></div>
</div>
<p>We can only change the ring if there is a <code class="docutils literal notranslate"><span class="pre">__call__</span></code> coercion
defined. The following succeeds because <code class="docutils literal notranslate"><span class="pre">ZZ(K(4))</span></code> is defined.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">cyclotomic_polynomial</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[[</span><span class="s1">&#39;t&#39;</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">4*t</span>
</pre></div>
</div>
<p>This does not succeed because <code class="docutils literal notranslate"><span class="pre">ZZ(K(a+1))</span></code> is not defined.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">cyclotomic_polynomial</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[[</span><span class="s1">&#39;t&#39;</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="p">((</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Unable to coerce a + 1 to an integer</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.coefficients">
<code class="descname">coefficients</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the nonzero coefficients of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">coefficients</span><span class="p">()</span>
<span class="go">[1, 1, -10/3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.common_prec">
<code class="descname">common_prec</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.common_prec" title="Permalink to this definition">¶</a></dt>
<dd><p>Return minimum precision of <span class="math notranslate nohighlight">\(f\)</span> and <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">common_prec</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">common_prec</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">common_prec</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">common_prec</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">common_prec</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.cos">
<code class="descname">cos</code><span class="sig-paren">(</span><em>prec='infinity'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.cos" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply cos to the formal power series.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> – Integer or <code class="docutils literal notranslate"><span class="pre">infinity</span></code>. The degree to truncate
the result to.</li>
</ul>
<p>OUTPUT:</p>
<p>A new power series.</p>
<p>EXAMPLES:</p>
<p>For one variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">O</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1 - 1/2*t^2 - t^3 + O(t^4)</span>
</pre></div>
</div>
<p>For several variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">T</span><span class="o">.</span><span class="n">O</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1 - 1/2*a^2 - a*b - 1/2*b^2 + O(a, b)^3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cos</span><span class="p">()</span>
<span class="go">1 - 1/2*a^2 - a*b - 1/2*b^2 + O(a, b)^3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1 + O(a, b)^2</span>
</pre></div>
</div>
<p>If the power series has a non-zero constant coefficient <span class="math notranslate nohighlight">\(c\)</span>,
one raises an error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">2</span><span class="o">+</span><span class="n">f</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Can only apply cos to formal power series with zero constant term.</span>
</pre></div>
</div>
<p>If no precision is specified, the default precision is used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">default_prec</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">1 - 1/2*a^2 + 1/24*a^4 - 1/720*a^6 + 1/40320*a^8 - 1/3628800*a^10 + O(a, b)^12</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 - 1/2*a^2 + 1/24*a^4 + O(a, b)^5</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">T</span><span class="o">.</span><span class="n">O</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1 - 1/2*a^2 + 1/24*a^4 + O(a, b)^5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.degree">
<code class="descname">degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of this power series, which is by definition the
degree of the underlying polynomial.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span><span class="o">^</span><span class="mi">100000</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">10000000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">100000</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.derivative">
<code class="descname">derivative</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>The formal derivative of this power series, with respect to
variables supplied in args.</p>
<p>Multiple variables and iteration counts may be supplied; see
documentation for the global derivative() function for more
details.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_derivative()</span></code></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">-1 + x - 4*x^3 + O(x^5)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">-1 + x - 4*x^3 + O(x^5)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">1 - 12*x^2 + O(x^4)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">1 - 12*x^2 + O(x^4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.egf_to_ogf">
<code class="descname">egf_to_ogf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.egf_to_ogf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ordinary generating function power series,
assuming self is an exponential generating function power series.</p>
<p>This function is known as <code class="docutils literal notranslate"><span class="pre">serlaplace</span></code> in PARI/GP.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">egf_to_ogf</span><span class="p">()</span>
<span class="go">t + t^2 + 2*t^3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.exp">
<code class="descname">exp</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return exp of this power series to the indicated precision.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> - integer; default is
<code class="docutils literal notranslate"><span class="pre">self.parent().default_prec</span></code></li>
</ul>
<p>ALGORITHM: See <a class="reference internal" href="#sage.rings.power_series_ring_element.PowerSeries.solve_linear_de" title="sage.rings.power_series_ring_element.PowerSeries.solve_linear_de"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve_linear_de()</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Screwy things can happen if the coefficient ring is not a
field of characteristic zero. See <a class="reference internal" href="#sage.rings.power_series_ring_element.PowerSeries.solve_linear_de" title="sage.rings.power_series_ring_element.PowerSeries.solve_linear_de"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve_linear_de()</span></code></a>.</li>
</ul>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-09-08): rewrote to use simplest possible “lazy” algorithm.</li>
<li>David Harvey (2006-09-10): rewrote to use divide-and-conquer
strategy.</li>
<li>David Harvey (2006-09-11): factored functionality out to
solve_linear_de().</li>
<li>Sourav Sen Gupta, David Harvey (2008-11): handle constant
term</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Check that <span class="math notranslate nohighlight">\(\exp(t)\)</span> is, well, <span class="math notranslate nohighlight">\(\exp(t)\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + t + 1/2*t^2 + 1/6*t^3 + 1/24*t^4 + 1/120*t^5 + 1/720*t^6 + 1/5040*t^7 + 1/40320*t^8 + 1/362880*t^9 + O(t^10)</span>
</pre></div>
</div>
<p>Check that <span class="math notranslate nohighlight">\(\exp(\log(1+t))\)</span> is <span class="math notranslate nohighlight">\(1+t\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="n">n</span><span class="o">/</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)])</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + t + O(t^10)</span>
</pre></div>
</div>
<p>Check that <span class="math notranslate nohighlight">\(\exp(2t + t^2 - t^5)\)</span> is whatever it is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + 2*t + 3*t^2 + 10/3*t^3 + 19/6*t^4 + 8/5*t^5 - 7/90*t^6 - 538/315*t^7 - 425/168*t^8 - 30629/11340*t^9 + O(t^10)</span>
</pre></div>
</div>
<p>Check requesting lower precision:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + t + 3/2*t^2 + 7/6*t^3 + 25/24*t^4 + O(t^5)</span>
</pre></div>
</div>
<p>Can’t get more precision than the input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1 + t + 3/2*t^2 + O(t^3)</span>
</pre></div>
</div>
<p>Check some boundary cases:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1 + O(t)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">O(t^0)</span>
</pre></div>
</div>
<p>Handle nonzero constant term (fixes <a class="reference external" href="https://trac.sagemath.org/4477">trac ticket #4477</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">2.71828182845905 + 2.71828182845905*x + 4.07742274268857*x^2 + O(x^3)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">exponential of constant term does not belong to coefficient ring (consider working in a larger ring)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">constant term of power series does not support exponentiation</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.exponents">
<code class="descname">exponents</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.exponents" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the exponents appearing in self with nonzero coefficients.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">exponents</span><span class="p">()</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.inverse">
<code class="descname">inverse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inverse of self, i.e., self^(-1).</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">t^-1</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.laurent_series_ring_element.LaurentSeries&#39;&gt;</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">1 + t + t^2 + t^3 + t^4 + t^5 + t^6 + t^7 + t^8 + ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.is_dense">
<code class="descname">is_dense</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.is_dense" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">is_dense</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">is_dense</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.is_gen">
<code class="descname">is_gen</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.is_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this is the generator (the variable) of the power
series ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[[]]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">is_gen</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">is_gen</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note that this only returns True on the actual generator, not on
something that happens to be equal to it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">is_gen</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mi">1</span><span class="o">*</span><span class="n">t</span> <span class="o">==</span> <span class="n">t</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.is_monomial">
<code class="descname">is_monomial</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.is_monomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this element is a monomial.  That is, if self is
<span class="math notranslate nohighlight">\(x^n\)</span> for some non-negative integer <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2909</span><span class="p">)</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2909</span><span class="p">)</span><span class="o">.</span><span class="n">is_monomial</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.is_sparse">
<code class="descname">is_sparse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.is_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">is_sparse</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">is_sparse</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.is_square">
<code class="descname">is_square</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.is_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this function has a square root in this ring, e.g.,
there is an element <span class="math notranslate nohighlight">\(y\)</span> in <code class="docutils literal notranslate"><span class="pre">self.parent()</span></code>
such that <span class="math notranslate nohighlight">\(y^2\)</span> equals <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>ALGORITHM: If the base ring is a field, this is true whenever the
power series has even valuation and the leading coefficient is a
perfect square.</p>
<p>For an integral domain, it attempts the square root in the
fraction field and tests whether or not the result lies in the
original ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RR</span><span class="p">))</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="mi">100</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.is_unit">
<code class="descname">is_unit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.is_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this power series is invertible.</p>
<p>A power series is invertible precisely when the
constant term is invertible.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_unit</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">t</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_unit</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-09-03)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.laurent_series">
<code class="descname">laurent_series</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.laurent_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Laurent series associated to this power series, i.e.,
this series considered as a Laurent series.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[[]]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="mi">17</span><span class="o">*</span><span class="n">w</span><span class="o">+</span><span class="mi">15</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Power Series Ring in w over Rational Field</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">laurent_series</span><span class="p">();</span> <span class="n">g</span>
<span class="go">1 + 17*w + 15*w^3 + O(w^5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.lift_to_precision">
<code class="descname">lift_to_precision</code><span class="sig-paren">(</span><em>absprec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.lift_to_precision" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a congruent power series with absolute precision at least
<code class="docutils literal notranslate"><span class="pre">absprec</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">absprec</span></code> – an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>), the
absolute precision of the result. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, lifts to an exact
element.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">lift_to_precision</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">t + t^2 + O(t^10)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">lift_to_precision</span><span class="p">()</span>
<span class="go">t + t^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.list">
<code class="descname">list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.list" title="Permalink to this definition">¶</a></dt>
<dd><p>See this method in derived classes:</p>
<ul class="simple">
<li><a class="reference internal" href="power_series_poly.html#sage.rings.power_series_poly.PowerSeries_poly.list" title="sage.rings.power_series_poly.PowerSeries_poly.list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.rings.power_series_poly.PowerSeries_poly.list()</span></code></a>,</li>
<li><a class="reference internal" href="multi_power_series_ring_element.html#sage.rings.multi_power_series_ring_element.MPowerSeries.list" title="sage.rings.multi_power_series_ring_element.MPowerSeries.list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.rings.multi_power_series_ring_element.MPowerSeries.list()</span></code></a></li>
</ul>
<p>Implementations <em>MUST</em> override this in the derived class.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sage: R.&lt;x&gt; = PowerSeriesRing(ZZ)
sage: PowerSeries.list(1+x^2)
Traceback (most recent call last):
...
NotImplementedError        
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.log">
<code class="descname">log</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Return log of this power series to the indicated precision.</p>
<p>This works only if the constant term of the power series is 1
or the base ring can take the logarithm of the constant coefficient.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> – integer; default is <code class="docutils literal notranslate"><span class="pre">self.parent().default_prec()</span></code></li>
</ul>
<p>ALGORITHM: See <a class="reference internal" href="#sage.rings.power_series_ring_element.PowerSeries.solve_linear_de" title="sage.rings.power_series_ring_element.PowerSeries.solve_linear_de"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve_linear_de()</span></code></a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Screwy things can happen if the coefficient ring is not a
field of characteristic zero. See <a class="reference internal" href="#sage.rings.power_series_ring_element.PowerSeries.solve_linear_de" title="sage.rings.power_series_ring_element.PowerSeries.solve_linear_de"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve_linear_de()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">t - 1/2*t^2 + 1/3*t^3 - 1/4*t^4 + 1/5*t^5 - 1/6*t^6 + 1/7*t^7 - 1/8*t^8 + 1/9*t^9 + O(t^10)</span>

<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">t + O(t^10)</span>

<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + t + O(t^10)</span>

<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">constant term of power series is not 1</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">2.00000000000000 + 1.00000000000000*t + O(t^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.nth_root">
<code class="descname">nth_root</code><span class="sig-paren">(</span><em>n</em>, <em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.nth_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">n</span></code>-th root of this power series.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer</li>
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> – integer (optional) - precision of the result. Though, if
this series has finite precision, then the result can not have larger
precision.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[[]]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + 1/5*x - 2/25*x^2 + ... + 12039376311816/2384185791015625*x^19 + O(x^20)</span>

<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + 1/5*x - 2/25*x^2 + 6/125*x^3 - 21/625*x^4 + O(x^5)</span>
</pre></div>
</div>
<p>Check that the results are consistent with taking log and exponential:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">200</span>
<span class="gp">sage: </span><span class="n">p1</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p1</span><span class="o">.</span><span class="n">prec</span><span class="p">()</span> <span class="o">==</span> <span class="n">p2</span><span class="o">.</span><span class="n">prec</span><span class="p">()</span> <span class="o">==</span> <span class="mi">100</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p1</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span> <span class="o">==</span> <span class="n">p2</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Positive characteristic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)[[]]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1 + 2*u^2 + u^6 + 2*u^8 + u^12 + 2*u^14 + O(u^20)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>
<span class="go">1 + 2*u^2 + O(u^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.ogf_to_egf">
<code class="descname">ogf_to_egf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.ogf_to_egf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the exponential generating function power series,
assuming self is an ordinary generating function power series.</p>
<p>This can also be computed as <code class="docutils literal notranslate"><span class="pre">serconvol(f,exp(t))</span></code> in PARI/GP.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">ogf_to_egf</span><span class="p">()</span>
<span class="go">t + 1/2*t^2 + 1/3*t^3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.padded_list">
<code class="descname">padded_list</code><span class="sig-paren">(</span><em>n=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.padded_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of coefficients of self up to (but not including)
<span class="math notranslate nohighlight">\(q^n\)</span>.</p>
<p>Includes 0’s in the list on the right so that the list has length
<span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> - (optional) an integer that is at least 0. If <code class="docutils literal notranslate"><span class="pre">n</span></code> is
not given, it will be taken to be the precision of self,
unless this is <code class="docutils literal notranslate"><span class="pre">+Infinity</span></code>, in which case we just return
<code class="docutils literal notranslate"><span class="pre">self.list()</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">q</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">17</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="mi">13</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[1, -17, 13, 0, 10]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">padded_list</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[1, -17, 13, 0, 10, 0, 0]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">padded_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[1, -17, 13, 0, 10, 0, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">padded_list</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[1, -17, 13]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">padded_list</span><span class="p">()</span>
<span class="go">[1, -17, 13, 0, 10, 0, 0]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">17</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="mi">13</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[1, -17, 13, 0, 10]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">padded_list</span><span class="p">()</span>
<span class="go">[1, -17, 13, 0, 10]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">padded_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[1, -17, 13, 0, 10, 0, 0, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.polynomial">
<code class="descname">polynomial</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>See this method in derived classes:</p>
<ul class="simple">
<li><a class="reference internal" href="power_series_poly.html#sage.rings.power_series_poly.PowerSeries_poly.polynomial" title="sage.rings.power_series_poly.PowerSeries_poly.polynomial"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.rings.power_series_poly.PowerSeries_poly.polynomial()</span></code></a>,</li>
<li><a class="reference internal" href="multi_power_series_ring_element.html#sage.rings.multi_power_series_ring_element.MPowerSeries.polynomial" title="sage.rings.multi_power_series_ring_element.MPowerSeries.polynomial"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.rings.multi_power_series_ring_element.MPowerSeries.polynomial()</span></code></a></li>
</ul>
<p>Implementations <em>MUST</em> override this in the derived class.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sage: R.&lt;x&gt; = PowerSeriesRing(ZZ)
sage: PowerSeries.polynomial(1+x^2)
Traceback (most recent call last):
...
NotImplementedError        
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.prec">
<code class="descname">prec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.prec" title="Permalink to this definition">¶</a></dt>
<dd><p>The precision of <span class="math notranslate nohighlight">\(...+O(x^r)\)</span> is by definition
<span class="math notranslate nohighlight">\(r\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[[]]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">prec</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">prec</span><span class="p">()</span>
<span class="go">100</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.precision_absolute">
<code class="descname">precision_absolute</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.precision_absolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the absolute precision of this series.</p>
<p>By definition, the absolute precision of
<span class="math notranslate nohighlight">\(...+O(x^r)\)</span> is <span class="math notranslate nohighlight">\(r\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[[]]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">100</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.precision_relative">
<code class="descname">precision_relative</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.precision_relative" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the relative precision of this series, that
is the difference between its absolute precision
and its valuation.</p>
<p>By convention, the relative precision of <span class="math notranslate nohighlight">\(0\)</span> (or
<span class="math notranslate nohighlight">\(O(x^r)\)</span> for any <span class="math notranslate nohighlight">\(r\)</span>) is <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[[]]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">precision_relative</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">precision_relative</span><span class="p">()</span>
<span class="go">100</span>
<span class="gp">sage: </span><span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">precision_relative</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.shift">
<code class="descname">shift</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Return this power series multiplied by the power <span class="math notranslate nohighlight">\(t^n\)</span>. If
<span class="math notranslate nohighlight">\(n\)</span> is negative, terms below <span class="math notranslate nohighlight">\(t^n\)</span> will be
discarded. Does not change this power series.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Despite the fact that higher order terms are printed to the
right in a power series, right shifting decreases the
powers of <span class="math notranslate nohighlight">\(t\)</span>, while left shifting increases
them. This is to be consistent with polynomials, integers,
etc.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="p">);</span> <span class="n">f</span>
<span class="go">1 - t + t^2 - t^3 + t^4 + O(t^5)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">t^3 - t^4 + t^5 - t^6 + t^7 + O(t^8)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span>
<span class="go">1 - t + t^2 + O(t^3)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span>
<span class="go">t^10 - t^11 + t^12 - t^13 + t^14 + O(t^15)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">&lt;&lt;</span> <span class="mi">29</span>
<span class="go">t^30</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Robert Bradshaw (2007-04-18)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.sin">
<code class="descname">sin</code><span class="sig-paren">(</span><em>prec='infinity'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.sin" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply sin to the formal power series.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> – Integer or <code class="docutils literal notranslate"><span class="pre">infinity</span></code>. The degree to truncate
the result to.</li>
</ul>
<p>OUTPUT:</p>
<p>A new power series.</p>
<p>EXAMPLES:</p>
<p>For one variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">O</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">t + t^2 - 1/6*t^3 + O(t^4)</span>
</pre></div>
</div>
<p>For several variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">T</span><span class="o">.</span><span class="n">O</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">a + b + a*b + O(a, b)^3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span>
<span class="go">a + b + a*b + O(a, b)^3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">a + b + O(a, b)^2</span>
</pre></div>
</div>
<p>If the power series has a non-zero constant coefficient <span class="math notranslate nohighlight">\(c\)</span>,
one raises an error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">2</span><span class="o">+</span><span class="n">f</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Can only apply sin to formal power series with zero constant term.</span>
</pre></div>
</div>
<p>If no precision is specified, the default precision is used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">default_prec</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">a - 1/6*a^3 + 1/120*a^5 - 1/5040*a^7 + 1/362880*a^9 - 1/39916800*a^11 + O(a, b)^12</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">a - 1/6*a^3 + O(a, b)^5</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">T</span><span class="o">.</span><span class="n">O</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">a - 1/6*a^3 + O(a, b)^5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.solve_linear_de">
<code class="descname">solve_linear_de</code><span class="sig-paren">(</span><em>prec='infinity'</em>, <em>b=None</em>, <em>f0=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.solve_linear_de" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain a power series solution to an inhomogeneous linear
differential equation of the form:</p>
<div class="math notranslate nohighlight">
\[f'(t) = a(t) f(t) + b(t).\]</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - the power series <span class="math notranslate nohighlight">\(a(t)\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">b</span></code> - the power series <span class="math notranslate nohighlight">\(b(t)\)</span> (default is
zero)</li>
<li><code class="docutils literal notranslate"><span class="pre">f0</span></code> - the constant term of <span class="math notranslate nohighlight">\(f\)</span> (“initial
condition”) (default is 1)</li>
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> - desired precision of result (this will be
reduced if either a or b have less precision available)</li>
</ul>
<p>OUTPUT: the power series <span class="math notranslate nohighlight">\(f\)</span>, to indicated precision</p>
<p>ALGORITHM: A divide-and-conquer strategy; see the source code.
Running time is approximately <span class="math notranslate nohighlight">\(M(n) \log n\)</span>, where
<span class="math notranslate nohighlight">\(M(n)\)</span> is the time required for a polynomial multiplication
of length <span class="math notranslate nohighlight">\(n\)</span> over the coefficient ring. (If you’re working
over something like <span class="math notranslate nohighlight">\(\QQ\)</span>, running time analysis can be a
little complicated because the coefficients tend to explode.)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>If the coefficient ring is a field of characteristic
zero, then the solution will exist and is unique.</li>
<li>For other coefficient rings, things are more
complicated. A solution may not exist, and if it does it
may not be unique. Generally, by the time the nth term
has been computed, the algorithm will have attempted
divisions by <span class="math notranslate nohighlight">\(n!\)</span> in the coefficient ring. So if
your coefficient ring has enough ‘precision’, and if your
coefficient ring can perform divisions even when the
answer is not unique, and if you know in advance that a
solution exists, then this function will find a solution
(otherwise it will probably crash).</li>
</ul>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-09-11): factored functionality out from
exp() function, cleaned up precision tests a bit</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">solve_linear_de</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">f0</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go"> 3/5 + 21/5*t + 33/10*t^2 - 38/15*t^3 + 11/24*t^4 + O(t^5)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">f</span> <span class="o">-</span> <span class="n">b</span>
<span class="go"> O(t^4)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">solve_linear_de</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">f0</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">cannot solve differential equation to infinite precision</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">solve_linear_de</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">f0</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="go"> 3/5 + 21/5*t + 33/10*t^2 - 38/15*t^3 + 11/24*t^4 + O(t^5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.sqrt">
<code class="descname">sqrt</code><span class="sig-paren">(</span><em>prec=None</em>, <em>extend=False</em>, <em>all=False</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.sqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a square root of self.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> - integer (default: None): if not None and the series
has infinite precision, truncates series at precision
prec.</li>
<li><code class="docutils literal notranslate"><span class="pre">extend</span></code> - bool (default: False); if True, return a square
root in an extension ring, if necessary. Otherwise, raise
a ValueError if the square root is not in the base power series
ring. For example, if <code class="docutils literal notranslate"><span class="pre">extend</span></code> is True the square root of a
power series with odd degree leading coefficient is
defined as an element of a formal extension ring.</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> - string; if <code class="docutils literal notranslate"><span class="pre">extend</span></code> is True, you must also specify the print
name of the formal square root.</li>
<li><code class="docutils literal notranslate"><span class="pre">all</span></code> - bool (default: False); if True, return all square
roots of self, instead of just one.</li>
</ul>
</div></blockquote>
<p>ALGORITHM: Newton’s method</p>
<div class="math notranslate nohighlight">
\[x_{i+1} = \frac{1}{2}( x_i + \mathrm{self}/x_i )\]</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">t</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="p">)</span>
<span class="go">1 + 1/2*t - 1/8*t^2 + 1/16*t^3 - 5/128*t^4 + O(t^5)</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="p">)</span>
<span class="go">2 + 1/4*t - 1/64*t^2 + 1/512*t^3 - 5/16384*t^4 + O(t^5)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;alpha&#39;</span><span class="p">);</span> <span class="n">u</span>
<span class="go">alpha</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">^</span><span class="mi">2</span>
<span class="go">2 + t</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Quotient Polynomial Ring in alpha over Power Series Ring in t over Rational Field with modulus x^2 - 2 - t</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1 + t</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="go">t + t^3</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">1 + t + t^2 + 7*t^3 + O(t^50)</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">t</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">CDF</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">v</span>
<span class="go">[1.0*I - 0.5*I*t - 0.125*I*t^2 - 0.5625*I*t^3 - 0.2890625*I*t^4 + O(t^5),</span>
<span class="go"> -1.0*I + 0.5*I*t + 0.125*I*t^2 + 0.5625*I*t^3 + 0.2890625*I*t^4 + O(t^5)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
<span class="go">[-1.0 + 1.0*t + 0.0*t^2 + 1.0*t^3 + O(t^5), -1.0 + 1.0*t + 0.0*t^2 + 1.0*t^3 + O(t^5)]</span>
</pre></div>
</div>
<p>A formal square root:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sqrtf&#39;</span><span class="p">);</span> <span class="n">s</span>
<span class="go">sqrtf</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">^</span><span class="mi">2</span>
<span class="go">2*t + t^3 + O(t^4)</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">Univariate Quotient Polynomial Ring in sqrtf over Power Series Ring in t over Rational Field with modulus x^2 - 2*t - t^3 + O(t^4)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Robert Bradshaw</li>
<li>William Stein</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.square_root">
<code class="descname">square_root</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.square_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the square root of self in this ring. If this cannot be done
then an error will be raised.</p>
<p>This function succeeds if and only if
<code class="docutils literal notranslate"><span class="pre">self</span></code>. <a class="reference internal" href="#sage.rings.power_series_ring_element.PowerSeries.is_square" title="sage.rings.power_series_ring_element.PowerSeries.is_square"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_square()</span></code></a></p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + 1/2*t - 1/8*t^2 + 1/16*t^3 - 5/128*t^4 + O(t^5)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Square root does not live in this ring.</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RR</span><span class="p">))</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1.41421356237309 + 0.353553390593274*t - 0.0441941738241592*t^2 + 0.0110485434560398*t^3 - 0.00345266983001244*t^4 + O(t^5)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Square root not defined for power series of odd valuation.</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="mi">20</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + 10*t + 45*t^2 + 120*t^3 + 210*t^4 + O(t^5)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">t</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Square root does not live in this ring.</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Robert Bradshaw</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.truncate">
<code class="descname">truncate</code><span class="sig-paren">(</span><em>prec='infinity'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.truncate" title="Permalink to this definition">¶</a></dt>
<dd><p>The polynomial obtained from power series by truncation.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">I</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)[[]]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="n">I</span><span class="o">^</span><span class="mi">8</span><span class="p">));</span> <span class="n">f</span>
<span class="go">1 + I + I^2 + I^3 + I^4 + I^5 + I^6 + I^7 + O(I^8)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">I^4 + I^3 + I^2 + I + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.valuation">
<code class="descname">valuation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the valuation of this power series.</p>
<p>This is equal to the valuation of the underlying polynomial.</p>
<p>EXAMPLES:</p>
<p>Sparse examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">t</span><span class="o">^</span><span class="mi">100000</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">10000000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">100000</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>Dense examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">17</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">100</span> <span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">110</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">100</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.valuation_zero_part">
<code class="descname">valuation_zero_part</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.valuation_zero_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Factor self as <span class="math notranslate nohighlight">\(q^n \cdot (a_0 + a_1 q + \cdots)\)</span> with
<span class="math notranslate nohighlight">\(a_0\)</span> nonzero. Then this function returns
<span class="math notranslate nohighlight">\(a_0 + a_1 q + \cdots\)</span> .</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This valuation zero part need not be a unit if, e.g.,
<span class="math notranslate nohighlight">\(a_0\)</span> is not invertible in the base ring.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">17</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">valuation_zero_part</span><span class="p">()</span>
<span class="go">17/3 - 2/9*t^3</span>
</pre></div>
</div>
<p>In this example the valuation 0 part is not a unit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">17</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">valuation_zero_part</span><span class="p">();</span> <span class="n">u</span>
<span class="go">-34 + 2*t^3</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">is_unit</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.power_series_ring_element.PowerSeries.variable">
<code class="descname">variable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.PowerSeries.variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string with the name of the variable
of this power series.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">Rationals</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">variable</span><span class="p">()</span>
<span class="go">&#39;x&#39;</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-08-08)</li>
</ul>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.rings.power_series_ring_element.is_PowerSeries">
<code class="descclassname">sage.rings.power_series_ring_element.</code><code class="descname">is_PowerSeries</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.is_PowerSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if <code class="docutils literal notranslate"><span class="pre">x</span></code> is an instance of a univariate
or multivariate power series.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.power_series_ring_element</span> <span class="kn">import</span> <span class="n">is_PowerSeries</span>
<span class="gp">sage: </span><span class="n">is_PowerSeries</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_PowerSeries</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_PowerSeries</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">is_PowerSeries</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.power_series_ring_element.make_element_from_parent_v0">
<code class="descclassname">sage.rings.power_series_ring_element.</code><code class="descname">make_element_from_parent_v0</code><span class="sig-paren">(</span><em>parent</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.make_element_from_parent_v0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="sage.rings.power_series_ring_element.make_powerseries_poly_v0">
<code class="descclassname">sage.rings.power_series_ring_element.</code><code class="descname">make_powerseries_poly_v0</code><span class="sig-paren">(</span><em>parent</em>, <em>f</em>, <em>prec</em>, <em>is_gen</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.power_series_ring_element.make_powerseries_poly_v0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="power_series_ring.html"
                        title="previous chapter">Power Series Rings</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="power_series_poly.html"
                        title="next chapter">Power Series Methods</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/rings/power_series_ring_element.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="power_series_poly.html" title="Power Series Methods"
             >next</a> |</li>
        <li class="right" >
          <a href="power_series_ring.html" title="Power Series Rings"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Power Series Rings</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2019, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>