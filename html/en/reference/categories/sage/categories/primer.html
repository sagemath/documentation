<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Categories" href="category.html" /><link rel="prev" title="Sage categories quickref" href="all.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Elements, parents, and categories in Sage: a primer - Category Framework</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a078f75a" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Category Framework</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.3 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Category Framework</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="all.html">Sage categories quickref</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Elements, parents, and categories in Sage: a primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="category.html">Categories</a></li>
<li class="toctree-l1"><a class="reference internal" href="category_with_axiom.html">Axioms</a></li>
<li class="toctree-l1"><a class="reference internal" href="functor.html">Functors</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Implementing a new parent: a tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="map.html">Base class for maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="homset.html">Homsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="morphism.html">Morphisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="pushout.html">Coercion via construction functors</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="action.html">Group, ring, etc. actions on objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="additive_groups.html">Additive groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="additive_magmas.html">Additive magmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="additive_monoids.html">Additive monoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="additive_semigroups.html">Additive semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="affine_weyl_groups.html">Affine Weyl groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="algebra_ideals.html">Algebra ideals</a></li>
<li class="toctree-l1"><a class="reference internal" href="algebra_modules.html">Algebra modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="algebras.html">Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="algebras_with_basis.html">Algebras With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="aperiodic_semigroups.html">Aperiodic semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="associative_algebras.html">Associative algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="bialgebras.html">Bialgebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="bialgebras_with_basis.html">Bialgebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="bimodules.html">Bimodules</a></li>
<li class="toctree-l1"><a class="reference internal" href="classical_crystals.html">Classical Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="coalgebras.html">Coalgebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="coalgebras_with_basis.html">Coalgebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="commutative_additive_groups.html">Commutative additive groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="commutative_additive_monoids.html">Commutative additive monoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="commutative_additive_semigroups.html">Commutative additive semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="commutative_algebra_ideals.html">Commutative algebra ideals</a></li>
<li class="toctree-l1"><a class="reference internal" href="commutative_algebras.html">Commutative algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="commutative_ring_ideals.html">Commutative ring ideals</a></li>
<li class="toctree-l1"><a class="reference internal" href="commutative_rings.html">Commutative rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="complete_discrete_valuation.html">Complete Discrete Valuation Rings (CDVR) and Fields (CDVF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="complex_reflection_groups.html">Complex reflection groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="complex_reflection_or_generalized_coxeter_groups.html">Common category for Generalized Coxeter Groups or Complex Reflection Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="coxeter_group_algebras.html">Coxeter Group Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="coxeter_groups.html">Coxeter Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="crystals.html">Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="cw_complexes.html">CW Complexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="discrete_valuation.html">Discrete Valuation Rings (DVR) and Fields (DVF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributive_magmas_and_additive_magmas.html">Distributive Magmas and Additive Magmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="division_rings.html">Division rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="domains.html">Domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="enumerated_sets.html">Enumerated sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="euclidean_domains.html">Euclidean domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="fields.html">Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtered_algebras.html">Filtered Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtered_algebras_with_basis.html">Filtered Algebras With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtered_modules.html">Filtered Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtered_modules_with_basis.html">Filtered Modules With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_complex_reflection_groups.html">Finite Complex Reflection Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_coxeter_groups.html">Finite Coxeter Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_crystals.html">Finite Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_dimensional_algebras_with_basis.html">Finite dimensional algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_dimensional_bialgebras_with_basis.html">Finite dimensional bialgebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_dimensional_coalgebras_with_basis.html">Finite dimensional coalgebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_dimensional_graded_lie_algebras_with_basis.html">Finite Dimensional Graded Lie Algebras With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_dimensional_hopf_algebras_with_basis.html">Finite dimensional Hopf algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_dimensional_lie_algebras_with_basis.html">Finite Dimensional Lie Algebras With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_dimensional_modules_with_basis.html">Finite dimensional modules with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_dimensional_nilpotent_lie_algebras_with_basis.html">Finite Dimensional Nilpotent Lie Algebras With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_dimensional_semisimple_algebras_with_basis.html">Finite dimensional semisimple algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_enumerated_sets.html">Finite Enumerated Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_fields.html">Finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_groups.html">Finite groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_lattice_posets.html">Finite lattice posets</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_monoids.html">Finite monoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_permutation_groups.html">Finite Permutation Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_posets.html">Finite posets</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_semigroups.html">Finite semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_sets.html">Finite sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="finite_weyl_groups.html">Finite Weyl Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="finitely_generated_lambda_bracket_algebras.html">Finitely Generated Lambda bracket Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="finitely_generated_lie_conformal_algebras.html">Finitely Generated Lie Conformal Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="finitely_generated_magmas.html">Finitely generated magmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="finitely_generated_semigroups.html">Finitely generated semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="function_fields.html">Function fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_sets.html">G-Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="gcd_domains.html">Gcd domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="generalized_coxeter_groups.html">Generalized Coxeter Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_algebras.html">Graded Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_algebras_with_basis.html">Graded algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_bialgebras.html">Graded bialgebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_bialgebras_with_basis.html">Graded bialgebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_coalgebras.html">Graded Coalgebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_coalgebras_with_basis.html">Graded coalgebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_hopf_algebras.html">Graded Hopf algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_hopf_algebras_with_basis.html">Graded Hopf algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_lie_algebras.html">Graded Lie Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_lie_algebras_with_basis.html">Graded Lie Algebras With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_lie_conformal_algebras.html">Graded Lie Conformal Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_modules.html">Graded modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_modules_with_basis.html">Graded modules with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="graphs.html">Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_algebras.html">Group Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="groupoid.html">Groupoid</a></li>
<li class="toctree-l1"><a class="reference internal" href="groups.html">Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="hecke_modules.html">Hecke modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="highest_weight_crystals.html">Highest Weight Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="hopf_algebras.html">Hopf algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="hopf_algebras_with_basis.html">Hopf algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_trivial_semigroups.html">H-trivial semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="infinite_enumerated_sets.html">Infinite Enumerated Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="integral_domains.html">Integral domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="j_trivial_semigroups.html">J-trivial semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="kac_moody_algebras.html">Kac-Moody Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda_bracket_algebras.html">Lambda Bracket Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda_bracket_algebras_with_basis.html">Lambda Bracket Algebras With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lattice_posets.html">Lattice posets</a></li>
<li class="toctree-l1"><a class="reference internal" href="left_modules.html">Left modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="lie_algebras.html">Lie Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="lie_algebras_with_basis.html">Lie Algebras With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lie_conformal_algebras.html">Lie Conformal Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="lie_conformal_algebras_with_basis.html">Lie Conformal Algebras With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lie_groups.html">Lie Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="loop_crystals.html">Loop Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="l_trivial_semigroups.html">L-trivial semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="magmas.html">Magmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="magmas_and_additive_magmas.html">Magmas and Additive Magmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="magmatic_algebras.html">Non-unital non-associative algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="manifolds.html">Manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_algebras.html">Matrix algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="metric_spaces.html">Metric Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="modular_abelian_varieties.html">Modular abelian varieties</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules_with_basis.html">Modules With Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="monoid_algebras.html">Monoid algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="monoids.html">Monoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="number_fields.html">Number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects.html">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="partially_ordered_monoids.html">Partially ordered monoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="permutation_groups.html">Permutation groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="pointed_sets.html">Pointed sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="polyhedra.html">Polyhedral subsets of free ZZ, QQ or RR-modules.</a></li>
<li class="toctree-l1"><a class="reference internal" href="posets.html">Posets</a></li>
<li class="toctree-l1"><a class="reference internal" href="principal_ideal_domains.html">Principal ideal domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="quotient_fields.html">Quotient fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantum_group_representations.html">Quantum Group Representations</a></li>
<li class="toctree-l1"><a class="reference internal" href="regular_crystals.html">Regular Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="regular_supercrystals.html">Regular Supercrystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="right_modules.html">Right modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="ring_ideals.html">Ring ideals</a></li>
<li class="toctree-l1"><a class="reference internal" href="rings.html">Rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="rngs.html">Rngs</a></li>
<li class="toctree-l1"><a class="reference internal" href="r_trivial_semigroups.html">R-trivial semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="schemes.html">Schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="semigroups.html">Semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="semirings.html">Semirngs</a></li>
<li class="toctree-l1"><a class="reference internal" href="semisimple_algebras.html">Semisimple Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="sets_cat.html">Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="sets_with_grading.html">Sets With a Grading</a></li>
<li class="toctree-l1"><a class="reference internal" href="sets_with_partial_maps.html">SetsWithPartialMaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="shephard_groups.html">Shephard Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="simplicial_complexes.html">Simplicial Complexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="simplicial_sets.html">Simplicial Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="super_algebras.html">Super Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="super_algebras_with_basis.html">Super algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="super_hopf_algebras_with_basis.html">Super Hopf algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="super_lie_conformal_algebras.html">Super Lie Conformal Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="super_modules.html">Super modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="super_modules_with_basis.html">Super modules with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="supercommutative_algebras.html">Supercommutative Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="supercrystals.html">Supercrystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="topological_spaces.html">Topological Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="triangular_kac_moody_algebras.html">Kac-Moody Algebras With Triangular Decomposition Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="unique_factorization_domains.html">Unique factorization domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="unital_algebras.html">Unital algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector_bundles.html">Vector Bundles</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector_spaces.html">Vector Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="weyl_groups.html">Weyl Groups</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="facade_sets.html">Facade Sets</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="covariant_functorial_construction.html">Covariant Functorial Constructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cartesian_product.html">Cartesian Product Functorial Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensor.html">Tensor Product Functorial Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="signed_tensor.html">Signed Tensor Product Functorial Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dual.html">Dual functorial construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="algebra_functor.html">Group algebras and beyond: the Algebra functorial construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="subquotients.html">Subquotient Functorial Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quotients.html">Quotients Functorial Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="subobjects.html">Subobjects Functorial Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="isomorphic_objects.html">Isomorphic Objects Functorial Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="homsets.html">Homset categories</a></li>
<li class="toctree-l1"><a class="reference internal" href="realizations.html">Realizations Covariant Functorial Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="with_realizations.html">With Realizations Covariant Functorial Construction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/algebras_with_basis.html">Examples of algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/commutative_additive_monoids.html">Examples of commutative additive monoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/commutative_additive_semigroups.html">Examples of commutative additive semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/coxeter_groups.html">Examples of Coxeter groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/crystals.html">Example of a crystal</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/cw_complexes.html">Examples of CW complexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/facade_sets.html">Example of facade set</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/finite_coxeter_groups.html">Examples of finite Coxeter groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/finite_dimensional_algebras_with_basis.html">Example of a finite dimensional algebra with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/finite_dimensional_lie_algebras_with_basis.html">Examples of a finite dimensional Lie algebra with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/finite_enumerated_sets.html">Examples of finite enumerated sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/finite_monoids.html">Examples of finite monoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/finite_semigroups.html">Examples of finite semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/finite_weyl_groups.html">Examples of finite Weyl groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/graded_connected_hopf_algebras_with_basis.html">Examples of graded connected Hopf algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/graded_modules_with_basis.html">Examples of graded modules with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/graphs.html">Examples of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/hopf_algebras_with_basis.html">Examples of Hopf algebras with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/infinite_enumerated_sets.html">Examples of infinite enumerated sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/lie_algebras.html">Examples of a Lie algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/lie_algebras_with_basis.html">Examples of a Lie algebra with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/magmas.html">Examples of magmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/manifolds.html">Examples of manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/monoids.html">Examples of monoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/posets.html">Examples of posets</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/semigroups.html">Examples of semigroups</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/semigroups_cython.html">Examples of semigroups in cython</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/sets_cat.html">Examples of sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/sets_with_grading.html">Example of a set with grading</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/with_realizations.html">Examples of parents endowed with multiple realizations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="category_types.html">Specific category classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="category_singleton.html">Singleton categories</a></li>
<li class="toctree-l1"><a class="reference internal" href="category_cy_helper.html">Fast functions for the category framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="coercion_methods.html">Coercion methods for categories</a></li>
<li class="toctree-l1"><a class="reference internal" href="poor_man_map.html">Poor Man’s map</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="elements-parents-and-categories-in-sage-a-primer">
<span id="sage-categories-primer"></span><h1><a class="toc-backref" href="#id4" role="doc-backlink">Elements, parents, and categories in Sage: a primer</a><a class="headerlink" href="#elements-parents-and-categories-in-sage-a-primer" title="Link to this heading">#</a></h1>
<nav class="contents this-will-duplicate-information-and-it-is-still-useful-here" id="contents">
<span id="module-sage.categories.primer"></span><p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#elements-parents-and-categories-in-sage-a-primer" id="id4">Elements, parents, and categories in Sage: a primer</a></p>
<ul>
<li><p><a class="reference internal" href="#abstract" id="id5">Abstract</a></p></li>
<li><p><a class="reference internal" href="#introduction-sage-as-a-library-of-objects-and-algorithms" id="id6">Introduction: Sage as a library of objects and algorithms</a></p></li>
<li><p><a class="reference internal" href="#a-bit-of-help-from-abstract-algebra" id="id7">A bit of help from abstract algebra</a></p></li>
<li><p><a class="reference internal" href="#a-bit-of-help-from-computer-science" id="id8">A bit of help from computer science</a></p></li>
<li><p><a class="reference internal" href="#sage-categories" id="id9">Sage categories</a></p></li>
<li><p><a class="reference internal" href="#case-study" id="id10">Case study</a></p></li>
<li><p><a class="reference internal" href="#specifying-the-category-of-a-parent" id="id11">Specifying the category of a parent</a></p></li>
<li><p><a class="reference internal" href="#scaling-further-functorial-constructions-axioms" id="id12">Scaling further: functorial constructions, axioms, …</a></p></li>
<li><p><a class="reference internal" href="#writing-a-new-category" id="id13">Writing a new category</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="abstract">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Abstract</a><a class="headerlink" href="#abstract" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>The purpose of categories in Sage is to translate the mathematical
concept of categories (category of groups, of vector spaces, …)
into a concrete software engineering design pattern for:</p>
<ul class="simple">
<li><p>organizing and promoting generic code</p></li>
<li><p>fostering consistency across the Sage library (naming
conventions, doc, tests)</p></li>
<li><p>embedding more mathematical knowledge into the system</p></li>
</ul>
<p>This design pattern is largely inspired from Axiom and its
followers (Aldor, Fricas, MuPAD, …). It differs from those by:</p>
<ul class="simple">
<li><p>blending in the Magma inspired concept of Parent/Element</p></li>
<li><p>being built on top of (and not into) the standard Python object
oriented and class hierarchy mechanism. This did not require
changing the language, and could in principle be implemented in
any language supporting the creation of new classes dynamically.</p></li>
</ul>
<p>The general philosophy is that <em>Building mathematical information
into the system yields more expressive, more conceptual and, at
the end, easier to maintain and faster code</em> (within a programming
realm; this would not necessarily apply to specialized libraries
like gmp!).</p>
</div></blockquote>
<section id="one-line-pitch-for-mathematicians">
<h3>One line pitch for mathematicians<a class="headerlink" href="#one-line-pitch-for-mathematicians" title="Link to this heading">#</a></h3>
<p>Categories in Sage provide a library of interrelated bookshelves, with
each bookshelf containing algorithms, tests, documentation, or some
mathematical facts about the objects of a given category (e.g. groups).</p>
</section>
<section id="one-line-pitch-for-programmers">
<h3>One line pitch for programmers<a class="headerlink" href="#one-line-pitch-for-programmers" title="Link to this heading">#</a></h3>
<p>Categories in Sage provide a large hierarchy of abstract classes for
mathematical objects. To keep it maintainable, the inheritance
information between the classes is not hardcoded but instead
reconstructed dynamically from duplication free semantic information.</p>
</section>
</section>
<section id="introduction-sage-as-a-library-of-objects-and-algorithms">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Introduction: Sage as a library of objects and algorithms</a><a class="headerlink" href="#introduction-sage-as-a-library-of-objects-and-algorithms" title="Link to this heading">#</a></h2>
<p>The Sage library, with more than one million lines of code,
documentation, and tests, implements:</p>
<ul>
<li><p>Thousands of different kinds of objects (classes):</p>
<p>Integers, polynomials, matrices, groups, number fields, elliptic
curves, permutations, morphisms, languages, … and a few racoons …</p>
</li>
<li><p>Tens of thousands methods and functions:</p>
<p>Arithmetic, integer and polynomial factorization, pattern matching
on words, …</p>
</li>
</ul>
<section id="some-challenges">
<h3>Some challenges<a class="headerlink" href="#some-challenges" title="Link to this heading">#</a></h3>
<ul>
<li><p>How to organize this library?</p>
<p>One needs some bookshelves to group together related objects and algorithms.</p>
</li>
<li><p>How to ensure consistency?</p>
<p>Similar objects should behave similarly:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Permutations</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">120</span>

<span class="gp">sage: </span><span class="n">GL</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>                                                       <span class="c1"># needs sage.modules</span>
<span class="go">6</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>                                            <span class="c1"># needs sage.modules</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">LatticePolytope</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">rows</span><span class="p">())</span>                                               <span class="c1"># needs sage.geometry.polyhedron sage.modules</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">npoints</span><span class="p">()</span>                <span class="c1"># oops!   # random                               # needs sage.geometry.polyhedron sage.modules</span>
<span class="go">37</span>
</pre></div>
</div>
</li>
<li><p>How to ensure robustness?</p></li>
<li><p>How to reduce duplication?</p>
<p>Example: binary powering:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">^</span><span class="mi">8</span> <span class="o">==</span> <span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span> <span class="o">==</span> <span class="p">((</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.modules</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;echelonizable&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">rank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">^</span><span class="mi">8</span> <span class="o">==</span> <span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span> <span class="o">==</span> <span class="p">((</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We want to implement binary powering only once, as <em>generic</em> code
that will apply in all cases.</p>
</li>
</ul>
</section>
</section>
<section id="a-bit-of-help-from-abstract-algebra">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">A bit of help from abstract algebra</a><a class="headerlink" href="#a-bit-of-help-from-abstract-algebra" title="Link to this heading">#</a></h2>
<section id="the-hierarchy-of-categories">
<h3>The hierarchy of categories<a class="headerlink" href="#the-hierarchy-of-categories" title="Link to this heading">#</a></h3>
<p>What makes binary powering work in the above examples? In both cases,
we have <em>a set</em> endowed with a <em>multiplicative binary operation</em> which
is <em>associative</em> and which has a unit element. Such a set is called a
<em>monoid</em>, and binary powering (to a non-negative power) works generally
for any monoid.</p>
<p>Sage knows about monoids:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Monoids</span><span class="p">()</span>
<span class="go">Category of monoids</span>
</pre></div>
</div>
<p>and sure enough, binary powering is defined there:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">_pow_int</span><span class="o">.</span><span class="vm">__module__</span>                                                         <span class="c1"># needs sage.modules</span>
<span class="go">&#39;sage.categories.monoids&#39;</span>
</pre></div>
</div>
<p>That’s our bookshelf! And it’s used in many places:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">GL</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span> <span class="ow">in</span> <span class="n">Monoids</span><span class="p">()</span>                                                        <span class="c1"># needs sage.modules</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">NN</span> <span class="ow">in</span> <span class="n">Monoids</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For a less trivial bookshelf we can consider euclidean rings: once we
know how to do euclidean division in some set <span class="math notranslate nohighlight">\(R\)</span>, we can compute
gcd’s in <span class="math notranslate nohighlight">\(R\)</span> generically using the Euclidean algorithm.</p>
<p>We are in fact very lucky: abstract algebra provides us right away
with a large and robust set of bookshelves which is the result of
centuries of work of mathematicians to identify the important
concepts. This includes for example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sets</span><span class="p">()</span>
<span class="go">Category of sets</span>

<span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span>
<span class="go">Category of groups</span>

<span class="gp">sage: </span><span class="n">Rings</span><span class="p">()</span>
<span class="go">Category of rings</span>

<span class="gp">sage: </span><span class="n">Fields</span><span class="p">()</span>
<span class="go">Category of fields</span>

<span class="gp">sage: </span><span class="n">HopfAlgebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Category of Hopf algebras over Rational Field</span>
</pre></div>
</div>
<p>Each of the above is called a <em>category</em>. It typically specifies what
are the operations on the elements, as well as the axioms satisfied by
those operations. For example the category of groups specifies that a
group is a set endowed with a binary operation (the multiplication)
which is associative and admits a unit and inverses.</p>
<p>Each set in Sage knows which bookshelf of generic algorithms it can
use, that is to which category it belongs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">GL</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>                                                                 <span class="c1"># needs sage.modules</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>                                                                  <span class="c1"># needs sage.modules</span>
<span class="go">Category of infinite groups</span>
</pre></div>
</div>
<p>In fact a group is a semigroup, and Sage knows about this:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">is_subcategory</span><span class="p">(</span><span class="n">Semigroups</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="ow">in</span> <span class="n">Semigroups</span><span class="p">()</span>                                                             <span class="c1"># needs sage.modules</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Altogether, our group gets algorithms from a bunch of bookshelves:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">categories</span><span class="p">()</span>                                                                <span class="c1"># needs sage.modules</span>
<span class="go">[Category of infinite groups, Category of groups, Category of monoids,</span>
<span class="go"> ...,</span>
<span class="go"> Category of magmas,</span>
<span class="go"> Category of infinite sets, ...]</span>
</pre></div>
</div>
<p>Those can be viewed graphically:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">category_graph</span><span class="p">()</span>                                                 <span class="c1"># needs sage.graphs</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_latex_options</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;dot2tex&quot;</span><span class="p">)</span>                                         <span class="c1"># needs sage.graphs sage.modules</span>
<span class="gp">sage: </span><span class="n">view</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>                               <span class="c1"># not tested                            # needs sage.graphs sage.modules sage.plot</span>
</pre></div>
</div>
<p>In case <code class="docutils literal notranslate"><span class="pre">dot2tex</span></code> is not available, you can use instead:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">vertex_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>                                         <span class="c1"># needs sage.graphs sage.modules sage.plot</span>
</pre></div>
</div>
<p>Here is an overview of all categories in Sage:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">category_graph</span><span class="p">()</span>                                 <span class="c1"># needs sage.graphs sage.modules</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_latex_options</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;dot2tex&quot;</span><span class="p">)</span>                                         <span class="c1"># needs sage.graphs sage.modules</span>
<span class="gp">sage: </span><span class="n">view</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>                               <span class="c1"># not tested                            # needs sage.graphs sage.modules sage.plot</span>
</pre></div>
</div>
<p>Wrap-up: generic algorithms in Sage are organized in a hierarchy of
bookshelves modelled upon the usual hierarchy of categories provided
by abstract algebra.</p>
</section>
<section id="elements-parents-categories">
<span id="category-primer-parents-elements-categories"></span><h3>Elements, Parents, Categories<a class="headerlink" href="#elements-parents-categories" title="Link to this heading">#</a></h3>
<p class="rubric">Parent</p>
<p>A <em>parent</em> is a Python instance modelling a set of mathematical
elements together with its additional (algebraic) structure.</p>
<p>Examples include the ring of integers, the group <span class="math notranslate nohighlight">\(S_3\)</span>, the set of
prime numbers, the set of linear maps between two given vector
spaces, and a given finite semigroup.</p>
<p>These sets are often equipped with additional structure: the set
of all integers forms a ring. The main way of encoding this
information is specifying which categories a parent belongs to.</p>
<p>It is completely possible to have different Python instances
modelling the same set of elements.  For example, one might want
to consider the ring of integers, or the poset of integers under
their standard order, or the poset of integers under divisibility,
or the semiring of integers under the operations of maximum and
addition.  Each of these would be a different instance, belonging
to different categories.</p>
<p>For a given model, there should be a unique instance in Sage
representing that parent:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">IntegerRing</span><span class="p">()</span> <span class="ow">is</span> <span class="n">IntegerRing</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Element</p>
<p>An <em>element</em> is a Python instance modelling a mathematical element
of a set.</p>
<p>Examples of element include <span class="math notranslate nohighlight">\(5\)</span> in the integer ring, <span class="math notranslate nohighlight">\(x^3 - x\)</span> in
the polynomial ring in <span class="math notranslate nohighlight">\(x\)</span> over the rationals, <span class="math notranslate nohighlight">\(4 + O(3^3)\)</span> in the
3-adics, the transposition <span class="math notranslate nohighlight">\((1 2)\)</span> in <span class="math notranslate nohighlight">\(S_3\)</span>, and the identity
morphism in the set of linear maps from <span class="math notranslate nohighlight">\(\QQ^3\)</span> to <span class="math notranslate nohighlight">\(\QQ^3\)</span>.</p>
<p>Every element in Sage has a parent.  The standard idiom in Sage
for creating elements is to create their parent, and then provide
enough data to define the element:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">3*x^2 + 2*x + 1</span>
</pre></div>
</div>
<p>One can also create elements using various methods on the parent
and arithmetic of elements:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="go">3*x^2 + 2*x + 1</span>
</pre></div>
</div>
<p>Unlike parents, elements in Sage are not necessarily unique:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">5040</span><span class="p">)</span> <span class="ow">is</span> <span class="n">ZZ</span><span class="p">(</span><span class="mi">5040</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Many parents model algebraic structures, and their elements
support arithmetic operations. One often further wants to do
arithmetic by combining elements from different parents: adding
together integers and rationals for example. Sage supports this
feature using coercion (see <a class="reference external" href="../../../coercion/sage/structure/coerce.html#module-sage.structure.coerce" title="(in Reference Manual v10.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.structure.coerce</span></code></a> for more
details).</p>
<p>It is possible for a parent to also have simultaneously the
structure of an element. Consider for example the monoid of all
finite groups, endowed with the Cartesian product operation.
Then, every finite group (which is a parent) is also an element of
this monoid. This is not yet implemented, and the design details
are not yet fixed but experiments are underway in this direction.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Give a concrete example, typically using <a class="reference external" href="../../../structure/sage/structure/element_wrapper.html#sage.structure.element_wrapper.ElementWrapper" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementWrapper</span></code></a>.</p>
</div>
<p class="rubric">Category</p>
<p>A <em>category</em> is a Python instance modelling a mathematical category.</p>
<p>Examples of categories include the category of finite semigroups,
the category of all (Python) objects, the category of
<span class="math notranslate nohighlight">\(\ZZ\)</span>-algebras, and the category of Cartesian products of
<span class="math notranslate nohighlight">\(\ZZ\)</span>-algebras:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FiniteSemigroups</span><span class="p">()</span>
<span class="go">Category of finite semigroups</span>
<span class="gp">sage: </span><span class="n">Objects</span><span class="p">()</span>
<span class="go">Category of objects</span>
<span class="gp">sage: </span><span class="n">Algebras</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">Category of algebras over Integer Ring</span>
<span class="gp">sage: </span><span class="n">Algebras</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">CartesianProducts</span><span class="p">()</span>
<span class="go">Category of Cartesian products of algebras over Integer Ring</span>
</pre></div>
</div>
<p>Mind the ‘s’ in the names of the categories above;
<code class="docutils literal notranslate"><span class="pre">GroupAlgebra</span></code> and <code class="docutils literal notranslate"><span class="pre">GroupAlgebras</span></code> are distinct things.</p>
<p>Every parent belongs to a collection of categories. Moreover,
categories are interrelated by the <em>super categories</em>
relation. For example, the category of rings is a super category
of the category of fields, because every field is also a ring.</p>
<p>A category serves two roles:</p>
<ul class="simple">
<li><p>to provide a model for the mathematical concept of a category
and the associated structures: homsets, morphisms, functorial
constructions, axioms.</p></li>
<li><p>to organize and promote generic code, naming conventions,
documentation, and tests across similar mathematical structures.</p></li>
</ul>
<p class="rubric">CategoryObject</p>
<p>Objects of a mathematical category are not necessarily parents.
Parent has a superclass that provides a means of modeling such.</p>
<p>For example, the category of schemes does not have a faithful
forgetful functor to the category of sets, so it does not make
sense to talk about schemes as parents.</p>
<p class="rubric">Morphisms, Homsets</p>
<p>As category theorists will expect, <em>Morphisms</em> and <em>Homsets</em> will
play an ever more important role, as support for them will
improve.</p>
<hr class="docutils" />
<p>Much of the mathematical information in Sage is encoded as relations
between elements and their parents, parents and their categories, and
categories and their super categories:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">1.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Integer Ring</span>

<span class="gp">sage: </span><span class="n">ZZ</span>
<span class="go">Integer Ring</span>

<span class="gp">sage: </span><span class="n">ZZ</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Join of Category of Dedekind domains</span>
<span class="go">    and Category of euclidean domains</span>
<span class="go">    and Category of infinite enumerated sets</span>
<span class="go">    and Category of metric spaces</span>

<span class="gp">sage: </span><span class="n">ZZ</span><span class="o">.</span><span class="n">categories</span><span class="p">()</span>
<span class="go">[Join of Category of Dedekind domains</span>
<span class="go">     and Category of euclidean domains</span>
<span class="go">     and Category of infinite enumerated sets</span>
<span class="go">     and Category of metric spaces,</span>
<span class="go"> Category of Dedekind domains,</span>
<span class="go"> Category of euclidean domains, Category of principal ideal domains,</span>
<span class="go"> Category of unique factorization domains, Category of gcd domains,</span>
<span class="go"> Category of integral domains, Category of domains,</span>
<span class="go"> Category of commutative rings, Category of rings, ...</span>
<span class="go"> Category of magmas and additive magmas, ...</span>
<span class="go"> Category of monoids, Category of semigroups,</span>
<span class="go"> Category of commutative magmas, Category of unital magmas, Category of magmas,</span>
<span class="go"> Category of commutative additive groups, ..., Category of additive magmas,</span>
<span class="go"> Category of infinite enumerated sets, Category of enumerated sets,</span>
<span class="go"> Category of infinite sets, Category of metric spaces,</span>
<span class="go"> Category of topological spaces, Category of sets,</span>
<span class="go"> Category of sets with partial maps,</span>
<span class="go"> Category of objects]</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">EuclideanDomains</span><span class="p">()</span><span class="o">.</span><span class="n">category_graph</span><span class="p">()</span>                                       <span class="c1"># needs sage.graphs</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_latex_options</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;dot2tex&quot;</span><span class="p">)</span>                                         <span class="c1"># needs sage.graphs sage.plot</span>
<span class="gp">sage: </span><span class="n">view</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>                               <span class="c1"># not tested                            # needs sage.graphs sage.plot</span>
</pre></div>
</div>
</section>
</section>
<section id="a-bit-of-help-from-computer-science">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">A bit of help from computer science</a><a class="headerlink" href="#a-bit-of-help-from-computer-science" title="Link to this heading">#</a></h2>
<section id="hierarchy-of-classes">
<h3>Hierarchy of classes<a class="headerlink" href="#hierarchy-of-classes" title="Link to this heading">#</a></h3>
<p>How are the bookshelves implemented in practice?</p>
<p>Sage uses the classical design paradigm of Object Oriented Programming
(OOP). Its fundamental principle is that any object that a program is
to manipulate should be modelled by an <em>instance</em> of a <em>class</em>. The
class implements:</p>
<blockquote>
<div><ul class="simple">
<li><p>a <em>data structure</em>: which describes how the object is stored,</p></li>
<li><p><em>methods</em>: which describe the operations on the object.</p></li>
</ul>
</div></blockquote>
<p>The instance itself contains the data for the given object, according
to the specified data structure.</p>
<p>Hence, all the objects mentioned above should be instances of some
classes. For example, an integer in Sage is an instance of the class
<a class="reference external" href="../../../rings_standard/sage/rings/integer.html#sage.rings.integer.Integer" title="(in Standard Commutative Rings v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a> (and it knows about it!):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="mi">12</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
<p>Applying an operation is generally done by <em>calling a method</em>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2^2 * 3</span>

<span class="gp">sage: </span><span class="c1"># needs sage.symbolic</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">12</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">6*(x + 1)^2</span>

<span class="gp">sage: </span><span class="c1"># needs sage.symbolic</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pQ</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">pQ</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.polynomial.polynomial_ring.PolynomialRing_field_with_category.element_class&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">pQ</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(6) * (x + 1)^2</span>

<span class="gp">sage: </span><span class="c1"># needs sage.symbolic</span>
<span class="gp">sage: </span><span class="n">pZ</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">](</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">pZ</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">pZ</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2 * 3 * (x + 1)^2</span>
</pre></div>
</div>
<p>Factoring integers, expressions, or polynomials are distinct tasks,
with completely different algorithms. Yet, from a user (or caller)
point of view, all those objects can be manipulated alike. This
illustrates the OOP concepts of <em>polymorphism</em>, <em>data abstraction</em>,
and <em>encapsulation</em>.</p>
<p>Let us be curious, and see where some methods are defined. This can be
done by introspection:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">_mul_</span><span class="err">??</span>                   <span class="c1"># not tested</span>
</pre></div>
</div>
<p>For plain Python methods, one can also just ask in which module they
are implemented:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">_pow_</span><span class="o">.</span><span class="vm">__module__</span>  <span class="c1"># not tested (Issue #24275)</span>
<span class="go">&#39;sage.categories.semigroups&#39;</span>

<span class="gp">sage: </span><span class="n">pQ</span><span class="o">.</span><span class="n">_mul_</span><span class="o">.</span><span class="vm">__module__</span>                                                           <span class="c1"># needs sage.symbolic</span>
<span class="go">&#39;sage.rings.polynomial.polynomial_element_generic&#39;</span>
<span class="gp">sage: </span><span class="n">pQ</span><span class="o">.</span><span class="n">_pow_</span><span class="o">.</span><span class="vm">__module__</span>                   <span class="c1"># not tested (Issue #24275)             # needs sage.symbolic</span>
<span class="go">&#39;sage.categories.semigroups&#39;</span>
</pre></div>
</div>
<p>We see that integers and polynomials have each their own
multiplication method: the multiplication algorithms are indeed
unrelated and deeply tied to their respective datastructures. On the
other hand, as we have seen above, they share the same powering method
because the set <span class="math notranslate nohighlight">\(\ZZ\)</span> of integers, and the set <span class="math notranslate nohighlight">\(\QQ[x]\)</span> of
polynomials are both semigroups. Namely, the class for integers and
the class for polynomials both derive from an <em>abstract class</em> for
semigroup elements, which factors out the <em>generic</em> methods like
<code class="docutils literal notranslate"><span class="pre">_pow_</span></code>. This illustrates the use of <em>hierarchy of classes</em> to share
common code between classes having common behaviour.</p>
<p>OOP design is all about isolating the objects that one wants to model
together with their operations, and designing an appropriate hierarchy
of classes for organizing the code. As we have seen above, the design
of the class hierarchy is easy since it can be modelled upon the
hierarchy of categories (bookshelves). Here is for example a piece of
the hierarchy of classes for an element of a group of permutations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Permutations</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">mro</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.combinat.permutation.StandardPermutations_n_with_category.element_class&#39;&gt;</span>
<span class="go">&lt;class &#39;sage.combinat.permutation.StandardPermutations_n.Element&#39;&gt;</span>
<span class="go">&lt;class &#39;sage.combinat.permutation.Permutation&#39;&gt;</span>
<span class="go">...</span>
<span class="go">&lt;class &#39;sage.categories.groups.Groups.element_class&#39;&gt;</span>
<span class="go">&lt;class &#39;sage.categories.monoids.Monoids.element_class&#39;&gt;</span>
<span class="go">...</span>
<span class="go">&lt;class &#39;sage.categories.semigroups.Semigroups.element_class&#39;&gt;</span>
<span class="go">...</span>
</pre></div>
</div>
<p>On the top, we see concrete classes that describe the data structure
for matrices and provide the operations that are tied to this data
structure. Then follow abstract classes that are attached to the
hierarchy of categories and provide generic algorithms.</p>
<p>The full hierarchy is best viewed graphically:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">class_graph</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>                                                  <span class="c1"># needs sage.combinat sage.graphs</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_latex_options</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;dot2tex&quot;</span><span class="p">)</span>                                         <span class="c1"># needs sage.combinat sage.graphs</span>
<span class="gp">sage: </span><span class="n">view</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>                               <span class="c1"># not tested                            # needs sage.combinat sage.graphs sage.plot</span>
</pre></div>
</div>
</section>
<section id="parallel-hierarchy-of-classes-for-parents">
<h3>Parallel hierarchy of classes for parents<a class="headerlink" href="#parallel-hierarchy-of-classes-for-parents" title="Link to this heading">#</a></h3>
<p>Let us recall that we do not just want to compute with elements of
mathematical sets, but with the sets themselves:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZ</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x,y&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">krull_dimension</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">quotient</span><span class="p">(</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">krull_dimension</span><span class="p">()</span> <span class="c1"># todo: not implemented</span>
</pre></div>
</div>
<p>Here are some typical operations that one may want to carry on various
kinds of sets:</p>
<ul class="simple">
<li><p>The set of permutations of 5, the set of rational points of an
elliptic curve: counting, listing, random generation</p></li>
<li><p>A language (set of words): rationality testing, counting elements,
generating series</p></li>
<li><p>A finite semigroup: left/right ideals, center, representation theory</p></li>
<li><p>A vector space, an algebra: Cartesian product, tensor product, quotient</p></li>
</ul>
<p>Hence, following the OOP fundamental principle, parents should also be
modelled by instances of some (hierarchy of) classes. For example, our
group <span class="math notranslate nohighlight">\(G\)</span> is an instance of the following class:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">GL</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>                                                                 <span class="c1"># needs sage.modules</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>                                                                       <span class="c1"># needs sage.libs.gap sage.modules</span>
<span class="go">&lt;class &#39;sage.groups.matrix_gps.linear_gap.LinearMatrixGroup_gap_with_category&#39;&gt;</span>
</pre></div>
</div>
<p>Here is a piece of the hierarchy of classes above it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">mro</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>                                      <span class="c1"># needs sage.libs.gap sage.modules</span>
<span class="go">&lt;class &#39;sage.groups.matrix_gps.linear_gap.LinearMatrixGroup_gap_with_category&#39;&gt;</span>
<span class="go">...</span>
<span class="go">&lt;class &#39;sage.categories.groups.Groups.parent_class&#39;&gt;</span>
<span class="go">&lt;class &#39;sage.categories.monoids.Monoids.parent_class&#39;&gt;</span>
<span class="go">&lt;class &#39;sage.categories.semigroups.Semigroups.parent_class&#39;&gt;</span>
<span class="go">...</span>
</pre></div>
</div>
<p>Note that the hierarchy of abstract classes is again attached to
categories and parallel to that we had seen for the elements. This is
best viewed graphically:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.graphs sage.modules</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">class_graph</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="sa">r</span><span class="s2">&quot;\_&quot;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_latex_options</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;dot2tex&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">view</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>                               <span class="c1"># not tested                            # needs sage.plot</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a progress upon systems like Axiom or MuPAD where a parent
is modelled by the class of its elements; this oversimplification
leads to confusion between methods on parents and elements, and
makes parents special; in particular it prevents potentially
interesting constructions like “groups of groups”.</p>
</div>
</section>
</section>
<section id="sage-categories">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Sage categories</a><a class="headerlink" href="#sage-categories" title="Link to this heading">#</a></h2>
<p>Why this business of categories? And to start with, why don’t we just
have a good old hierarchy of classes <code class="docutils literal notranslate"><span class="pre">Group</span></code>, <code class="docutils literal notranslate"><span class="pre">Semigroup</span></code>,
<code class="docutils literal notranslate"><span class="pre">Magma</span></code>, … ?</p>
<section id="dynamic-hierarchy-of-classes">
<h3>Dynamic hierarchy of classes<a class="headerlink" href="#dynamic-hierarchy-of-classes" title="Link to this heading">#</a></h3>
<p>As we have just seen, when we manipulate groups, we actually
manipulate several kinds of objects:</p>
<ul class="simple">
<li><p>groups</p></li>
<li><p>group elements</p></li>
<li><p>morphisms between groups</p></li>
<li><p>and even the category of groups itself!</p></li>
</ul>
<p>Thus, on the group bookshelf, we want to put generic code for each of
the above. We therefore need three, parallel hierarchies of abstract
classes:</p>
<ul class="simple">
<li><p>Group, Monoid, Semigroup, Magma, …</p></li>
<li><p>GroupElement, MonoidElement, SemigroupElement, MagmaElement, …</p></li>
<li><p>GroupMorphism, MonoidMorphism, SemigroupMorphism, MagmaMorphism, …</p></li>
</ul>
<p>(and in fact many more as we will see).</p>
<p>We could implement the above hierarchies as usual:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">class Group(Monoid):</span>
<span class="go">    # generic methods that apply to all groups</span>

<span class="go">class GroupElement(MonoidElement):</span>
<span class="go">    # generic methods that apply to all group elements</span>

<span class="go">class GroupMorphism(MonoidMorphism):</span>
<span class="go">    # generic methods that apply to all group morphisms</span>
</pre></div>
</div>
<p>And indeed that’s how it was done in Sage before 2009, and there are
still many traces of this. The drawback of this approach is
duplication: the fact that a group is a monoid is repeated three times
above!</p>
<p>Instead, Sage now uses the following syntax, where the <a class="reference internal" href="groups.html#sage.categories.groups.Groups" title="sage.categories.groups.Groups"><code class="xref py py-class docutils literal notranslate"><span class="pre">Groups</span></code></a>
bookshelf is structured into units with <em>nested classes</em>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">class Groups(Category):</span>

<span class="go">    def super_categories(self):</span>
<span class="go">        return [Monoids(), ...]</span>

<span class="go">    class ParentMethods:</span>
<span class="go">        # generic methods that apply to all groups</span>

<span class="go">    class ElementMethods:</span>
<span class="go">        # generic methods that apply to all group elements</span>

<span class="go">    class MorphismMethods:</span>
<span class="go">        # generic methods that apply to all group morphisms (not yet implemented)</span>

<span class="go">    class SubcategoryMethods:</span>
<span class="go">        # generic methods that apply to all subcategories of Groups()</span>
</pre></div>
</div>
<p>With this syntax, the information that a group is a monoid is
specified only once, in the <a class="reference internal" href="category.html#sage.categories.category.Category.super_categories" title="sage.categories.category.Category.super_categories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Category.super_categories()</span></code></a>
method. And indeed, when the category of inverse unital magmas was
introduced, there was a <em>single point of truth</em> to update in order to
reflect the fact that a group is an inverse unital magma:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">super_categories</span><span class="p">()</span>
<span class="go">[Category of monoids, Category of inverse unital magmas]</span>
</pre></div>
</div>
<p>The price to pay (there is no free lunch) is that some magic is
required to construct the actual hierarchy of classes for parents,
elements, and morphisms.  Namely, <code class="docutils literal notranslate"><span class="pre">Groups.ElementMethods</span></code> should be
seen as just a bag of methods, and the actual class
<code class="docutils literal notranslate"><span class="pre">Groups().element_class</span></code> is constructed from it by adding the
appropriate super classes according to
<code class="docutils literal notranslate"><span class="pre">Groups().super_categories()</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">element_class</span>
<span class="go">&lt;class &#39;sage.categories.groups.Groups.element_class&#39;&gt;</span>

<span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">element_class</span><span class="o">.</span><span class="vm">__bases__</span>
<span class="go">(&lt;class &#39;sage.categories.monoids.Monoids.element_class&#39;&gt;,</span>
<span class="go"> &lt;class &#39;sage.categories.magmas.Magmas.Unital.Inverse.element_class&#39;&gt;)</span>
</pre></div>
</div>
<p>We now see that the hierarchy of classes for parents and elements is
parallel to the hierarchy of categories:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">all_super_categories</span><span class="p">()</span>
<span class="go">[Category of groups,</span>
<span class="go"> Category of monoids,</span>
<span class="go"> Category of semigroups,</span>
<span class="go"> ...</span>
<span class="go"> Category of magmas,</span>
<span class="go"> Category of sets,</span>
<span class="go"> ...]</span>

<span class="gp">sage: </span><span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">element_class</span><span class="o">.</span><span class="n">mro</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.categories.groups.Groups.element_class&#39;&gt;</span>
<span class="go">&lt;class &#39;sage.categories.monoids.Monoids.element_class&#39;&gt;</span>
<span class="go">&lt;class &#39;sage.categories.semigroups.Semigroups.element_class&#39;&gt;</span>
<span class="go">...</span>
<span class="go">&lt;class &#39;sage.categories.magmas.Magmas.element_class&#39;&gt;</span>
<span class="go">...</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">parent_class</span><span class="o">.</span><span class="n">mro</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.categories.groups.Groups.parent_class&#39;&gt;</span>
<span class="go">&lt;class &#39;sage.categories.monoids.Monoids.parent_class&#39;&gt;</span>
<span class="go">&lt;class &#39;sage.categories.semigroups.Semigroups.parent_class&#39;&gt;</span>
<span class="go">...</span>
<span class="go">&lt;class &#39;sage.categories.magmas.Magmas.parent_class&#39;&gt;</span>
<span class="go">...</span>
</pre></div>
</div>
<p>Another advantage of building the hierarchy of classes dynamically is
that, for parametrized categories, the hierarchy may depend on the
parameters. For example an algebra over <span class="math notranslate nohighlight">\(\QQ\)</span> is a <span class="math notranslate nohighlight">\(\QQ\)</span>-vector space,
but an algebra over <span class="math notranslate nohighlight">\(\ZZ\)</span> is not (it is just a <span class="math notranslate nohighlight">\(\ZZ\)</span>-module)!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At this point this whole infrastructure may feel like
overdesigning, right? We felt like this too! But we will see later
that, once one gets used to it, this approach scales very
naturally.</p>
<p>From a computer science point of view, this infrastructure
implements, on top of standard multiple inheritance, a dynamic
composition mechanism of mixin classes (<a class="reference external" href="https://en.wikipedia.org/wiki/Mixin">Wikipedia article Mixin</a>),
governed by mathematical properties.</p>
<p>For implementation details on how the hierarchy of classes for
parents and elements is constructed, see <a class="reference internal" href="category.html#sage.categories.category.Category" title="sage.categories.category.Category"><code class="xref py py-class docutils literal notranslate"><span class="pre">Category</span></code></a>.</p>
</div>
</section>
<section id="on-the-category-hierarchy-subcategories-and-super-categories">
<span id="category-primer-subcategory"></span><h3>On the category hierarchy: subcategories and super categories<a class="headerlink" href="#on-the-category-hierarchy-subcategories-and-super-categories" title="Link to this heading">#</a></h3>
<p>We have seen above that, for example, the category of sets is a super
category of the category of groups. This models the fact that a group
can be unambiguously considered as a set by forgetting its group
operation. In object-oriented parlance, we want the relation “a group
<em>is a</em> set”, so that groups can directly inherit code implemented on
sets.</p>
<p>Formally, a category <code class="docutils literal notranslate"><span class="pre">Cs()</span></code> is a <em>super category</em> of a category
<code class="docutils literal notranslate"><span class="pre">Ds()</span></code> if Sage considers any object of <code class="docutils literal notranslate"><span class="pre">Ds()</span></code> to be an object of
<code class="docutils literal notranslate"><span class="pre">Cs()</span></code>, up to an implicit application of a canonical functor from
<code class="docutils literal notranslate"><span class="pre">Ds()</span></code> to <code class="docutils literal notranslate"><span class="pre">Cs()</span></code>. This functor is normally an inclusion of
categories or a forgetful functor. Reciprocally, <code class="docutils literal notranslate"><span class="pre">Ds()</span></code> is said to
be a <em>subcategory</em> of <code class="docutils literal notranslate"><span class="pre">Cs()</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This terminology deviates from the usual mathematical definition
of <em>subcategory</em> and is subject to change. Indeed, the forgetful
functor from the category of groups to the category of sets is not
an inclusion of categories, as it is not injective: a given set
may admit more than one group structure. See <a class="reference external" href="https://github.com/sagemath/sage/issues/16183">github issue #16183</a> for
more details. The name <em>supercategory</em> is also used with a
different meaning in certain areas of mathematics.</p>
</div>
</section>
<section id="categories-are-instances-and-have-operations">
<h3>Categories are instances and have operations<a class="headerlink" href="#categories-are-instances-and-have-operations" title="Link to this heading">#</a></h3>
<p>Note that categories themselves are naturally modelled by instances
because they can have operations of their own. An important one is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">example</span><span class="p">()</span>                                                            <span class="c1"># needs sage.modules</span>
<span class="go">General Linear Group of degree 4 over Rational Field</span>
</pre></div>
</div>
<p>which gives an example of object of the category. Besides illustrating
the category, the example provides a minimal template for implementing
a new object in the category:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Semigroups</span><span class="p">()</span><span class="o">.</span><span class="n">example</span><span class="p">();</span> <span class="n">S</span>
<span class="go">An example of a semigroup: the left zero semigroup</span>
</pre></div>
</div>
<p>Its source code can be obtained by introspection:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="err">??</span>                                     <span class="c1"># not tested</span>
</pre></div>
</div>
<p>This example is also typically used for testing generic methods. See
<a class="reference internal" href="category.html#sage.categories.category.Category.example" title="sage.categories.category.Category.example"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Category.example()</span></code></a> for more.</p>
<p>Other operations on categories include querying the super categories
or the axioms satisfied by the operations of a category:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">super_categories</span><span class="p">()</span>
<span class="go">[Category of monoids, Category of inverse unital magmas]</span>
<span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">axioms</span><span class="p">()</span>
<span class="go">frozenset({&#39;Associative&#39;, &#39;Inverse&#39;, &#39;Unital&#39;})</span>
</pre></div>
</div>
<p>or constructing the intersection of two categories, or the smallest
category containing them:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">FiniteSets</span><span class="p">()</span>
<span class="go">Category of finite groups</span>
<span class="gp">sage: </span><span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span> <span class="o">|</span> <span class="n">Groups</span><span class="p">()</span>
<span class="go">Category of monoids</span>
</pre></div>
</div>
</section>
<section id="specifications-and-generic-documentation">
<h3>Specifications and generic documentation<a class="headerlink" href="#specifications-and-generic-documentation" title="Link to this heading">#</a></h3>
<p>Categories do not only contain code but also the specifications of the
operations. In particular a list of mandatory and optional methods to
be implemented can be found by introspection with:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">required_methods</span><span class="p">()</span>
<span class="go">{&#39;element&#39;: {&#39;optional&#39;: [&#39;_mul_&#39;], &#39;required&#39;: []},</span>
<span class="go"> &#39;parent&#39;: {&#39;optional&#39;: [], &#39;required&#39;: [&#39;__contains__&#39;]}}</span>
</pre></div>
</div>
<p>Documentation about those methods can be obtained with:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Groups</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_class</span><span class="o">.</span><span class="n">_mul_</span><span class="err">?</span>        <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">parent_class</span><span class="o">.</span><span class="n">one</span><span class="err">?</span>           <span class="c1"># not tested</span>
</pre></div>
</div>
<p>See also the <a class="reference external" href="../../../misc/sage/misc/abstract_method.html#sage.misc.abstract_method.abstract_method" title="(in Utilities v10.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">abstract_method()</span></code></a> decorator.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Well, more precisely, that’s how things should be, but there is
still some work to do in this direction. For example, the inverse
operation is not specified above. Also, we are still missing a
good programmatic syntax to specify the input and output types of
the methods. Finally, in many cases the implementer must provide
at least one of two methods, each having a default implementation
using the other one (e.g. listing or iterating for a finite
enumerated set); there is currently no good programmatic way to
specify this.</p>
</div>
</section>
<section id="generic-tests">
<h3>Generic tests<a class="headerlink" href="#generic-tests" title="Link to this heading">#</a></h3>
<p>Another feature that parents and elements receive from categories is
generic tests; their purpose is to check (at least to some extent)
that the parent satisfies the required mathematical properties (is my
semigroup indeed associative?) and is implemented according to the
specifications (does the method <code class="docutils literal notranslate"><span class="pre">an_element</span></code> indeed return an
element of the parent?):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">FiniteSemigroups</span><span class="p">()</span><span class="o">.</span><span class="n">example</span><span class="p">(</span><span class="n">alphabet</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">running ._test_an_element() . . . pass</span>
<span class="go">running ._test_associativity() . . . pass</span>
<span class="go">running ._test_cardinality() . . . pass</span>
<span class="go">running ._test_category() . . . pass</span>
<span class="go">running ._test_construction() . . . pass</span>
<span class="go">running ._test_elements() . . .</span>
<span class="go">  Running the test suite of self.an_element()</span>
<span class="go">  running ._test_category() . . . pass</span>
<span class="go">  running ._test_eq() . . . pass</span>
<span class="go">  running ._test_new() . . . pass</span>
<span class="go">  running ._test_not_implemented_methods() . . . pass</span>
<span class="go">  running ._test_pickling() . . . pass</span>
<span class="go">  pass</span>
<span class="go">    running ._test_elements_eq_reflexive() . . . pass</span>
<span class="go">    running ._test_elements_eq_symmetric() . . . pass</span>
<span class="go">    running ._test_elements_eq_transitive() . . . pass</span>
<span class="go">    running ._test_elements_neq() . . . pass</span>
<span class="go">running ._test_enumerated_set_contains() . . . pass</span>
<span class="go">running ._test_enumerated_set_iter_cardinality() . . . pass</span>
<span class="go">running ._test_enumerated_set_iter_list() . . . pass</span>
<span class="go">running ._test_eq() . . . pass</span>
<span class="go">running ._test_new() . . . pass</span>
<span class="go">running ._test_not_implemented_methods() . . . pass</span>
<span class="go">running ._test_pickling() . . . pass</span>
<span class="go">running ._test_some_elements() . . . pass</span>
</pre></div>
</div>
<p>Tests can be run individually:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">_test_associativity</span><span class="p">()</span>
</pre></div>
</div>
<p>Here is how to access the code of this test:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">_test_associativity</span><span class="err">??</span> <span class="c1"># not tested</span>
</pre></div>
</div>
<p>Here is how to run the test on all elements:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">_test_associativity</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference external" href="../../../misc/sage/misc/sage_unittest.html#sage.misc.sage_unittest.TestSuite" title="(in Utilities v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TestSuite</span></code></a> for more information.</p>
<p>Let us see what happens when a test fails. Here we redefine the
product of <span class="math notranslate nohighlight">\(S\)</span> to something definitely not associative:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">product</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">S</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="o">+</span><span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span><span class="n">y</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>And rerun the test:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">_test_associativity</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="n">L</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">  File &quot;.../sage/categories/semigroups.py&quot;, line ..., in _test_associativity</span>
<span class="go">    tester.assertTrue((x * y) * z == x * (y * z))</span>
<span class="go">...</span>
<span class="go">AssertionError: &#39;((aa)a)&#39; != &#39;(a(aa))&#39;</span>
</pre></div>
</div>
<p>We can recover instantly the actual values of <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, that is,
a counterexample to the associativity of our broken semigroup, using post
mortem introspection with the Python debugger <code class="docutils literal notranslate"><span class="pre">pdb</span></code> (this does not
work yet in the notebook):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">pdb</span>
<span class="gp">sage: </span><span class="n">pdb</span><span class="o">.</span><span class="n">pm</span><span class="p">()</span>                       <span class="c1"># not tested</span>
<span class="go">&gt; /opt/sage-5.11.rc1/local/lib/python/unittest/case.py(424)assertTrue()</span>
<span class="go">-&gt; raise self.failureException(msg)</span>
<span class="go">(Pdb) u</span>
<span class="go">&gt; /opt/sage-5.11.rc1/local/lib/python2.7/site-packages/sage/categories/semigroups.py(145)_test_associativity()</span>
<span class="go">-&gt; tester.assertTrue((x * y) * z == x * (y * z))</span>
<span class="go">(Pdb) p x, y, z</span>
<span class="go">(&#39;a&#39;, &#39;a&#39;, &#39;a&#39;)</span>
<span class="go">(Pdb) p (x * y) * z</span>
<span class="go">&#39;((aa)a)&#39;</span>
<span class="go">(Pdb) p x * (y * z)</span>
<span class="go">&#39;(a(aa))&#39;</span>
</pre></div>
</div>
</section>
<section id="wrap-up">
<h3>Wrap-up<a class="headerlink" href="#wrap-up" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Categories provide a natural hierarchy of bookshelves to organize
not only code, but also specifications and testing tools.</p></li>
<li><p>Everything about, say, algebras with a distinguished basis is
gathered in <a class="reference internal" href="algebras_with_basis.html#sage.categories.algebras_with_basis.AlgebrasWithBasis" title="sage.categories.algebras_with_basis.AlgebrasWithBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgebrasWithBasis</span></code></a> or its super categories.
This includes properties and algorithms for elements, parents,
morphisms, but also, as we will see, for constructions like
Cartesian products or quotients.</p></li>
<li><p>The mathematical relations between elements, parents, and categories
translate dynamically into a traditional hierarchy of classes.</p></li>
<li><p>This design enforces robustness and consistency, which is
particularly welcome given that Python is an interpreted language
without static type checking.</p></li>
</ul>
</section>
</section>
<section id="case-study">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Case study</a><a class="headerlink" href="#case-study" title="Link to this heading">#</a></h2>
<p>In this section, we study an existing parent in detail; a good followup is to
go through the <a class="reference internal" href="tutorial.html#module-sage.categories.tutorial" title="sage.categories.tutorial"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.categories.tutorial</span></code></a> or the thematic tutorial on
coercion and categories (“How to implement new algebraic structures in Sage”)
to learn how to implement a new one!</p>
<p>We consider the example of finite semigroup provided by the category:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">FiniteSemigroups</span><span class="p">()</span><span class="o">.</span><span class="n">example</span><span class="p">();</span> <span class="n">S</span>
<span class="go">An example of a finite semigroup: the left regular band generated by (&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="err">?</span>                    <span class="c1"># not tested</span>
</pre></div>
</div>
<p>Where do all the operations on <code class="docutils literal notranslate"><span class="pre">S</span></code> and its elements come from?</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">_repr_</span></code> is a technical method which comes with the data structure
(<a class="reference external" href="../../../structure/sage/structure/element_wrapper.html#sage.structure.element_wrapper.ElementWrapper" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementWrapper</span></code></a>); since it’s implemented in Cython, we need
to use Sage’s introspection tools to recover where it’s implemented:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">_repr_</span><span class="o">.</span><span class="vm">__module__</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">sageinspect</span><span class="o">.</span><span class="n">sage_getfile</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">_repr_</span><span class="p">)</span>
<span class="go">&#39;.../sage/structure/element_wrapper.pyx&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">_pow_int</span></code> is a generic method for all finite semigroups:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">_pow_int</span><span class="o">.</span><span class="vm">__module__</span>
<span class="go">&#39;sage.categories.semigroups&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">__mul__</span></code> is a generic method provided by the <a class="reference internal" href="magmas.html#sage.categories.magmas.Magmas" title="sage.categories.magmas.Magmas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Magmas</span></code></a>
category (a <em>magma</em> is a set with an inner law <span class="math notranslate nohighlight">\(*\)</span>, not necessarily
associative). If the two arguments are in the same parent, it will
call the method <code class="docutils literal notranslate"><span class="pre">_mul_</span></code>, and otherwise let the <a class="reference external" href="../../../coercion/sage/structure/coerce.html#module-sage.structure.coerce" title="(in Reference Manual v10.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">coercion</span> <span class="pre">model</span></code></a> try to discover how to do the
multiplication:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="fm">__mul__</span><span class="err">??</span>                           <span class="c1"># not tested</span>
</pre></div>
</div>
<p>Since it is a speed critical method, it is implemented in Cython
in a separate file:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">_mul_</span><span class="o">.</span><span class="vm">__module__</span>
<span class="go">&#39;sage.categories.coercion_methods&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">_mul_</span></code> is a default implementation, also provided by the
<a class="reference internal" href="magmas.html#sage.categories.magmas.Magmas" title="sage.categories.magmas.Magmas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Magmas</span></code></a> category, that delegates the work to the method
<code class="docutils literal notranslate"><span class="pre">product</span></code> of the parent (following the advice: if you do not know
what to do, ask your parent); it’s also a speed critical method:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">_mul_</span><span class="err">??</span>                             <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">_mul_</span><span class="o">.</span><span class="vm">__module__</span>
<span class="go">&#39;sage.categories.coercion_methods&#39;</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">_mul_</span><span class="o">.</span><span class="vm">__func__</span> <span class="ow">is</span> <span class="n">Magmas</span><span class="o">.</span><span class="n">ElementMethods</span><span class="o">.</span><span class="n">_mul_parent</span>
<span class="go">True</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">product</span></code> is a mathematical method implemented by the parent:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="vm">__module__</span>
<span class="go">&#39;sage.categories.examples.finite_semigroups&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cayley_graph</span></code> is a generic method on the parent, provided by the
<a class="reference internal" href="finite_semigroups.html#sage.categories.finite_semigroups.FiniteSemigroups" title="sage.categories.finite_semigroups.FiniteSemigroups"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteSemigroups</span></code></a> category:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">cayley_graph</span><span class="o">.</span><span class="vm">__module__</span>
<span class="go">&#39;sage.categories.semigroups&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">multiplication_table</span></code> is a generic method on the parent, provided
by the <a class="reference internal" href="magmas.html#sage.categories.magmas.Magmas" title="sage.categories.magmas.Magmas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Magmas</span></code></a> category (it does not require associativity):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">multiplication_table</span><span class="o">.</span><span class="vm">__module__</span>
<span class="go">&#39;sage.categories.magmas&#39;</span>
</pre></div>
</div>
<p>Consider now the implementation of the semigroup:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="err">??</span>                                     <span class="c1"># not tested</span>
</pre></div>
</div>
<p>This implementation specifies a data structure for the parents and the
elements, and makes a promise: the implemented parent is a finite
semigroup. Then it fulfills the promise by implementing the basic
operation <code class="docutils literal notranslate"><span class="pre">product</span></code>.  It also implements the optional method
<code class="docutils literal notranslate"><span class="pre">semigroup_generators</span></code>. In exchange, <span class="math notranslate nohighlight">\(S\)</span> and its elements receive
generic implementations of all the other operations. <span class="math notranslate nohighlight">\(S\)</span> may override
any of those by more efficient ones. It may typically implement the
element method <code class="docutils literal notranslate"><span class="pre">is_idempotent</span></code> to always return <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>A (not yet complete) list of mandatory and optional methods to be
implemented can be found by introspection with:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FiniteSemigroups</span><span class="p">()</span><span class="o">.</span><span class="n">required_methods</span><span class="p">()</span>
<span class="go">{&#39;element&#39;: {&#39;optional&#39;: [&#39;_mul_&#39;], &#39;required&#39;: []},</span>
<span class="go"> &#39;parent&#39;: {&#39;optional&#39;: [&#39;semigroup_generators&#39;],</span>
<span class="go">  &#39;required&#39;: [&#39;__contains__&#39;]}}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">product</span></code> does not appear in the list because a default implementation
is provided in term of the method <code class="docutils literal notranslate"><span class="pre">_mul_</span></code> on elements. Of course, at
least one of them should be implemented. On the other hand, a default
implementation for <code class="docutils literal notranslate"><span class="pre">__contains__</span></code> is provided by <a class="reference external" href="../../../structure/sage/structure/parent.html#sage.structure.parent.Parent" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parent</span></code></a>.</p>
<p>Documentation about those methods can be obtained with:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">FiniteSemigroups</span><span class="p">()</span><span class="o">.</span><span class="n">element_class</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">_mul_</span><span class="err">?</span>                                <span class="c1"># not tested</span>
</pre></div>
</div>
<p>See also the <a class="reference external" href="../../../misc/sage/misc/abstract_method.html#sage.misc.abstract_method.abstract_method" title="(in Utilities v10.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">abstract_method()</span></code></a> decorator.</p>
<p>Here is the code for the finite semigroups category:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FiniteSemigroups</span><span class="err">??</span>                      <span class="c1"># not tested</span>
</pre></div>
</div>
</section>
<section id="specifying-the-category-of-a-parent">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Specifying the category of a parent</a><a class="headerlink" href="#specifying-the-category-of-a-parent" title="Link to this heading">#</a></h2>
<p>Some parent constructors (not enough!) allow to specify the desired
category for the parent. This can typically be used to specify
additional properties of the parent that we know to hold a priori. For
example, permutation groups are by default in the category of finite
permutation groups (no surprise):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">PermutationGroup</span><span class="p">([[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)]]);</span> <span class="n">P</span>                                          <span class="c1"># needs sage.combinat sage.groups</span>
<span class="go">Permutation Group with generators [(1,2,3)]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>                                                                  <span class="c1"># needs sage.combinat</span>
<span class="go">Category of finite enumerated permutation groups</span>
</pre></div>
</div>
<p>In this case, the group is commutative, so we can specify this:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">PermutationGroup</span><span class="p">([[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)]],</span>                                             <span class="c1"># needs sage.combinat sage.groups</span>
<span class="gp">....: </span>                     <span class="n">category</span><span class="o">=</span><span class="n">PermutationGroups</span><span class="p">()</span><span class="o">.</span><span class="n">Finite</span><span class="p">()</span><span class="o">.</span><span class="n">Commutative</span><span class="p">());</span> <span class="n">P</span>
<span class="go">Permutation Group with generators [(1,2,3)]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>                                                                  <span class="c1"># needs sage.combinat</span>
<span class="go">Category of finite enumerated commutative permutation groups</span>
</pre></div>
</div>
<p>This feature can even be used, typically in experimental code, to add
more structure to existing parents, and in particular to add methods
for the parents or the elements, without touching the code base:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">Foos</span><span class="p">(</span><span class="n">Category</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">super_categories</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>         <span class="k">return</span> <span class="p">[</span><span class="n">PermutationGroups</span><span class="p">()</span><span class="o">.</span><span class="n">Finite</span><span class="p">()</span><span class="o">.</span><span class="n">Commutative</span><span class="p">()]</span>
<span class="gp">....: </span>    <span class="k">class</span> <span class="nc">ParentMethods</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">class</span> <span class="nc">ElementMethods</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="c1"># needs sage.combinat</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">PermutationGroup</span><span class="p">([[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)]],</span> <span class="n">category</span><span class="o">=</span><span class="n">Foos</span><span class="p">())</span>                            <span class="c1"># needs sage.groups</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">foo</span><span class="p">()</span>
<span class="go">foo</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="go">bar</span>
</pre></div>
</div>
<p>In the long run, it would be thinkable to use this idiom to implement
forgetful functors; for example the above group could be constructed
as a plain set with:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">PermutationGroup</span><span class="p">([[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)]],</span> <span class="n">category</span><span class="o">=</span><span class="n">Sets</span><span class="p">())</span>    <span class="c1"># not implemented, needs sage.combinat</span>
</pre></div>
</div>
<p>At this stage though, this is still to be explored for robustness
and practicality. For now, most parents that accept a category argument
only accept a subcategory of the default one.</p>
</section>
<section id="scaling-further-functorial-constructions-axioms">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Scaling further: functorial constructions, axioms, …</a><a class="headerlink" href="#scaling-further-functorial-constructions-axioms" title="Link to this heading">#</a></h2>
<p>In this section, we explore more advanced features of categories.
Along the way, we illustrate that a large hierarchy of categories is
desirable to model complicated mathematics, and that scaling to
support such a large hierarchy is the driving motivation for the
design of the category infrastructure.</p>
<section id="functorial-constructions">
<span id="category-primer-functorial-constructions"></span><h3>Functorial constructions<a class="headerlink" href="#functorial-constructions" title="Link to this heading">#</a></h3>
<p>Sage has support for a certain number of so-called <em>covariant
functorial constructions</em> which can be used to construct new parents
from existing ones while carrying over as much as possible of their
algebraic structure. This includes:</p>
<ul class="simple">
<li><p>Cartesian products:
See <code class="xref py py-const docutils literal notranslate"><span class="pre">cartesian_product</span></code>.</p></li>
<li><p>Tensor products:
See <a class="reference internal" href="tensor.html#sage.categories.tensor.tensor" title="sage.categories.tensor.tensor"><code class="xref py py-const docutils literal notranslate"><span class="pre">tensor</span></code></a>.</p></li>
<li><p>Subquotients / quotients / subobjects / isomorphic objects:
See:</p>
<ul>
<li><p><a class="reference internal" href="sets_cat.html#sage.categories.sets_cat.Sets.SubcategoryMethods.Subquotients" title="sage.categories.sets_cat.Sets.SubcategoryMethods.Subquotients"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Sets().Subquotients</span></code></a>,</p></li>
<li><p><a class="reference internal" href="sets_cat.html#sage.categories.sets_cat.Sets.SubcategoryMethods.Quotients" title="sage.categories.sets_cat.Sets.SubcategoryMethods.Quotients"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Sets().Quotients</span></code></a>,</p></li>
<li><p><a class="reference internal" href="sets_cat.html#sage.categories.sets_cat.Sets.SubcategoryMethods.Subobjects" title="sage.categories.sets_cat.Sets.SubcategoryMethods.Subobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Sets().Subobjects</span></code></a>,</p></li>
<li><p><a class="reference internal" href="sets_cat.html#sage.categories.sets_cat.Sets.SubcategoryMethods.IsomorphicObjects" title="sage.categories.sets_cat.Sets.SubcategoryMethods.IsomorphicObjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Sets().IsomorphicObjects</span></code></a></p></li>
</ul>
</li>
<li><p>Dual objects:
See <a class="reference internal" href="modules.html#sage.categories.modules.Modules.SubcategoryMethods.DualObjects" title="sage.categories.modules.Modules.SubcategoryMethods.DualObjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Modules().DualObjects</span></code></a>.</p></li>
<li><p>Algebras, as in group algebras, monoid algebras, …:
See: <a class="reference internal" href="sets_cat.html#sage.categories.sets_cat.Sets.ParentMethods.algebra" title="sage.categories.sets_cat.Sets.ParentMethods.algebra"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Sets.ParentMethods.algebra()</span></code></a>.</p></li>
</ul>
<p>Let for example <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> be two parents, and let us construct the
Cartesian product <span class="math notranslate nohighlight">\(A \times B \times B\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AlgebrasWithBasis</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">example</span><span class="p">();</span>     <span class="n">A</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>                        <span class="c1"># needs sage.combinat sage.modules</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">HopfAlgebrasWithBasis</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">example</span><span class="p">();</span> <span class="n">B</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>                        <span class="c1"># needs sage.combinat sage.modules</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">cartesian_product</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="p">]);</span> <span class="n">C</span>                                           <span class="c1"># needs sage.combinat sage.modules</span>
<span class="go">A (+) B (+) B</span>
</pre></div>
</div>
<p>In which category should this new parent be? Since <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are
vector spaces, the result is, as a vector space, the direct sum
<span class="math notranslate nohighlight">\(A \oplus B \oplus B\)</span>, hence the notation. Also, since both <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>
are monoids, <span class="math notranslate nohighlight">\(A \times B \times B\)</span> is naturally endowed with a monoid
structure for pointwise multiplication:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="ow">in</span> <span class="n">Monoids</span><span class="p">()</span>                                                                <span class="c1"># needs sage.combinat sage.modules</span>
<span class="go">True</span>
</pre></div>
</div>
<p>the unit being the Cartesian product of the units of the operands:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>                                                                       <span class="c1"># needs sage.combinat sage.modules</span>
<span class="go">B[(0, word: )] + B[(1, ())] + B[(2, ())]</span>
<span class="gp">sage: </span><span class="n">cartesian_product</span><span class="p">([</span><span class="n">A</span><span class="o">.</span><span class="n">one</span><span class="p">(),</span> <span class="n">B</span><span class="o">.</span><span class="n">one</span><span class="p">(),</span> <span class="n">B</span><span class="o">.</span><span class="n">one</span><span class="p">()])</span>                                <span class="c1"># needs sage.combinat sage.modules</span>
<span class="go">B[(0, word: )] + B[(1, ())] + B[(2, ())]</span>
</pre></div>
</div>
<p>The pointwise product can be implemented generically for all magmas
(i.e. sets endowed with a multiplicative operation) that are
constructed as Cartesian products. It’s thus implemented in the
<a class="reference internal" href="magmas.html#sage.categories.magmas.Magmas" title="sage.categories.magmas.Magmas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Magmas</span></code></a> category:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="vm">__module__</span>                                                          <span class="c1"># needs sage.combinat sage.modules</span>
<span class="go">&#39;sage.categories.magmas&#39;</span>
</pre></div>
</div>
<p>More specifically, keeping on using nested classes to structure the
code, the product method is put in the nested class
<a class="reference internal" href="magmas.html#sage.categories.magmas.Magmas.CartesianProducts.ParentMethods" title="sage.categories.magmas.Magmas.CartesianProducts.ParentMethods"><code class="xref py py-class docutils literal notranslate"><span class="pre">Magmas.CartesianProducts.ParentMethods</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">class Magmas(Category):</span>
<span class="go">    class ParentMethods:</span>
<span class="go">        # methods for magmas</span>
<span class="go">    class ElementMethods:</span>
<span class="go">        # methods for elements of magmas</span>
<span class="go">    class CartesianProduct(CartesianProductCategory):</span>
<span class="go">        class ParentMethods:</span>
<span class="go">            # methods for magmas that are constructed as Cartesian products</span>
<span class="go">            def product(self, x, y):</span>
<span class="go">                # ...</span>
<span class="go">        class ElementMethods:</span>
<span class="go">            # ...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The support for nested classes in Python is relatively
recent. Their intensive use for the category infrastructure did
reveal some glitches in their implementation, in particular around
class naming and introspection. Sage currently works around the
more annoying ones but some remain visible. See
e.g. <a class="reference external" href="../../../misc/sage/misc/test_nested_class.html#module-sage.misc.test_nested_class" title="(in Reference Manual v10.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.test_nested_class</span></code></a>.</p>
</div>
<p>Let us now look at the categories of <code class="docutils literal notranslate"><span class="pre">C</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">categories</span><span class="p">()</span>                                                                <span class="c1"># needs sage.combinat sage.modules</span>
<span class="go">[Category of finite dimensional Cartesian products of algebras with basis over Rational Field, ...</span>
<span class="go"> Category of Cartesian products of algebras over Rational Field, ...</span>
<span class="go"> Category of Cartesian products of semigroups, Category of semigroups, ...</span>
<span class="go"> Category of Cartesian products of magmas, ..., Category of magmas, ...</span>
<span class="go"> Category of Cartesian products of additive magmas, ..., Category of additive magmas,</span>
<span class="go"> Category of Cartesian products of sets, Category of sets, ...]</span>
</pre></div>
</div>
<p>This reveals the parallel hierarchy of categories for Cartesian
products of semigroups magmas, … We are thus glad that Sage uses
its knowledge that a monoid is a semigroup to automatically deduce
that a Cartesian product of monoids is a Cartesian product of
semigroups, and build the hierarchy of classes for parents and
elements accordingly.</p>
<p>In general, the Cartesian product of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> can potentially be an
algebra, a coalgebra, a differential module, and be finite
dimensional, or graded, or ….  This can only be decided at runtime,
by introspection into the properties of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>; furthermore, the
number of possible combinations (e.g. finite dimensional differential
algebra) grows exponentially with the number of properties.</p>
</section>
<section id="axioms">
<span id="category-primer-axioms"></span><h3>Axioms<a class="headerlink" href="#axioms" title="Link to this heading">#</a></h3>
<section id="first-examples">
<h4>First examples<a class="headerlink" href="#first-examples" title="Link to this heading">#</a></h4>
<p>We have seen that Sage is aware of the axioms satisfied by, for
example, groups:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">axioms</span><span class="p">()</span>
<span class="go">frozenset({&#39;Associative&#39;, &#39;Inverse&#39;, &#39;Unital&#39;})</span>
</pre></div>
</div>
<p>In fact, the category of groups can be <em>defined</em> by stating that a
group is a magma, that is a set endowed with an internal binary
multiplication, which satisfies the above axioms. Accordingly, we can
construct the category of groups from the category of magmas:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Magmas</span><span class="p">()</span><span class="o">.</span><span class="n">Associative</span><span class="p">()</span><span class="o">.</span><span class="n">Unital</span><span class="p">()</span><span class="o">.</span><span class="n">Inverse</span><span class="p">()</span>
<span class="go">Category of groups</span>
</pre></div>
</div>
<p>In general, we can construct new categories in Sage by specifying the
axioms that are satisfied by the operations of the super
categories. For example, starting from the category of magmas, we can
construct all the following categories just by specifying the axioms
satisfied by the multiplication:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Magmas</span><span class="p">()</span>
<span class="go">Category of magmas</span>
<span class="gp">sage: </span><span class="n">Magmas</span><span class="p">()</span><span class="o">.</span><span class="n">Unital</span><span class="p">()</span>
<span class="go">Category of unital magmas</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Magmas</span><span class="p">()</span><span class="o">.</span><span class="n">Commutative</span><span class="p">()</span><span class="o">.</span><span class="n">Unital</span><span class="p">()</span>
<span class="go">Category of commutative unital magmas</span>
<span class="gp">sage: </span><span class="n">Magmas</span><span class="p">()</span><span class="o">.</span><span class="n">Unital</span><span class="p">()</span><span class="o">.</span><span class="n">Commutative</span><span class="p">()</span>
<span class="go">Category of commutative unital magmas</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Magmas</span><span class="p">()</span><span class="o">.</span><span class="n">Associative</span><span class="p">()</span>
<span class="go">Category of semigroups</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Magmas</span><span class="p">()</span><span class="o">.</span><span class="n">Associative</span><span class="p">()</span><span class="o">.</span><span class="n">Unital</span><span class="p">()</span>
<span class="go">Category of monoids</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Magmas</span><span class="p">()</span><span class="o">.</span><span class="n">Associative</span><span class="p">()</span><span class="o">.</span><span class="n">Unital</span><span class="p">()</span><span class="o">.</span><span class="n">Commutative</span><span class="p">()</span>
<span class="go">Category of commutative monoids</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Magmas</span><span class="p">()</span><span class="o">.</span><span class="n">Associative</span><span class="p">()</span><span class="o">.</span><span class="n">Unital</span><span class="p">()</span><span class="o">.</span><span class="n">Inverse</span><span class="p">()</span>
<span class="go">Category of groups</span>
</pre></div>
</div>
</section>
<section id="axioms-and-categories-with-axioms">
<h4>Axioms and categories with axioms<a class="headerlink" href="#axioms-and-categories-with-axioms" title="Link to this heading">#</a></h4>
<p>Here, <code class="docutils literal notranslate"><span class="pre">Associative</span></code>, <code class="docutils literal notranslate"><span class="pre">Unital</span></code>, <code class="docutils literal notranslate"><span class="pre">Commutative</span></code> are axioms. In
general, any category <code class="docutils literal notranslate"><span class="pre">Cs</span></code> in Sage can declare a new axiom
<code class="docutils literal notranslate"><span class="pre">A</span></code>. Then, the <em>category with axiom</em> <code class="docutils literal notranslate"><span class="pre">Cs.A()</span></code> models the
subcategory of the objects of <code class="docutils literal notranslate"><span class="pre">Cs</span></code> satisfying the axiom
<code class="docutils literal notranslate"><span class="pre">A</span></code>. Similarly, for any subcategory <code class="docutils literal notranslate"><span class="pre">Ds</span></code> of <code class="docutils literal notranslate"><span class="pre">Cs</span></code>, <code class="docutils literal notranslate"><span class="pre">Ds.A()</span></code>
models the subcategory of the objects of <code class="docutils literal notranslate"><span class="pre">Ds</span></code> satisfying the axiom
<code class="docutils literal notranslate"><span class="pre">A</span></code>. In most cases, it’s a <em>full subcategory</em> (see
<a class="reference external" href="https://en.wikipedia.org/wiki/Subcategory">Wikipedia article Subcategory</a>).</p>
<p>For example, the category of sets defines the <code class="docutils literal notranslate"><span class="pre">Finite</span></code> axiom, and
this axiom is available in the subcategory of groups:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sets</span><span class="p">()</span><span class="o">.</span><span class="n">Finite</span><span class="p">()</span>
<span class="go">Category of finite sets</span>
<span class="gp">sage: </span><span class="n">Groups</span><span class="p">()</span><span class="o">.</span><span class="n">Finite</span><span class="p">()</span>
<span class="go">Category of finite groups</span>
</pre></div>
</div>
<p>The meaning of each axiom is described in the documentation of the
corresponding method, which can be obtained as usual by
instrospection:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">Groups</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">Finite</span><span class="err">?</span>              <span class="c1"># not tested</span>
</pre></div>
</div>
<p>The purpose of categories with axioms is no different from other
categories: to provide bookshelves of code, documentation,
mathematical knowledge, tests, for their objects. The extra feature is
that, when intersecting categories, axioms are automatically combined
together:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">Magmas</span><span class="p">()</span><span class="o">.</span><span class="n">Associative</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Magmas</span><span class="p">()</span><span class="o">.</span><span class="n">Unital</span><span class="p">()</span><span class="o">.</span><span class="n">Inverse</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Sets</span><span class="p">()</span><span class="o">.</span><span class="n">Finite</span><span class="p">();</span> <span class="n">C</span>
<span class="go">Category of finite groups</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">axioms</span><span class="p">())</span>
<span class="go">[&#39;Associative&#39;, &#39;Finite&#39;, &#39;Inverse&#39;, &#39;Unital&#39;]</span>
</pre></div>
</div>
<p>For a more advanced example, Sage knows that a ring is a set <span class="math notranslate nohighlight">\(C\)</span>
endowed with a multiplication which distributes over addition, such
that <span class="math notranslate nohighlight">\((C, +)\)</span> is a commutative additive group and <span class="math notranslate nohighlight">\((C, *)\)</span> is a monoid:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">CommutativeAdditiveGroups</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Monoids</span><span class="p">())</span><span class="o">.</span><span class="n">Distributive</span><span class="p">();</span> <span class="n">C</span>
<span class="go">Category of rings</span>

<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">axioms</span><span class="p">())</span>
<span class="go">[&#39;AdditiveAssociative&#39;, &#39;AdditiveCommutative&#39;, &#39;AdditiveInverse&#39;,</span>
<span class="go"> &#39;AdditiveUnital&#39;, &#39;Associative&#39;, &#39;Distributive&#39;, &#39;Unital&#39;]</span>
</pre></div>
</div>
<p>The infrastructure allows for specifying further deduction rules, in
order to encode mathematical facts like Wedderburn’s theorem:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DivisionRings</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Sets</span><span class="p">()</span><span class="o">.</span><span class="n">Finite</span><span class="p">()</span>
<span class="go">Category of finite enumerated fields</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When an axiom specifies the properties of some operations in Sage,
the notations for those operations are tied to this axiom. For
example, as we have seen above, we need two distinct axioms for
associativity: the axiom “AdditiveAssociative” is about the
properties of the addition <span class="math notranslate nohighlight">\(+\)</span>, whereas the axiom “Associative” is
about the properties of the multiplication <span class="math notranslate nohighlight">\(*\)</span>.</p>
<p>We are touching here an inherent limitation of the current
infrastructure. There is indeed no support for providing generic
code that is independent of the notations. In particular, the
category hierarchy about additive structures (additive monoids,
additive groups, …) is completely duplicated by that for
multiplicative structures (monoids, groups, …).</p>
<p>As far as we know, none of the existing computer algebra systems
has a good solution for this problem. The difficulty is that this
is not only about a single notation but a bunch of operators and
methods: <code class="docutils literal notranslate"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">zero,</span> <span class="pre">summation,</span> <span class="pre">sum,</span> <span class="pre">...</span></code> in one case, <code class="docutils literal notranslate"><span class="pre">*,</span> <span class="pre">/,</span>
<span class="pre">one,</span> <span class="pre">product,</span> <span class="pre">prod,</span> <span class="pre">factor,</span> <span class="pre">...</span></code> in the other. Sharing something
between the two hierarchies of categories would only be useful if
one could write generic code that applies in both cases; for that
one needs to somehow automatically substitute the right operations
in the right spots in the code. That’s kind of what we are doing
manually between
e.g. <a class="reference internal" href="additive_magmas.html#sage.categories.additive_magmas.AdditiveMagmas.ParentMethods.addition_table" title="sage.categories.additive_magmas.AdditiveMagmas.ParentMethods.addition_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AdditiveMagmas.ParentMethods.addition_table()</span></code></a> and
<a class="reference internal" href="magmas.html#sage.categories.magmas.Magmas.ParentMethods.multiplication_table" title="sage.categories.magmas.Magmas.ParentMethods.multiplication_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Magmas.ParentMethods.multiplication_table()</span></code></a>, but doing this
systematically is a different beast from what we have been doing
so far with just usual inheritance.</p>
</div>
</section>
<section id="single-entry-point-and-name-space-usage">
<span id="category-primer-axioms-single-entry-point"></span><h4>Single entry point and name space usage<a class="headerlink" href="#single-entry-point-and-name-space-usage" title="Link to this heading">#</a></h4>
<p>A nice feature of the notation <code class="docutils literal notranslate"><span class="pre">Cs.A()</span></code> is that, from a single entry
point (say the category <a class="reference internal" href="magmas.html#sage.categories.magmas.Magmas" title="sage.categories.magmas.Magmas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Magmas</span></code></a> as above), one can explore a
whole range of related categories, typically with the help of
introspection to discover which axioms are available, and without
having to import new Python modules. This feature will be used in
<a class="reference external" href="https://github.com/sagemath/sage/issues/15741">github issue #15741</a> to unclutter the global name space from, for example,
the many variants of the category of algebras like:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FiniteDimensionalAlgebrasWithBasis</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Category of finite dimensional algebras with basis over Rational Field</span>
</pre></div>
</div>
<p>There will of course be a deprecation step, but it’s recommended to
prefer right away the more flexible notation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">WithBasis</span><span class="p">()</span><span class="o">.</span><span class="n">FiniteDimensional</span><span class="p">()</span>
<span class="go">Category of finite dimensional algebras with basis over Rational Field</span>
</pre></div>
</div>
<aside class="topic">
<p class="topic-title">Design discussion</p>
<p>How far should this be pushed? <a class="reference internal" href="fields.html#sage.categories.fields.Fields" title="sage.categories.fields.Fields"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a> should definitely
stay, but should <a class="reference internal" href="finite_groups.html#sage.categories.finite_groups.FiniteGroups" title="sage.categories.finite_groups.FiniteGroups"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteGroups</span></code></a> or <a class="reference internal" href="division_rings.html#sage.categories.division_rings.DivisionRings" title="sage.categories.division_rings.DivisionRings"><code class="xref py py-class docutils literal notranslate"><span class="pre">DivisionRings</span></code></a>
be removed from the global namespace? Do we want to further
completely deprecate the notation <code class="docutils literal notranslate"><span class="pre">FiniteGroups()`</span> <span class="pre">in</span> <span class="pre">favor</span> <span class="pre">of</span>
<span class="pre">``Groups().Finite()</span></code>?</p>
</aside>
</section>
<section id="on-the-potential-combinatorial-explosion-of-categories-with-axioms">
<span id="category-primer-axioms-explosion"></span><h4>On the potential combinatorial explosion of categories with axioms<a class="headerlink" href="#on-the-potential-combinatorial-explosion-of-categories-with-axioms" title="Link to this heading">#</a></h4>
<p>Even for a very simple category like <code class="docutils literal notranslate"><span class="pre">Magmas</span></code>, there are about <span class="math notranslate nohighlight">\(2^5\)</span>
potential combinations of the axioms! Think about what this becomes
for a category with two operations <span class="math notranslate nohighlight">\(+\)</span> and <span class="math notranslate nohighlight">\(*\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">Magmas</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">AdditiveMagmas</span><span class="p">())</span><span class="o">.</span><span class="n">Distributive</span><span class="p">();</span> <span class="n">C</span>
<span class="go">Category of distributive magmas and additive magmas</span>

<span class="gp">sage: </span><span class="n">CAA</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Associative</span><span class="p">()</span><span class="o">.</span><span class="n">AdditiveAssociative</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">CAA</span><span class="o">.</span><span class="n">AdditiveCommutative</span><span class="p">()</span><span class="o">.</span><span class="n">AdditiveUnital</span><span class="p">()</span><span class="o">.</span><span class="n">AdditiveInverse</span><span class="p">()</span>
<span class="go">Category of rngs</span>

<span class="gp">sage: </span><span class="n">CAA</span><span class="o">.</span><span class="n">AdditiveCommutative</span><span class="p">()</span><span class="o">.</span><span class="n">AdditiveUnital</span><span class="p">()</span><span class="o">.</span><span class="n">Unital</span><span class="p">()</span>
<span class="go">Category of semirings</span>

<span class="gp">sage: </span><span class="n">CAA</span><span class="o">.</span><span class="n">AdditiveCommutative</span><span class="p">()</span><span class="o">.</span><span class="n">AdditiveUnital</span><span class="p">()</span><span class="o">.</span><span class="n">AdditiveInverse</span><span class="p">()</span><span class="o">.</span><span class="n">Unital</span><span class="p">()</span>
<span class="go">Category of rings</span>

<span class="gp">sage: </span><span class="n">Rings</span><span class="p">()</span><span class="o">.</span><span class="n">Division</span><span class="p">()</span>
<span class="go">Category of division rings</span>

<span class="gp">sage: </span><span class="n">Rings</span><span class="p">()</span><span class="o">.</span><span class="n">Division</span><span class="p">()</span><span class="o">.</span><span class="n">Commutative</span><span class="p">()</span>
<span class="go">Category of fields</span>

<span class="gp">sage: </span><span class="n">Rings</span><span class="p">()</span><span class="o">.</span><span class="n">Division</span><span class="p">()</span><span class="o">.</span><span class="n">Finite</span><span class="p">()</span>
<span class="go">Category of finite enumerated fields</span>
</pre></div>
</div>
<p>or for more advanced categories:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">HopfAlgebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">WithBasis</span><span class="p">()</span><span class="o">.</span><span class="n">Graded</span><span class="p">()</span><span class="o">.</span><span class="n">Connected</span><span class="p">()</span><span class="o">.</span><span class="n">category_graph</span><span class="p">()</span>        <span class="c1"># needs sage.graphs</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_latex_options</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;dot2tex&quot;</span><span class="p">)</span>                                         <span class="c1"># needs sage.graphs</span>
<span class="gp">sage: </span><span class="n">view</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>                               <span class="c1"># not tested                            # needs sage.graphs sage.plot</span>
</pre></div>
</div>
</section>
<section id="difference-between-axioms-and-regressive-covariant-functorial-constructions">
<h4>Difference between axioms and regressive covariant functorial constructions<a class="headerlink" href="#difference-between-axioms-and-regressive-covariant-functorial-constructions" title="Link to this heading">#</a></h4>
<p>Our running examples here will be the axiom <code class="docutils literal notranslate"><span class="pre">FiniteDimensional</span></code> and
the regressive covariant functorial construction <code class="docutils literal notranslate"><span class="pre">Graded</span></code>. Let
<code class="docutils literal notranslate"><span class="pre">Cs</span></code> be some subcategory of <code class="docutils literal notranslate"><span class="pre">Modules</span></code>, say the category of modules
itself:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cs</span> <span class="o">=</span> <span class="n">Modules</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, <code class="docutils literal notranslate"><span class="pre">Cs.FiniteDimensional()</span></code> (respectively <code class="docutils literal notranslate"><span class="pre">Cs.Graded()</span></code>) is the
subcategory of the objects <code class="docutils literal notranslate"><span class="pre">O</span></code> of <code class="docutils literal notranslate"><span class="pre">Cs</span></code> which are finite
dimensional (respectively graded).</p>
<p>Let also <code class="docutils literal notranslate"><span class="pre">Ds</span></code> be a subcategory of <code class="docutils literal notranslate"><span class="pre">Cs</span></code>, say:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Ds</span> <span class="o">=</span> <span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
</pre></div>
</div>
<p>A finite dimensional algebra is also a finite dimensional module:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">FiniteDimensional</span><span class="p">()</span><span class="o">.</span><span class="n">is_subcategory</span><span class="p">(</span><span class="n">Modules</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">FiniteDimensional</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Similarly a graded algebra is also a graded module:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">Graded</span><span class="p">()</span><span class="o">.</span><span class="n">is_subcategory</span><span class="p">(</span> <span class="n">Modules</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">Graded</span><span class="p">()</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This is the <em>covariance</em> property: for <code class="docutils literal notranslate"><span class="pre">A</span></code> an axiom or a covariant
functorial construction, if <code class="docutils literal notranslate"><span class="pre">Ds</span></code> is a subcategory of <code class="docutils literal notranslate"><span class="pre">Cs</span></code>, then
<code class="docutils literal notranslate"><span class="pre">Ds.A()</span></code> is a subcategory of <code class="docutils literal notranslate"><span class="pre">Cs.A()</span></code>.</p>
<p>What happens if we consider reciprocally an object of <code class="docutils literal notranslate"><span class="pre">Cs.A()</span></code> which
is also in <code class="docutils literal notranslate"><span class="pre">Ds</span></code>? A finite dimensional module which is also an
algebra is a finite dimensional algebra:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Modules</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">FiniteDimensional</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Category of finite dimensional algebras over Rational Field</span>
</pre></div>
</div>
<p>On the other hand, a graded module <span class="math notranslate nohighlight">\(O\)</span> which is also an algebra is not
necessarily a graded algebra! Indeed, the grading on <span class="math notranslate nohighlight">\(O\)</span> may not be
compatible with the product on <span class="math notranslate nohighlight">\(O\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Modules</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">Graded</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Join of Category of algebras over Rational Field</span>
<span class="go"> and Category of graded vector spaces over Rational Field</span>
</pre></div>
</div>
<p>The relevant difference between <code class="docutils literal notranslate"><span class="pre">FiniteDimensional</span></code> and <code class="docutils literal notranslate"><span class="pre">Graded</span></code>
is that <code class="docutils literal notranslate"><span class="pre">FiniteDimensional</span></code> is a statement about the properties of
<code class="docutils literal notranslate"><span class="pre">O</span></code> seen as a module (and thus does not depend on the given
category), whereas <code class="docutils literal notranslate"><span class="pre">Graded</span></code> is a statement about the properties of
<code class="docutils literal notranslate"><span class="pre">O</span></code> and all its operations in the given category.</p>
<p>In general, if a category satisfies a given axiom, any subcategory
also satisfies that axiom. Another formulation is that, for an axiom
<code class="docutils literal notranslate"><span class="pre">A</span></code> defined in a super category <code class="docutils literal notranslate"><span class="pre">Cs</span></code> of <code class="docutils literal notranslate"><span class="pre">Ds</span></code>, <code class="docutils literal notranslate"><span class="pre">Ds.A()</span></code> is the
intersection of the categories <code class="docutils literal notranslate"><span class="pre">Ds</span></code> and <code class="docutils literal notranslate"><span class="pre">Cs.A()</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">As</span> <span class="o">=</span> <span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">FiniteDimensional</span><span class="p">();</span> <span class="n">As</span>
<span class="go">Category of finite dimensional algebras over Rational Field</span>
<span class="gp">sage: </span><span class="n">Bs</span> <span class="o">=</span> <span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">Modules</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">FiniteDimensional</span><span class="p">();</span> <span class="n">As</span>
<span class="go">Category of finite dimensional algebras over Rational Field</span>
<span class="gp">sage: </span><span class="n">As</span> <span class="ow">is</span> <span class="n">Bs</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An immediate consequence is that, as we have already noticed, axioms
commute:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">As</span> <span class="o">=</span> <span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">FiniteDimensional</span><span class="p">()</span><span class="o">.</span><span class="n">WithBasis</span><span class="p">();</span> <span class="n">As</span>
<span class="go">Category of finite dimensional algebras with basis over Rational Field</span>
<span class="gp">sage: </span><span class="n">Bs</span> <span class="o">=</span> <span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">WithBasis</span><span class="p">()</span><span class="o">.</span><span class="n">FiniteDimensional</span><span class="p">();</span> <span class="n">Bs</span>
<span class="go">Category of finite dimensional algebras with basis over Rational Field</span>
<span class="gp">sage: </span><span class="n">As</span> <span class="ow">is</span> <span class="n">Bs</span>
<span class="go">True</span>
</pre></div>
</div>
<p>On the other hand, axioms do not necessarily commute with functorial
constructions, even if the current printout may missuggest so:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">As</span> <span class="o">=</span> <span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">Graded</span><span class="p">()</span><span class="o">.</span><span class="n">WithBasis</span><span class="p">();</span> <span class="n">As</span>
<span class="go">Category of graded algebras with basis over Rational Field</span>
<span class="gp">sage: </span><span class="n">Bs</span> <span class="o">=</span> <span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">WithBasis</span><span class="p">()</span><span class="o">.</span><span class="n">Graded</span><span class="p">();</span> <span class="n">Bs</span>
<span class="go">Category of graded algebras with basis over Rational Field</span>
<span class="gp">sage: </span><span class="n">As</span> <span class="ow">is</span> <span class="n">Bs</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This is because <code class="docutils literal notranslate"><span class="pre">Bs</span></code> is the category of algebras endowed with basis,
which are further graded; in particular the basis must respect the
grading (i.e. be made of homogeneous elements). On the other hand,
<code class="docutils literal notranslate"><span class="pre">As</span></code> is the category of graded algebras, which are further endowed
with some basis; that basis need not respect the grading. In fact
<code class="docutils literal notranslate"><span class="pre">As</span></code> is really a join category:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">As</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.categories.category.JoinCategory_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">As</span><span class="o">.</span><span class="n">_repr_</span><span class="p">(</span><span class="n">as_join</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;Join of Category of algebras with basis over Rational Field and Category of graded algebras over Rational Field&#39;</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Improve the printing of functorial constructions and joins to
raise this potentially dangerous ambiguity.</p>
</div>
</section>
<section id="further-reading-on-axioms">
<h4>Further reading on axioms<a class="headerlink" href="#further-reading-on-axioms" title="Link to this heading">#</a></h4>
<p>We refer to <a class="reference internal" href="category_with_axiom.html#module-sage.categories.category_with_axiom" title="sage.categories.category_with_axiom"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.categories.category_with_axiom</span></code></a> for how to
implement axioms.</p>
</section>
</section>
<section id="id3">
<h3>Wrap-up<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>As we have seen, there is a combinatorial explosion of possible
classes. Constructing by hand the full class hierarchy would not scale
unless one would restrict to a very rigid subset. Even if it was
possible to construct automatically the full hierarchy, this would not
scale with respect to system resources.</p>
<p>When designing software systems with large hierarchies of abstract
classes for business objects, the difficulty is usually to identify a
proper set of key concepts. Here we are lucky, as the key concepts
have been long identified and are relatively few:</p>
<ul class="simple">
<li><p>Operations (<span class="math notranslate nohighlight">\(+\)</span>, <span class="math notranslate nohighlight">\(*\)</span>, …)</p></li>
<li><p>Axioms on those operations (associativity, …)</p></li>
<li><p>Constructions (Cartesian products, …)</p></li>
</ul>
<p>Better, those concepts are sufficiently well known so that a user can
reasonably be expected to be familiar with the concepts that are
involved for his own needs.</p>
<p>Instead, the difficulty is concentrated in the huge number of possible
combinations, an unpredictable large subset of which being potentially
of interest; at the same time, only a small – but moving – subset
has code naturally attached to it.</p>
<p>This has led to the current design, where one focuses on writing the
relatively few classes for which there is actual code or mathematical
information, and lets Sage <em>compose dynamically and lazily</em> those
building blocks to construct the minimal hierarchy of classes needed
for the computation at hand. This allows for the infrastructure to
scale smoothly as bookshelves are added, extended, or reorganized.</p>
</section>
</section>
<section id="writing-a-new-category">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Writing a new category</a><a class="headerlink" href="#writing-a-new-category" title="Link to this heading">#</a></h2>
<p>Each category <span class="math notranslate nohighlight">\(C\)</span> <strong>must</strong> be provided with a method
<code class="docutils literal notranslate"><span class="pre">C.super_categories()</span></code> and <em>can</em> be provided with a method
<code class="docutils literal notranslate"><span class="pre">C._subcategory_hook_(D)</span></code>. Also, it may be needed to insert <span class="math notranslate nohighlight">\(C\)</span> into
the output of the <code class="docutils literal notranslate"><span class="pre">super_categories()</span></code> method of some other
category. This determines the position of <span class="math notranslate nohighlight">\(C\)</span> in the category graph.</p>
<p>A category <em>may</em> provide methods that can be used by all its objects,
respectively by all elements of its objects.</p>
<p>Each category <em>should</em> come with a good example, in
<code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.categories.examples</span></code>.</p>
<section id="inserting-the-new-category-into-the-category-graph">
<h3>Inserting the new category into the category graph<a class="headerlink" href="#inserting-the-new-category-into-the-category-graph" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">C.super_categories()</span></code> <em>must</em> return a list of categories, namely
the <em>immediate</em> super categories of <span class="math notranslate nohighlight">\(C\)</span>.  Of course, if you know that
your new category <span class="math notranslate nohighlight">\(C\)</span> is an immediate super category of some existing
category <span class="math notranslate nohighlight">\(D\)</span>, then you should also update the method
<code class="docutils literal notranslate"><span class="pre">D.super_categories</span></code> to include <span class="math notranslate nohighlight">\(C\)</span>.</p>
<p>The immediate super categories of <span class="math notranslate nohighlight">\(C\)</span> <em>should not</em> be <a class="reference internal" href="category.html#sage.categories.category.JoinCategory" title="sage.categories.category.JoinCategory"><code class="xref py py-class docutils literal notranslate"><span class="pre">join</span>
<span class="pre">categories</span></code></a>. Furthermore, one always should have:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">Cs().is_subcategory( Category.join(Cs().super_categories()) )</span>

<span class="go">Cs()._cmp_key  &gt;  other._cmp_key  for other in Cs().super_categories()</span>
</pre></div>
</div>
<p>This is checked by <a class="reference internal" href="category.html#sage.categories.category.Category._test_category" title="sage.categories.category.Category._test_category"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_test_category()</span></code></a>.</p>
<p>In several cases, the category <span class="math notranslate nohighlight">\(C\)</span> is directly provided with a generic
implementation of <code class="docutils literal notranslate"><span class="pre">super_categories</span></code>; a typical example is when <span class="math notranslate nohighlight">\(C\)</span>
implements an axiom or a functorial construction; in such a case, <span class="math notranslate nohighlight">\(C\)</span>
may implement <code class="docutils literal notranslate"><span class="pre">C.extra_super_categories()</span></code> to complement the super
categories discovered by the generic implementation. This method needs
not return immediate super categories; instead it’s usually best to
specify the largest super category providing the desired mathematical
information. For example, the category
<a class="reference internal" href="magmas.html#sage.categories.magmas.Magmas.Commutative.Algebras" title="sage.categories.magmas.Magmas.Commutative.Algebras"><code class="xref py py-class docutils literal notranslate"><span class="pre">Magmas.Commutative.Algebras</span></code></a> just states that the algebra of a
commutative magma is a commutative magma. This is sufficient to let
Sage deduce that it’s in fact a commutative algebra.</p>
</section>
<section id="methods-for-objects-and-elements">
<h3>Methods for objects and elements<a class="headerlink" href="#methods-for-objects-and-elements" title="Link to this heading">#</a></h3>
<p>Different objects of the same category share some algebraic features, and
very often these features can be encoded in a method, in a generic way.
For example, for every commutative additive monoid, it makes sense to ask
for the sum of a list of elements. Sage’s category framework allows to
provide a generic implementation for all objects of a category.</p>
<p>If you want to provide your new category with generic methods for
objects (or elements of objects), then you simply add a nested class
called <code class="docutils literal notranslate"><span class="pre">ParentMethods</span></code> (or <code class="docutils literal notranslate"><span class="pre">ElementMethods</span></code>). The methods of that
class will automatically become methods of the objects (or the
elements). For instance:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">prod</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">2*x*y</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="vm">__module__</span>
<span class="go">&#39;sage.categories.monoids&#39;</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="vm">__func__</span> <span class="ow">is</span> <span class="n">raw_getattr</span><span class="p">(</span><span class="n">Monoids</span><span class="p">()</span><span class="o">.</span><span class="n">ParentMethods</span><span class="p">,</span> <span class="s2">&quot;prod&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We recommend to study the code of one example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">CommutativeAdditiveMonoids</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="err">??</span>                               <span class="c1"># not tested</span>
</pre></div>
</div>
</section>
<section id="on-the-order-of-super-categories">
<span id="category-primer-category-order"></span><h3>On the order of super categories<a class="headerlink" href="#on-the-order-of-super-categories" title="Link to this heading">#</a></h3>
<p>The generic method <code class="docutils literal notranslate"><span class="pre">C.all_super_categories()</span></code> determines recursively
the list of <em>all</em> super categories of <span class="math notranslate nohighlight">\(C\)</span>.</p>
<p>The order of the categories in this list does influence the
inheritance of methods for parents and elements. Namely, if <span class="math notranslate nohighlight">\(P\)</span> is an
object in the category <span class="math notranslate nohighlight">\(C\)</span> and if <span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_2\)</span> are both super
categories of <span class="math notranslate nohighlight">\(C\)</span> defining some method <code class="docutils literal notranslate"><span class="pre">foo</span></code> in <code class="docutils literal notranslate"><span class="pre">ParentMethods</span></code>,
then <span class="math notranslate nohighlight">\(P\)</span> will use <span class="math notranslate nohighlight">\(C_1\)</span>’s version of <code class="docutils literal notranslate"><span class="pre">foo</span></code> if and only if <span class="math notranslate nohighlight">\(C_1\)</span>
appears in <code class="docutils literal notranslate"><span class="pre">C.all_super_categories()</span></code> before <span class="math notranslate nohighlight">\(C_2\)</span>.</p>
<p>However this must be considered as an <em>implementation detail</em>: if
<span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_2\)</span> are incomparable categories, then the order in which
they appear must be mathematically irrelevant: in particular, the
methods <code class="docutils literal notranslate"><span class="pre">foo</span></code> in <span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_2\)</span> must have the same semantic. Code
should not rely on any specific order, as it is subject to later
change. Whenever one of the implementations is preferred in some common
subcategory of <span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_2\)</span>, for example for efficiency reasons,
the ambiguity should be resolved explicitly by defining a
method <code class="docutils literal notranslate"><span class="pre">foo</span></code> in this category. See the method <code class="docutils literal notranslate"><span class="pre">some_elements</span></code> in
the code of the category <a class="reference internal" href="finite_coxeter_groups.html#sage.categories.finite_coxeter_groups.FiniteCoxeterGroups" title="sage.categories.finite_coxeter_groups.FiniteCoxeterGroups"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteCoxeterGroups</span></code></a> for an example.</p>
<p>Since <a class="reference external" href="https://github.com/sagemath/sage/issues/11943">github issue #11943</a>, <code class="docutils literal notranslate"><span class="pre">C.all_super_categories()</span></code> is computed by the
so-called <code class="docutils literal notranslate"><span class="pre">C3</span></code> algorithm used by Python to compute Method Resolution
Order of new-style classes. Thus the order in
<code class="docutils literal notranslate"><span class="pre">C.all_super_categories()</span></code>, <code class="docutils literal notranslate"><span class="pre">C.parent_class.mro()</span></code> and
<code class="docutils literal notranslate"><span class="pre">C.element_class.mro()</span></code> are guaranteed to be consistent.</p>
<p>Since <a class="reference external" href="https://github.com/sagemath/sage/issues/13589">github issue #13589</a>, the <code class="docutils literal notranslate"><span class="pre">C3</span></code> algorithm is put under control of some
total order on categories. This order is not necessarily meaningful,
but it guarantees that <code class="docutils literal notranslate"><span class="pre">C3</span></code> always finds a consistent Method
Resolution Order. For background, see
<a class="reference external" href="../../../misc/sage/misc/c3_controlled.html#module-sage.misc.c3_controlled" title="(in Reference Manual v10.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.c3_controlled</span></code></a>. A visible effect is that the order in
which categories are specified in <code class="docutils literal notranslate"><span class="pre">C.super_categories()</span></code>, or in a
join category, no longer influences the result of
<code class="docutils literal notranslate"><span class="pre">C.all_super_categories()</span></code>.</p>
</section>
<section id="subcategory-hook-advanced-optimization-feature">
<h3>Subcategory hook (advanced optimization feature)<a class="headerlink" href="#subcategory-hook-advanced-optimization-feature" title="Link to this heading">#</a></h3>
<p>The default implementation of the method <code class="docutils literal notranslate"><span class="pre">C.is_subcategory(D)</span></code> is to
look up whether <span class="math notranslate nohighlight">\(D\)</span> appears in <code class="docutils literal notranslate"><span class="pre">C.all_super_categories()</span></code>. However,
building the list of all the super categories of <span class="math notranslate nohighlight">\(C\)</span> is an expensive
operation that is sometimes best avoided. For example, if both <span class="math notranslate nohighlight">\(C\)</span> and
<span class="math notranslate nohighlight">\(D\)</span> are categories defined over a base, but the bases differ, then one
knows right away that they can not be subcategories of each other.</p>
<p>When such a short-path is known, one can implement a method
<code class="docutils literal notranslate"><span class="pre">_subcategory_hook_</span></code>. Then, <code class="docutils literal notranslate"><span class="pre">C.is_subcategory(D)</span></code> first calls
<code class="docutils literal notranslate"><span class="pre">D._subcategory_hook_(C)</span></code>. If this returns <code class="docutils literal notranslate"><span class="pre">Unknown</span></code>, then
<code class="docutils literal notranslate"><span class="pre">C.is_subcategory(D)</span></code> tries to find <code class="docutils literal notranslate"><span class="pre">D</span></code> in
<code class="docutils literal notranslate"><span class="pre">C.all_super_categories()</span></code>. Otherwise, <code class="docutils literal notranslate"><span class="pre">C.is_subcategory(D)</span></code>
returns the result of <code class="docutils literal notranslate"><span class="pre">D._subcategory_hook_(C)</span></code>.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">D._subcategory_hook_(C)</span></code> tests whether
<code class="docutils literal notranslate"><span class="pre">issubclass(C.parent_class,D.parent_class)</span></code>, which is very often
giving the right answer:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Rings</span><span class="p">()</span><span class="o">.</span><span class="n">_subcategory_hook_</span><span class="p">(</span><span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">HopfAlgebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">_subcategory_hook_</span><span class="p">(</span><span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Algebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">_subcategory_hook_</span><span class="p">(</span><span class="n">HopfAlgebras</span><span class="p">(</span><span class="n">QQ</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="category.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Categories</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="all.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Sage categories quickref</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2024, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Elements, parents, and categories in Sage: a primer</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a><ul>
<li><a class="reference internal" href="#one-line-pitch-for-mathematicians">One line pitch for mathematicians</a></li>
<li><a class="reference internal" href="#one-line-pitch-for-programmers">One line pitch for programmers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#introduction-sage-as-a-library-of-objects-and-algorithms">Introduction: Sage as a library of objects and algorithms</a><ul>
<li><a class="reference internal" href="#some-challenges">Some challenges</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-bit-of-help-from-abstract-algebra">A bit of help from abstract algebra</a><ul>
<li><a class="reference internal" href="#the-hierarchy-of-categories">The hierarchy of categories</a></li>
<li><a class="reference internal" href="#elements-parents-categories">Elements, Parents, Categories</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-bit-of-help-from-computer-science">A bit of help from computer science</a><ul>
<li><a class="reference internal" href="#hierarchy-of-classes">Hierarchy of classes</a></li>
<li><a class="reference internal" href="#parallel-hierarchy-of-classes-for-parents">Parallel hierarchy of classes for parents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage-categories">Sage categories</a><ul>
<li><a class="reference internal" href="#dynamic-hierarchy-of-classes">Dynamic hierarchy of classes</a></li>
<li><a class="reference internal" href="#on-the-category-hierarchy-subcategories-and-super-categories">On the category hierarchy: subcategories and super categories</a></li>
<li><a class="reference internal" href="#categories-are-instances-and-have-operations">Categories are instances and have operations</a></li>
<li><a class="reference internal" href="#specifications-and-generic-documentation">Specifications and generic documentation</a></li>
<li><a class="reference internal" href="#generic-tests">Generic tests</a></li>
<li><a class="reference internal" href="#wrap-up">Wrap-up</a></li>
</ul>
</li>
<li><a class="reference internal" href="#case-study">Case study</a></li>
<li><a class="reference internal" href="#specifying-the-category-of-a-parent">Specifying the category of a parent</a></li>
<li><a class="reference internal" href="#scaling-further-functorial-constructions-axioms">Scaling further: functorial constructions, axioms, …</a><ul>
<li><a class="reference internal" href="#functorial-constructions">Functorial constructions</a></li>
<li><a class="reference internal" href="#axioms">Axioms</a><ul>
<li><a class="reference internal" href="#first-examples">First examples</a></li>
<li><a class="reference internal" href="#axioms-and-categories-with-axioms">Axioms and categories with axioms</a></li>
<li><a class="reference internal" href="#single-entry-point-and-name-space-usage">Single entry point and name space usage</a></li>
<li><a class="reference internal" href="#on-the-potential-combinatorial-explosion-of-categories-with-axioms">On the potential combinatorial explosion of categories with axioms</a></li>
<li><a class="reference internal" href="#difference-between-axioms-and-regressive-covariant-functorial-constructions">Difference between axioms and regressive covariant functorial constructions</a></li>
<li><a class="reference internal" href="#further-reading-on-axioms">Further reading on axioms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id3">Wrap-up</a></li>
</ul>
</li>
<li><a class="reference internal" href="#writing-a-new-category">Writing a new category</a><ul>
<li><a class="reference internal" href="#inserting-the-new-category-into-the-category-graph">Inserting the new category into the category graph</a></li>
<li><a class="reference internal" href="#methods-for-objects-and-elements">Methods for objects and elements</a></li>
<li><a class="reference internal" href="#on-the-order-of-super-categories">On the order of super categories</a></li>
<li><a class="reference internal" href="#subcategory-hook-advanced-optimization-feature">Subcategory hook (advanced optimization feature)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>