<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Tips and References" href="git_background.html" /><link rel="prev" title="The Sage Trac Server" href="trac.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Using Git with the Sage Trac Server - Developer&#39;s Guide</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZGD13B5572"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ZGD13B5572');
</script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Developer's Guide</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 9.8 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="index.html">Home - Developer's Guide</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="git_setup.html">Setting Up Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="walk_through.html">Sage Development Process</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="trac.html">The Sage Trac Server</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Using Git with the Sage Trac Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="git_background.html">Tips and References</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_git.html">Advanced Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows.html">Distributed Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="git_trac.html">Optional: Using the Git-Trac Command</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="workspace.html">Setting up your workspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding_basics.html">General Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="reviewer_checklist.html">The reviewer’s check list</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="doctesting.html">Running Sage’s doctests</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="portability_testing.html">Testing on multiple platforms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Additional development and testing tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sage_manuals.html">The Sage Manuals</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="coding_in_python.html">Coding in Python for Sage</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding_in_cython.html">Coding in Cython</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding_in_other.html">Using External Libraries and Interfaces</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="packaging_sage_library.html">Packaging the Sage Library</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="packaging.html">Packaging Third-Party Code</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="using-git-with-the-sage-trac-server">
<span id="chapter-manual-git"></span><h1>Using Git with the Sage Trac Server<a class="headerlink" href="#using-git-with-the-sage-trac-server" title="Permalink to this heading">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Sage development is scheduled to move to GitHub in February 2023.</strong> The exact
date will be announced in <a class="reference external" href="https://groups.google.com/g/sage-devel">https://groups.google.com/g/sage-devel</a>. After
the transition, some parts of this guide (especially those related with <a class="reference external" href="https://trac.sagemath.org">the
Sage Trac server</a>) will become obsolete and be
updated according to the new workflow on GitHub. See our <a class="reference external" href="https://github.com/sagemath/trac-to-github/blob/master/docs/Migration-Trac-to-Github.md">transition guide from Trac to
GitHub</a>
for the preliminary version of the workflow.</p>
</div>
<p>Now we continue our introduction to git from <a class="reference internal" href="walk_through.html#chapter-walkthrough"><span class="std std-ref">Sage Development Process</span></a>.
We discuss how to push your local changes to a remote repository
so that your changes can be reviewed for inclusion in Sage.</p>
<p>In the following, we assume that you are in the source directory of Sage (<code class="docutils literal notranslate"><span class="pre">SAGE_ROOT</span></code>),
obtained either from a source tarball or by cloning a Sage git repository
such as <a class="reference external" href="https://github.com/sagemath/sage.git">https://github.com/sagemath/sage.git</a>, as described in the
<a class="reference external" href="https://github.com/sagemath/sage/#readme">README</a>.
In either case, this source directory is actually the main worktree of
a local git repository.</p>
<p>Using the following command, we can see which remote repository or repositories
are associated with this local repository:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git remote -v
<span class="go">origin      https://github.com/sagemath/sage.git (fetch)</span>
<span class="go">origin      https://github.com/sagemath/sage.git (push)</span>
</pre></div>
</div>
<section id="git-authentication-through-ssh">
<span id="section-git-ssh"></span><h2>Git authentication through SSH<a class="headerlink" href="#git-authentication-through-ssh" title="Permalink to this heading">#</a></h2>
<p>In order to push changes securely to a remote repository, git uses
public-key cryptography. This section will show you how to set up the
necessary cryptographic keys for Secure Shell (SSH).</p>
<section id="checking-whether-you-have-already-have-suitable-ssh-keys">
<h3>Checking whether you have already have suitable SSH keys<a class="headerlink" href="#checking-whether-you-have-already-have-suitable-ssh-keys" title="Permalink to this heading">#</a></h3>
<p>Follow the instructions in
<a class="reference external" href="https://docs.gitlab.com/ee/user/ssh.html#see-if-you-have-an-existing-ssh-key-pair">https://docs.gitlab.com/ee/user/ssh.html#see-if-you-have-an-existing-ssh-key-pair</a>.</p>
</section>
<section id="generating-your-ssh-keys">
<h3>Generating your SSH Keys<a class="headerlink" href="#generating-your-ssh-keys" title="Permalink to this heading">#</a></h3>
<p>If you don’t have suitable SSH keys yet, you can create a key pair
with the <code class="docutils literal notranslate"><span class="pre">ssh-keygen</span></code> tool.</p>
<p>Follow either the detailed instructions at
<a class="reference external" href="https://docs.gitlab.com/ee/user/ssh.html#generate-an-ssh-key-pair">https://docs.gitlab.com/ee/user/ssh.html#generate-an-ssh-key-pair</a>
or the following brief instructions:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost ~]$ </span>ssh-keygen
<span class="go">Generating public/private rsa key pair.</span>
<span class="go">Enter file in which to save the key (/home/user/.ssh/id_rsa):</span>
<span class="go">Enter passphrase (empty for no passphrase):</span>
<span class="go">Enter same passphrase again:</span>
<span class="go">Your identification has been saved in /home/user/.ssh/id_rsa.</span>
<span class="go">Your public key has been saved in /home/user/.ssh/id_rsa.pub.</span>
<span class="go">The key fingerprint is:</span>
<span class="go">ce:32:b3:de:38:56:80:c9:11:f0:b3:88:f2:1c:89:0a user@localhost</span>
<span class="go">The key&#39;s randomart image is:</span>
<span class="go">+--[ RSA 2048]----+</span>
<span class="go">|  ....           |</span>
<span class="go">|   ..            |</span>
<span class="go">|   .o+           |</span>
<span class="go">| o o+o.          |</span>
<span class="go">|E + .  .S        |</span>
<span class="go">|+o .   o.        |</span>
<span class="go">|. o   +.o        |</span>
<span class="go">|      oB         |</span>
<span class="go">|     o+..        |</span>
<span class="go">+-----------------+</span>
</pre></div>
</div>
<p>This will generate a new random private RSA key
in the <code class="docutils literal notranslate"><span class="pre">.ssh</span></code> folder in your home directory. By default, they are</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">~/.ssh/id_rsa</span></code></dt><dd><p>Your private key. Keep safe. <strong>Never</strong> hand it out to anybody.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">~/.ssh/id_rsa.pub</span></code></dt><dd><p>The corresponding public key. This and only this file can be safely
disclosed to third parties.</p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">ssh-keygen</span></code> tool will let you generate a key with a different
file name, or protect it with a passphrase. Depending on how much you
trust your own computer or system administrator, you can leave the
passphrase empty to be able to login without any human intervention.</p>
</section>
<section id="linking-your-public-key-to-your-trac-account">
<span id="section-trac-ssh-key"></span><h3>Linking your Public Key to your Trac Account<a class="headerlink" href="#linking-your-public-key-to-your-trac-account" title="Permalink to this heading">#</a></h3>
<p>In order to push your code directly to a branch on the git repository
trac.sagemath.org, the Sage trac server needs to know your public
key. You can upload it in the preferences, that is</p>
<ol class="arabic simple">
<li><p>Go to <a class="reference external" href="https://trac.sagemath.org">https://trac.sagemath.org</a></p></li>
<li><p>Log in with your trac username/password</p></li>
<li><p>Click on “Preferences”</p></li>
<li><p>Go to the “SSH Keys” tab</p></li>
<li><p>Paste the content of your public key file
(e.g. <code class="docutils literal notranslate"><span class="pre">~/.ssh/id_rsa.pub</span></code>)</p></li>
<li><p>Click on “Save changes”</p></li>
</ol>
<p>Note that this does <strong>not</strong> allow you to ssh into any account on trac,
it is only used to authenticate you to the gitolite installation on
trac. You can test that you are being authenticated correctly by
issuing some basic gitolite commands, for example:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost ~]$ </span>ssh git@trac.sagemath.org info
<span class="go">hello user, this is git@trac running gitolite3 (unknown) on git 1.7.9.5</span>

<span class="go"> R W      sage</span>
<span class="gp">[user@localhost ~]$ </span>ssh git@trac.sagemath.org <span class="nb">help</span>
<span class="go">hello user, this is gitolite3 (unknown) on git 1.7.9.5</span>

<span class="go">list of remote commands available:</span>

<span class="go">    desc</span>
<span class="go">    help</span>
<span class="go">    info</span>
<span class="go">    perms</span>
<span class="go">    writable</span>
</pre></div>
</div>
</section>
<section id="adding-your-public-key-for-authentication-on-another-server">
<h3>Adding your Public Key for authentication on another server<a class="headerlink" href="#adding-your-public-key-for-authentication-on-another-server" title="Permalink to this heading">#</a></h3>
<p>If you have an account on a lab or department computer that allows you
to log in remotely via SSH, you can now also use your SSH keys to
log in. Just copy the <strong>public</strong> key file (ending in <code class="docutils literal notranslate"><span class="pre">.pub</span></code>) to
<code class="docutils literal notranslate"><span class="pre">~/.ssh/authorized_keys</span></code> on the remote computer and make sure that
the file is only read/writeable by yourself. Voila, the next time you
ssh into that machine you don’t have to provide your password.</p>
</section>
</section>
<section id="the-git-repository-trac-sagemath-org">
<span id="section-git-trac"></span><h2>The git repository trac.sagemath.org<a class="headerlink" href="#the-git-repository-trac-sagemath-org" title="Permalink to this heading">#</a></h2>
<p>The Sage trac server is another git repository for the Sage source tree, it is
served via the ssh protocol. To add it as a remote repository to your local git
repository, use these commands:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git remote add trac https://github.com/sagemath/sagetrac-mirror.git -t master
<span class="gp">[user@localhost sage]$ </span>git remote set-url --push trac git@trac.sagemath.org:sage.git
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Sage development is scheduled to move to GitHub in February 2023.</strong> After the
move, the Sage trac server <a class="reference external" href="mailto:git&#37;&#52;&#48;trac&#46;sagemath&#46;org">git<span>&#64;</span>trac<span>&#46;</span>sagemath<span>&#46;</span>org</a>:sage.git will no longer be
available, but all branches will be available (in read-only mode) on
<a class="reference external" href="https://github.com/sagemath/sagetrac-mirror.git">https://github.com/sagemath/sagetrac-mirror.git</a>.</p>
</div>
<p>Instead of <code class="docutils literal notranslate"><span class="pre">trac</span></code> you can use any other name you want, of course.
To verify that it is set up correctly:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git remote -v
<span class="go">origin      https://github.com/sagemath/sage.git (fetch)</span>
<span class="go">origin      https://github.com/sagemath/sage.git (push)</span>
<span class="go">trac        https://github.com/sagemath/sagetrac-mirror.git (fetch)</span>
<span class="go">trac        git@trac.sagemath.org:sage.git (push)</span>
</pre></div>
</div>
<p>It is perfectly fine to have multiple remote repositories for git,
think of them as bookmarks. You can then use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> to get
changes and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> to upload your local changes using:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git &lt;push<span class="p">|</span>pull&gt; trac <span class="o">[</span>ARGS<span class="o">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the command above we set up the remote to only track the
<code class="docutils literal notranslate"><span class="pre">master</span></code> branch on the trac server (the <code class="docutils literal notranslate"><span class="pre">-t</span> <span class="pre">master</span></code>
option). This avoids clutter by not automatically downloading all
branches ever created. But it also means that you will not fetch
everything that is on trac by default, and you need to explicitly
tell git which branch you want to get from trac. See the
<a class="reference internal" href="#section-git-checkout"><span class="std std-ref">Checking Out Tickets</span></a> section for examples.</p>
</div>
<p>Note that write operations (<code class="docutils literal notranslate"><span class="pre">push</span></code>) use the ssh protocol (specified by the <code class="docutils literal notranslate"><span class="pre">git&#64;</span></code>
part). For this to work, you need to have a trac account and to set up your ssh public
key as described in <a class="reference external" href="http://doc.sagemath.org/html/en/developer/trac.html#trac-authentication-through-ssh">Trac authentication through ssh</a>.
Authentication is necessary if you want to upload anything to ensure
that it really is from you.</p>
<p>The above instructions set up the remote to perform read-only operations (<code class="docutils literal notranslate"><span class="pre">fetch</span></code>)
using HTTPS from a mirror of the trac repository instead. The mirror is faster and
more reliable than our git server. However, this configuration is not recommended if
you use VS Code as an IDE.</p>
<p>If you want to use ssh only for both <code class="docutils literal notranslate"><span class="pre">fetch</span></code> and <code class="docutils literal notranslate"><span class="pre">push</span></code>, use the
following commands instead:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git remote add trac git@trac.sagemath.org:sage.git -t master
<span class="gp">[user@localhost sage]$ </span>git remote -v
<span class="go">origin      https://github.com/sagemath/sage.git (fetch)</span>
<span class="go">origin      https://github.com/sagemath/sage.git (push)</span>
<span class="go">trac        git@trac.sagemath.org:sage.git (fetch)</span>
<span class="go">trac        git@trac.sagemath.org:sage.git (push)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The Patch buildbot will automatically test your ticket. See <a class="reference external" href="https://trac.sagemath.org/wiki/patchbot">trac ticket #wiki/patchbot</a>
for more information about its features and limitations. Make sure that you
look at the log, especially if the patch buildbot did not give you
the green blob.</p></li>
</ul>
<section id="checking-out-tickets">
<span id="section-git-checkout"></span><h3>Checking Out Tickets<a class="headerlink" href="#checking-out-tickets" title="Permalink to this heading">#</a></h3>
<p>Trac tickets that are finished or in the process of being worked on
can have a git branch attached to them. This is the “Branch:” field in
the ticket description. The branch name is generally of the form
<code class="docutils literal notranslate"><span class="pre">u/user/description</span></code>, where <code class="docutils literal notranslate"><span class="pre">user</span></code> is the name of the user who
made the branch and <code class="docutils literal notranslate"><span class="pre">description</span></code> is some free-form short
description (and can include further slashes).</p>
<p>If you want to work with the changes in that remote branch, you must
make a local copy. In particular, git has no concept of directly
working with the remote branch, the remotes are only bookmarks for
things that you can get from/to the remote server. Hence, the first
thing you should do is to get everything from the trac server’s branch
into your local repository. This is achieved by:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git fetch trac u/user/description
<span class="go">remote: Counting objects: 62, done.</span>
<span class="go">remote: Compressing objects: 100% (48/48), done.</span>
<span class="go">remote: Total 48 (delta 42), reused 0 (delta 0)</span>
<span class="go">Unpacking objects: 100% (48/48), done.</span>
<span class="go">From trac.sagemath.org:sage</span>
<span class="go">* [new branch]      u/user/description -&gt; FETCH_HEAD</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">u/user/description</span></code> branch is now temporarily (until you fetch
something else) stored in your local git database under the alias
<code class="docutils literal notranslate"><span class="pre">FETCH_HEAD</span></code>. In the second step, we make it available as a new
local branch and switch to it. Your local branch can have a different
name, for example:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git checkout -b my_branch FETCH_HEAD
<span class="go">Switched to a new branch &#39;my_branch&#39;</span>
</pre></div>
</div>
<p>creates a new branch in your local git repository named <code class="docutils literal notranslate"><span class="pre">my_branch</span></code>
and modifies your local Sage filesystem tree to the state of the files
in that ticket. You can now edit files and commit changes to your
local branch.</p>
</section>
<section id="pushing-your-changes-to-a-ticket">
<span id="section-git-push"></span><h3>Pushing Your Changes to a Ticket<a class="headerlink" href="#pushing-your-changes-to-a-ticket" title="Permalink to this heading">#</a></h3>
<p>To add your local branch to a trac ticket, you should first decide on
a name on the Sage trac repository.</p>
<p>For read/write permissions on git branches, see
<a class="reference internal" href="git_trac.html#section-git-trac-branch-names"><span class="std std-ref">Note on Branch Names</span></a></p>
<p>In order to avoid name clashes, you can use
<code class="docutils literal notranslate"><span class="pre">u/your_username/a_description_of_your_branch</span></code> (the description can contain
slashes, but no spaces). Then:</p>
<ul>
<li><p><strong>Fill</strong> the <code class="docutils literal notranslate"><span class="pre">Branch</span></code> field of the trac ticket with that name.</p></li>
<li><p><strong>Push</strong> your branch to trac with either:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git push --set-upstream trac HEAD:u/user/description
</pre></div>
</div>
<p>if you started the branch yourself and do not follow any other branch,
or use:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git push trac HEAD:u/user/description
</pre></div>
</div>
<p>if your branch already has an upstream branch.</p>
</li>
</ul>
<p>Here, <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> means that you are pushing the most recent commit (and, by
extension, all of its parent commits) of the current local branch to the remote
branch.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Branch</span></code> field on the trac ticket can appear in red/green. See
<a class="reference internal" href="trac.html#section-trac-fields"><span class="std std-ref">The Ticket Fields</span></a> to learn what it means.</p>
</section>
<section id="getting-changes">
<span id="section-git-pull"></span><h3>Getting Changes<a class="headerlink" href="#getting-changes" title="Permalink to this heading">#</a></h3>
<p>A common task during development is to synchronize your local copy of
the branch with the branch on trac. In particular, assume you
downloaded somebody else’s branch and made some suggestions for
improvements on the trac ticket. Now the original author incorporated
your suggestions into his branch, and you want to get the added
changesets to complete your review. Assuming that you originally got
your local branch as in <a class="reference internal" href="#section-git-checkout"><span class="std std-ref">Checking Out Tickets</span></a>, you can just
issue:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git pull trac u/user/description
<span class="go">From trac.sagemath.org:sage</span>
<span class="go"> * branch            u/user/description -&gt; FETCH_HEAD</span>
<span class="go">Updating 8237337..07152d8</span>
<span class="go">Fast-forward</span>
<span class="go"> src/sage/tests/cmdline.py      | 3 ++-</span>
<span class="go"> 1 file changed, 2 insertions(+), 1 deletions(-)</span>
</pre></div>
</div>
<p>where now <code class="docutils literal notranslate"><span class="pre">user</span></code> is the other developer’s trac username and
<code class="docutils literal notranslate"><span class="pre">description</span></code> is some description that he chose. This command will
download the changes from the originally-used remote branch and merge
them into your local branch. If you haven’t published your local
commits yet then you can also rebase them via:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git pull -r trac u/user/description
<span class="go">From trac.sagemath.org:sage</span>
<span class="go"> * branch            u/user/description -&gt; FETCH_HEAD</span>
<span class="go">First, rewinding head to replay your work on top of it...</span>
<span class="go">Applying: my local commit</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#section-git-merge"><span class="std std-ref">Merging and Rebasing</span></a> section for an in-depth explanation of
merge vs. rebase.</p>
<p>So far, we assumed that there are no conflicts. It is unavoidable in
distributed development that, sometimes, the same location in a source
source file is changed by more than one person. Reconciling these
conflicting edits is explained in the <a class="reference internal" href="git_trac.html#section-git-trac-conflict"><span class="std std-ref">Conflict Resolution</span></a>
section.</p>
</section>
<section id="updating-master">
<span id="section-git-pull-master"></span><h3>Updating Master<a class="headerlink" href="#updating-master" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">master</span></code> branch can be updated just like any other branch. However, your
local copy of the master branch should stay <strong>identical</strong> to the trac master
branch.</p>
<p>If you accidentally added commits to your local copy of <code class="docutils literal notranslate"><span class="pre">master</span></code>, you must
delete them before updating the branch.</p>
<p>One way to ensure that you are notified of potential problems is to use <code class="docutils literal notranslate"><span class="pre">git</span>
<span class="pre">pull</span> <span class="pre">--ff-only</span></code>, which will raise an error if a non-trivial merge would be
required:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git checkout master
<span class="gp">[user@localhost sage]$ </span>git pull --ff-only trac master
</pre></div>
</div>
<p>If this pull fails, then something is wrong with the local copy of the
master branch. To switch to the correct Sage master branch, use:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[user@localhost sage]$ </span>git checkout master
<span class="gp">[user@localhost sage]$ </span>git reset --hard trac/master
</pre></div>
</div>
</section>
</section>
<section id="merging-and-rebasing">
<span id="section-git-merge"></span><h2>Merging and Rebasing<a class="headerlink" href="#merging-and-rebasing" title="Permalink to this heading">#</a></h2>
<p>Sometimes, a new version of Sage is released while you work on a git branch.</p>
<p>Let us assume you started <code class="docutils literal notranslate"><span class="pre">my_branch</span></code> at commit <code class="docutils literal notranslate"><span class="pre">B</span></code>. After a while, your
branch has advanced to commit <code class="docutils literal notranslate"><span class="pre">Z</span></code>, but you updated <code class="docutils literal notranslate"><span class="pre">master</span></code> (see
<a class="reference internal" href="#section-git-pull-master"><span class="std std-ref">Updating Master</span></a>) and now your git history looks like this (see
<a class="reference internal" href="walk_through.html#section-walkthrough-logs"><span class="std std-ref">The History</span></a>):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>      X---Y---Z my_branch
     /
A---B---C---D master
</pre></div>
</div>
<p>How should you deal with such changes? In principle, there are two ways:</p>
<ul>
<li><p><strong>Rebase:</strong> The first solution is to <strong>replay</strong> commits <code class="docutils literal notranslate"><span class="pre">X,Y,Z</span></code> atop of the
new <code class="docutils literal notranslate"><span class="pre">master</span></code>. This is called <strong>rebase</strong>, and it rewrites your current
branch:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git checkout my_branch
git rebase -i master
</pre></div>
</div>
<p>In terms of the commit graph, this results in:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>              X&#39;--Y&#39;--Z&#39; my_branch
             /
A---B---C---D master
</pre></div>
</div>
<p>Note that this operation rewrites the history of <code class="docutils literal notranslate"><span class="pre">my_branch</span></code> (see
<a class="reference internal" href="advanced_git.html#section-git-rewriting-history"><span class="std std-ref">Rewriting History</span></a>). This can lead to problems if somebody
began to write code atop of your commits <code class="docutils literal notranslate"><span class="pre">X,Y,Z</span></code>. It is safe otherwise.</p>
<p><strong>Alternatively</strong>, you can rebase <code class="docutils literal notranslate"><span class="pre">my_branch</span></code> while updating master at the
same time (see <a class="reference internal" href="#section-git-pull"><span class="std std-ref">Getting Changes</span></a>):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git checkout my_branch
git pull -r master
</pre></div>
</div>
</li>
<li><p><strong>Merging</strong> your branch with <code class="docutils literal notranslate"><span class="pre">master</span></code> will create a new commit above the two
of them:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git checkout my_branch
git merge master
</pre></div>
</div>
<p>The result is the following commit graph:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>      X---Y---Z---W my_branch
     /           /
A---B---C-------D master
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Pros:</strong> you did not rewrite history (see
<a class="reference internal" href="advanced_git.html#section-git-rewriting-history"><span class="std std-ref">Rewriting History</span></a>).The additional commit is then easily
pushed to the git repository and distributed to your collaborators.</p></li>
<li><p><strong>Cons:</strong> it introduced an extra merge commit that would
not be there had you used rebase.</p></li>
</ul>
<p><strong>Alternatively</strong>, you can merge <code class="docutils literal notranslate"><span class="pre">my_branch</span></code> while updating master at the
same time (see <a class="reference internal" href="#section-git-pull"><span class="std std-ref">Getting Changes</span></a>):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git checkout my_branch
git pull master
</pre></div>
</div>
</li>
</ul>
<p><strong>In case of doubt</strong> use merge rather than rebase. There is less risk involved,
and rebase in this case is only useful for branches with a very long history.</p>
<p>Finally, <strong>do nothing unless necessary:</strong> it is perfectly fine for your branch
to be behind <code class="docutils literal notranslate"><span class="pre">master</span></code>. You can always merge/rebase if/when your branch’s name
appears in red on its trac page (see <a class="reference internal" href="trac.html#section-trac-fields"><span class="std std-ref">The Ticket Fields</span></a>), or when you
will really need a feature that is only available in the current master.</p>
</section>
<section id="merge-tools">
<span id="section-git-mergetool"></span><h2>Merge Tools<a class="headerlink" href="#merge-tools" title="Permalink to this heading">#</a></h2>
<p>Simple conflicts can be easily solved with git only (see <a class="reference internal" href="git_trac.html#section-git-trac-conflict"><span class="std std-ref">Conflict Resolution</span></a>)</p>
<p>For more complicated ones, a range of specialized programs are
available. Because the conflict marker includes the hash of the most recent
common parent, you can use a three-way diff:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">[alice@laptop]$ </span>git mergetool

<span class="go">This message is displayed because &#39;merge.tool&#39; is not configured.</span>
<span class="go">See &#39;git mergetool --tool-help&#39; or &#39;git help config&#39; for more details.</span>
<span class="go">&#39;git mergetool&#39; will now attempt to use one of the following tools:</span>
<span class="go">meld opendiff kdiff3 [...] merge araxis bc3 codecompare emerge vimdiff</span>
<span class="go">Merging:</span>
<span class="go">fibonacci.py</span>

<span class="go">Normal merge conflict for &#39;fibonacci.py&#39;:</span>
<span class="go">  {local}: modified file</span>
<span class="go">  {remote}: modified file</span>
<span class="go">Hit return to start merge resolution tool (meld):</span>
</pre></div>
</div>
<p>If you don’t have a favourite merge tool we suggest you try <a class="reference external" href="http://meldmerge.org/">meld</a> (cross-platform). The result looks like the following
screenshot.</p>
<img alt="_images/meld-screenshot.png" src="_images/meld-screenshot.png" />
<p>The middle file is the most recent common parent; on the right is
Bob’s version and on the left is Alice’s conflicting version. Clicking
on the arrow moves the marked change to the file in the adjacent
pane.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="git_background.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tips and References</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="trac.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">The Sage Trac Server</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Using Git with the Sage Trac Server</a><ul>
<li><a class="reference internal" href="#git-authentication-through-ssh">Git authentication through SSH</a><ul>
<li><a class="reference internal" href="#checking-whether-you-have-already-have-suitable-ssh-keys">Checking whether you have already have suitable SSH keys</a></li>
<li><a class="reference internal" href="#generating-your-ssh-keys">Generating your SSH Keys</a></li>
<li><a class="reference internal" href="#linking-your-public-key-to-your-trac-account">Linking your Public Key to your Trac Account</a></li>
<li><a class="reference internal" href="#adding-your-public-key-for-authentication-on-another-server">Adding your Public Key for authentication on another server</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-git-repository-trac-sagemath-org">The git repository trac.sagemath.org</a><ul>
<li><a class="reference internal" href="#checking-out-tickets">Checking Out Tickets</a></li>
<li><a class="reference internal" href="#pushing-your-changes-to-a-ticket">Pushing Your Changes to a Ticket</a></li>
<li><a class="reference internal" href="#getting-changes">Getting Changes</a></li>
<li><a class="reference internal" href="#updating-master">Updating Master</a></li>
</ul>
</li>
<li><a class="reference internal" href="#merging-and-rebasing">Merging and Rebasing</a></li>
<li><a class="reference internal" href="#merge-tools">Merge Tools</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    </body>
</html>