<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Install from Source Code &mdash; Sage Installation Guide v7.4</title>
    
    <link rel="stylesheet" href="_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '7.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Sage Installation Guide v7.4" href="index.html" />
    <link rel="next" title="Standard packages" href="standard_packages.html" />
    <link rel="prev" title="Install from Pre-built Binaries" href="binary.html" />
    <link rel="icon" href="_static/sageicon.png" type="image/x-icon" />
    <script src="_static/thebe.js" type="text/javascript"></script>
    <script src="_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="standard_packages.html" title="Standard packages"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="binary.html" title="Install from Pre-built Binaries"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="index.html">Install Guide v7.4</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="install-from-source-code">
<span id="sec-installation-from-sources"></span><h1><a class="toc-backref" href="#id5">Install from Source Code</a><a class="headerlink" href="#install-from-source-code" title="Permalink to this headline">¶</a></h1>
<p>More familiarity with computers may be required to build Sage from
the <a class="reference external" href="http://en.wikipedia.org/wiki/Source_code">source code</a>.
If you do have all the <a class="reference internal" href="#section-prereqs"><span class="std std-ref">pre-requisite tools</span></a>,
the process should be completely
painless, basically consisting in extracting the source tarball and typing
<code class="docutils literal"><span class="pre">make</span></code>.  It can take your computer a while to build Sage from the source code,
although the procedure is fully automated and should need no human
intervention.</p>
<p>Building Sage from the source code has the major advantage that your install
will be optimised for your particular computer and should therefore offer
better performance and compatibility than a binary install.
Moreover, it offers you full development capabilities:
you can change absolutely any part of Sage or the programs on which it depends,
and recompile the modified parts.</p>
<p><a class="reference external" href="http://www.sagemath.org/download-source.html">Download the Sage source code</a>
or <a class="reference external" href="https://github.com/sagemath/sage">check it out with git</a> (see also.
<a class="reference external" href="http://doc.sagemath.org/html/en/developer/manual_git.html#section-git-checkout">the developers guide</a>).
If you changed your mind, you can also download a
<a class="reference external" href="http://www.sagemath.org/download.html">binary distribution</a>
for some operating systems.</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#install-from-source-code" id="id5">Install from Source Code</a><ul>
<li><a class="reference internal" href="#supported-platforms" id="id6">Supported platforms</a></li>
<li><a class="reference internal" href="#prerequisites" id="id7">Prerequisites</a></li>
<li><a class="reference internal" href="#additional-software" id="id8">Additional software</a></li>
<li><a class="reference internal" href="#step-by-step-installation-procedure" id="id9">Step-by-step installation procedure</a></li>
<li><a class="reference internal" href="#make-targets" id="id10">Make targets</a></li>
<li><a class="reference internal" href="#environment-variables" id="id11">Environment variables</a></li>
<li><a class="reference internal" href="#installation-in-a-multiuser-environment" id="id12">Installation in a Multiuser Environment</a></li>
<li><a class="reference internal" href="#some-common-problems" id="id13">Some common problems</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="supported-platforms">
<h2><a class="toc-backref" href="#id6">Supported platforms</a><a class="headerlink" href="#supported-platforms" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference external" href="http://wiki.sagemath.org/SupportedPlatforms">http://wiki.sagemath.org/SupportedPlatforms</a> for the full list of platforms
on which Sage is supported and the level of support for these systems.</p>
<p>Sage is supported on a number of <a class="reference external" href="http://en.wikipedia.org/wiki/Linux">Linux</a>,
Mac <a class="reference external" href="http://www.apple.com/macosx/">OS X</a> ,
Sun/Oracle <a class="reference external" href="http://www.oracle.com/solaris">Solaris</a> releases,
but not necessarily all versions of these operating systems.
There is no native version of Sage which installs on
<a class="reference external" href="http://en.wikipedia.org/wiki/Microsoft_Windows">Microsoft Windows</a>,
although Sage can be used on Windows with the aid of a
<a class="reference external" href="http://en.wikipedia.org/wiki/Virtual_machine">virtual machine</a>
or the <a class="reference external" href="http://cygwin.com/">Cygwin</a> Linux API layer.</p>
<p>On the <a class="reference external" href="http://wiki.sagemath.org/SupportedPlatforms">list of supported platforms</a>,
you can find details about
<a class="reference external" href="http://en.wikipedia.org/wiki/Computer_port_%28software%29">ports</a>
to other operating systems or processors which may be taking place.</p>
</div>
<div class="section" id="prerequisites">
<span id="section-prereqs"></span><h2><a class="toc-backref" href="#id7">Prerequisites</a><a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-requirements">
<h3>General requirements<a class="headerlink" href="#general-requirements" title="Permalink to this headline">¶</a></h3>
<p>This section details the technical prerequisites needed on all platforms. See
also the <a class="reference internal" href="#system-specific-requirements">System-specific requirements</a> below.</p>
<div class="section" id="disk-space-and-memory">
<h4>Disk space and memory<a class="headerlink" href="#disk-space-and-memory" title="Permalink to this headline">¶</a></h4>
<p>Your computer comes with at least 6 GB of free disk space running one of the
supported versions of an operating system listed at
<a class="reference external" href="http://wiki.sagemath.org/SupportedPlatforms">http://wiki.sagemath.org/SupportedPlatforms</a>.
It is recommended to have at least 2 GB of RAM, but you might get away
with less (be sure to have some swap space in this case).</p>
</div>
<div class="section" id="command-line-tools">
<h4>Command-line tools<a class="headerlink" href="#command-line-tools" title="Permalink to this headline">¶</a></h4>
<p>In addition to standard <a class="reference external" href="http://en.wikipedia.org/wiki/POSIX">POSIX</a> utilities
and the <a class="reference external" href="http://en.wikipedia.org/wiki/Bash_(Unix_shell)">bash</a> shell,
the following standard command-line development tools must be installed on your
computer:</p>
<ul class="simple">
<li>A <strong>C/C++ compiler</strong>: Since Sage builds its own GCC if needed,
a wide variety of C/C++ compilers is supported.
Many GCC versions work,
from as old as version 3.4.3 to the most recent release.
Clang also works.
On Solaris systems, the Sun compiler should also work.
See also <a class="reference internal" href="#using-alternative-compilers">Using alternative compilers</a>.</li>
<li><strong>make</strong>: GNU make, version 3.80 or later. Version 3.82 or later is recommended.</li>
<li><strong>m4</strong>: GNU m4 1.4.2 or later (non-GNU or older versions might also work).</li>
<li><strong>perl</strong>: version 5.8.0 or later.</li>
<li><strong>ar</strong> and <strong>ranlib</strong>: can be obtained as part of GNU binutils.</li>
<li><strong>tar</strong>: GNU tar version 1.17 or later, or BSD tar.</li>
<li><strong>python</strong>: Python &gt;= 2.6.</li>
</ul>
<div class="section" id="fortran-and-compiler-suites">
<h5>Fortran and compiler suites<a class="headerlink" href="#fortran-and-compiler-suites" title="Permalink to this headline">¶</a></h5>
<p>Sage also needs a Fortran compiler.
The only configuration currently supported is matching versions of the
C, C++ and Fortran compilers from the
<a class="reference external" href="http://gcc.gnu.org/">GNU Compiler Collection (GCC)</a>.
Therefore, if you plan on using your own GCC compilers, then make sure that
their versions match.</p>
<p>Alternatively, Sage includes a GCC package, so that C, C++ and Fortran
compilers will be built when the build system detects that it is needed,
e.g., non-GCC compilers, or
versions of the GCC compilers known to miscompile some components of Sage,
or simply a missing Fortran compiler.
In any case, you always need at least a C/C++ compiler to build the GCC
package and its prerequisites before the compilers it provides can be used.</p>
<p>Note that you can always override this behavior through the environment
variable <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_INSTALL_GCC</span></code>, see <a class="reference internal" href="#section-compilers"><span class="std std-ref">Using alternative compilers</span></a> and
<a class="reference internal" href="#section-envvar"><span class="std std-ref">Environment variables</span></a>.</p>
</div>
</div>
<div class="section" id="other-notes">
<h4>Other notes<a class="headerlink" href="#other-notes" title="Permalink to this headline">¶</a></h4>
<p>Although some of Sage is written in <a class="reference external" href="http://www.python.org/">Python</a>, you do
not need Python pre-installed on your computer, since the Sage installation
includes virtually everything you need.</p>
<p>After extracting the Sage tarball, the subdirectory <code class="file docutils literal"><span class="pre">upstream</span></code>
contains the source distributions for everything on which Sage depends.
If cloned from a git repository, the upstream tarballs will be downloaded,
verified, and cached as part of the Sage installation process.
We emphasize that all of this software is included with Sage, so you do not
have to worry about trying to download and install any one of these packages
(such as Python, for example) yourself.</p>
<p>When the Sage installation program is run,
it will check that you have each of the above-listed prerequisites,
and inform you of any that are missing, or have unsuitable versions.</p>
</div>
</div>
<div class="section" id="system-specific-requirements">
<h3>System-specific requirements<a class="headerlink" href="#system-specific-requirements" title="Permalink to this headline">¶</a></h3>
<p>On Mac OS X, there are various developer tools needed which may require
some registration on Apple&#8217;s developer site; see
<a class="reference internal" href="#section-macprereqs"><span class="std std-ref">Mac OS X prerequisite installation</span></a>.</p>
<p>On Redhat-derived systems not all perl components are installed by
default and you might have to install the <strong>perl-ExtUtils-MakeMaker</strong>
package.</p>
<p>On Cygwin, the <strong>lapack</strong> and <strong>liblapack-devel</strong> packages are required to
provide ATLAS support as the Sage package for ATLAS is not built by default.</p>
</div>
<div class="section" id="installing-prerequisites">
<h3>Installing prerequisites<a class="headerlink" href="#installing-prerequisites" title="Permalink to this headline">¶</a></h3>
<p>To check if you have the above prerequisites installed, for example <code class="docutils literal"><span class="pre">perl</span></code>,
type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">command</span> <span class="o">-</span><span class="n">v</span> <span class="n">perl</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">which</span> <span class="n">perl</span>
</pre></div>
</div>
<p>on the command line. If it gives an error (or returns nothing), then
either <code class="docutils literal"><span class="pre">perl</span></code> is not installed, or it is installed but not in your
<a class="reference external" href="http://en.wikipedia.org/wiki/PATH_%28variable%29">PATH</a>.</p>
<div class="section" id="linux-prerequisite-installation">
<h4>Linux prerequisite installation<a class="headerlink" href="#linux-prerequisite-installation" title="Permalink to this headline">¶</a></h4>
<p>On Linux systems (e.g., Ubuntu, Redhat, etc), <code class="docutils literal"><span class="pre">ar</span></code> and <code class="docutils literal"><span class="pre">ranlib</span></code> are in the
<a class="reference external" href="http://www.gnu.org/software/binutils/">binutils</a> package.
The other programs are usually located in packages with their respective names.
Assuming you have sufficient privileges, you can install the <code class="docutils literal"><span class="pre">binutils</span></code> and
other necessary components.
If you do not have the privileges to do this, ask your system administrator to
do this, or build the components from source code.
The method of installing additional software varies from distribution to
distribution, but on a <a class="reference external" href="http://www.debian.org/">Debian</a> based system (e.g.
<a class="reference external" href="http://www.ubuntu.com/">Ubuntu</a> or <a class="reference external" href="http://www.linuxmint.com/">Mint</a>),
you would use
<a class="reference external" href="http://en.wikipedia.org/wiki/Advanced_Packaging_Tool">apt-get</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># debian</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">binutils</span> <span class="n">gcc</span> <span class="n">make</span> <span class="n">m4</span> <span class="n">perl</span> <span class="n">tar</span> <span class="n">git</span>

<span class="c1"># redhat</span>
<span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">binutils</span> <span class="n">gcc</span> <span class="n">make</span> <span class="n">m4</span> <span class="n">perl</span> <span class="n">tar</span> <span class="n">git</span> <span class="n">perl</span><span class="o">-</span><span class="n">ExtUtils</span><span class="o">-</span><span class="n">MakeMaker</span>
</pre></div>
</div>
<p>to install all general requirements, or, if you don&#8217;t want Sage to build its
own GCC:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># debian</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">binutils</span> <span class="n">gcc</span> <span class="n">g</span><span class="o">++</span> <span class="n">gfortran</span> <span class="n">make</span> <span class="n">m4</span> <span class="n">perl</span> <span class="n">tar</span> <span class="n">git</span>

<span class="c1"># redhat</span>
<span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">binutils</span> <span class="n">gcc</span> <span class="n">gcc</span><span class="o">-</span><span class="n">c</span><span class="o">++</span> <span class="n">gcc</span><span class="o">-</span><span class="n">gfortran</span> <span class="n">make</span> <span class="n">m4</span> <span class="n">perl</span> <span class="n">tar</span> <span class="n">git</span> <span class="n">perl</span><span class="o">-</span><span class="n">ExtUtils</span><span class="o">-</span><span class="n">MakeMaker</span>
</pre></div>
</div>
<p>(This was tested on Ubuntu 12.04.2.)
On other Linux systems, you might use
<a class="reference external" href="http://en.wikipedia.org/wiki/RPM_Package_Manager">rpm</a>,
<a class="reference external" href="http://en.wikipedia.org/wiki/Yellowdog_Updater,_Modified">yum</a>,
or other package managers.</p>
</div>
<div class="section" id="mac-os-x-prerequisite-installation">
<span id="section-macprereqs"></span><h4>Mac OS X prerequisite installation<a class="headerlink" href="#mac-os-x-prerequisite-installation" title="Permalink to this headline">¶</a></h4>
<p>On OS X systems, you need a recent version of
<a class="reference external" href="http://developer.apple.com/downloads/index.action?=command%20line%20tools">Command Line Tools</a>.
It provides all the above requirements.</p>
<p>If you have already installed <a class="reference external" href="http://developer.apple.com/xcode/">Xcode</a>
(which at the time of writing is freely available in the Mac App Store,
or through <a class="reference external" href="http://developer.apple.com/downloads/">http://developer.apple.com/downloads/</a> provided you registered for an
Apple Developer account), you can install the command line tools from
there as well.</p>
<ul class="simple">
<li>With OS X Mavericks or Yosemite, run the command
<code class="docutils literal"><span class="pre">xcode-select</span> <span class="pre">--install</span></code> from a Terminal window and click &#8220;Install&#8221;
in the pop-up dialog box.</li>
<li>Using OS X Mountain Lion or earlier, run Xcode, open its &#8220;Downloads&#8221;
preference pane and install the command line tools from there.</li>
<li>On pre-Lion OS X systems, the command line tools are not available as a
separate download and you have to install the full-blown Xcode supporting your
system version.</li>
</ul>
<p>If you have not installed <a class="reference external" href="http://developer.apple.com/xcode/">Xcode</a>
you can get these tools as a relatively small download, but it does require
a registration.</p>
<ul class="simple">
<li>First, you will need to register as an Apple Developer at
<a class="reference external" href="http://developer.apple.com/register/">http://developer.apple.com/register/</a>.</li>
<li>Having done so, you should be able to download it for free at
<a class="reference external" href="http://developer.apple.com/downloads/index.action?=command%20line%20tools">http://developer.apple.com/downloads/index.action?=command%20line%20tools</a></li>
<li>Alternately, <a class="reference external" href="https://developer.apple.com/opensource/">https://developer.apple.com/opensource/</a> should have a link
to Command Line Tools.</li>
</ul>
</div>
<div class="section" id="other-platforms">
<h4>Other platforms<a class="headerlink" href="#other-platforms" title="Permalink to this headline">¶</a></h4>
<p>On Solaris, you would use <code class="docutils literal"><span class="pre">pkgadd</span></code> and on OpenSolaris <code class="docutils literal"><span class="pre">ipf</span></code> to install
the necessary software.</p>
<p>On Cygwin, you would use the <code class="docutils literal"><span class="pre">setup.exe</span></code> program.
As on Linux systems, <code class="docutils literal"><span class="pre">ar</span></code> and <code class="docutils literal"><span class="pre">ranlib</span></code> are provided by the <code class="docutils literal"><span class="pre">binutils</span></code> package.
As far as compilers are concerned, you should either install matching versions
of the <code class="docutils literal"><span class="pre">gcc4-core</span></code>, <code class="docutils literal"><span class="pre">gcc4-g++</span></code>, and <code class="docutils literal"><span class="pre">gcc4-gfortran</span></code> packages, or
the <code class="docutils literal"><span class="pre">gcc4-core</span></code> package alone if you plan on using Sage&#8217;s own GCC.</p>
<p>On other systems, check the documentation for your particular operating system.</p>
</div>
</div>
<div class="section" id="specific-notes-for-make-and-tar">
<h3>Specific notes for <code class="docutils literal"><span class="pre">make</span></code> and <code class="docutils literal"><span class="pre">tar</span></code><a class="headerlink" href="#specific-notes-for-make-and-tar" title="Permalink to this headline">¶</a></h3>
<p>On OS X, the system-wide BSD <code class="docutils literal"><span class="pre">tar</span></code> supplied will build Sage, so there is no
need to install the GNU <code class="docutils literal"><span class="pre">tar</span></code>.</p>
<p>On Solaris or OpenSolaris, the Sun/Oracle versions of <code class="docutils literal"><span class="pre">make</span></code> and <code class="docutils literal"><span class="pre">tar</span></code> are
unsuitable for building Sage.
Therefore, you must have the GNU versions of <code class="docutils literal"><span class="pre">make</span></code> and <code class="docutils literal"><span class="pre">tar</span></code> installed and
they must be the first <code class="docutils literal"><span class="pre">make</span></code> and <code class="docutils literal"><span class="pre">tar</span></code> in your <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code>.</p>
<p>On Solaris 10, a version of GNU <code class="docutils literal"><span class="pre">make</span></code> may be found at
<code class="file docutils literal"><span class="pre">/usr/sfw/bin/gmake</span></code>,
but you will need to copy it somewhere else and rename it to <code class="docutils literal"><span class="pre">make</span></code>.
The same is true for GNU <code class="docutils literal"><span class="pre">tar</span></code>; a version of GNU <code class="docutils literal"><span class="pre">tar</span></code> may be found at
<code class="file docutils literal"><span class="pre">/usr/sfw/bin/gtar</span></code>,
but it will need to be copied somewhere else and renamed to <code class="docutils literal"><span class="pre">tar</span></code>.
It is recommended to create a directory <code class="file docutils literal"><span class="pre">$HOME/bins-for-sage</span></code> and to put
the GNU versions of <code class="docutils literal"><span class="pre">tar</span></code> and <code class="docutils literal"><span class="pre">make</span></code> in that directory.
Then ensure that <code class="file docutils literal"><span class="pre">$HOME/bins-for-sage</span></code> is first in your <span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code>.
That&#8217;s because Sage also needs <code class="file docutils literal"><span class="pre">/usr/ccs/bin</span></code> in your <span class="target" id="index-3"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code> to
execute programs like <code class="docutils literal"><span class="pre">ar</span></code> and <code class="docutils literal"><span class="pre">ranlib</span></code>, but <code class="file docutils literal"><span class="pre">/usr/ccs/bin</span></code> has the
Sun/Oracle versions of <code class="docutils literal"><span class="pre">make</span></code> and <code class="docutils literal"><span class="pre">tar</span></code> in it.</p>
<p>If you attempt to build Sage on AIX or HP-UX, you will need to install both
GNU <code class="docutils literal"><span class="pre">make</span></code> and GNU <code class="docutils literal"><span class="pre">tar</span></code>.</p>
</div>
<div class="section" id="using-alternative-compilers">
<span id="section-compilers"></span><h3>Using alternative compilers<a class="headerlink" href="#using-alternative-compilers" title="Permalink to this headline">¶</a></h3>
<p>Sage developers tend to use fairly recent versions of GCC.
Nonetheless, the Sage build process should succeed with any reasonable C/C++ compiler.
This is because Sage will build GCC first (if needed) and then use that newly
built GCC to compile Sage.</p>
<p>If you don&#8217;t want this and want to try building Sage with a different set of
compilers,
you need to set the environment variable <span class="target" id="index-4"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_INSTALL_GCC</span></code> to <code class="docutils literal"><span class="pre">no</span></code>.
Make sure you have C, C++, and Fortran compilers installed!</p>
<p>Building all of Sage with Clang is currently not supported, see <a class="reference external" href="https://trac.sagemath.org/12426">trac ticket #12426</a>.</p>
<p>If you are interested in working on support for commerical compilers from
<a class="reference external" href="http://docs.hp.com/en/5966-9844/ch01s03.html">HP</a>,
<a class="reference external" href="http://www-01.ibm.com/software/awdtools/xlcpp/">IBM</a>,
<a class="reference external" href="http://software.intel.com/en-us/articles/intel-compilers/">Intel</a>,
<a class="reference external" href="http://www.oracle.com/technetwork/server-storage/solarisstudio/overview/index.html">Sun/Oracle</a>,
etc,
please email the sage-devel mailing list at <a class="reference external" href="http://groups.google.com/group/sage-devel">http://groups.google.com/group/sage-devel</a>.</p>
</div>
</div>
<div class="section" id="additional-software">
<h2><a class="toc-backref" href="#id8">Additional software</a><a class="headerlink" href="#additional-software" title="Permalink to this headline">¶</a></h2>
<div class="section" id="recommended-programs">
<h3>Recommended programs<a class="headerlink" href="#recommended-programs" title="Permalink to this headline">¶</a></h3>
<p>The following programs are recommended.
They are not strictly required at build time or at run time,
but provide additional capablities:</p>
<ul class="simple">
<li><strong>dvipng</strong>.</li>
<li><strong>ffmpeg</strong>.</li>
<li><strong>ImageMagick</strong>.</li>
<li><strong>latex</strong>: highly recommended.</li>
</ul>
<p>It is highly recommended that you have
<a class="reference external" href="http://en.wikipedia.org/wiki/LaTeX">Latex</a>
installed, but it is not required.</p>
<p>The most popular packaging is <a class="reference external" href="www.tug.org/texlive/">TeX Live</a> ,
which you can install locally inside Sage with the commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span> <span class="o">-</span><span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;$SAGE_ROOT/src/ext/texlive/texlive-install&#39;</span>
</pre></div>
</div>
<p>On Linux systems you can alternatively install your distribution&#8217;s
texlive packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">texlive</span>       <span class="c1"># debian</span>
<span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">texlive</span>           <span class="c1"># redhat</span>
</pre></div>
</div>
<p>or similar commands. In addition to the base texlive install you will
probably need a number of optional texlive packages, for example
country-specific babel packages for the localized Sage
documentation. The required texlive packages are listed in
<code class="docutils literal"><span class="pre">SAGE_ROOT/src/ext/texlive/package-list.txt</span></code>.</p>
<p>If you don&#8217;t have either ImageMagick or ffmpeg, you won&#8217;t be able to
view animations.
ffmpeg can produce animations in more different formats than ImageMagick,
and seems to be faster than ImageMagick when creating animated GIFs.
Either ImageMagick or dvipng is used for displaying some LaTeX output in the
Sage notebook.</p>
</div>
<div class="section" id="notebook-additional-features">
<h3>Notebook additional features<a class="headerlink" href="#notebook-additional-features" title="Permalink to this headline">¶</a></h3>
<p>By default, the Sage notebook uses the
<a class="reference external" href="http://en.wikipedia.org/wiki/HTTP">HTTP</a>
protocol when you type the command <code class="docutils literal"><span class="pre">notebook()</span></code>.
To run the notebook in secure mode by typing <code class="docutils literal"><span class="pre">notebook(secure=True)</span></code> which
uses the <a class="reference external" href="http://en.wikipedia.org/wiki/HTTPS">HTTPS</a> protocol,
or to use <a class="reference external" href="http://en.wikipedia.org/wiki/OpenID">OpenID</a> authentication,
you need to follow specific installation steps described in
<a class="reference internal" href="#section-notebook-ssl"><span class="std std-ref">Building the notebook with SSL support</span></a>.</p>
<p>Although all necessary components are provided through Sage optional packages,
i.e. you can install a local version of <a class="reference external" href="http://www.openssl.org">OpenSSL</a>
by using Sage&#8217;s <strong>openssl</strong> package and running <code class="docutils literal"><span class="pre">sage</span> <span class="pre">-i</span> <span class="pre">openssl</span></code> as suggested
in <a class="reference internal" href="#section-notebook-ssl"><span class="std std-ref">Building the notebook with SSL support</span></a> (this requires an Internet connection),
you might prefer to install OpenSSL and the OpenSSL development headers
globally on your system.</p>
<p>On Linux systems, those are usually provided by the <strong>libssl</strong> and
<strong>libssl-dev</strong> packages and can be installed using:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libssl</span> <span class="n">libssl</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>or similar commands.</p>
<p>Finally, if you intend to distribute the notebook load onto several Sage
servers, you will surely want to setup an
<a class="reference external" href="http://en.wikipedia.org/wiki/SSH">SSH</a> server and generate SSH keys.
This can be achieved using <a class="reference external" href="http://www.openssh.org">OpenSSH</a>.</p>
<p>On Linux systems, the OpenSSH server, client and utilities are usually provided
by the <strong>openssh-server</strong> and <strong>openssh-client</strong> packages and can be installed
using:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">openssh</span><span class="o">-</span><span class="n">server</span> <span class="n">openssh</span><span class="o">-</span><span class="n">client</span>
</pre></div>
</div>
<p>or similar commands.</p>
</div>
<div class="section" id="tcl-tk">
<h3>Tcl/Tk<a class="headerlink" href="#tcl-tk" title="Permalink to this headline">¶</a></h3>
<p>If you want to use <a class="reference external" href="http://www.tcl.tk/">Tcl/Tk</a> libraries in Sage,
you need to install the Tcl/Tk and its development headers before building
Sage.
Sage&#8217;s Python will then automatically recognize your system&#8217;s install of
Tcl/Tk.</p>
<p>On Linux systems, these are usually provided by the <strong>tk</strong> and <strong>tk-dev</strong>
(or <strong>tk-devel</strong>) packages which can be installed using:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">tk</span> <span class="n">tk</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>or similar commands.</p>
<p>If you installed Sage first, all is not lost. You just need to rebuild
Sage&#8217;s Python and any part of Sage relying on it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sage</span> <span class="o">-</span><span class="n">f</span> <span class="n">python2</span>  <span class="c1"># rebuild Python</span>
<span class="n">make</span>             <span class="c1"># rebuild components of Sage depending on Python</span>
</pre></div>
</div>
<p>after installing the Tcl/Tk development libraries as above.</p>
<p>If</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">_tkinter</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">Tkinter</span>
</pre></div>
</div>
<p>does not raise an <code class="docutils literal"><span class="pre">ImportError</span></code>, then it worked.</p>
</div>
</div>
<div class="section" id="step-by-step-installation-procedure">
<span id="build-from-source-step-by-step"></span><h2><a class="toc-backref" href="#id9">Step-by-step installation procedure</a><a class="headerlink" href="#step-by-step-installation-procedure" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-procedure">
<h3>General procedure<a class="headerlink" href="#general-procedure" title="Permalink to this headline">¶</a></h3>
<p>Installation from source is (potentially) very easy, because the distribution
contains (essentially) everything on which Sage depends.</p>
<p>Make sure there are <strong>no spaces</strong> in the path name for the directory in which
you build:
several of Sage&#8217;s components will not build if there are spaces in the path.
Running Sage from a directory with spaces in its name will also fail.</p>
<ol class="arabic">
<li><p class="first">Go to <a class="reference external" href="http://www.sagemath.org/download-source.html">http://www.sagemath.org/download-source.html</a>, select a mirror,
and download the file <code class="file docutils literal"><span class="pre">sage-x.y.tar</span></code>.</p>
<p>This tarfile contains the source code for Sage and the source for all
programs on which Sage depends.
Note that this file is not compressed; it&#8217;s just a plain tarball (which
happens to be full of compressed files).</p>
<p>Download it into any directory you have write access to, preferably on a
fast filesystem, avoiding
<a class="reference external" href="http://en.wikipedia.org/wiki/Network_File_System">NFS</a> and the like.
On personal computers, any subdirectory of your <span class="target" id="index-5"></span><code class="xref std std-envvar docutils literal"><span class="pre">HOME</span></code> directory
should do.
The directory where you built Sage is <strong>NOT</strong> hardcoded.
You should be able to safely move or rename that directory.
(It&#8217;s a bug if this is not the case.)</p>
</li>
<li><p class="first">Extract the tarfile:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="n">xvf</span> <span class="n">sage</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">tar</span>
</pre></div>
</div>
<p>This creates a directory <code class="file docutils literal"><span class="pre">sage-x.y</span></code>.</p>
</li>
<li><p class="first">Change into that directory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">sage</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
<p>This is Sage&#8217;s home directory.
It is also referred to as <span class="target" id="index-6"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_ROOT</span></code> or the top level Sage
directory.</p>
</li>
<li><p class="first">Optional, but highly recommended:
Read the <code class="file docutils literal"><span class="pre">README.txt</span></code> file there.</p>
</li>
<li><p class="first">On OSX 10.4, OS 10.5, Solaris 10 and OpenSolaris, if you wish to build a
64-bit version of Sage, assuming your computer and operating system are
64-bit, type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">SAGE64</span><span class="o">=</span><span class="n">yes</span>
</pre></div>
</div>
<p>It should be noted that as of April 2011, 64-bit builds of Sage on both
Solaris 10 and OpenSolaris are not very stable, so you are advised not to
set <span class="target" id="index-7"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE64</span></code> to <code class="docutils literal"><span class="pre">yes</span></code>.
This will then create stable 32-bit versions of Sage.
See <a class="reference external" href="http://wiki.sagemath.org/solaris">http://wiki.sagemath.org/solaris</a> for the latest information.</p>
</li>
<li><p class="first">Start the build process:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span>
</pre></div>
</div>
<p>or if your system supports multiprocessing and you want to use several
processes to build Sage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">MAKE</span><span class="o">=</span><span class="s1">&#39;make -jNUM&#39;</span> <span class="n">make</span>
</pre></div>
</div>
<p>to tell the <code class="docutils literal"><span class="pre">make</span></code> program to run <code class="docutils literal"><span class="pre">NUM</span></code> jobs in parallel when building
Sage. This compiles Sage and all its dependencies.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Mac OS X allows changing directories without using exact capitalization.
Beware of this convenience when compiling for OS X. Ignoring exact
capitalization when changing into <span class="target" id="index-8"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_ROOT</span></code> can lead to build
errors for dependencies requiring exact capitalization in path names.</p>
</div>
<p>Note that you do not need to be logged in as root, since no files are
changed outside of the <code class="file docutils literal"><span class="pre">sage-x.y</span></code> directory.
In fact, <strong>it is inadvisable to build Sage as root</strong>, as the root account
should only be used when absolutely necessary and mistyped commands can have
serious consequences if you are logged in as root.
There has been a bug reported (see <a class="reference external" href="https://trac.sagemath.org/9551">trac ticket #9551</a>) in Sage which would have
overwritten a system file had the user been logged in as root.</p>
<p>Typing <code class="docutils literal"><span class="pre">make</span></code> performs the usual steps for each Sage&#8217;s dependency,
but installs all the resulting files into the local build tree.
Depending on the age and the architecture of your system, it can take from
a few tens of minutes to several hours to build Sage from source.
On really slow hardware, it can even take a few days to build Sage.</p>
<p>Each component of Sage has its own build log, saved in
<code class="file docutils literal"><span class="pre">SAGE_ROOT/logs/pkgs</span></code>.
If the build of Sage fails, you will see a message mentioning which
package(s) failed to build and the location of the log file for each
failed package.
If this happens, then paste the contents of these log file(s)
to the Sage support
newsgroup at <a class="reference external" href="http://groups.google.com/group/sage-support">http://groups.google.com/group/sage-support</a>.
If the log files are very large (and many are), then don&#8217;t paste the whole
file, but make sure to include any error messages.
It would also be helpful to include the type of operating system
(Linux, OS X, Solaris, OpenSolaris, Cygwin, or any other system),
the version and release date of that operating system and the version of
the copy of Sage you are using.
(There are no formal requirements for bug reports &#8211; just send them;
we appreciate everything.)</p>
<p>See <a class="reference internal" href="#section-make"><span class="std std-ref">Make targets</span></a> for some targets for the <code class="docutils literal"><span class="pre">make</span></code> command,
<a class="reference internal" href="#section-envvar"><span class="std std-ref">Environment variables</span></a> for additional informatio on useful environment
variables used by Sage,
and <a class="reference internal" href="#section-notebook-ssl"><span class="std std-ref">Building the notebook with SSL support</span></a> for additional instruction on how to build
the notebook with SSL support.</p>
</li>
<li><p class="first">To start Sage, you can now simply type from Sage&#8217;s home directory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">sage</span>
</pre></div>
</div>
<p>You should see the Sage prompt, which will look something like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sage
----------------------------------------------------------------------
| Sage Version 5.8, Release Date: 2013-03-15                         |
| Type &quot;notebook()&quot; for the browser-based notebook interface.        |
| Type &quot;help()&quot; for help.                                            |
----------------------------------------------------------------------
sage:
</pre></div>
</div>
<p>Note that Sage should take well under a minute when it starts for the first
time, but can take several minutes if the file system is slow or busy.
Since Sage opens a lot of files, it is preferable to install Sage on a fast
filesystem if possible.</p>
<p>Just starting successfully tests that many of the components built
correctly.
Note that this should have been already automatically tested during the
build process.
If the above is not displayed (e.g., if you get a massive traceback), please
report the problem, e.g., at <a class="reference external" href="http://groups.google.com/group/sage-support">http://groups.google.com/group/sage-support</a>.</p>
<p>After Sage has started, try a simple command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Or something slightly more complicated:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">2005</span><span class="p">)</span>
<span class="go">5 * 401</span>
</pre></div>
</div>
</li>
<li><p class="first">Optional, but highly recommended:
Test the install by typing <code class="docutils literal"><span class="pre">./sage</span> <span class="pre">--testall</span></code>.
This runs most examples in the source code and makes sure that they run
exactly as claimed.
To test all examples, use <code class="docutils literal"><span class="pre">./sage</span> <span class="pre">--testall</span> <span class="pre">--optional=all</span> <span class="pre">--long</span></code>;
this will run examples that take a long time, and those that depend on
optional packages and software, e.g., Mathematica or Magma.
Some (optional) examples will therefore likely fail.</p>
<p>Alternatively, from within <code class="file docutils literal"><span class="pre">$SAGE_ROOT</span></code>, you can type <code class="docutils literal"><span class="pre">make</span> <span class="pre">test</span></code>
(respectively <code class="docutils literal"><span class="pre">make</span> <span class="pre">ptest</span></code>) to run all the standard test code serially
(respectively in parallel).</p>
<p>Testing the Sage library can take from half an hour to several hours,
depending on your hardware.
On slow hardware building and testing Sage can even take several days!</p>
</li>
<li><p class="first">Optional:
Check the interfaces to any other software that you have available.
Note that each interface calls its corresponding program by a particular
name: <a class="reference external" href="http://www.wolfram.com/mathematica/">Mathematica</a> is invoked by
calling <code class="docutils literal"><span class="pre">math</span></code>, <a class="reference external" href="http://www.maplesoft.com/">Maple</a> by calling <code class="docutils literal"><span class="pre">maple</span></code>,
etc.
The easiest way to change this name or perform other customizations is
to create a redirection script in <code class="file docutils literal"><span class="pre">$SAGE_ROOT/local/bin</span></code>.
Sage inserts this directory at the front of your <span class="target" id="index-9"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code>, so your
script may need to use an absolute path to avoid calling itself; also, your
script should pass along all of its arguments.
For example, a <code class="docutils literal"><span class="pre">maple</span></code> script might look like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="n">exec</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">maple10</span><span class="o">.</span><span class="mi">2</span><span class="o">/</span><span class="n">maple</span><span class="o">.</span><span class="n">tty</span> <span class="s2">&quot;$@&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Optional:
There are different possibilities to make using Sage a little easier:</p>
<ul>
<li><p class="first">Make a symbolic link from <code class="file docutils literal"><span class="pre">/usr/local/bin/sage</span></code> (or another
directory in your <span class="target" id="index-10"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code>) to <code class="file docutils literal"><span class="pre">$SAGE_ROOT/sage</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sage</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">y</span><span class="o">/</span><span class="n">sage</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sage</span>
</pre></div>
</div>
<p>Now simply typing <code class="docutils literal"><span class="pre">sage</span></code> from any directory should be sufficient to run
Sage.</p>
</li>
<li><p class="first">Copy <code class="file docutils literal"><span class="pre">$SAGE_ROOT/sage</span></code> to a location in your <span class="target" id="index-11"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code>.
If you do this, make sure you edit the line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#SAGE_ROOT=/path/to/sage-version</span>
</pre></div>
</div>
<p>at the beginning of the copied <code class="docutils literal"><span class="pre">sage</span></code> script according to the direction
given there to something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SAGE_ROOT</span><span class="o">=&lt;</span><span class="n">SAGE_ROOT</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>(note that you have to change <code class="docutils literal"><span class="pre">&lt;SAGE_ROOT&gt;</span></code> above!).
It is best to edit only the copy, not the original.</p>
</li>
<li><p class="first">For <a class="reference external" href="http://www.kde.org/">KDE</a> users, create a bash script called
<code class="docutils literal"><span class="pre">sage</span></code> containing the lines
(note that you have to change <code class="docutils literal"><span class="pre">&lt;SAGE_ROOT&gt;</span></code> below!):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="n">konsole</span> <span class="o">-</span><span class="n">T</span> <span class="s2">&quot;sage&quot;</span> <span class="o">-</span><span class="n">e</span> <span class="o">&lt;</span><span class="n">SAGE_ROOT</span><span class="o">&gt;/</span><span class="n">sage</span>
</pre></div>
</div>
<p>make it executable:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chmod</span> <span class="n">a</span><span class="o">+</span><span class="n">x</span> <span class="n">sage</span>
</pre></div>
</div>
<p>and put it somewhere in your <span class="target" id="index-12"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code>.</p>
<p>You can also make a KDE desktop icon with this line as the command
(under the Application tab of the Properties of the icon, which you get my
right clicking the mouse on the icon).</p>
</li>
<li><p class="first">On Linux and OS X systems, you can make an alias to
<code class="file docutils literal"><span class="pre">$SAGE_ROOT/sage</span></code>.
For example, put something similar to the following line in your
<code class="file docutils literal"><span class="pre">.bashrc</span></code> file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">alias</span> <span class="n">sage</span><span class="o">=&lt;</span><span class="n">SAGE_ROOT</span><span class="o">&gt;/</span><span class="n">sage</span>
</pre></div>
</div>
<p>(Note that you have to change <code class="docutils literal"><span class="pre">&lt;SAGE_ROOT&gt;</span></code> above!)
Having done so, quit your terminal emulator and restart it.
Now typing <code class="docutils literal"><span class="pre">sage</span></code> within your terminal emulator should start Sage.</p>
</li>
</ul>
</li>
<li><p class="first">Optional:
Install optional Sage packages and databases.
Type <code class="docutils literal"><span class="pre">sage</span> <span class="pre">--optional</span></code> to see a list of them (this requires an Internet
connection), or visit <a class="reference external" href="http://www.sagemath.org/packages/optional/">http://www.sagemath.org/packages/optional/</a>.
Then type <code class="docutils literal"><span class="pre">sage</span> <span class="pre">-i</span> <span class="pre">&lt;package-name&gt;</span></code> to automatically download and install
a given package.</p>
</li>
<li><p class="first">Optional:
Run the <code class="docutils literal"><span class="pre">install_scripts</span></code> command from within Sage to create GAP, GP,
Maxima, Singular, etc., scripts in your <span class="target" id="index-13"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code>.
Type <code class="docutils literal"><span class="pre">install_scripts?</span></code> in Sage for details.</p>
</li>
<li><p class="first">Have fun! Discover some amazing conjectures!</p>
</li>
</ol>
</div>
<div class="section" id="building-the-notebook-with-ssl-support">
<span id="section-notebook-ssl"></span><h3>Building the notebook with SSL support<a class="headerlink" href="#building-the-notebook-with-ssl-support" title="Permalink to this headline">¶</a></h3>
<p>Read this section if you are intending to run a Sage notebook server for
multiple users.</p>
<p>For security, you may wish users to access the server using the HTTPS protocol
(i.e., to run <code class="docutils literal"><span class="pre">notebook(secure=True)</span></code>).
You also may want to use OpenID for user authentication.
The first of these requires you to install
<a class="reference external" href="http://pyopenssl.sourceforge.net/">pyOpenSSL</a>,
and they both require OpenSSL.</p>
<p>If you have OpenSSL and the OpenSSL development headers installed on your
system, you can install pyOpenSSL by building Sage and then typing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">sage</span> <span class="o">-</span><span class="n">i</span> <span class="n">pyopenssl</span>
</pre></div>
</div>
<p>Alternatively, <code class="docutils literal"><span class="pre">make</span> <span class="pre">ssl</span></code> builds Sage and installs pyOpenSSL at once.
Note that these commands require Internet access.</p>
<p>If you are missing either OpenSSL or OpenSSL&#8217;s development headers,
you can install a local copy of both into your Sage installation first.
Ideally, this should be done before installing Sage; otherwise, you should at
least rebuild Sage&#8217;s Python, and ideally any part of Sage relying on it.
The procedure is as follows (again, with a computer connected to the
Internet).
Starting from a fresh Sage tarball:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">sage</span> <span class="o">-</span><span class="n">i</span> <span class="n">openssl</span>
<span class="n">make</span> <span class="n">ssl</span>
</pre></div>
</div>
<p>And if you&#8217;ve already built Sage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">sage</span> <span class="o">-</span><span class="n">i</span> <span class="n">openssl</span>
<span class="o">./</span><span class="n">sage</span> <span class="o">-</span><span class="n">f</span> <span class="n">python2</span>
<span class="n">make</span> <span class="n">ssl</span>
</pre></div>
</div>
<p>The third line will rebuild all parts of Sage that depend on Python;
this can take a while.</p>
</div>
<div class="section" id="rebasing-issues-on-cygwin">
<h3>Rebasing issues on Cygwin<a class="headerlink" href="#rebasing-issues-on-cygwin" title="Permalink to this headline">¶</a></h3>
<p>Building on Cygwin will occasionally require &#8220;rebasing&#8221; <code class="docutils literal"><span class="pre">dll</span></code> files.
Sage provides some scripts, located in <code class="file docutils literal"><span class="pre">$SAGE_LOCAL/bin</span></code>, to do so:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sage-rebaseall.sh</span></code>, a shell script which calls Cygwin&#8217;s <code class="docutils literal"><span class="pre">rebaseall</span></code>
program.
It must be run within a <code class="docutils literal"><span class="pre">dash</span></code> shell from the <span class="target" id="index-14"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_ROOT</span></code> directory
after all other Cygwin processes have been shut down and needs write-access
to the system-wide rebase database located at <code class="file docutils literal"><span class="pre">/etc/rebase.db.i386</span></code>,
which usually means administrator privileges.
It updates the system-wide database and adds Sage dlls to it, so that
subsequent calls to <code class="docutils literal"><span class="pre">rebaseall</span></code> will take them into account.</li>
<li><code class="docutils literal"><span class="pre">sage-rebase.sh</span></code>, a shell script which calls Cygwin&#8217;s <code class="docutils literal"><span class="pre">rebase</span></code> program
together with the <code class="docutils literal"><span class="pre">-O/--oblivious</span></code> option.
It must be run within a shell from <span class="target" id="index-15"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_ROOT</span></code> directory.
Contrary to the <code class="docutils literal"><span class="pre">sage-rebaseall.sh</span></code> script, it neither updates the
system-wide database, nor adds Sage dlls to it.
Therefore, subsequent calls to <code class="docutils literal"><span class="pre">rebaseall</span></code> will not take them into account.</li>
<li><code class="docutils literal"><span class="pre">sage-rebaseall.bat</span></code> (respectively <code class="docutils literal"><span class="pre">sage-rebase.bat</span></code>), an MS-DOS batch
file which calls the <code class="docutils literal"><span class="pre">sage-rebaseall.sh</span></code> (respectively <code class="docutils literal"><span class="pre">sage-rebase.sh</span></code>)
script.
It must be run from a Windows command prompt, after adjusting
<span class="target" id="index-16"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_ROOT</span></code> to the Windows location of Sage&#8217;s home directory, and, if
Cygwin is installed in a non-standard location, adjusting
<span class="target" id="index-17"></span><code class="xref std std-envvar docutils literal"><span class="pre">CYGWIN_ROOT</span></code> as well.</li>
</ul>
<p>Some systems may encounter this problem frequently enough to make building or
testing difficult.
If executing the above scripts or directly calling <code class="docutils literal"><span class="pre">rebaseall</span></code> does not solve
rebasing issues, deleting the system-wide database and then regenerating it
from scratch, e.g., by executing <code class="docutils literal"><span class="pre">sage-rebaseall.sh</span></code>, might help.</p>
<p>Finally, on Cygwin, one should also avoid the following:</p>
<ul class="simple">
<li>building in home directories of Windows domain users;</li>
<li>building in paths with capital letters
(see <a class="reference external" href="https://trac.sagemath.org/13343">trac ticket #13343</a>, although there has been some success doing so).</li>
</ul>
</div>
</div>
<div class="section" id="make-targets">
<span id="section-make"></span><h2><a class="toc-backref" href="#id10">Make targets</a><a class="headerlink" href="#make-targets" title="Permalink to this headline">¶</a></h2>
<p>To build Sage from scratch, you would typically execute <code class="docutils literal"><span class="pre">make</span></code> in Sage&#8217;s home
directory to build Sage and its <a class="reference external" href="http://en.wikipedia.org/wiki/HTML">HTML</a>
documentation.
The <code class="docutils literal"><span class="pre">make</span></code> command is pretty smart, so if your build of Sage is interrupted,
then running <code class="docutils literal"><span class="pre">make</span></code> again should cause it to pick up where it left off.
The <code class="docutils literal"><span class="pre">make</span></code> command can also be given options, which control what is built and
how it is built:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">make</span> <span class="pre">build</span></code> builds Sage: it compiles all of the Sage packages.
It does not build the documentation.</li>
<li><code class="docutils literal"><span class="pre">make</span> <span class="pre">doc</span></code> builds Sage&#8217;s documentation in HTML format.
Note that this requires that Sage be built first, so it will automatically
run <code class="docutils literal"><span class="pre">make</span> <span class="pre">build</span></code> first.
Thus, running <code class="docutils literal"><span class="pre">make</span> <span class="pre">doc</span></code> is equivalent to running <code class="docutils literal"><span class="pre">make</span></code>.</li>
<li><code class="docutils literal"><span class="pre">make</span> <span class="pre">doc-pdf</span></code> builds Sage&#8217;s documentation in PDF format. This also
requires that Sage be built first, so it will automatically run <code class="docutils literal"><span class="pre">make</span>
<span class="pre">build</span></code>.</li>
<li><code class="docutils literal"><span class="pre">make</span> <span class="pre">doc-html-no-plot</span></code> builds Sage&#8217;s documentation in html format
but skips the inclusion of graphics auto-generated using the
<code class="docutils literal"><span class="pre">..</span> <span class="pre">PLOT</span></code> markup and the <code class="docutils literal"><span class="pre">sphinx_plot</span></code> function. This is
primarily intended for use when producing certain binary
distributions of Sage, to lower the size of the distribution. As of
this writing (December 2014, Sage 6.5), there are only a few such
plots, adding about 4M to the <code class="file docutils literal"><span class="pre">local/share/doc/sage/</span></code> directory.
In the future, this may grow, of course. Note: after using this, if you
want to build the documentation and include the pictures, you should
run <code class="docutils literal"><span class="pre">make</span> <span class="pre">doc-clean</span></code>, because the presence, or lack, of pictures
is cached in the documentation output.
You can benefit from this no-plot feature with other make targets by doing
<code class="docutils literal"><span class="pre">export</span> <span class="pre">SAGE_DOCBUILD_OPTS+='</span> <span class="pre">--no-plot'</span></code></li>
<li><code class="docutils literal"><span class="pre">make</span> <span class="pre">ptest</span></code> and <code class="docutils literal"><span class="pre">make</span> <span class="pre">ptestlong</span></code>: these run Sage&#8217;s test suite.
The first version skips tests that need more than a few seconds to complete
and those which depend on optional packages or additional software.
The second version includes the former, and so it takes longer.
The &#8220;p&#8221; in <code class="docutils literal"><span class="pre">ptest</span></code> stands for &#8220;parallel&#8221;: tests are run in parallel.
If you want to run tests serially, you can use <code class="docutils literal"><span class="pre">make</span> <span class="pre">test</span></code> or
<code class="docutils literal"><span class="pre">make</span> <span class="pre">testlong</span></code> instead.
If you want to run tests depending on optional packages and additional
software, you can use <code class="docutils literal"><span class="pre">make</span> <span class="pre">testall</span></code>, <code class="docutils literal"><span class="pre">make</span> <span class="pre">ptestall</span></code>,
<code class="docutils literal"><span class="pre">make</span> <span class="pre">testalllong</span></code>, or <code class="docutils literal"><span class="pre">make</span> <span class="pre">ptestalllong</span></code>.</li>
<li><code class="docutils literal"><span class="pre">make</span> <span class="pre">doc-clean</span></code> removes several directories which are produced
when building the documentation.</li>
<li><code class="docutils literal"><span class="pre">make</span> <span class="pre">distclean</span></code> restores the Sage directory to its state before doing any
building: it is almost equivalent to deleting Sage&#8217;s entire home directory and
unpacking the source tarfile again, the only difference being that the
<code class="file docutils literal"><span class="pre">.git</span></code> directory is preserved, so git branches are not deleted.</li>
</ul>
</div>
<div class="section" id="environment-variables">
<span id="section-envvar"></span><h2><a class="toc-backref" href="#id11">Environment variables</a><a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h2>
<p>Sage uses several environment variables to control its build process.
Most users won&#8217;t need to set any of these: the build process just works on many
platforms.
(Note though that setting <span class="target" id="index-18"></span><code class="xref std std-envvar docutils literal"><span class="pre">MAKE</span></code>, as described below, can significantly
speed up the process.)
Building Sage involves building about 100 packages, each of which has its own
compilation instructions.</p>
<p>The Sage source tarball already includes the sources for all standard
packages, that is, it allows you to build Sage without internet
connection. The git repository, however, does not contain the source
code for third-party packages. Instead, it will be downloaded as
needed (Note: you can run <code class="docutils literal"><span class="pre">make</span> <span class="pre">download</span></code> to force downloading
packages before building). Package downloads use the Sage mirror
network, the nearest mirror will be determined automatically for
you. This is influenced by the following environment variable:</p>
<ul>
<li><p class="first"><span class="target" id="index-19"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_SERVER</span></code> - Try the specified mirror first, before
falling back to the official Sage mirror list. Note that Sage will
search the directory</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">SAGE_SERVER/spkg/upstream</span></code></li>
</ul>
<p>for clean upstream tarballs, and it searches the directories</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">SAGE_SERVER/spkg/standard/</span></code>,</li>
<li><code class="docutils literal"><span class="pre">SAGE_SERVER/spkg/optional/</span></code>,</li>
<li><code class="docutils literal"><span class="pre">SAGE_SERVER/spkg/experimental/</span></code>,</li>
<li><code class="docutils literal"><span class="pre">SAGE_SERVER/spkg/archive/</span></code></li>
</ul>
<p>for old-style Sage packages.</p>
</li>
</ul>
<p>Here are some of the more commonly used variables affecting the build process:</p>
<ul>
<li><p class="first"><span class="target" id="index-20"></span><code class="xref std std-envvar docutils literal"><span class="pre">MAKE</span></code> - one useful setting for this variable when building Sage is
<code class="docutils literal"><span class="pre">MAKE='make</span> <span class="pre">-jNUM'</span></code> to tell the <code class="docutils literal"><span class="pre">make</span></code> program to run <code class="docutils literal"><span class="pre">NUM</span></code> jobs in
parallel when building.
Note that not all Sage packages (e.g. ATLAS) support this variable.</p>
<p>Some people advise using more jobs than there are CPU cores, at least if the
system is not heavily loaded and has plenty of RAM; for example, a good
setting for <code class="docutils literal"><span class="pre">NUM</span></code> might be between 1 and 1.5 times the number of cores.
In addition, the <code class="docutils literal"><span class="pre">-l</span></code> option sets a load limit: <code class="docutils literal"><span class="pre">MAKE='make</span> <span class="pre">-j4</span> <span class="pre">-l5.5</span></code>,
for example, tells <code class="docutils literal"><span class="pre">make</span></code> to try to use four jobs, but to not start more
than one job if the system load average is above 5.5.
See the manual page for GNU <code class="docutils literal"><span class="pre">make</span></code>: <a class="reference external" href="http://www.gnu.org/software/make/manual/make.html#Options-Summary">Command-line options</a>
and <a class="reference external" href="http://www.gnu.org/software/make/manual/make.html#Parallel">Parallel building</a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Some users on single-core OS X machines have reported problems when
building Sage with <code class="docutils literal"><span class="pre">MAKE='make</span> <span class="pre">-jNUM'</span></code> with <code class="docutils literal"><span class="pre">NUM</span></code> greater than one.</p>
</div>
</li>
<li><p class="first"><span class="target" id="index-21"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_NUM_THREADS</span></code> - if set to a number, then when building the
documentation, parallel doctesting, or running <code class="docutils literal"><span class="pre">sage</span> <span class="pre">-b</span></code>, use this many
threads.
If this is not set, then determine the number of threads using the value of
the <span class="target" id="index-22"></span><code class="xref std std-envvar docutils literal"><span class="pre">MAKE</span></code> (see above) or <span class="target" id="index-23"></span><code class="xref std std-envvar docutils literal"><span class="pre">MAKEFLAGS</span></code> environment variables.
If none of these specifies a number of jobs, use one thread (except for
parallel testing: there we use a default of the number of CPU cores, with a
maximum of 8 and a minimum of 2).</p>
</li>
<li><p class="first"><span class="target" id="index-24"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_CHECK</span></code> - if set to <code class="docutils literal"><span class="pre">yes</span></code>, then during the build process,
or when installing packages manually,
run the test suite for each package which has one.
See also <span class="target" id="index-25"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_CHECK_PACKAGES</span></code>.</p>
</li>
<li><p class="first"><span class="target" id="index-26"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_CHECK_PACKAGES</span></code> - if <span class="target" id="index-27"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_CHECK</span></code> is set to <code class="docutils literal"><span class="pre">yes</span></code>,
then the default behavior is to run test suites for all spkgs which contain
them.
If <span class="target" id="index-28"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_CHECK_PACKAGES</span></code> is set, it should be a comma-separated list
of strings of the form <code class="docutils literal"><span class="pre">package-name</span></code> or <code class="docutils literal"><span class="pre">!package-name</span></code>.
An entry <code class="docutils literal"><span class="pre">package-name</span></code> means to run the test suite for the named package
regardless of the setting of <span class="target" id="index-29"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_CHECK</span></code>.
An entry <code class="docutils literal"><span class="pre">!package-name</span></code> means to skip its test suite.
So if this is set to <code class="docutils literal"><span class="pre">mpir,!python</span></code>, then always run the test suite for
MPIR, but always skip the test suite for Python.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As of this writing (April 2013, Sage 5.8), the test suite for the Python
spkg fails on most platforms.
So when this variable is empty or unset, Sage uses a default of
<code class="docutils literal"><span class="pre">!python</span></code>.</p>
</div>
</li>
<li><p class="first"><span class="target" id="index-30"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE64</span></code> - if set to <code class="docutils literal"><span class="pre">yes</span></code>, then build a 64-bit binary on platforms
which default to 32-bit, even though they can build 64-bit binaries.
It adds the compiler flag <code class="docutils literal"><span class="pre">-m64</span></code> when compiling programs.
The <span class="target" id="index-31"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE64</span></code> variable is mainly of use on OS X (pre 10.6), Solaris
and OpenSolaris, though it will add the <code class="docutils literal"><span class="pre">-m64</span></code> flag on any operating
system.
If you are running Linux or version 10.6 or later of OS X on a 64-bit
machine, then Sage will automatically build a 64-bit binary, so this
variable does not need to be set.</p>
</li>
<li><p class="first"><span class="target" id="index-32"></span><code class="xref std std-envvar docutils literal"><span class="pre">CFLAG64</span></code> - default value <code class="docutils literal"><span class="pre">-m64</span></code>.
If Sage detects that it should build a 64-bit binary, then it uses this flag
when compiling C code.
Modify it if necessary for your system and C compiler.
This should not be necessary on most systems &#8211; this flag will typically be
set automatically, based on the setting of <span class="target" id="index-33"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE64</span></code>, for example.</p>
</li>
<li><p class="first"><span class="target" id="index-34"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_INSTALL_GCC</span></code> - by default, Sage will automatically detect
whether to install the <a class="reference external" href="http://gcc.gnu.org/">GNU Compiler Collection (GCC)</a>
package or not (depending on whether C, C++, and Fortran compilers are present
and the versions of those compilers).
Setting <code class="docutils literal"><span class="pre">SAGE_INSTALL_GCC=yes</span></code> will force Sage to install GCC.
Setting <code class="docutils literal"><span class="pre">SAGE_INSTALL_GCC=no</span></code> will prevent Sage from installing GCC.</p>
</li>
<li><p class="first"><span class="target" id="index-35"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_INSTALL_CCACHE</span></code> - by default Sage doesn&#8217;t install ccache,
however by setting <code class="docutils literal"><span class="pre">SAGE_INSTALL_CCACHE=yes</span></code> Sage will install ccache.
Because the Sage distribution is quite large, the maximum cache is set to 4G.
This can be changed by running <code class="docutils literal"><span class="pre">sage</span> <span class="pre">-sh</span> <span class="pre">-c</span> <span class="pre">&quot;ccache</span> <span class="pre">--max-size=SIZE&quot;</span></code>,
where <code class="docutils literal"><span class="pre">SIZE</span></code> is specified in gigabytes, megabytes, or kilobytes by
appending a &#8220;G&#8221;, &#8220;M&#8221;, or &#8220;K&#8221;.</p>
<p>Sage does not include the sources for ccache since it is an optional package.
Because of this, it is necessary to have an Internet connection while
building ccache for Sage, so that Sage can pull down the necessary
sources.</p>
</li>
<li><p class="first"><span class="target" id="index-36"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_DEBUG</span></code> - controls debugging support.
There are three different possible values:</p>
<ul class="simple">
<li>Not set (or set to anything else than &#8220;yes&#8221; or &#8220;no&#8221;): build binaries with
debugging symbols, but no special debug builds.
This is the default.
There is no performance impact, only additional disk space is used.</li>
<li><code class="docutils literal"><span class="pre">SAGE_DEBUG=no</span></code>: <code class="docutils literal"><span class="pre">no</span></code> means no debugging symbols (that is, no
<code class="docutils literal"><span class="pre">gcc</span> <span class="pre">-g</span></code>), which saves some disk space.</li>
<li><code class="docutils literal"><span class="pre">SAGE_DEBUG=yes</span></code>: build debug versions if possible (in particular,
Python is built with additional debugging turned on and Singular is built
with a different memory manager).
These will be notably slower but, for example, make it much easier to
pinpoint memory allocation problems.</li>
</ul>
</li>
<li><p class="first"><span class="target" id="index-37"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_PROFILE</span></code> - controls profiling support. If this is set
to <code class="docutils literal"><span class="pre">yes</span></code>, profiling support is enabled where possible. Note that
Python-level profiling is always avaliable; This option enables
profiling in Cython modules.</p>
</li>
<li><p class="first"><span class="target" id="index-38"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_SPKG_INSTALL_DOCS</span></code> - if set to <code class="docutils literal"><span class="pre">yes</span></code>, then install
package-specific documentation to
<code class="file docutils literal"><span class="pre">$SAGE_ROOT/local/share/doc/PACKAGE_NAME/</span></code> when an spkg is
installed.
This option may not be supported by all spkgs.
Some spkgs might also assume that certain programs are available on the
system (for example, <code class="docutils literal"><span class="pre">latex</span></code> or <code class="docutils literal"><span class="pre">pdflatex</span></code>).</p>
</li>
<li><p class="first"><span class="target" id="index-39"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_DOC_MATHJAX</span></code> - by default, any LaTeX code in Sage&#8217;s
documentation is processed by MathJax.
If this variable is set to <code class="docutils literal"><span class="pre">no</span></code>, then MathJax is not used &#8211; instead,
math is processed using LaTeX and converted by dvipng to image files,
and then those files are included into the documentation.
Typically, building the documentation using LaTeX and dvipng takes longer
and uses more memory and disk space than using MathJax.</p>
</li>
<li><p class="first"><span class="target" id="index-40"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_DOCBUILD_OPTS</span></code> - the value of this variable is passed as an
argument to <code class="docutils literal"><span class="pre">sage</span> <span class="pre">--docbuild</span> <span class="pre">all</span> <span class="pre">html</span></code> or <code class="docutils literal"><span class="pre">sage</span> <span class="pre">--docbuild</span> <span class="pre">all</span> <span class="pre">pdf</span></code> when
you run <code class="docutils literal"><span class="pre">make</span></code>, <code class="docutils literal"><span class="pre">make</span> <span class="pre">doc</span></code>, or <code class="docutils literal"><span class="pre">make</span> <span class="pre">doc-pdf</span></code>.
For example, you can add <code class="docutils literal"><span class="pre">--no-plot</span></code> to this variable to avoid building
the graphics coming from the <code class="docutils literal"><span class="pre">..</span> <span class="pre">PLOT</span></code> directive within the documentation,
or you can add <code class="docutils literal"><span class="pre">--no-tests</span></code> to omit all &#8220;TESTS&#8221; blocks in the
reference manual. Run <code class="docutils literal"><span class="pre">sage</span> <span class="pre">--docbuild</span> <span class="pre">help</span></code> to see the full list
of options.</p>
</li>
<li><p class="first"><span class="target" id="index-41"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_BUILD_DIR</span></code> - the default behavior is to build each spkg in a
subdirectory of <code class="file docutils literal"><span class="pre">$SAGE_ROOT/local/var/tmp/sage/build/</span></code>; for
example, build version 3.8.3.p12 of
<code class="file docutils literal"><span class="pre">atlas</span></code> in the directory
<code class="file docutils literal"><span class="pre">$SAGE_ROOT/local/var/tmp/sage/build/atlas-3.8.3.p12/</span></code>.
If this variable is set, then build in
<code class="file docutils literal"><span class="pre">$SAGE_BUILD_DIR/atlas-3.8.3.p12/</span></code> instead.
If the directory <code class="file docutils literal"><span class="pre">$SAGE_BUILD_DIR</span></code> does not exist, it is created.
As of this writing (Sage 4.8), when building the standard Sage packages,
1.5 gigabytes of free space are required in this directory (or more if
<code class="docutils literal"><span class="pre">SAGE_KEEP_BUILT_SPKGS=yes</span></code> &#8211; see below); the exact amount of required
space varies from platform to platform.
For example, the block size of the file system will affect the amount of
space used, since some spkgs contain many small files.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The variable <span class="target" id="index-42"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_BUILD_DIR</span></code> must be set to the full path name
of either an existing directory for which the user has write permissions,
or to the full path name of a nonexistent directory which the user has
permission to create.
The path name must contain <strong>no spaces</strong>.</p>
</div>
</li>
<li><p class="first"><span class="target" id="index-43"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_KEEP_BUILT_SPKGS</span></code> - the default behavior is to delete each
build directory &#8211; the appropriate subdirectory of
<code class="file docutils literal"><span class="pre">$SAGE_ROOT/local/var/tmp/sage/build</span></code> or
<code class="file docutils literal"><span class="pre">$SAGE_BUILD_DIR</span></code> &#8211; after each spkg
is successfully built, and to keep it if there were errors installing the
spkg.
Set this variable to <code class="docutils literal"><span class="pre">yes</span></code> to keep the subdirectory regardless.
Furthermore, if you install an spkg for which there is already a
corresponding subdirectory, for example left over from a previous build,
then the default behavior is to delete that old subdirectory.
If this variable is set to <code class="docutils literal"><span class="pre">yes</span></code>, then the old subdirectory is moved to
<code class="file docutils literal"><span class="pre">$SAGE_ROOT/local/var/tmp/sage/build/old/</span></code> (or
<code class="file docutils literal"><span class="pre">$SAGE_BUILD_DIR/old</span></code>),
overwriting any already existing file or directory with the same name.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">After a full build of Sage (as of version 4.8), these subdirectories can
take up to 6 gigabytes of storage, in total, depending on the platform
and the block size of the file system.
If you always set this variable to <code class="docutils literal"><span class="pre">yes</span></code>, it can take even more space:
rebuilding every spkg would use double the amount of space, and any
upgrades to spkgs would create still more directories, using still more
space.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In an existing Sage installation, running <code class="docutils literal"><span class="pre">sage</span> <span class="pre">-i</span> <span class="pre">-s</span> <span class="pre">&lt;package-name&gt;</span></code>
or <code class="docutils literal"><span class="pre">sage</span> <span class="pre">-f</span> <span class="pre">-s</span> <span class="pre">&lt;package-name&gt;</span></code> installs the spkg <code class="docutils literal"><span class="pre">&lt;package-name&gt;</span></code> and
keeps the corresponding build directory; thus setting
<span class="target" id="index-44"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_KEEP_BUILT_SPKGS</span></code> to <code class="docutils literal"><span class="pre">yes</span></code> mimics this behavior when
building Sage from scratch or when installing individual spkgs.
So you can set this variable to <code class="docutils literal"><span class="pre">yes</span></code> instead of using the <code class="docutils literal"><span class="pre">-s</span></code> flag
for <code class="docutils literal"><span class="pre">sage</span> <span class="pre">-i</span></code> and <code class="docutils literal"><span class="pre">sage</span> <span class="pre">-f</span></code>.</p>
</div>
</li>
<li><p class="first"><span class="target" id="index-45"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_FAT_BINARY</span></code> - to build binaries that will run on the
widest range of target CPUs set this variable to <code class="docutils literal"><span class="pre">yes</span></code> before
building Sage. This does not make the binaries relocatable, it only
avoids newer CPU instruction set extensions. For relocatable (=can
be moved to a different directory) binaries, you must use
<a class="reference external" href="https://github.com/sagemath/binary-pkg">https://github.com/sagemath/binary-pkg</a></p>
</li>
</ul>
<p>Variables to set if you&#8217;re trying to build Sage with an unusual setup, e.g.,
an unsupported machine or an unusual compiler:</p>
<ul>
<li><p class="first"><span class="target" id="index-46"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_PORT</span></code> - if you try to build Sage on a platform which is
recognized as being unsupported (e.g. AIX, or HP-UX), or with a compiler
which is unsupported (anything except GCC), you will see a message saying
something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">You</span> <span class="n">are</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">build</span> <span class="n">Sage</span> <span class="n">on</span> <span class="n">IBM</span><span class="s1">&#39;s AIX operating system,</span>
<span class="n">which</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">supported</span> <span class="n">platform</span> <span class="k">for</span> <span class="n">Sage</span> <span class="n">yet</span><span class="o">.</span> <span class="n">Things</span> <span class="n">may</span> <span class="ow">or</span>
<span class="n">may</span> <span class="ow">not</span> <span class="n">work</span><span class="o">.</span> <span class="n">If</span> <span class="n">you</span> <span class="n">would</span> <span class="n">like</span> <span class="n">to</span> <span class="n">help</span> <span class="n">port</span> <span class="n">Sage</span> <span class="n">to</span> <span class="n">AIX</span><span class="p">,</span>
<span class="n">please</span> <span class="n">join</span> <span class="n">the</span> <span class="n">sage</span><span class="o">-</span><span class="n">devel</span> <span class="n">discussion</span> <span class="nb">list</span> <span class="o">--</span> <span class="n">see</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">groups</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">group</span><span class="o">/</span><span class="n">sage</span><span class="o">-</span><span class="n">devel</span>
<span class="n">The</span> <span class="n">Sage</span> <span class="n">community</span> <span class="n">would</span> <span class="n">also</span> <span class="n">appreciate</span> <span class="nb">any</span> <span class="n">patches</span> <span class="n">you</span> <span class="n">submit</span><span class="o">.</span>

<span class="n">To</span> <span class="n">get</span> <span class="n">past</span> <span class="n">this</span> <span class="n">message</span> <span class="ow">and</span> <span class="k">try</span> <span class="n">building</span> <span class="n">Sage</span> <span class="n">anyway</span><span class="p">,</span>
<span class="n">export</span> <span class="n">the</span> <span class="n">variable</span> <span class="n">SAGE_PORT</span> <span class="n">to</span> <span class="n">something</span> <span class="n">non</span><span class="o">-</span><span class="n">empty</span><span class="o">.</span>
</pre></div>
</div>
<p>If this is case and you want to try to build Sage anyway, follow the
directions: set <span class="target" id="index-47"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_PORT</span></code> to something non-empty (and expect to
run into problems).</p>
</li>
</ul>
<p>Environment variables dealing with specific Sage packages:</p>
<ul>
<li><p class="first"><span class="target" id="index-48"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_MP_LIBRARY</span></code> - to use an alternative library in place of <code class="docutils literal"><span class="pre">MPIR</span></code>
for multiprecision integer arithmetic. Supported values are</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">MPIR</span></code> (default choice), <code class="docutils literal"><span class="pre">GMP</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first"><span class="target" id="index-49"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_ATLAS_ARCH</span></code> - if you are compiling ATLAS (in particular,
if <span class="target" id="index-50"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_ATLAS_LIB</span></code> is not set), you can use this environment
variable to set a particular architecture and instruction set extension,
to control the maximum number of threads ATLAS can use, and to trigger the
installation of a static library (which is disabled by default unless
building our custom shared libraries fails).
The syntax is</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">SAGE_ATLAS_ARCH=[threads:n,][static,]arch[,isaext1][,isaext2]...[,isaextN]</span></code>.</p>
</div></blockquote>
<p>While ATLAS comes with precomputed timings for a variety of CPUs, it only
uses them if it finds an exact match.
Otherwise, ATLAS runs through a lengthy automated tuning process in order
to optimize performance for your particular system, which can take several
days on slow and unusual systems.
You drastically reduce the total Sage compile time if you manually select a
suitable architecture.
It is recommended to specify a suitable architecture on laptops or other
systems with CPU throttling or if you want to distribute the binaries.
Available architectures are</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">POWER3</span></code>, <code class="docutils literal"><span class="pre">POWER4</span></code>, <code class="docutils literal"><span class="pre">POWER5</span></code>, <code class="docutils literal"><span class="pre">PPCG4</span></code>, <code class="docutils literal"><span class="pre">PPCG5</span></code>,
<code class="docutils literal"><span class="pre">POWER6</span></code>, <code class="docutils literal"><span class="pre">POWER7</span></code>, <code class="docutils literal"><span class="pre">IBMz9</span></code>, <code class="docutils literal"><span class="pre">IBMz10</span></code>, <code class="docutils literal"><span class="pre">IBMz196</span></code>,
<code class="docutils literal"><span class="pre">x86x87</span></code>, <code class="docutils literal"><span class="pre">x86SSE1</span></code>, <code class="docutils literal"><span class="pre">x86SSE2</span></code>, <code class="docutils literal"><span class="pre">x86SSE3</span></code>, <code class="docutils literal"><span class="pre">P5</span></code>,
<code class="docutils literal"><span class="pre">P5MMX</span></code>, <code class="docutils literal"><span class="pre">PPRO</span></code>, <code class="docutils literal"><span class="pre">PII</span></code>, <code class="docutils literal"><span class="pre">PIII</span></code>, <code class="docutils literal"><span class="pre">PM</span></code>, <code class="docutils literal"><span class="pre">CoreSolo</span></code>,
<code class="docutils literal"><span class="pre">CoreDuo</span></code>, <code class="docutils literal"><span class="pre">Core2Solo</span></code>, <code class="docutils literal"><span class="pre">Core2</span></code>, <code class="docutils literal"><span class="pre">Corei1</span></code>, <code class="docutils literal"><span class="pre">Corei2</span></code>,
<code class="docutils literal"><span class="pre">Atom</span></code>, <code class="docutils literal"><span class="pre">P4</span></code>, <code class="docutils literal"><span class="pre">P4E</span></code>, <code class="docutils literal"><span class="pre">Efficeon</span></code>, <code class="docutils literal"><span class="pre">K7</span></code>, <code class="docutils literal"><span class="pre">HAMMER</span></code>,
<code class="docutils literal"><span class="pre">AMD64K10h</span></code>, <code class="docutils literal"><span class="pre">AMDDOZER</span></code>, <code class="docutils literal"><span class="pre">UNKNOWNx86</span></code>, <code class="docutils literal"><span class="pre">IA64Itan</span></code>,
<code class="docutils literal"><span class="pre">IA64Itan2</span></code>, <code class="docutils literal"><span class="pre">USI</span></code>, <code class="docutils literal"><span class="pre">USII</span></code>, <code class="docutils literal"><span class="pre">USIII</span></code>, <code class="docutils literal"><span class="pre">USIV</span></code>, <code class="docutils literal"><span class="pre">UST2</span></code>,
<code class="docutils literal"><span class="pre">UnknownUS</span></code>, <code class="docutils literal"><span class="pre">MIPSR1xK</span></code>, <code class="docutils literal"><span class="pre">MIPSICE9</span></code>, <code class="docutils literal"><span class="pre">ARMv7</span></code>.</p>
</div></blockquote>
<p>and instruction set extensions are</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">VSX</span></code>, <code class="docutils literal"><span class="pre">AltiVec</span></code>, <code class="docutils literal"><span class="pre">AVXMAC</span></code>, <code class="docutils literal"><span class="pre">AVXFMA4</span></code>, <code class="docutils literal"><span class="pre">AVX</span></code>, <code class="docutils literal"><span class="pre">SSE3</span></code>,
<code class="docutils literal"><span class="pre">SSE2</span></code>, <code class="docutils literal"><span class="pre">SSE1</span></code>, <code class="docutils literal"><span class="pre">3DNow</span></code>, <code class="docutils literal"><span class="pre">NEON</span></code>.</p>
</div></blockquote>
<p>In addition, you can also set</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">SAGE_ATLAS_ARCH=fast</span></code> which picks defaults for a modern (2-3 year old)
CPU of your processor line, and</li>
<li><code class="docutils literal"><span class="pre">SAGE_ATLAS_ARCH=base</span></code> which picks defaults that should work for a ~10
year old CPU.</li>
</ul>
<p>For example,</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">SAGE_ATLAS_ARCH=Corei2,AVX,SSE3,SSE2,SSE1</span></code></p>
</div></blockquote>
<p>would be appropriate for a Core i7 CPU.</p>
</li>
<li><p class="first"><span class="target" id="index-51"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_ATLAS_LIB</span></code> - if you have an installation of ATLAS on your
system and you want Sage to use it instead of building and installing its
own version of ATLAS, set this variable to be the directory containing your
ATLAS installation.
It should contain the files <code class="file docutils literal"><span class="pre">libatlas</span></code>, <code class="file docutils literal"><span class="pre">liblapack</span></code>,
<code class="file docutils literal"><span class="pre">libcblas</span></code>, <code class="file docutils literal"><span class="pre">libf77blas</span></code> (and optionally <code class="file docutils literal"><span class="pre">libptcblas</span></code> and
<code class="file docutils literal"><span class="pre">libptf77blas</span></code> for multi-threaded computations), with extensions <code class="docutils literal"><span class="pre">.a</span></code>,
<code class="docutils literal"><span class="pre">.so</span></code>, or <code class="docutils literal"><span class="pre">.dylib</span></code>.  For backward compatibility, the libraries may also be
in the subdirectory <code class="file docutils literal"><span class="pre">SAGE_ATLAS_LIB/lib/</span></code>.</p>
</li>
<li><p class="first"><span class="target" id="index-52"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_MATPLOTLIB_GUI</span></code> - if set to anything non-empty except <code class="docutils literal"><span class="pre">no</span></code>,
then Sage will attempt to build the graphical backend when it builds the
matplotlib package.</p>
</li>
<li><p class="first"><span class="target" id="index-53"></span><code class="xref std std-envvar docutils literal"><span class="pre">PARI_CONFIGURE</span></code> - use this to pass extra parameters to
PARI&#8217;s <code class="docutils literal"><span class="pre">Configure</span></code> script, for example to specify graphics
support (which is disabled by default). See the file
<code class="file docutils literal"><span class="pre">build/pkgs/pari/spkg-install</span></code> for more information.</p>
</li>
<li><p class="first"><span class="target" id="index-54"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_TUNE_PARI</span></code>: If yes, enable PARI self-tuning. Note that
this can be time-consuming. If you set this variable to &#8220;yes&#8221;, you
will also see this: <code class="docutils literal"><span class="pre">WARNING:</span> <span class="pre">Tuning</span> <span class="pre">PARI/GP</span> <span class="pre">is</span> <span class="pre">unreliable.</span> <span class="pre">You</span> <span class="pre">may</span>
<span class="pre">find</span> <span class="pre">your</span> <span class="pre">build</span> <span class="pre">of</span> <span class="pre">PARI</span> <span class="pre">fails,</span> <span class="pre">or</span> <span class="pre">PARI/GP</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">work</span> <span class="pre">properly</span>
<span class="pre">once</span> <span class="pre">built.</span> <span class="pre">We</span> <span class="pre">recommend</span> <span class="pre">to</span> <span class="pre">build</span> <span class="pre">this</span> <span class="pre">package</span> <span class="pre">with</span>
<span class="pre">SAGE_CHECK=&quot;yes&quot;.</span></code></p>
</li>
<li><p class="first"><span class="target" id="index-55"></span><code class="xref std std-envvar docutils literal"><span class="pre">PARI_MAKEFLAGS</span></code>: The value of this variable is passed as an
argument to the <code class="docutils literal"><span class="pre">$MAKE</span></code> command when compiling PARI.</p>
</li>
</ul>
<p>Some standard environment variables which are used by Sage:</p>
<ul class="simple">
<li><span class="target" id="index-56"></span><code class="xref std std-envvar docutils literal"><span class="pre">CC</span></code> - while some programs allow you to use this to specify your C
compiler, <strong>not every Sage package recognizes this</strong>.
If GCC is installed within Sage, <span class="target" id="index-57"></span><code class="xref std std-envvar docutils literal"><span class="pre">CC</span></code> is ignored and Sage&#8217;s <code class="docutils literal"><span class="pre">gcc</span></code>
is used instead.</li>
<li><span class="target" id="index-58"></span><code class="xref std std-envvar docutils literal"><span class="pre">CPP</span></code> - similarly, this will set the C preprocessor for some Sage
packages, and similarly, using it is likely quite risky.
If GCC is installed within Sage, <span class="target" id="index-59"></span><code class="xref std std-envvar docutils literal"><span class="pre">CPP</span></code> is ignored and Sage&#8217;s <code class="docutils literal"><span class="pre">cpp</span></code>
is used instead.</li>
<li><span class="target" id="index-60"></span><code class="xref std std-envvar docutils literal"><span class="pre">CXX</span></code> - similarly, this will set the C++ compiler for some Sage
packages, and similarly, using it is likely quite risky.
If GCC is installed within Sage, <span class="target" id="index-61"></span><code class="xref std std-envvar docutils literal"><span class="pre">CXX</span></code> is ignored and Sage&#8217;s <code class="docutils literal"><span class="pre">g++</span></code>
is used instead.</li>
<li><span class="target" id="index-62"></span><code class="xref std std-envvar docutils literal"><span class="pre">FC</span></code> - similarly, this will set the Fortran compiler.
This is supported by all Sage packages which have Fortran code.
However, for historical reasons, the value is hardcoded during the initial
<code class="docutils literal"><span class="pre">make</span></code> and subsequent changes to <code class="docutils literal"><span class="pre">$FC</span></code> might be ignored (in which case,
the original value will be used instead).
If GCC is installed within Sage, <span class="target" id="index-63"></span><code class="xref std std-envvar docutils literal"><span class="pre">FC</span></code> is ignored and Sage&#8217;s
<code class="docutils literal"><span class="pre">gfortran</span></code> is used instead.</li>
<li><span class="target" id="index-64"></span><code class="xref std std-envvar docutils literal"><span class="pre">CFLAGS</span></code>, <span class="target" id="index-65"></span><code class="xref std std-envvar docutils literal"><span class="pre">CXXFLAGS</span></code> and <span class="target" id="index-66"></span><code class="xref std std-envvar docutils literal"><span class="pre">FCFLAGS</span></code> - the flags for
the C compiler, the C++ compiler and the Fortran compiler, respectively.
The same comments apply to these: setting them may cause problems, because
they are not universally respected among the Sage packages. Note
also that <code class="docutils literal"><span class="pre">export</span> <span class="pre">CFLAGS=&quot;&quot;</span></code> does not have the same effect as
<code class="docutils literal"><span class="pre">unset</span> <span class="pre">CFLAGS</span></code>. The latter is preferable.</li>
<li>Similar comments apply to other compiler and linker flags like
<span class="target" id="index-67"></span><code class="xref std std-envvar docutils literal"><span class="pre">CPPFLAGS</span></code>, <span class="target" id="index-68"></span><code class="xref std std-envvar docutils literal"><span class="pre">LDFLAGS</span></code>, <span class="target" id="index-69"></span><code class="xref std std-envvar docutils literal"><span class="pre">CXXFLAG64</span></code>,
<span class="target" id="index-70"></span><code class="xref std std-envvar docutils literal"><span class="pre">LDFLAG64</span></code>, and <span class="target" id="index-71"></span><code class="xref std std-envvar docutils literal"><span class="pre">LD</span></code>.</li>
</ul>
<p>Sage uses the following environment variables when it runs:</p>
<ul class="simple">
<li><span class="target" id="index-72"></span><code class="xref std std-envvar docutils literal"><span class="pre">DOT_SAGE</span></code> - this is the directory, to which the user has read and
write access, where Sage stores a number of files.
The default location is <code class="file docutils literal"><span class="pre">$HOME/.sage/</span></code>.</li>
<li><span class="target" id="index-73"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_STARTUP_FILE</span></code> - a file including commands to be executed every
time Sage starts.
The default value is <code class="file docutils literal"><span class="pre">$DOT_SAGE/init.sage</span></code>.</li>
<li><span class="target" id="index-74"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_PATH</span></code> - a colon-separated list of directories which Sage
searches when trying to locate Python libraries.</li>
<li><span class="target" id="index-75"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_BROWSER</span></code> - on most platforms, Sage will detect the command to
run a web browser, but if this doesn&#8217;t seem to work on your machine, set this
variable to the appropriate command.</li>
</ul>
<p>Sage overrides the user&#8217;s settings of the following variables:</p>
<ul class="simple">
<li><span class="target" id="index-76"></span><code class="xref std std-envvar docutils literal"><span class="pre">MPLCONFIGDIR</span></code> - ordinarily, this variable lets the user set their
matplotlib config directory.
Due to incompatibilies in the contents of this directory among different
versions of matplotlib, Sage overrides the user&#8217;s setting, defining it
instead to be <code class="file docutils literal"><span class="pre">$DOT_SAGE/matplotlib-VER</span></code>, with <code class="docutils literal"><span class="pre">VER</span></code> replaced by the
current matplotlib version number.</li>
</ul>
<p>Variables dealing with doctesting:</p>
<ul class="simple">
<li><span class="target" id="index-77"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_TIMEOUT</span></code> - used for Sage&#8217;s doctesting: the number of seconds
to allow a doctest before timing it out.
If this isn&#8217;t set, the default is 300 seconds (5 minutes).</li>
<li><span class="target" id="index-78"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_TIMEOUT_LONG</span></code> - used for Sage&#8217;s doctesting: the number of
seconds to allow a doctest before timing it out, if tests are run using
<code class="docutils literal"><span class="pre">sage</span> <span class="pre">-t</span> <span class="pre">--long</span></code>.
If this isn&#8217;t set, the default is 1800 seconds (30 minutes).</li>
<li><span class="target" id="index-79"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_PICKLE_JAR</span></code> - if you want to update the the standard pickle
jar, set this to something non-empty and run the doctest suite.
See the documentation for the functions <code class="xref py py-func docutils literal"><span class="pre">picklejar()</span></code> and
<code class="xref py py-func docutils literal"><span class="pre">unpickle_all()</span></code> in
<code class="file docutils literal"><span class="pre">$SAGE_ROOT/src/sage/structure/sage_object.pyx</span></code>, online
<a class="reference external" href="http://doc.sagemath.org/html/en/reference/sage/structure/sage_object.html#sage.structure.sage_object.picklejar">here (picklejar)</a>
and <a class="reference external" href="http://doc.sagemath.org/html/en/reference/sage/structure/sage_object.html#sage.structure.sage_object.unpickle_all">here (unpickle_all)</a>.</li>
<li><span class="target" id="index-80"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_TEST_GLOBAL_ITER</span></code>, <span class="target" id="index-81"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_TEST_ITER</span></code>: these can
be used instead of passing the flags <code class="docutils literal"><span class="pre">--global-iterations</span></code> and
<code class="docutils literal"><span class="pre">--file-iterations</span></code>, respectively, to <code class="docutils literal"><span class="pre">sage</span> <span class="pre">-t</span></code>. Indeed, these
variables are only used if the flags are unset. Run <code class="docutils literal"><span class="pre">sage</span> <span class="pre">-t</span> <span class="pre">-h</span></code>
for more information on the effects of these flags (and therefore
these variables).</li>
</ul>
<p>Sage sets some other environment variables. The most accurate way to
see what Sage does is to first run <code class="docutils literal"><span class="pre">env</span></code> from a shell prompt to see
what environment variables you have set. Then run <code class="docutils literal"><span class="pre">sage</span> <span class="pre">--sh</span> <span class="pre">-c</span>
<span class="pre">env</span></code> to see the list after Sage sets its variables. (This runs a
separate shell, executes the shell command <code class="docutils literal"><span class="pre">env</span></code>, and then exits
that shell, so after running this, your settings will be restored.)
Alternatively, you can peruse the shell script
<code class="file docutils literal"><span class="pre">src/bin/sage-env</span></code>.</p>
<p>Sage also has some environment-like settings. Some of these correspond
to actual environment variables while others have names like
environment variables but are only available while Sage is running. To
see a list, execute <code class="docutils literal"><span class="pre">sage.env.[TAB]</span></code> while running Sage.</p>
</div>
<div class="section" id="installation-in-a-multiuser-environment">
<h2><a class="toc-backref" href="#id12">Installation in a Multiuser Environment</a><a class="headerlink" href="#installation-in-a-multiuser-environment" title="Permalink to this headline">¶</a></h2>
<p>This section addresses the question of how a system administrator can install
a single copy of Sage in a multi-user computer network.</p>
<div class="section" id="system-wide-install">
<h3>System-wide install<a class="headerlink" href="#system-wide-install" title="Permalink to this headline">¶</a></h3>
<p>In the instructions below, we assume that <code class="docutils literal"><span class="pre">/path/to/sage-x.y</span></code> is
the directory where you want to install Sage.</p>
<ol class="arabic">
<li><p class="first">First of all, extract the Sage source tarball in <code class="docutils literal"><span class="pre">/path/to</span></code>
(this will create the directory <code class="docutils literal"><span class="pre">/path/to/sage-x.y</span></code>).
After extracting, you can change the directory name if you do not
like <code class="docutils literal"><span class="pre">sage-x.y</span></code>.</p>
</li>
<li><p class="first">Change the ownership of the <code class="docutils literal"><span class="pre">/path/to/sage-x.y</span></code> directory tree
to your normal user account (as opposed to <code class="docutils literal"><span class="pre">root</span></code>). This is because
Sage will refuse to compile as <code class="docutils literal"><span class="pre">root</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">user</span><span class="p">:</span><span class="n">group</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sage</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
</li>
<li><p class="first">Using your normal user account, build Sage.
See the <a class="reference internal" href="#build-from-source-step-by-step"><span class="std std-ref">Step-by-step installation procedure</span></a> above.</p>
</li>
<li><p class="first">Make a symbolic link to the <code class="docutils literal"><span class="pre">sage</span></code> script in <code class="file docutils literal"><span class="pre">/usr/local/bin</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sage</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">y</span><span class="o">/</span><span class="n">sage</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sage</span>
</pre></div>
</div>
<p>Alternatively, copy the Sage script:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sage</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">y</span><span class="o">/</span><span class="n">sage</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sage</span>
</pre></div>
</div>
<p>If you do this, make sure you edit the line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#SAGE_ROOT=/path/to/sage-version</span>
</pre></div>
</div>
<p>at the beginning of the copied <code class="docutils literal"><span class="pre">sage</span></code> script according to the direction
given there to something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SAGE_ROOT</span><span class="o">=&lt;</span><span class="n">SAGE_ROOT</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>(note that you have to change <code class="docutils literal"><span class="pre">&lt;SAGE_ROOT&gt;</span></code> above!).
It is recommended not to edit the original <code class="docutils literal"><span class="pre">sage</span></code> script, only the copy at
<code class="file docutils literal"><span class="pre">/usr/local/bin/sage</span></code>.</p>
</li>
<li><p class="first">Optionally, you can test Sage by running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">testlong</span>
</pre></div>
</div>
<p>or <code class="docutils literal"><span class="pre">make</span> <span class="pre">ptestlong</span></code> which tests files in parallel using multiple
processes.
You can also omit <code class="docutils literal"><span class="pre">long</span></code> to skip tests which take a long time.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="some-common-problems">
<h2><a class="toc-backref" href="#id13">Some common problems</a><a class="headerlink" href="#some-common-problems" title="Permalink to this headline">¶</a></h2>
<div class="section" id="atlas">
<h3>ATLAS<a class="headerlink" href="#atlas" title="Permalink to this headline">¶</a></h3>
<p>Usually Sage will build ATLAS with architectural defaults that are not tuned
to your particular CPU.
In particular, if your CPU has powersaving enabled then no accurate timings
can be made to tune the ATLAS build for your hardware.
If BLAS performance is critical for you, you must recompile ATLAS after
installing Sage either with architecture settings that match your hardware,
or run through ATLAS&#8217; automatic tuning process where timings of different
implementations are compared and the best choice used to build a custom ATLAS
library.
To do so, you have to</p>
<ul class="simple">
<li>Leave the computer idle while you are reinstalling ATLAS.
Most of ATLAS will intentionally only compile/run on a single core.
Accurate timings of cache edges require that the CPU is otherwise idle.</li>
<li>Make sure that CPU powersaving mode (that is, anything but the
<code class="docutils literal"><span class="pre">performance</span></code> CPU scaling governor in Linux) is turned off when building
ATLAS.
This requires administrator privileges.</li>
<li>If your architecture is listed in <span class="target" id="index-82"></span><code class="xref std std-envvar docutils literal"><span class="pre">SAGE_ATLAS_ARCH</span></code>, you should set
it as it can help ATLAS in narrowing down the timing search.</li>
</ul>
<p>To help you disable CPU power saving, Sage includes an <code class="docutils literal"><span class="pre">atlas-config</span></code> script
that will turn off CPU powersave and rebuild ATLAS.
The script will call <code class="docutils literal"><span class="pre">sudo</span></code> to gain the necessary rights, which may prompt
you for your password. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">atlas</span><span class="o">-</span><span class="n">config</span>
</pre></div>
</div>
<p>will run through the full automated tuning, and:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SAGE_ATLAS_ARCH</span><span class="o">=</span><span class="n">Corei2</span><span class="p">,</span><span class="n">AVX</span><span class="p">,</span><span class="n">SSE3</span><span class="p">,</span><span class="n">SSE2</span><span class="p">,</span><span class="n">SSE1</span> <span class="n">atlas</span><span class="o">-</span><span class="n">config</span>
</pre></div>
</div>
<p>would be appropriate if you have a Core i3/5/7 processor with AVX support.</p>
<p><strong>This page was last updated in July 2016 (Sage 7.3).</strong></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Install from Source Code</a><ul>
<li><a class="reference internal" href="#supported-platforms">Supported platforms</a></li>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a><ul>
<li><a class="reference internal" href="#general-requirements">General requirements</a><ul>
<li><a class="reference internal" href="#disk-space-and-memory">Disk space and memory</a></li>
<li><a class="reference internal" href="#command-line-tools">Command-line tools</a><ul>
<li><a class="reference internal" href="#fortran-and-compiler-suites">Fortran and compiler suites</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-notes">Other notes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#system-specific-requirements">System-specific requirements</a></li>
<li><a class="reference internal" href="#installing-prerequisites">Installing prerequisites</a><ul>
<li><a class="reference internal" href="#linux-prerequisite-installation">Linux prerequisite installation</a></li>
<li><a class="reference internal" href="#mac-os-x-prerequisite-installation">Mac OS X prerequisite installation</a></li>
<li><a class="reference internal" href="#other-platforms">Other platforms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specific-notes-for-make-and-tar">Specific notes for <code class="docutils literal"><span class="pre">make</span></code> and <code class="docutils literal"><span class="pre">tar</span></code></a></li>
<li><a class="reference internal" href="#using-alternative-compilers">Using alternative compilers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-software">Additional software</a><ul>
<li><a class="reference internal" href="#recommended-programs">Recommended programs</a></li>
<li><a class="reference internal" href="#notebook-additional-features">Notebook additional features</a></li>
<li><a class="reference internal" href="#tcl-tk">Tcl/Tk</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-by-step-installation-procedure">Step-by-step installation procedure</a><ul>
<li><a class="reference internal" href="#general-procedure">General procedure</a></li>
<li><a class="reference internal" href="#building-the-notebook-with-ssl-support">Building the notebook with SSL support</a></li>
<li><a class="reference internal" href="#rebasing-issues-on-cygwin">Rebasing issues on Cygwin</a></li>
</ul>
</li>
<li><a class="reference internal" href="#make-targets">Make targets</a></li>
<li><a class="reference internal" href="#environment-variables">Environment variables</a></li>
<li><a class="reference internal" href="#installation-in-a-multiuser-environment">Installation in a Multiuser Environment</a><ul>
<li><a class="reference internal" href="#system-wide-install">System-wide install</a></li>
</ul>
</li>
<li><a class="reference internal" href="#some-common-problems">Some common problems</a><ul>
<li><a class="reference internal" href="#atlas">ATLAS</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="binary.html"
                                  title="previous chapter">Install from Pre-built Binaries</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="standard_packages.html"
                                  title="next chapter">Standard packages</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/source.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <!-- The shading of the "Go" button should be consistent -->
                <!-- with the colour of the header and footer. See the file -->
                <!-- doc/common/themes/sage/theme.conf for colours used by -->
                <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="standard_packages.html" title="Standard packages"
             >next</a> |</li>
        <li class="right" >
          <a href="binary.html" title="Install from Pre-built Binaries"
             >previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="index.html">Install Guide v7.4</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>