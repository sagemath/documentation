<!doctype html>
<html class="no-js" lang="fr" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Recherche" href="search.html" /><link rel="next" title="Utiliser SageTeX" href="sagetex.html" /><link rel="prev" title="Sage, LaTeX et compagnie" href="latex.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Programmation - Tutoriel Sage v10.3</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="_static/custom-furo.css?v=213650f8" />
    <link rel="stylesheet" type="text/css" href="_static/custom-jupyter-sphinx.css?v=6422c25e" />
    <link rel="stylesheet" type="text/css" href="_static/custom-codemirror-monokai.css?v=b5588f12" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Tutoriel Sage v10.3</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../en/index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.3 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Recherche" name="q" aria-label="Recherche">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="index.html">Home - Tutoriel Sage v10.3</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tour.html">Visite guidée</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Visite guidée</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tour_assignment.html">Affectation, égalité et arithmétique</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_help.html">Obtenir de l’aide</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_help.html#fonctions-indentation-et-iteration">Fonctions, indentation et itération</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_algebra.html">Algèbre de base et calcul infinitésimal</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_plotting.html">Graphiques</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_functions.html">Problèmes fréquents concernant les fonctions</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_rings.html">Anneaux de base</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_polynomial.html">Polynômes</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_coercion.html">Parents, conversions, coercitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_linalg.html">Algèbre linéaire</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_groups.html">Groupes finis, groupes abéliens</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_numtheory.html">Théorie des nombres</a></li>
<li class="toctree-l2"><a class="reference internal" href="tour_advanced.html">Quelques mathématiques plus avancées</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interactive_shell.html">La ligne de commande interactive</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="latex.html">Sage, LaTeX et compagnie</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Programmation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sagetex.html">Utiliser SageTeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="afterword.html">Postface</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Annexe</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliographie</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="programmation">
<h1>Programmation<a class="headerlink" href="#programmation" title="Link to this heading">#</a></h1>
<section id="charger-et-attacher-des-fichiers-sage">
<span id="section-loadattach"></span><h2>Charger et attacher des fichiers Sage<a class="headerlink" href="#charger-et-attacher-des-fichiers-sage" title="Link to this heading">#</a></h2>
<p>Nous décrivons maintenant la manière de charger dans Sage des programmes
écrits dans des fichiers séparés. Créons un fichier appelé
<code class="docutils literal notranslate"><span class="pre">example.sage</span></code> avec le contenu suivant :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">print(&quot;Hello World&quot;)</span>
<span class="go">print(2^3)</span>
</pre></div>
</div>
<p>Nous pouvons lire et exécuter le contenu du fichier <code class="docutils literal notranslate"><span class="pre">example.sage</span></code>
en utilisant la commande <code class="docutils literal notranslate"><span class="pre">load</span></code>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;example.sage&quot;</span><span class="p">)</span>
<span class="go">Hello World</span>
<span class="go">8</span>
</pre></div>
</div>
<p>Nous pouvons aussi attacher un fichier Sage à la session en cours avec
la commande <code class="docutils literal notranslate"><span class="pre">attach</span></code> :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">attach</span><span class="p">(</span><span class="s2">&quot;example.sage&quot;</span><span class="p">)</span>
<span class="go">Hello World</span>
<span class="go">8</span>
</pre></div>
</div>
<p>L’effet de cette commande est que si nous modifions maintenant
<code class="docutils literal notranslate"><span class="pre">example.sage</span></code> et entrons une ligne vierge (i.e. appuyons sur
<code class="docutils literal notranslate"><span class="pre">entrée</span></code>), le contenu de <code class="docutils literal notranslate"><span class="pre">example.sage</span></code> sera automatiquement
rechargé dans Sage.</p>
<p>Avec <code class="docutils literal notranslate"><span class="pre">attach</span></code>, le fichier est rechargé automatiquement
dans Sage à chaque modification, ce qui est pratique pour déboguer du
code ; tandis qu’avec <code class="docutils literal notranslate"><span class="pre">load</span></code> il n’est chargé qu’une fois.</p>
<p>Lorsque Sage lit <code class="docutils literal notranslate"><span class="pre">example.sage</span></code>, il le convertit en un programme
Python qui est ensuite exécuté par l’interpréteur Python. Cette
conversion est minimale, elle se résume essentiellement à encapsuler les
littéraux entiers dans des <code class="docutils literal notranslate"><span class="pre">Integer()</span></code> et les littéraux flottants dans
des <code class="docutils literal notranslate"><span class="pre">RealNumber()</span></code>, à remplacer les <code class="docutils literal notranslate"><span class="pre">^</span></code> par des <code class="docutils literal notranslate"><span class="pre">**</span></code>, et à
remplacer par exemple <code class="docutils literal notranslate"><span class="pre">R.2</span></code> par <code class="docutils literal notranslate"><span class="pre">R.gen(2)</span></code>. La version convertie en
Python de <code class="docutils literal notranslate"><span class="pre">example.sage</span></code> est placée dans le même répertoire sous le
nom <code class="docutils literal notranslate"><span class="pre">example.sage.py</span></code>. Elle contient le code suivant :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">print(&quot;Hello World&quot;)</span>
<span class="go">print(Integer(2)**Integer(3))</span>
</pre></div>
</div>
<p>On voit que les littéraux entiers ont été encapsulés et que le <code class="docutils literal notranslate"><span class="pre">^</span></code> a
été remplacé par <code class="docutils literal notranslate"><span class="pre">**</span></code> (en effet, en Python, <code class="docutils literal notranslate"><span class="pre">^</span></code> représente le ou
exclusif et <code class="docutils literal notranslate"><span class="pre">**</span></code> l’exponentiation).</p>
<p>(Ce prétraitement est implémenté dans le fichier
<code class="docutils literal notranslate"><span class="pre">sage/misc/interpreter.py</span></code>.)</p>
<p>On peut coller dans Sage des blocs de code de plusieurs lignes avec des
indentations pourvu que les blocs soient délimités par des
retours à la ligne (cela n’est pas nécessaire quand le code est dans
un fichier). Cependant, la meilleure façon d’entrer ce genre de code
dans Sage est de l’enregistrer dans un fichier et d’utiliser la commande
<code class="docutils literal notranslate"><span class="pre">attach</span></code> comme décrit ci-dessus.</p>
</section>
<section id="ecrire-des-programmes-compiles">
<span id="section-compile"></span><h2>Écrire des programmes compilés<a class="headerlink" href="#ecrire-des-programmes-compiles" title="Link to this heading">#</a></h2>
<p>Dans les calculs mathématiques sur ordinateur, la vitesse a une
importance cruciale. Or, si Python est un langage commode et de très haut
niveau, certaines opérations peuvent être plus rapides de plusieurs
ordres de grandeur si elles sont implémentées sur des types statiques
dans un langage compilé. Certaines parties de Sage auraient été trop
lentes si elles avaient été écrites entièrement en Python. Pour pallier
ce problème, Sage supporte une sorte de « version compilée » de Python
appelée Cython (voir <a class="reference internal" href="bibliography.html#cyt" id="id1"><span>[Cyt]</span></a> et <a class="reference internal" href="bibliography.html#pyr" id="id2"><span>[Pyr]</span></a>). Cython ressemble à la fois
à Python et à C. La plupart des constructions Python, dont la définition
de listes par compréhension, les expressions conditionnelles, les
constructions comme <code class="docutils literal notranslate"><span class="pre">+=</span></code> sont autorisées en Cython. Vous pouvez aussi
importer du code depuis d’autres modules Python. En plus de cela,
vous pouvez déclarer des variables C arbitraires, et faire directement
des appels arbitraires à des bibliothèques C. Le code Cython est
converti en C et compilé avec le compilateur C.</p>
<p>Pour créer votre propre code Sage compilé, donnez à votre fichier source
l’exension <code class="docutils literal notranslate"><span class="pre">.spyx</span></code> (à la place de <code class="docutils literal notranslate"><span class="pre">.sage</span></code>). Avec l’interface en
ligne de commande, vous pouvez charger ou attacher des fichiers de code
compilé exactement comme les fichiers interprétés. Pour l’instant,
le <em>notebook</em> ne permet pas d’attacher des fichiers compilés. La
compilation proprement dite a lieu « en coulisse », sans que vous ayez à
la déclencher explicitement.  La bibliothèque d’objets partagés compilés se trouve
dans <code class="docutils literal notranslate"><span class="pre">$HOME/.sage/temp/hostname/pid/spyx</span></code>. Ces fichiers sont supprimés
lorsque vous quittez Sage.</p>
<p>Attention, le prétraitement des fichiers Sage mentionné plus haut N’EST
PAS appliqué aux fichiers spyx, ainsi, dans un fichier spyx, <code class="docutils literal notranslate"><span class="pre">1/3</span></code>
vaut 0 et non le nombre rationnel <span class="math notranslate nohighlight">\(1/3\)</span>. Pour appeler une fonction
<code class="docutils literal notranslate"><span class="pre">foo</span></code> de la bibliothèque Sage depuis un fichier spyx, importez
<code class="docutils literal notranslate"><span class="pre">sage.all</span></code> et appelez <code class="docutils literal notranslate"><span class="pre">sage.all.foo</span></code>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">import sage.all</span>
<span class="go">def foo(n):</span>
<span class="go">    return sage.all.factorial(n)</span>
</pre></div>
</div>
<section id="appeler-des-fonctions-definies-dans-des-fichiers-c-separes">
<h3>Appeler des fonctions définies dans des fichiers C séparés<a class="headerlink" href="#appeler-des-fonctions-definies-dans-des-fichiers-c-separes" title="Link to this heading">#</a></h3>
<p>Il n’est pas difficile non plus d’accéder à des fonctions écrites en C,
dans des fichiers *.c séparés. Créez dans un même répertoire deux
fichiers <code class="docutils literal notranslate"><span class="pre">test.c</span></code> et <code class="docutils literal notranslate"><span class="pre">test.spyx</span></code> avec les contenus suivants :</p>
<p>Le code C pur : <code class="docutils literal notranslate"><span class="pre">test.c</span></code></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">int add_one(int n) {</span>
<span class="go">  return n + 1;</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Le code Cython : <code class="docutils literal notranslate"><span class="pre">test.spyx</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">cdef extern from &quot;test.c&quot;:</span>
<span class="go">    int add_one(int n)</span>

<span class="go">def test(n):</span>
<span class="go">    return add_one(n)</span>
</pre></div>
</div>
<p>Vous pouvez alors faire :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">attach</span><span class="p">(</span><span class="s2">&quot;test.spyx&quot;</span><span class="p">)</span>
<span class="go">Compiling (...)/test.spyx...</span>
<span class="gp">sage: </span><span class="n">test</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
<p>Si la compilation du code C généré à partir d’un fichier Cython
nécessite une bibliothèque supplémentaire <code class="docutils literal notranslate"><span class="pre">foo</span></code>, ajoutez au source
Cython la ligne <code class="docutils literal notranslate"><span class="pre">clib</span> <span class="pre">foo</span></code>. De même, il est possible d’ajouter un
fichier C supplémentaire <code class="docutils literal notranslate"><span class="pre">bar</span></code> aux fichiers à compiler avec la
déclaration <code class="docutils literal notranslate"><span class="pre">cfile</span> <span class="pre">bar</span></code>.</p>
</section>
</section>
<section id="scripts-python-sage-autonomes">
<span id="section-standalone"></span><h2>Scripts Python/Sage autonomes<a class="headerlink" href="#scripts-python-sage-autonomes" title="Link to this heading">#</a></h2>
<p>Le script autonome suivant, écrit en Sage, permet de factoriser des
entiers, des polynômes, etc. :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">#!/usr/bin/env sage</span>

<span class="go">import sys</span>
<span class="go">from sage.all import *</span>

<span class="go">if len(sys.argv) != 2:</span>
<span class="go">    print(&quot;Usage: %s &lt;n&gt;&quot; % sys.argv[0])</span>
<span class="go">    print(&quot;Outputs the prime factorization of n.&quot;)</span>
<span class="go">    sys.exit(1)</span>

<span class="go">print(factor(sage_eval(sys.argv[1])))</span>
</pre></div>
</div>
<p>Pour utiliser ce script, votre répertoire <code class="docutils literal notranslate"><span class="pre">SAGE_ROOT</span></code> doit apparaître
dans la variable d’environnement PATH. Supposons que le script ci-dessus
soit appelé <code class="docutils literal notranslate"><span class="pre">factor</span></code>, il peut alors être utilisé comme dans l’exemple
suivant :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">bash $ ./factor 2006</span>
<span class="go">2 * 17 * 59</span>
</pre></div>
</div>
</section>
<section id="types-de-donnees">
<h2>Types de données<a class="headerlink" href="#types-de-donnees" title="Link to this heading">#</a></h2>
<p>Chaque objet Sage a un type bien défini. Python dispose d’une vaste
gamme de types intégrés et la bibliothèque Sage en fournit de nombreux
autres. Parmi les types intégrés de Python, citons les chaînes, les
listes, les n-uplets, les entiers et les flottants :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;sage&quot;</span><span class="p">;</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">&lt;... &#39;str&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;sage&#39;</span><span class="p">;</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>      <span class="c1"># guillemets simples ou doubles</span>
<span class="go">&lt;... &#39;str&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">&lt;... &#39;list&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">&lt;... &#39;tuple&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2006</span><span class="p">);</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">&lt;... &#39;int&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">2006</span><span class="p">);</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">&lt;... &#39;float&#39;&gt;</span>
</pre></div>
</div>
<p>Sage ajoute de nombreux autres types. Par exemple, les espaces
vectoriels :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">VectorSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">);</span> <span class="n">V</span>
<span class="go">Vector space of dimension 1000000 over Rational Field</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.modules.free_module.FreeModule_ambient_field_with_category&#39;&gt;</span>
</pre></div>
</div>
<p>Seules certaines fonctions peuvent être appelées sur <code class="docutils literal notranslate"><span class="pre">V</span></code>. Dans
d’autres logiciels mathématiques, cela se fait en notation
« fonctionnelle », en écrivant <code class="docutils literal notranslate"><span class="pre">foo(V,...)</span></code>. En Sage, certaines
fonctions sont attachés au type (ou classe) de l’objet et appelées avec
une syntaxe « orientée objet » comme en Java ou en C++, par exemple
<code class="docutils literal notranslate"><span class="pre">V.foo(...)</span></code>. Cela évite de polluer l’espace de noms global avec des
dizaines de milliers de fonctions, et cela permet d’avoir plusieurs
fonctions appelées <code class="docutils literal notranslate"><span class="pre">foo</span></code>, avec des comportements différents, sans devoir
se reposer sur le type des arguments (ni sur des instructions case) pour
décider laquelle appeler. De plus, une fonction dont vous réutilisez le
nom demeure disponible : par exemple, si vous appelez quelque chose
<code class="docutils literal notranslate"><span class="pre">zeta</span></code> et si ensuite vous voulez calculer la valeur de la fonction
zêta de Riemann au point 0.5, vous pouvez encore écrire <code class="docutils literal notranslate"><span class="pre">s=.5;</span>
<span class="pre">s.zeta()</span></code>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">zeta</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">=</span><span class="mf">.5</span><span class="p">;</span> <span class="n">s</span><span class="o">.</span><span class="n">zeta</span><span class="p">()</span>
<span class="go">-1.46035450880959</span>
</pre></div>
</div>
<p>La notation fonctionnelle usuelle est aussi acceptée dans certains cas
courants, par commodité et parce que certaines expressions mathématiques
ne sont pas claires en notation orientée objet. Voici quelques exemples.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">n</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">sqrt(2)</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">sqrt(2)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">VectorSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">    [</span>
<span class="go">    (1, 0),</span>
<span class="go">    (0, 1)</span>
<span class="go">    ]</span>
<span class="gp">sage: </span><span class="n">basis</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="go">    [</span>
<span class="go">    (1, 0),</span>
<span class="go">    (0, 1)</span>
<span class="go">    ]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="mi">2</span><span class="p">);</span> <span class="n">M</span>
<span class="go">Full MatrixSpace of 2 by 2 dense matrices over Finite Field of size 7</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">[1 2]</span>
<span class="go">[3 4]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">x^2 + 2*x + 5</span>
<span class="gp">sage: </span><span class="n">charpoly</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">x^2 + 2*x + 5</span>
</pre></div>
</div>
<p>Pour obtenir la liste de toutes les fonctions membres de <span class="math notranslate nohighlight">\(A\)</span>,
utilisez la complétion de ligne de commande : tapez <code class="docutils literal notranslate"><span class="pre">A.</span></code>, puis appuyez
sur la touche <code class="docutils literal notranslate"><span class="pre">[tab]</span></code> de votre clavier, comme expliqué dans la section
<a class="reference internal" href="interactive_shell.html#section-tabcompletion"><span class="std std-ref">Recherche en arrière et complétion de ligne de commande</span></a>.</p>
</section>
<section id="listes-n-uplets-et-sequences">
<h2>Listes, n-uplets et séquences<a class="headerlink" href="#listes-n-uplets-et-sequences" title="Link to this heading">#</a></h2>
<p>Une liste stocke des éléments qui peuvent être de type arbitraire. Comme
en C, en C++ etc. (mais au contraire de ce qu’il se passe dans la
plupart des systèmes de calcul formel usuels) les éléments de la liste
sont indexés à partir de <span class="math notranslate nohighlight">\(0\)</span> :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">SymmetricGroup</span><span class="p">(</span><span class="mi">3</span><span class="p">)];</span> <span class="n">v</span>
<span class="go">[2, 3, 5, &#39;x&#39;, Symmetric group of order 3! as a permutation group]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">&lt;... &#39;list&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">5</span>
</pre></div>
</div>
<p>Lors d’un accès à une liste, l’index n’a pas besoin d’être un entier
Python. Un entier (Integer) Sage (ou un Rational, ou n’importe quoi
d’autre qui a une méthode <code class="docutils literal notranslate"><span class="pre">__index__</span></code>) fait aussi l’affaire.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>      <span class="c1"># Integer (entier Sage)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>       <span class="c1"># ça marche !</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>  <span class="c1"># Ok aussi</span>
<span class="go">3</span>
</pre></div>
</div>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">range</span></code> crée une liste d’entiers Python (et non d’entiers
Sage) :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="go">[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]</span>
</pre></div>
</div>
<p>Cela est utile pour construire des listes par compréhension :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">factor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[1, 2, 3, 2^2, 5, 2 * 3, 7, 2^3, 3^2, 2 * 5, 11, 2^2 * 3, 13, 2 * 7]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
<span class="go">13</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
<span class="go">&lt;class &#39;sage.structure.factorization_integer.IntegerFactorization&#39;&gt;</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">factor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_odd</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="go">[1, 3, 5, 7, 3^2, 11, 13]</span>
</pre></div>
</div>
<p>Pour plus d’information sur les compréhensions, voir <a class="reference internal" href="bibliography.html#pyt" id="id3"><span>[PyT]</span></a>.</p>
<p>Une fonctionnalité merveilleuse est l’extraction de tranches d’une
liste. Si <code class="docutils literal notranslate"><span class="pre">L</span></code> est une liste, <code class="docutils literal notranslate"><span class="pre">L[m:n]</span></code> renvoie la sous-liste de <code class="docutils literal notranslate"><span class="pre">L</span></code>
formée des éléments d’indices <span class="math notranslate nohighlight">\(m\)</span> à <span class="math notranslate nohighlight">\(n-1\)</span> inclus :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">factor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
<span class="go">[5, 2 * 3, 7, 2^3, 3^2]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">[1, 2, 3, 2^2]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">14</span><span class="p">:]</span>
<span class="go">[3 * 5, 2^4, 17, 2 * 3^2, 19]</span>
</pre></div>
</div>
<p>Les n-uplets ressemblent aux listes, à ceci près qu’ils sont non
mutables, ce qui signifie qu’ils ne peuvent plus être modifiés
une fois créés.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span> <span class="n">v</span>
<span class="go">(1, 2, 3, 4)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">&lt;... &#39;tuple&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: &#39;tuple&#39; object does not support item assignment</span>
</pre></div>
</div>
<p>Les séquences sont un troisième type Sage analogue aux listes.
Contrairement aux listes et aux n-uplets, il ne s’agit pas d’un type
interne de Python. Par défaut, les séquences sont mutables, mais on
peut interdire leur modification en utilisant la méthode
<code class="docutils literal notranslate"><span class="pre">set_immutable</span></code> de la classe <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>, comme dans l’exemple
suivant. Tous les éléments d’une séquence ont un parent commun, appelé
l’univers de la séquence.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">[1, 2, 3, 4/5]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.structure.sequence.Sequence_generic&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">&lt;class &#39;sage.rings.rational.Rational&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Rational Field</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">is_immutable</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: object is immutable; please change a copy instead.</span>
</pre></div>
</div>
<p>Les séquences sont des objets dérivés des listes, et peuvent être
utilisées partout où les listes peuvent l’être :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4/5]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="go">&lt;... &#39;list&#39;&gt;</span>
</pre></div>
</div>
<p>Autre exemple : les bases d’espaces vectoriels sont des séquences non
mutables, car il ne faut pas les modifier.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">^</span><span class="mi">3</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">();</span> <span class="n">B</span>
<span class="go">[</span>
<span class="go">(1, 0, 0),</span>
<span class="go">(0, 1, 0),</span>
<span class="go">(0, 0, 1)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.structure.sequence.Sequence_generic&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: object is immutable; please change a copy instead.</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Vector space of dimension 3 over Rational Field</span>
</pre></div>
</div>
</section>
<section id="dictionnaires">
<h2>Dictionnaires<a class="headerlink" href="#dictionnaires" title="Link to this heading">#</a></h2>
<p>Un dictionnaire (parfois appelé un tableau associatif) est une
correspondance entre des objets « hachables » (par exemple des chaînes, des
nombres, ou des n-uplets de tels objets, voir
<a class="reference external" href="http://docs.python.org/tut/node7.html">http://docs.python.org/tut/node7.html</a> et
<a class="reference external" href="http://docs.python.org/lib/typesmapping.html">http://docs.python.org/lib/typesmapping.html</a> dans la documentation de
Python pour plus de détails) vers des objets arbitraires.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;sage&#39;</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">:</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)}</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">&lt;... &#39;dict&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">[1, &#39;sage&#39;, Integer Ring]</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;sage&#39;</span><span class="p">]</span>
<span class="go">17</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">[</span><span class="n">ZZ</span><span class="p">]</span>
<span class="go">Finite Field of size 7</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">5</span>
</pre></div>
</div>
<p>La troisième clé utilisée ci-dessus, l’anneau des entiers relatifs,
montre que les indices d’un dictionnaire peuvent être des objets
compliqués.</p>
<p>Un dictionnaire peut être transformé en une liste de couples clé-objet
contenant les mêmes données :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(1, 5), (&#39;sage&#39;, 17), (Integer Ring, Finite Field of size 7)]</span>
</pre></div>
</div>
<p>Le parcours itératifs des paires d’un dictionnaire est un idiome de
programmation fréquent :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">16</span><span class="p">}</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
<span class="go">[8, 27, 64]</span>
</pre></div>
</div>
<p>Comme le montre la dernière sortie ci-dessus, un dictionnaire stocke ses
éléments sans ordre particulier.</p>
</section>
<section id="ensembles">
<h2>Ensembles<a class="headerlink" href="#ensembles" title="Link to this heading">#</a></h2>
<p>Python dispose d’un type ensemble intégré. Sa principale caractéristique
est qu’il est possible de tester très rapidement si un élément
appartient ou non à un ensemble. Le type ensemble fournit les opérations
ensemblistes usuelles.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">]);</span>   <span class="n">Y</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span>   <span class="c1"># random sort order</span>
<span class="go">{1, 19, &#39;a&#39;}</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Y</span>
<span class="go">{2/3, 1}</span>
<span class="gp">sage: </span><span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">X</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">Y</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="go">{1}</span>
</pre></div>
</div>
<p>Sage a son propre type ensemble, qui est (dans certains cas) implémenté
au-dessus du type Python, mais offre quelques fonctionnalités
supplémentaires utiles à Sage. Pour créer un ensemble Sage, on utilise
<code class="docutils literal notranslate"><span class="pre">Set(...)</span></code>. Par exemple,</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">Set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">]);</span>   <span class="n">Y</span> <span class="o">=</span> <span class="n">Set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span>   <span class="c1"># random sort order</span>
<span class="go">{&#39;a&#39;, 1, 19}</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">==</span> <span class="n">Set</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Y</span>
<span class="go">{1, 2/3}</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="go">{1}</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
<span class="go">\left\{1, \frac{2}{3}\right\}</span>
<span class="gp">sage: </span><span class="n">Set</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">Set of elements of Integer Ring</span>
</pre></div>
</div>
</section>
<section id="iterateurs">
<h2>Itérateurs<a class="headerlink" href="#iterateurs" title="Link to this heading">#</a></h2>
<p>Les itérateurs sont un ajout récent à Python, particulièrement utile
dans les applications mathématiques. Voici quelques exemples, consultez
<a class="reference internal" href="bibliography.html#pyt" id="id4"><span>[PyT]</span></a> pour plus de détails. Fabriquons un itérateur sur les carrés
d’entiers positifs jusqu’à <span class="math notranslate nohighlight">\(10000000\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000000</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Nous créons maintenant un itérateur sur les nombres premiers de la forme
<span class="math notranslate nohighlight">\(4p+1\)</span> où <span class="math notranslate nohighlight">\(p\)</span> est lui aussi premier, et nous examinons les
quelques premières valeurs qu’il prend.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Primes</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">&lt;generator object &lt;genexpr&gt; at 0x...&gt;</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">13</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">29</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">53</span>
</pre></div>
</div>
<p>Certains anneaux, par exemple les corps finis et les entiers, disposent
d’itérateurs associés :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6]</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ZZ</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">(0, 0)</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">(0, -1)</span>
</pre></div>
</div>
</section>
<section id="boucles-fonctions-structures-de-controle-et-comparaisons">
<h2>Boucles, fonctions, structures de contrôle et comparaisons<a class="headerlink" href="#boucles-fonctions-structures-de-controle-et-comparaisons" title="Link to this heading">#</a></h2>
<p>Nous avons déjà vu quelques exemples courants d’utilisation des boucles
<code class="docutils literal notranslate"><span class="pre">for</span></code>. En Python, les boucles <code class="docutils literal notranslate"><span class="pre">for</span></code> ont la structure suivante, avec
une indentation :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; for i in range(5):</span>
<span class="go">...     print(i)</span>
<span class="go">...</span>
<span class="go">0</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Notez bien les deux points à la fin de l’instruction for (il n’y a pas de
« do » ou « od » comme en Maple ou en GAP) ainsi que l’indentation du
corps de la boucle, formé de l’unique instruction <code class="docutils literal notranslate"><span class="pre">print(i)</span></code>. Cette
indentation est significative, c’est elle qui délimite le corps de la
boucle. Depuis la ligne de commande Sage, les lignes suivantes sont
automatiquement indentées quand vous appuyez sur <code class="docutils literal notranslate"><span class="pre">entrée</span></code> après un
signe « : », comme illustré ci-dessous.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="c1"># appuyez deux fois sur entrée ici</span>
<span class="go">0</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Le signe <code class="docutils literal notranslate"><span class="pre">=</span></code> représente l’affectation.
L’opérateur <code class="docutils literal notranslate"><span class="pre">==</span></code> est le test d’égalité.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">4</span>
<span class="go">7</span>
<span class="go">8</span>
<span class="go">11</span>
<span class="go">13</span>
<span class="go">14</span>
</pre></div>
</div>
<p>Retenez bien que l’indentation détermine la structure en blocs des
instructions <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">for</span></code> et <code class="docutils literal notranslate"><span class="pre">while</span></code> :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">legendre</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">is_sqr_modp</span><span class="o">=-</span><span class="mi">1</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="n">a</span> <span class="o">%</span> <span class="n">p</span> <span class="o">==</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="o">%</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">....: </span>            <span class="n">is_sqr_modp</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="n">is_sqr_modp</span>

<span class="gp">sage: </span><span class="n">legendre</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">legendre</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>Naturellement, l’exemple précédent n’est pas une implémentation efficace du
symbole de Legendre ! Il est simplement destiné à illustrer différents
aspects de la programmation Python/Sage. La fonction {kronecker} fournie
avec Sage calcule le symbole de Legendre efficacement, en appelant la
bibliothèque C de PARI.</p>
<p>Remarquons aussi que les opérateurs de comparaison numériques comme <code class="docutils literal notranslate"><span class="pre">==</span></code>,
<code class="docutils literal notranslate"><span class="pre">!=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> convertissent automatiquement leurs
deux membres en des nombres du même type lorsque c’est possible :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mf">3.1</span><span class="p">;</span> <span class="mf">3.1</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="go">True</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>   <span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">/</span><span class="mi">1</span>
<span class="go">True</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Pour évaluer des inégalités symboliques, utilisez <code class="docutils literal notranslate"><span class="pre">bool</span></code> :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">x &lt; x + 1</span>
<span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Lorsque l’on cherche à comparer des objets de types différents, Sage essaie le
plus souvent de trouver une coercition canonique des deux objets dans un même
parent (voir la section <a class="reference internal" href="tour_coercion.html#section-coercion"><span class="std std-ref">Parents, conversions, coercitions</span></a> pour plus de détails). Si cela
réussit, la comparaison est faite entre les objets convertis ; sinon, les
objets sont simplement considérés comme différents. Pour tester si deux
variables font référence au même objet, on utilise l’opérateur <code class="docutils literal notranslate"><span class="pre">is</span></code>. Ainsi,
l’entier Python (<code class="docutils literal notranslate"><span class="pre">int</span></code>) <code class="docutils literal notranslate"><span class="pre">1</span></code> est unique, mais pas l’entier Sage <code class="docutils literal notranslate"><span class="pre">1</span></code> :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mi">1</span> <span class="ow">is</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mi">1</span> <span class="ow">is</span> <span class="mi">1</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mi">1</span> <span class="o">==</span> <span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Dans les deux lignes suivantes, la première égalité est fausse parce
qu’il n’y a pas de morphisme canonique <span class="math notranslate nohighlight">\(\QQ\to
\GF{5}\)</span>, et donc pas de manière canonique de comparer l’élément
<span class="math notranslate nohighlight">\(1\)</span> de <span class="math notranslate nohighlight">\(\GF{5}\)</span> à <span class="math notranslate nohighlight">\(1 \in \QQ\)</span>. En
revanche, il y a une projection canonique <span class="math notranslate nohighlight">\(\ZZ \to
\GF{5}\)</span>, de sorte que la deuxième comparaison renvoie « vrai ».
Remarquez aussi que l’ordre des membres de l’égalité n’a pas
d’importance.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">QQ</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">QQ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">ZZ</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">ZZ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">QQ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>ATTENTION : La comparaison est plus restrictive en Sage qu’en Magma, qui
considère <span class="math notranslate nohighlight">\(1 \in \GF{5}\)</span> comme égal à <span class="math notranslate nohighlight">\(1 \in \QQ\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">magma</span><span class="p">(</span><span class="s1">&#39;GF(5)!1 eq Rationals()!1&#39;</span><span class="p">)</span>  <span class="c1"># optional - magma</span>
<span class="go">true</span>
</pre></div>
</div>
</section>
<section id="profilage-profiling">
<h2>Profilage (profiling)<a class="headerlink" href="#profilage-profiling" title="Link to this heading">#</a></h2>
<p>Auteur de la section : Martin Albrecht (<a class="reference external" href="mailto:malb&#37;&#52;&#48;informatik&#46;uni-bremen&#46;de">malb<span>&#64;</span>informatik<span>&#46;</span>uni-bremen<span>&#46;</span>de</a>)</p>
<blockquote>
<div><p>« Premature optimization is the root of all evil. » - Donald Knuth
(« L’optimisation prématurée est la source de tous les maux. »)</p>
</div></blockquote>
<p>Il est parfois utile de rechercher dans un programme les goulets
d’étranglements qui représentent la plus grande partie du temps de
calcul : cela peut donner une idée des parties à optimiser. Cette
opération s’appelle profiler le code. Python, et donc Sage, offrent un
certain nombre de possibilités pour ce faire.</p>
<p>La plus simple consiste à utiliser la commande <code class="docutils literal notranslate"><span class="pre">prun</span></code> du shell
interactif. Elle renvoie un rapport qui résume les temps d’exécution des
fonctions les plus coûteuses. Pour profiler, par exemple, le produit de
matrices à coefficients dans un corps fini (qui, dans Sage 1.0, est
lent), on entre :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">objgen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,[</span><span class="n">k</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="mi">10</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="o">%</span><span class="k">prun</span> B = A*A
<span class="go">       32893 function calls in 1.100 CPU seconds</span>

<span class="go">Ordered by: internal time</span>

<span class="go">ncalls tottime percall cumtime percall filename:lineno(function)</span>
<span class="go"> 12127  0.160   0.000   0.160  0.000 :0(isinstance)</span>
<span class="go">  2000  0.150   0.000   0.280  0.000 matrix.py:2235(__getitem__)</span>
<span class="go">  1000  0.120   0.000   0.370  0.000 finite_field_element.py:392(__mul__)</span>
<span class="go">  1903  0.120   0.000   0.200  0.000 finite_field_element.py:47(__init__)</span>
<span class="go">  1900  0.090   0.000   0.220  0.000 finite_field_element.py:376(__compat)</span>
<span class="go">   900  0.080   0.000   0.260  0.000 finite_field_element.py:380(__add__)</span>
<span class="go">     1  0.070   0.070   1.100  1.100 matrix.py:864(__mul__)</span>
<span class="go">  2105  0.070   0.000   0.070  0.000 matrix.py:282(ncols)</span>
<span class="go">  ...</span>
</pre></div>
</div>
<p>Ici, <code class="docutils literal notranslate"><span class="pre">ncalls</span></code> désigne le nombre d’appels, <code class="docutils literal notranslate"><span class="pre">tottime</span></code> le temps total
passé dans une fonction (sans compter celui pris par les autres
fonctions appelées par la fonction en question), <code class="docutils literal notranslate"><span class="pre">percall</span></code> est le
rapport <code class="docutils literal notranslate"><span class="pre">tottime</span></code> divisé par <code class="docutils literal notranslate"><span class="pre">ncalls</span></code>. <code class="docutils literal notranslate"><span class="pre">cumtime</span></code> donne le temps
total passé dans la fonction en comptant les appels qu’elle effectue, la
deuxième colonne <code class="docutils literal notranslate"><span class="pre">percall</span></code> est le quotient de <code class="docutils literal notranslate"><span class="pre">cumtime</span></code> par le
nombre d’appels primitifs, et <code class="docutils literal notranslate"><span class="pre">filename:lineno(function)</span></code> donne pour
chaque fonction le nom de fichier et le numéro de la ligne où elle est
définie. En règle générale, plus haut la fonction apparaît dans ce tableau,
plus elle est coûteuse — et donc intéressante à optimiser.</p>
<p>Comme d’habitude, <code class="docutils literal notranslate"><span class="pre">prun?</span></code> donne plus d’informations sur l’utilisation
du profileur et la signification de sa sortie.</p>
<p>Il est possible d’écrire les données de profilage dans un objet pour les
étudier de plus près :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="o">%</span><span class="k">prun</span> -r A*A
<span class="gp">sage: </span><span class="n">stats</span> <span class="o">=</span> <span class="n">_</span>
<span class="gp">sage: </span>stats<span class="o">?</span>
</pre></div>
</div>
<p>Remarque : entrer <code class="docutils literal notranslate"><span class="pre">stats</span> <span class="pre">=</span> <span class="pre">prun</span> <span class="pre">-r</span> <span class="pre">A\*A</span></code> à la place des deux premières
lignes ci-dessus provoque une erreur de syntaxe, car prun n’est pas une
fonction normale mais une commande du shell IPython.</p>
<p>Pour obtenir une jolie représentation graphique des données de
profilage, vous pouvez utiliser le profileur hotshot, un petit script
appelé <code class="docutils literal notranslate"><span class="pre">hotshot2cachetree</span></code> et (sous Unix uniquement) le programme
<code class="docutils literal notranslate"><span class="pre">kcachegrind</span></code>. Voici le même exemple que ci-dessus avec le profileur
hotshot :</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">objgen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,[</span><span class="n">k</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="mi">10</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">hotshot</span>
<span class="gp">sage: </span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pythongrind.prof&quot;</span>
<span class="gp">sage: </span><span class="n">prof</span> <span class="o">=</span> <span class="n">hotshot</span><span class="o">.</span><span class="n">Profile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">lineevents</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">prof</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;A*A&quot;</span><span class="p">)</span>
<span class="go">&lt;hotshot.Profile instance at 0x414c11ec&gt;</span>
<span class="gp">sage: </span><span class="n">prof</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>À ce stade le résultat est dans un fichier <code class="docutils literal notranslate"><span class="pre">pythongrind.prof</span></code> dans le
répertoire de travail courant. Convertissons-le au format cachegrind
pour le visualiser.</p>
<p>Dans le shell du système d’exploitation, tapez</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">hotshot2calltree -o cachegrind.out.42 pythongrind.prof</span>
</pre></div>
</div>
<p>Le fichier <code class="docutils literal notranslate"><span class="pre">cachegrind.out.42</span></code> peut maintenant être examiné avec
<code class="docutils literal notranslate"><span class="pre">kcachegrind</span></code>. Notez qu’il est important de respecter la convention de
nommage <code class="docutils literal notranslate"><span class="pre">cachegrind.out.XX</span></code>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="sagetex.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Utiliser SageTeX</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="latex.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Sage, LaTeX et compagnie</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2024, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Programmation</a><ul>
<li><a class="reference internal" href="#charger-et-attacher-des-fichiers-sage">Charger et attacher des fichiers Sage</a></li>
<li><a class="reference internal" href="#ecrire-des-programmes-compiles">Écrire des programmes compilés</a><ul>
<li><a class="reference internal" href="#appeler-des-fonctions-definies-dans-des-fichiers-c-separes">Appeler des fonctions définies dans des fichiers C séparés</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scripts-python-sage-autonomes">Scripts Python/Sage autonomes</a></li>
<li><a class="reference internal" href="#types-de-donnees">Types de données</a></li>
<li><a class="reference internal" href="#listes-n-uplets-et-sequences">Listes, n-uplets et séquences</a></li>
<li><a class="reference internal" href="#dictionnaires">Dictionnaires</a></li>
<li><a class="reference internal" href="#ensembles">Ensembles</a></li>
<li><a class="reference internal" href="#iterateurs">Itérateurs</a></li>
<li><a class="reference internal" href="#boucles-fonctions-structures-de-controle-et-comparaisons">Boucles, fonctions, structures de contrôle et comparaisons</a></li>
<li><a class="reference internal" href="#profilage-profiling">Profilage (profiling)</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=393a324f"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=0477930c"></script>
    <script src="_static/tabs.js?v=3ee01567"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="_static/translations.js?v=d99ca74e"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="_static/jupyter-sphinx-furo.js?v=1e69cd27"></script>
    </body>
</html>